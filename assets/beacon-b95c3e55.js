import{_ as d,K as v,M as m,N as y}from"./main-653d6738.js";import{N as f,C as A}from"./DAppClient-3841790b.js";let o;const p=async e=>({name:"TEZGOV",iconUrl:"https://tezgov.app/icon/favicon.png",preferredNetwork:e??f.MAINNET,eventHandlers:{},colorMode:A.DARK}),g=async(e,t)=>{const s=await v({method:"get",url:"/assets/styles/beacon.css"}),n=new Promise((c,a)=>{m(document.body,i=>{const r=i;if(typeof r.id=="string"&&r.id.startsWith("beacon-alert-wrapper")){const _=r==null?void 0:r.shadowRoot;if(_){y(_,s.data);const w=_.querySelector(".beacon-modal__close__wrapper");w&&w.addEventListener("click",()=>a("closed"))}return r.style.display="block",!0}return!1})}),l=e.requestPermissions(t);await Promise.race([n,l])},u=async(e,t)=>{await e.client.getActiveAccount()||await g(e,{network:t})},h=async(e,t)=>{if(o!==void 0)if((t==null?void 0:t.useCached)===!0){const c=o;return await u(c,{type:e}),c}else o.disconnect(),o.clearActiveAccount(),o=void 0;const{BeaconWallet:s}=await d(()=>import("./taquito-beacon-wallet.es6-8dbc569f.js"),["assets/taquito-beacon-wallet.es6-8dbc569f.js","assets/DAppClient-3841790b.js","assets/main-653d6738.js","assets/index-64bbceaa.css","assets/taquito.es6-e44d04e4.js"]),n=o??new s(await p(e));return o=n,await u(n,{type:e}),n},k=async()=>{const{BeaconWallet:e}=await d(()=>import("./taquito-beacon-wallet.es6-8dbc569f.js"),["assets/taquito-beacon-wallet.es6-8dbc569f.js","assets/DAppClient-3841790b.js","assets/main-653d6738.js","assets/index-64bbceaa.css","assets/taquito.es6-e44d04e4.js"]),t=o??new e(await p());o=t;const s=await t.client.getActiveAccount();return{active:!!s,networkId:s==null?void 0:s.network.type}},E=async(e="mainnet",t)=>{const{create_toolkit:s}=await d(()=>import("./taquito-eebcd1ca.js"),["assets/taquito-eebcd1ca.js","assets/taquito.es6-e44d04e4.js","assets/main-653d6738.js","assets/index-64bbceaa.css","assets/DAppClient-3841790b.js"]),{tezos:n,forger:l}=await s(t.rpc),c=await h(e,t);n.setWalletProvider(c);const a=await c.client.getActiveAccount(),i=a!=null&&a.address?await n.rpc.getManagerKey(a==null?void 0:a.address):void 0;return{wallet:c,account:a==null?void 0:a.address,tezos:n,forger:l,managerKey:i==null?void 0:i.toString()}},N=async()=>{o==null||o.disconnect(),o=void 0};export{E as connect_beacon_wallet,h as create_beacon_wallet,N as disconnect_beacon_wallet,k as has_active_account};
