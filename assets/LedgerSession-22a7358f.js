import{E as Qt,m as Jt,q as er,v as tr,O as oe,D as rr}from"./main-043506b6.js";import{S as nr}from"./SessionBase-d64d9027.js";import{O as sr,_ as ir}from"./taquito-utils.es6-82c03c39.js";import{L as or}from"./LedgerDialog-ca2fe39d.js";import"./_commonjsHelpers-6dff16f2.js";import"./taquito.es6-a47a8eec.js";import"./index-9aada285.js";import"./index-6f227088.js";import"./DAppClient-8558df6f.js";var ar=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(n[s]=i[s])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();globalThis&&globalThis.__values;var f=function(r){var t=function(e){ar(n,e);function n(i,s,o){var u=e.call(this,i||r,o)||this;if(Object.setPrototypeOf(u,n.prototype),u.name=r,s)for(var c in s)u[c]=s[c];if(o&&cr(o)&&"cause"in o&&!("cause"in u)){var a=o.cause;u.cause=a,"stack"in a&&(u.stack=u.stack+`
CAUSE: `+a.stack)}return u}return n}(Error);return t};function cr(r){return typeof r=="object"}var ur=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(n[s]=i[s])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();f("AccountNameRequired");f("AccountNotSupported");f("AmountRequired");f("BluetoothRequired");f("BtcUnmatchedApp");f("CantOpenDevice");f("CashAddrNotSupported");f("CurrencyNotSupported");f("DeviceAppVerifyNotSupported");f("DeviceGenuineSocketEarlyClose");f("DeviceNotGenuine");f("DeviceOnDashboardExpected");f("DeviceOnDashboardUnexpected");f("DeviceInOSUExpected");f("DeviceHalted");f("DeviceNameInvalid");f("DeviceSocketFail");f("DeviceSocketNoBulkStatus");var lr=f("LockedDeviceError"),At=f("DisconnectedDevice"),_t=f("DisconnectedDeviceDuringOperation");f("DeviceExtractOnboardingStateError");f("DeviceOnboardingStatePollingError");f("EnpointConfig");f("EthAppPleaseEnableContractData");f("FeeEstimationFailed");f("FirmwareNotRecognized");f("HardResetFail");f("InvalidXRPTag");f("InvalidAddress");f("InvalidAddressBecauseDestinationIsAlsoSource");f("LatestMCUInstalledError");f("UnknownMCU");f("LedgerAPIError");f("LedgerAPIErrorWithMessage");f("LedgerAPINotAvailable");f("ManagerAppAlreadyInstalled");f("ManagerAppRelyOnBTC");f("ManagerAppDepInstallRequired");f("ManagerAppDepUninstallRequired");f("ManagerDeviceLocked");f("ManagerFirmwareNotEnoughSpace");f("ManagerNotEnoughSpace");f("ManagerUninstallBTCDep");f("NetworkDown");f("NoAddressesFound");f("NotEnoughBalance");f("NotEnoughBalanceToDelegate");f("NotEnoughBalanceInParentAccount");f("NotEnoughSpendableBalance");f("NotEnoughBalanceBecauseDestinationNotCreated");f("NoAccessToCamera");f("NotEnoughGas");f("NotSupportedLegacyAddress");f("GasLessThanEstimate");f("PriorityFeeTooLow");f("PriorityFeeTooHigh");f("PriorityFeeHigherThanMaxFee");f("MaxFeeTooLow");f("PasswordsDontMatch");f("PasswordIncorrect");f("RecommendSubAccountsToEmpty");f("RecommendUndelegation");f("TimeoutTagged");f("UnexpectedBootloader");f("MCUNotGenuineToDashboard");f("RecipientRequired");f("UnavailableTezosOriginatedAccountReceive");f("UnavailableTezosOriginatedAccountSend");f("UpdateFetchFileFail");f("UpdateIncorrectHash");f("UpdateIncorrectSig");f("UpdateYourApp");f("UserRefusedDeviceNameChange");f("UserRefusedAddress");f("UserRefusedFirmwareUpdate");f("UserRefusedAllowManager");f("UserRefusedOnDevice");var Fe=f("TransportOpenUserCancelled"),Ze=f("TransportInterfaceNotAvailable"),fr=f("TransportRaceCondition"),hr=f("TransportWebUSBGestureRequired");f("DeviceShouldStayInApp");f("WebsocketConnectionError");f("WebsocketConnectionFailed");f("WrongDeviceForAccount");f("WrongAppForCurrency");f("ETHAddressNonEIP");f("CantScanQRCode");f("FeeNotLoaded");f("FeeRequired");f("FeeTooHigh");f("DustLimit");f("PendingOperation");f("SyncError");f("PairingFailed");f("GenuineCheckFailed");f("LedgerAPI4xx");f("LedgerAPI5xx");f("FirmwareOrAppUpdateRequired");f("LanguageNotFound");f("NoDBPathGiven");f("DBWrongPassword");f("DBNotReset");var k=function(r){ur(t,r);function t(e,n){var i=this,s="TransportError";return i=r.call(this,e||s)||this,i.name=s,i.message=e,i.stack=new Error().stack,i.id=n,i}return t}(Error),he={PIN_REMAINING_ATTEMPTS:25536,INCORRECT_LENGTH:26368,MISSING_CRITICAL_PARAMETER:26624,COMMAND_INCOMPATIBLE_FILE_STRUCTURE:27009,SECURITY_STATUS_NOT_SATISFIED:27010,CONDITIONS_OF_USE_NOT_SATISFIED:27013,INCORRECT_DATA:27264,NOT_ENOUGH_MEMORY_SPACE:27268,REFERENCED_DATA_NOT_FOUND:27272,FILE_ALREADY_EXISTS:27273,INCORRECT_P1_P2:27392,INS_NOT_SUPPORTED:27904,CLA_NOT_SUPPORTED:28160,TECHNICAL_PROBLEM:28416,OK:36864,MEMORY_PROBLEM:37440,NO_EF_SELECTED:37888,INVALID_OFFSET:37890,FILE_NOT_FOUND:37892,INCONSISTENT_FILE:37896,ALGORITHM_NOT_SUPPORTED:38020,INVALID_KCV:38021,CODE_NOT_INITIALIZED:38914,ACCESS_CONDITION_NOT_FULFILLED:38916,CONTRADICTION_SECRET_CODE_STATUS:38920,CONTRADICTION_INVALIDATION:38928,CODE_BLOCKED:38976,MAX_VALUE_REACHED:38992,GP_AUTH_FAILED:25344,LICENSING:28482,HALTED:28586,LOCKED_DEVICE:21781,CUSTOM_IMAGE_EMPTY:26158,CUSTOM_IMAGE_BOOTLOADER:26159};function pr(r){switch(r){case 26368:return"Incorrect length";case 26624:return"Missing critical parameter";case 27010:return"Security not satisfied (dongle locked or have invalid access rights)";case 27013:return"Condition of use not satisfied (denied by the user?)";case 27264:return"Invalid data received";case 27392:return"Invalid parameter received";case 21781:return"Locked device"}if(28416<=r&&r<=28671)return"Internal error, please report"}function xt(r){var t=Object.keys(he).find(function(s){return he[s]===r})||"UNKNOWN_ERROR",e=pr(r)||t,n=r.toString(16),i="Ledger device: ".concat(e," (0x").concat(n,")");if(r===he.LOCKED_DEVICE)throw new lr(i);this.name="TransportStatusError",this.message=i,this.stack=new Error().stack,this.statusCode=r,this.statusText=t}xt.prototype=new Error;var Re=globalThis&&globalThis.__awaiter||function(r,t,e,n){function i(s){return s instanceof e?s:new e(function(o){o(s)})}return new(e||(e=Promise))(function(s,o){function u(l){try{a(n.next(l))}catch(h){o(h)}}function c(l){try{a(n.throw(l))}catch(h){o(h)}}function a(l){l.done?s(l.value):i(l.value).then(u,c)}a((n=n.apply(r,t||[])).next())})},Ne=globalThis&&globalThis.__generator||function(r,t){var e={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(a){return function(l){return c([a,l])}}function c(a){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,i&&(s=a[0]&2?i.return:a[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,a[1])).done)return s;switch(i=0,s&&(a=[a[0]&2,s.value]),a[0]){case 0:case 1:s=a;break;case 4:return e.label++,{value:a[1],done:!1};case 5:e.label++,i=a[1],a=[0];continue;case 7:a=e.ops.pop(),e.trys.pop();continue;default:if(s=e.trys,!(s=s.length>0&&s[s.length-1])&&(a[0]===6||a[0]===2)){e=0;continue}if(a[0]===3&&(!s||a[1]>s[0]&&a[1]<s[3])){e.label=a[1];break}if(a[0]===6&&e.label<s[1]){e.label=s[1],s=a;break}if(s&&e.label<s[2]){e.label=s[2],e.ops.push(a);break}s[2]&&e.ops.pop(),e.trys.pop();continue}a=t.call(r,e)}catch(l){a=[6,l],i=0}finally{n=s=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},dr=globalThis&&globalThis.__read||function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),i,s=[],o;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(u){o={error:u}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(o)throw o.error}}return s},vr=globalThis&&globalThis.__spreadArray||function(r,t,e){if(e||arguments.length===2)for(var n=0,i=t.length,s;n<i;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return r.concat(s||Array.prototype.slice.call(t))},gr=globalThis&&globalThis.__values||function(r){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&r[t],n=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Lt=function(){function r(){var t=this;this.exchangeTimeout=3e4,this.unresponsiveTimeout=15e3,this.deviceModel=null,this._events=new sr.exports,this.send=function(e,n,i,s,o,u){return o===void 0&&(o=Buffer.alloc(0)),u===void 0&&(u=[he.OK]),Re(t,void 0,void 0,function(){var c,a;return Ne(this,function(l){switch(l.label){case 0:if(o.length>=256)throw new k("data.length exceed 256 bytes limit. Got: "+o.length,"DataLengthTooBig");return[4,this.exchange(Buffer.concat([Buffer.from([e,n,i,s]),Buffer.from([o.length]),o]))];case 1:if(c=l.sent(),a=c.readUInt16BE(c.length-2),!u.some(function(h){return h===a}))throw new xt(a);return[2,c]}})})},this.exchangeAtomicImpl=function(e){return Re(t,void 0,void 0,function(){var n,i,s,o,u,c=this;return Ne(this,function(a){switch(a.label){case 0:if(this.exchangeBusyPromise)throw new fr("An action was already pending on the Ledger device. Please deny or reconnect.");i=new Promise(function(l){n=l}),this.exchangeBusyPromise=i,s=!1,o=setTimeout(function(){s=!0,c.emit("unresponsive")},this.unresponsiveTimeout),a.label=1;case 1:return a.trys.push([1,,3,4]),[4,e()];case 2:return u=a.sent(),s&&this.emit("responsive"),[2,u];case 3:return clearTimeout(o),n&&n(),this.exchangeBusyPromise=null,[7];case 4:return[2]}})})},this._appAPIlock=null}return r.prototype.exchange=function(t){throw new Error("exchange not implemented")},r.prototype.setScrambleKey=function(t){},r.prototype.close=function(){return Promise.resolve()},r.prototype.on=function(t,e){this._events.on(t,e)},r.prototype.off=function(t,e){this._events.removeListener(t,e)},r.prototype.emit=function(t){for(var e,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];(e=this._events).emit.apply(e,vr([t],dr(n),!1))},r.prototype.setDebugMode=function(){console.warn("setDebugMode is deprecated. use @ledgerhq/logs instead. No logs are emitted in this anymore.")},r.prototype.setExchangeTimeout=function(t){this.exchangeTimeout=t},r.prototype.setExchangeUnresponsiveTimeout=function(t){this.unresponsiveTimeout=t},r.create=function(t,e){var n=this;return t===void 0&&(t=3e3),new Promise(function(i,s){var o=!1,u=n.listen({next:function(a){o=!0,u&&u.unsubscribe(),c&&clearTimeout(c),n.open(a.descriptor,t).then(i,s)},error:function(a){c&&clearTimeout(c),s(a)},complete:function(){c&&clearTimeout(c),o||s(new k(n.ErrorMessage_NoDeviceFound,"NoDeviceFound"))}}),c=e?setTimeout(function(){u.unsubscribe(),s(new k(n.ErrorMessage_ListenTimeout,"ListenTimeout"))},e):null})},r.prototype.decorateAppAPIMethods=function(t,e,n){var i,s;try{for(var o=gr(e),u=o.next();!u.done;u=o.next()){var c=u.value;t[c]=this.decorateAppAPIMethod(c,t[c],t,n)}}catch(a){i={error:a}}finally{try{u&&!u.done&&(s=o.return)&&s.call(o)}finally{if(i)throw i.error}}},r.prototype.decorateAppAPIMethod=function(t,e,n,i){var s=this;return function(){for(var o=[],u=0;u<arguments.length;u++)o[u]=arguments[u];return Re(s,void 0,void 0,function(){var c;return Ne(this,function(a){switch(a.label){case 0:if(c=this._appAPIlock,c)return[2,Promise.reject(new k("Ledger Device is busy (lock "+c+")","TransportLocked"))];a.label=1;case 1:return a.trys.push([1,,3,4]),this._appAPIlock=t,this.setScrambleKey(i),[4,e.apply(n,o)];case 2:return[2,a.sent()];case 3:return this._appAPIlock=null,[7];case 4:return[2]}})})}},r.ErrorMessage_ListenTimeout="No Ledger device found (timeout)",r.ErrorMessage_NoDeviceFound="No Ledger device found",r}(),Qe=5;function Er(r){var t=Buffer.alloc(2);return t.writeUInt16BE(r,0),t}var mr={data:Buffer.alloc(0),dataLength:0,sequence:0},Dt=function(r,t){return{makeBlocks:function(e){var n=Buffer.concat([Er(e.length),e]),i=t-5,s=Math.ceil(n.length/i);n=Buffer.concat([n,Buffer.alloc(s*i-n.length+1).fill(0)]);for(var o=[],u=0;u<s;u++){var c=Buffer.alloc(5);c.writeUInt16BE(r,0),c.writeUInt8(Qe,2),c.writeUInt16BE(u,3);var a=n.slice(u*i,(u+1)*i);o.push(Buffer.concat([c,a]))}return o},reduceResponse:function(e,n){var i=e||mr,s=i.data,o=i.dataLength,u=i.sequence;if(n.readUInt16BE(0)!==r)throw new k("Invalid channel","InvalidChannel");if(n.readUInt8(2)!==Qe)throw new k("Invalid tag","InvalidTag");if(n.readUInt16BE(3)!==u)throw new k("Invalid sequence","InvalidSequence");e||(o=n.readUInt16BE(5)),u++;var c=n.slice(e?5:7);return s=Buffer.concat([s,c]),s.length>o&&(s=s.slice(0,o)),{data:s,dataLength:o,sequence:u}},getReducedResult:function(e){if(e&&e.dataLength===e.data.length)return e.data}}},q={exports:{}};const yr="2.0.0",Ir=256,$r=Number.MAX_SAFE_INTEGER||9007199254740991,wr=16;var me={SEMVER_SPEC_VERSION:yr,MAX_LENGTH:Ir,MAX_SAFE_INTEGER:$r,MAX_SAFE_COMPONENT_LENGTH:wr};const Tr=typeof process=="object"&&{}&&{}.NODE_DEBUG&&/\bsemver\b/i.test({}.NODE_DEBUG)?(...r)=>console.error("SEMVER",...r):()=>{};var ye=Tr;(function(r,t){const{MAX_SAFE_COMPONENT_LENGTH:e}=me,n=ye;t=r.exports={};const i=t.re=[],s=t.src=[],o=t.t={};let u=0;const c=(a,l,h)=>{const I=u++;n(a,I,l),o[a]=I,s[I]=l,i[I]=new RegExp(l,h?"g":void 0)};c("NUMERICIDENTIFIER","0|[1-9]\\d*"),c("NUMERICIDENTIFIERLOOSE","[0-9]+"),c("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),c("MAINVERSION",`(${s[o.NUMERICIDENTIFIER]})\\.(${s[o.NUMERICIDENTIFIER]})\\.(${s[o.NUMERICIDENTIFIER]})`),c("MAINVERSIONLOOSE",`(${s[o.NUMERICIDENTIFIERLOOSE]})\\.(${s[o.NUMERICIDENTIFIERLOOSE]})\\.(${s[o.NUMERICIDENTIFIERLOOSE]})`),c("PRERELEASEIDENTIFIER",`(?:${s[o.NUMERICIDENTIFIER]}|${s[o.NONNUMERICIDENTIFIER]})`),c("PRERELEASEIDENTIFIERLOOSE",`(?:${s[o.NUMERICIDENTIFIERLOOSE]}|${s[o.NONNUMERICIDENTIFIER]})`),c("PRERELEASE",`(?:-(${s[o.PRERELEASEIDENTIFIER]}(?:\\.${s[o.PRERELEASEIDENTIFIER]})*))`),c("PRERELEASELOOSE",`(?:-?(${s[o.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${s[o.PRERELEASEIDENTIFIERLOOSE]})*))`),c("BUILDIDENTIFIER","[0-9A-Za-z-]+"),c("BUILD",`(?:\\+(${s[o.BUILDIDENTIFIER]}(?:\\.${s[o.BUILDIDENTIFIER]})*))`),c("FULLPLAIN",`v?${s[o.MAINVERSION]}${s[o.PRERELEASE]}?${s[o.BUILD]}?`),c("FULL",`^${s[o.FULLPLAIN]}$`),c("LOOSEPLAIN",`[v=\\s]*${s[o.MAINVERSIONLOOSE]}${s[o.PRERELEASELOOSE]}?${s[o.BUILD]}?`),c("LOOSE",`^${s[o.LOOSEPLAIN]}$`),c("GTLT","((?:<|>)?=?)"),c("XRANGEIDENTIFIERLOOSE",`${s[o.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),c("XRANGEIDENTIFIER",`${s[o.NUMERICIDENTIFIER]}|x|X|\\*`),c("XRANGEPLAIN",`[v=\\s]*(${s[o.XRANGEIDENTIFIER]})(?:\\.(${s[o.XRANGEIDENTIFIER]})(?:\\.(${s[o.XRANGEIDENTIFIER]})(?:${s[o.PRERELEASE]})?${s[o.BUILD]}?)?)?`),c("XRANGEPLAINLOOSE",`[v=\\s]*(${s[o.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[o.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[o.XRANGEIDENTIFIERLOOSE]})(?:${s[o.PRERELEASELOOSE]})?${s[o.BUILD]}?)?)?`),c("XRANGE",`^${s[o.GTLT]}\\s*${s[o.XRANGEPLAIN]}$`),c("XRANGELOOSE",`^${s[o.GTLT]}\\s*${s[o.XRANGEPLAINLOOSE]}$`),c("COERCE",`(^|[^\\d])(\\d{1,${e}})(?:\\.(\\d{1,${e}}))?(?:\\.(\\d{1,${e}}))?(?:$|[^\\d])`),c("COERCERTL",s[o.COERCE],!0),c("LONETILDE","(?:~>?)"),c("TILDETRIM",`(\\s*)${s[o.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",c("TILDE",`^${s[o.LONETILDE]}${s[o.XRANGEPLAIN]}$`),c("TILDELOOSE",`^${s[o.LONETILDE]}${s[o.XRANGEPLAINLOOSE]}$`),c("LONECARET","(?:\\^)"),c("CARETTRIM",`(\\s*)${s[o.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",c("CARET",`^${s[o.LONECARET]}${s[o.XRANGEPLAIN]}$`),c("CARETLOOSE",`^${s[o.LONECARET]}${s[o.XRANGEPLAINLOOSE]}$`),c("COMPARATORLOOSE",`^${s[o.GTLT]}\\s*(${s[o.LOOSEPLAIN]})$|^$`),c("COMPARATOR",`^${s[o.GTLT]}\\s*(${s[o.FULLPLAIN]})$|^$`),c("COMPARATORTRIM",`(\\s*)${s[o.GTLT]}\\s*(${s[o.LOOSEPLAIN]}|${s[o.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",c("HYPHENRANGE",`^\\s*(${s[o.XRANGEPLAIN]})\\s+-\\s+(${s[o.XRANGEPLAIN]})\\s*$`),c("HYPHENRANGELOOSE",`^\\s*(${s[o.XRANGEPLAINLOOSE]})\\s+-\\s+(${s[o.XRANGEPLAINLOOSE]})\\s*$`),c("STAR","(<|>)?=?\\s*\\*"),c("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),c("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")})(q,q.exports);const Sr=["includePrerelease","loose","rtl"],Rr=r=>r?typeof r!="object"?{loose:!0}:Sr.filter(t=>r[t]).reduce((t,e)=>(t[e]=!0,t),{}):{};var Ie=Rr;const Je=/^[0-9]+$/,Ct=(r,t)=>{const e=Je.test(r),n=Je.test(t);return e&&n&&(r=+r,t=+t),r===t?0:e&&!n?-1:n&&!e?1:r<t?-1:1},Nr=(r,t)=>Ct(t,r);var Pt={compareIdentifiers:Ct,rcompareIdentifiers:Nr};const ae=ye,{MAX_LENGTH:et,MAX_SAFE_INTEGER:ce}=me,{re:tt,t:rt}=q.exports,Or=Ie,{compareIdentifiers:Q}=Pt;let F=class{constructor(t,e){if(e=Or(e),t instanceof F){if(t.loose===!!e.loose&&t.includePrerelease===!!e.includePrerelease)return t;t=t.version}else if(typeof t!="string")throw new TypeError(`Invalid Version: ${t}`);if(t.length>et)throw new TypeError(`version is longer than ${et} characters`);ae("SemVer",t,e),this.options=e,this.loose=!!e.loose,this.includePrerelease=!!e.includePrerelease;const n=t.trim().match(e.loose?tt[rt.LOOSE]:tt[rt.FULL]);if(!n)throw new TypeError(`Invalid Version: ${t}`);if(this.raw=t,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>ce||this.major<0)throw new TypeError("Invalid major version");if(this.minor>ce||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>ce||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(i=>{if(/^[0-9]+$/.test(i)){const s=+i;if(s>=0&&s<ce)return s}return i}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(ae("SemVer.compare",this.version,this.options,t),!(t instanceof F)){if(typeof t=="string"&&t===this.version)return 0;t=new F(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof F||(t=new F(t,this.options)),Q(this.major,t.major)||Q(this.minor,t.minor)||Q(this.patch,t.patch)}comparePre(t){if(t instanceof F||(t=new F(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let e=0;do{const n=this.prerelease[e],i=t.prerelease[e];if(ae("prerelease compare",e,n,i),n===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(n===void 0)return-1;if(n===i)continue;return Q(n,i)}while(++e)}compareBuild(t){t instanceof F||(t=new F(t,this.options));let e=0;do{const n=this.build[e],i=t.build[e];if(ae("prerelease compare",e,n,i),n===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(n===void 0)return-1;if(n===i)continue;return Q(n,i)}while(++e)}inc(t,e){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",e);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",e);break;case"prepatch":this.prerelease.length=0,this.inc("patch",e),this.inc("pre",e);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",e),this.inc("pre",e);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{let n=this.prerelease.length;for(;--n>=0;)typeof this.prerelease[n]=="number"&&(this.prerelease[n]++,n=-2);n===-1&&this.prerelease.push(0)}e&&(Q(this.prerelease[0],e)===0?isNaN(this.prerelease[1])&&(this.prerelease=[e,0]):this.prerelease=[e,0]);break;default:throw new Error(`invalid increment argument: ${t}`)}return this.format(),this.raw=this.version,this}};var _=F;const{MAX_LENGTH:br}=me,{re:nt,t:st}=q.exports,it=_,Ar=Ie,_r=(r,t)=>{if(t=Ar(t),r instanceof it)return r;if(typeof r!="string"||r.length>br||!(t.loose?nt[st.LOOSE]:nt[st.FULL]).test(r))return null;try{return new it(r,t)}catch{return null}};var te=_r;const xr=te,Lr=(r,t)=>{const e=xr(r,t);return e?e.version:null};var Dr=Lr;const Cr=te,Pr=(r,t)=>{const e=Cr(r.trim().replace(/^[=v]+/,""),t);return e?e.version:null};var Ur=Pr;const ot=_,Fr=(r,t,e,n)=>{typeof e=="string"&&(n=e,e=void 0);try{return new ot(r instanceof ot?r.version:r,e).inc(t,n).version}catch{return null}};var Br=Fr;const at=_,Gr=(r,t,e)=>new at(r,e).compare(new at(t,e));var C=Gr;const Mr=C,jr=(r,t,e)=>Mr(r,t,e)===0;var Ve=jr;const ct=te,Vr=Ve,Xr=(r,t)=>{if(Vr(r,t))return null;{const e=ct(r),n=ct(t),i=e.prerelease.length||n.prerelease.length,s=i?"pre":"",o=i?"prerelease":"";for(const u in e)if((u==="major"||u==="minor"||u==="patch")&&e[u]!==n[u])return s+u;return o}};var kr=Xr;const qr=_,zr=(r,t)=>new qr(r,t).major;var Hr=zr;const Yr=_,Kr=(r,t)=>new Yr(r,t).minor;var Wr=Kr;const Zr=_,Qr=(r,t)=>new Zr(r,t).patch;var Jr=Qr;const en=te,tn=(r,t)=>{const e=en(r,t);return e&&e.prerelease.length?e.prerelease:null};var rn=tn;const nn=C,sn=(r,t,e)=>nn(t,r,e);var on=sn;const an=C,cn=(r,t)=>an(r,t,!0);var un=cn;const ut=_,ln=(r,t,e)=>{const n=new ut(r,e),i=new ut(t,e);return n.compare(i)||n.compareBuild(i)};var Xe=ln;const fn=Xe,hn=(r,t)=>r.sort((e,n)=>fn(e,n,t));var pn=hn;const dn=Xe,vn=(r,t)=>r.sort((e,n)=>dn(n,e,t));var gn=vn;const En=C,mn=(r,t,e)=>En(r,t,e)>0;var $e=mn;const yn=C,In=(r,t,e)=>yn(r,t,e)<0;var ke=In;const $n=C,wn=(r,t,e)=>$n(r,t,e)!==0;var Ut=wn;const Tn=C,Sn=(r,t,e)=>Tn(r,t,e)>=0;var qe=Sn;const Rn=C,Nn=(r,t,e)=>Rn(r,t,e)<=0;var ze=Nn;const On=Ve,bn=Ut,An=$e,_n=qe,xn=ke,Ln=ze,Dn=(r,t,e,n)=>{switch(t){case"===":return typeof r=="object"&&(r=r.version),typeof e=="object"&&(e=e.version),r===e;case"!==":return typeof r=="object"&&(r=r.version),typeof e=="object"&&(e=e.version),r!==e;case"":case"=":case"==":return On(r,e,n);case"!=":return bn(r,e,n);case">":return An(r,e,n);case">=":return _n(r,e,n);case"<":return xn(r,e,n);case"<=":return Ln(r,e,n);default:throw new TypeError(`Invalid operator: ${t}`)}};var Ft=Dn;const Cn=_,Pn=te,{re:ue,t:le}=q.exports,Un=(r,t)=>{if(r instanceof Cn)return r;if(typeof r=="number"&&(r=String(r)),typeof r!="string")return null;t=t||{};let e=null;if(!t.rtl)e=r.match(ue[le.COERCE]);else{let n;for(;(n=ue[le.COERCERTL].exec(r))&&(!e||e.index+e[0].length!==r.length);)(!e||n.index+n[0].length!==e.index+e[0].length)&&(e=n),ue[le.COERCERTL].lastIndex=n.index+n[1].length+n[2].length;ue[le.COERCERTL].lastIndex=-1}return e===null?null:Pn(`${e[2]}.${e[3]||"0"}.${e[4]||"0"}`,t)};var Fn=Un,Oe,lt;function Bn(){return lt||(lt=1,Oe=function(r){r.prototype[Symbol.iterator]=function*(){for(let t=this.head;t;t=t.next)yield t.value}}),Oe}var Gn=T;T.Node=Z;T.create=T;function T(r){var t=this;if(t instanceof T||(t=new T),t.tail=null,t.head=null,t.length=0,r&&typeof r.forEach=="function")r.forEach(function(i){t.push(i)});else if(arguments.length>0)for(var e=0,n=arguments.length;e<n;e++)t.push(arguments[e]);return t}T.prototype.removeNode=function(r){if(r.list!==this)throw new Error("removing node which does not belong to this list");var t=r.next,e=r.prev;return t&&(t.prev=e),e&&(e.next=t),r===this.head&&(this.head=t),r===this.tail&&(this.tail=e),r.list.length--,r.next=null,r.prev=null,r.list=null,t};T.prototype.unshiftNode=function(r){if(r!==this.head){r.list&&r.list.removeNode(r);var t=this.head;r.list=this,r.next=t,t&&(t.prev=r),this.head=r,this.tail||(this.tail=r),this.length++}};T.prototype.pushNode=function(r){if(r!==this.tail){r.list&&r.list.removeNode(r);var t=this.tail;r.list=this,r.prev=t,t&&(t.next=r),this.tail=r,this.head||(this.head=r),this.length++}};T.prototype.push=function(){for(var r=0,t=arguments.length;r<t;r++)jn(this,arguments[r]);return this.length};T.prototype.unshift=function(){for(var r=0,t=arguments.length;r<t;r++)Vn(this,arguments[r]);return this.length};T.prototype.pop=function(){if(this.tail){var r=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,r}};T.prototype.shift=function(){if(this.head){var r=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,r}};T.prototype.forEach=function(r,t){t=t||this;for(var e=this.head,n=0;e!==null;n++)r.call(t,e.value,n,this),e=e.next};T.prototype.forEachReverse=function(r,t){t=t||this;for(var e=this.tail,n=this.length-1;e!==null;n--)r.call(t,e.value,n,this),e=e.prev};T.prototype.get=function(r){for(var t=0,e=this.head;e!==null&&t<r;t++)e=e.next;if(t===r&&e!==null)return e.value};T.prototype.getReverse=function(r){for(var t=0,e=this.tail;e!==null&&t<r;t++)e=e.prev;if(t===r&&e!==null)return e.value};T.prototype.map=function(r,t){t=t||this;for(var e=new T,n=this.head;n!==null;)e.push(r.call(t,n.value,this)),n=n.next;return e};T.prototype.mapReverse=function(r,t){t=t||this;for(var e=new T,n=this.tail;n!==null;)e.push(r.call(t,n.value,this)),n=n.prev;return e};T.prototype.reduce=function(r,t){var e,n=this.head;if(arguments.length>1)e=t;else if(this.head)n=this.head.next,e=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=0;n!==null;i++)e=r(e,n.value,i),n=n.next;return e};T.prototype.reduceReverse=function(r,t){var e,n=this.tail;if(arguments.length>1)e=t;else if(this.tail)n=this.tail.prev,e=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=this.length-1;n!==null;i--)e=r(e,n.value,i),n=n.prev;return e};T.prototype.toArray=function(){for(var r=new Array(this.length),t=0,e=this.head;e!==null;t++)r[t]=e.value,e=e.next;return r};T.prototype.toArrayReverse=function(){for(var r=new Array(this.length),t=0,e=this.tail;e!==null;t++)r[t]=e.value,e=e.prev;return r};T.prototype.slice=function(r,t){t=t||this.length,t<0&&(t+=this.length),r=r||0,r<0&&(r+=this.length);var e=new T;if(t<r||t<0)return e;r<0&&(r=0),t>this.length&&(t=this.length);for(var n=0,i=this.head;i!==null&&n<r;n++)i=i.next;for(;i!==null&&n<t;n++,i=i.next)e.push(i.value);return e};T.prototype.sliceReverse=function(r,t){t=t||this.length,t<0&&(t+=this.length),r=r||0,r<0&&(r+=this.length);var e=new T;if(t<r||t<0)return e;r<0&&(r=0),t>this.length&&(t=this.length);for(var n=this.length,i=this.tail;i!==null&&n>t;n--)i=i.prev;for(;i!==null&&n>r;n--,i=i.prev)e.push(i.value);return e};T.prototype.splice=function(r,t,...e){r>this.length&&(r=this.length-1),r<0&&(r=this.length+r);for(var n=0,i=this.head;i!==null&&n<r;n++)i=i.next;for(var s=[],n=0;i&&n<t;n++)s.push(i.value),i=this.removeNode(i);i===null&&(i=this.tail),i!==this.head&&i!==this.tail&&(i=i.prev);for(var n=0;n<e.length;n++)i=Mn(this,i,e[n]);return s};T.prototype.reverse=function(){for(var r=this.head,t=this.tail,e=r;e!==null;e=e.prev){var n=e.prev;e.prev=e.next,e.next=n}return this.head=t,this.tail=r,this};function Mn(r,t,e){var n=t===r.head?new Z(e,null,t,r):new Z(e,t,t.next,r);return n.next===null&&(r.tail=n),n.prev===null&&(r.head=n),r.length++,n}function jn(r,t){r.tail=new Z(t,r.tail,null,r),r.head||(r.head=r.tail),r.length++}function Vn(r,t){r.head=new Z(t,null,r.head,r),r.tail||(r.tail=r.head),r.length++}function Z(r,t,e,n){if(!(this instanceof Z))return new Z(r,t,e,n);this.list=n,this.value=r,t?(t.next=this,this.prev=t):this.prev=null,e?(e.prev=this,this.next=e):this.next=null}try{Bn()(T)}catch{}const Xn=Gn,K=Symbol("max"),M=Symbol("length"),J=Symbol("lengthCalculator"),ie=Symbol("allowStale"),W=Symbol("maxAge"),G=Symbol("dispose"),ft=Symbol("noDisposeOnSet"),b=Symbol("lruList"),D=Symbol("cache"),Bt=Symbol("updateAgeOnGet"),be=()=>1;class kn{constructor(t){if(typeof t=="number"&&(t={max:t}),t||(t={}),t.max&&(typeof t.max!="number"||t.max<0))throw new TypeError("max must be a non-negative number");this[K]=t.max||1/0;const e=t.length||be;if(this[J]=typeof e!="function"?be:e,this[ie]=t.stale||!1,t.maxAge&&typeof t.maxAge!="number")throw new TypeError("maxAge must be a number");this[W]=t.maxAge||0,this[G]=t.dispose,this[ft]=t.noDisposeOnSet||!1,this[Bt]=t.updateAgeOnGet||!1,this.reset()}set max(t){if(typeof t!="number"||t<0)throw new TypeError("max must be a non-negative number");this[K]=t||1/0,ne(this)}get max(){return this[K]}set allowStale(t){this[ie]=!!t}get allowStale(){return this[ie]}set maxAge(t){if(typeof t!="number")throw new TypeError("maxAge must be a non-negative number");this[W]=t,ne(this)}get maxAge(){return this[W]}set lengthCalculator(t){typeof t!="function"&&(t=be),t!==this[J]&&(this[J]=t,this[M]=0,this[b].forEach(e=>{e.length=this[J](e.value,e.key),this[M]+=e.length})),ne(this)}get lengthCalculator(){return this[J]}get length(){return this[M]}get itemCount(){return this[b].length}rforEach(t,e){e=e||this;for(let n=this[b].tail;n!==null;){const i=n.prev;ht(this,t,n,e),n=i}}forEach(t,e){e=e||this;for(let n=this[b].head;n!==null;){const i=n.next;ht(this,t,n,e),n=i}}keys(){return this[b].toArray().map(t=>t.key)}values(){return this[b].toArray().map(t=>t.value)}reset(){this[G]&&this[b]&&this[b].length&&this[b].forEach(t=>this[G](t.key,t.value)),this[D]=new Map,this[b]=new Xn,this[M]=0}dump(){return this[b].map(t=>de(this,t)?!1:{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}).toArray().filter(t=>t)}dumpLru(){return this[b]}set(t,e,n){if(n=n||this[W],n&&typeof n!="number")throw new TypeError("maxAge must be a number");const i=n?Date.now():0,s=this[J](e,t);if(this[D].has(t)){if(s>this[K])return ee(this,this[D].get(t)),!1;const c=this[D].get(t).value;return this[G]&&(this[ft]||this[G](t,c.value)),c.now=i,c.maxAge=n,c.value=e,this[M]+=s-c.length,c.length=s,this.get(t),ne(this),!0}const o=new qn(t,e,s,i,n);return o.length>this[K]?(this[G]&&this[G](t,e),!1):(this[M]+=o.length,this[b].unshift(o),this[D].set(t,this[b].head),ne(this),!0)}has(t){if(!this[D].has(t))return!1;const e=this[D].get(t).value;return!de(this,e)}get(t){return Ae(this,t,!0)}peek(t){return Ae(this,t,!1)}pop(){const t=this[b].tail;return t?(ee(this,t),t.value):null}del(t){ee(this,this[D].get(t))}load(t){this.reset();const e=Date.now();for(let n=t.length-1;n>=0;n--){const i=t[n],s=i.e||0;if(s===0)this.set(i.k,i.v);else{const o=s-e;o>0&&this.set(i.k,i.v,o)}}}prune(){this[D].forEach((t,e)=>Ae(this,e,!1))}}const Ae=(r,t,e)=>{const n=r[D].get(t);if(n){const i=n.value;if(de(r,i)){if(ee(r,n),!r[ie])return}else e&&(r[Bt]&&(n.value.now=Date.now()),r[b].unshiftNode(n));return i.value}},de=(r,t)=>{if(!t||!t.maxAge&&!r[W])return!1;const e=Date.now()-t.now;return t.maxAge?e>t.maxAge:r[W]&&e>r[W]},ne=r=>{if(r[M]>r[K])for(let t=r[b].tail;r[M]>r[K]&&t!==null;){const e=t.prev;ee(r,t),t=e}},ee=(r,t)=>{if(t){const e=t.value;r[G]&&r[G](e.key,e.value),r[M]-=e.length,r[D].delete(e.key),r[b].removeNode(t)}};class qn{constructor(t,e,n,i,s){this.key=t,this.value=e,this.length=n,this.now=i,this.maxAge=s||0}}const ht=(r,t,e,n)=>{let i=e.value;de(r,i)&&(ee(r,e),r[ie]||(i=void 0)),i&&t.call(n,i.value,i.key,r)};var zn=kn,_e,pt;function P(){if(pt)return _e;pt=1;class r{constructor(p,y){if(y=n(y),p instanceof r)return p.loose===!!y.loose&&p.includePrerelease===!!y.includePrerelease?p:new r(p.raw,y);if(p instanceof i)return this.raw=p.value,this.set=[[p]],this.format(),this;if(this.options=y,this.loose=!!y.loose,this.includePrerelease=!!y.includePrerelease,this.raw=p,this.set=p.split("||").map(E=>this.parseRange(E.trim())).filter(E=>E.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${p}`);if(this.set.length>1){const E=this.set[0];if(this.set=this.set.filter(m=>!I(m[0])),this.set.length===0)this.set=[E];else if(this.set.length>1){for(const m of this.set)if(m.length===1&&v(m[0])){this.set=[m];break}}}this.format()}format(){return this.range=this.set.map(p=>p.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(p){p=p.trim();const E=`parseRange:${Object.keys(this.options).join(",")}:${p}`,m=e.get(E);if(m)return m;const g=this.options.loose,$=g?u[c.HYPHENRANGELOOSE]:u[c.HYPHENRANGE];p=p.replace($,Wt(this.options.includePrerelease)),s("hyphen replace",p),p=p.replace(u[c.COMPARATORTRIM],a),s("comparator trim",p),p=p.replace(u[c.TILDETRIM],l),p=p.replace(u[c.CARETTRIM],h),p=p.split(/\s+/).join(" ");let S=p.split(" ").map(O=>U(O,this.options)).join(" ").split(/\s+/).map(O=>Kt(O,this.options));g&&(S=S.filter(O=>(s("loose invalid filter",O,this.options),!!O.match(u[c.COMPARATORLOOSE])))),s("range list",S);const w=new Map,N=S.map(O=>new i(O,this.options));for(const O of N){if(I(O))return[O];w.set(O.value,O)}w.size>1&&w.has("")&&w.delete("");const L=[...w.values()];return e.set(E,L),L}intersects(p,y){if(!(p instanceof r))throw new TypeError("a Range is required");return this.set.some(E=>x(E,y)&&p.set.some(m=>x(m,y)&&E.every(g=>m.every($=>g.intersects($,y)))))}test(p){if(!p)return!1;if(typeof p=="string")try{p=new o(p,this.options)}catch{return!1}for(let y=0;y<this.set.length;y++)if(Zt(this.set[y],p,this.options))return!0;return!1}}_e=r;const t=zn,e=new t({max:1e3}),n=Ie,i=we(),s=ye,o=_,{re:u,t:c,comparatorTrimReplace:a,tildeTrimReplace:l,caretTrimReplace:h}=q.exports,I=d=>d.value==="<0.0.0-0",v=d=>d.value==="",x=(d,p)=>{let y=!0;const E=d.slice();let m=E.pop();for(;y&&E.length;)y=E.every(g=>m.intersects(g,p)),m=E.pop();return y},U=(d,p)=>(s("comp",d,p),d=kt(d,p),s("caret",d),d=B(d,p),s("tildes",d),d=zt(d,p),s("xrange",d),d=Yt(d,p),s("stars",d),d),R=d=>!d||d.toLowerCase()==="x"||d==="*",B=(d,p)=>d.trim().split(/\s+/).map(y=>Xt(y,p)).join(" "),Xt=(d,p)=>{const y=p.loose?u[c.TILDELOOSE]:u[c.TILDE];return d.replace(y,(E,m,g,$,S)=>{s("tilde",d,E,m,g,$,S);let w;return R(m)?w="":R(g)?w=`>=${m}.0.0 <${+m+1}.0.0-0`:R($)?w=`>=${m}.${g}.0 <${m}.${+g+1}.0-0`:S?(s("replaceTilde pr",S),w=`>=${m}.${g}.${$}-${S} <${m}.${+g+1}.0-0`):w=`>=${m}.${g}.${$} <${m}.${+g+1}.0-0`,s("tilde return",w),w})},kt=(d,p)=>d.trim().split(/\s+/).map(y=>qt(y,p)).join(" "),qt=(d,p)=>{s("caret",d,p);const y=p.loose?u[c.CARETLOOSE]:u[c.CARET],E=p.includePrerelease?"-0":"";return d.replace(y,(m,g,$,S,w)=>{s("caret",d,m,g,$,S,w);let N;return R(g)?N="":R($)?N=`>=${g}.0.0${E} <${+g+1}.0.0-0`:R(S)?g==="0"?N=`>=${g}.${$}.0${E} <${g}.${+$+1}.0-0`:N=`>=${g}.${$}.0${E} <${+g+1}.0.0-0`:w?(s("replaceCaret pr",w),g==="0"?$==="0"?N=`>=${g}.${$}.${S}-${w} <${g}.${$}.${+S+1}-0`:N=`>=${g}.${$}.${S}-${w} <${g}.${+$+1}.0-0`:N=`>=${g}.${$}.${S}-${w} <${+g+1}.0.0-0`):(s("no pr"),g==="0"?$==="0"?N=`>=${g}.${$}.${S}${E} <${g}.${$}.${+S+1}-0`:N=`>=${g}.${$}.${S}${E} <${g}.${+$+1}.0-0`:N=`>=${g}.${$}.${S} <${+g+1}.0.0-0`),s("caret return",N),N})},zt=(d,p)=>(s("replaceXRanges",d,p),d.split(/\s+/).map(y=>Ht(y,p)).join(" ")),Ht=(d,p)=>{d=d.trim();const y=p.loose?u[c.XRANGELOOSE]:u[c.XRANGE];return d.replace(y,(E,m,g,$,S,w)=>{s("xRange",d,E,m,g,$,S,w);const N=R(g),L=N||R($),O=L||R(S),re=O;return m==="="&&re&&(m=""),w=p.includePrerelease?"-0":"",N?m===">"||m==="<"?E="<0.0.0-0":E="*":m&&re?(L&&($=0),S=0,m===">"?(m=">=",L?(g=+g+1,$=0,S=0):($=+$+1,S=0)):m==="<="&&(m="<",L?g=+g+1:$=+$+1),m==="<"&&(w="-0"),E=`${m+g}.${$}.${S}${w}`):L?E=`>=${g}.0.0${w} <${+g+1}.0.0-0`:O&&(E=`>=${g}.${$}.0${w} <${g}.${+$+1}.0-0`),s("xRange return",E),E})},Yt=(d,p)=>(s("replaceStars",d,p),d.trim().replace(u[c.STAR],"")),Kt=(d,p)=>(s("replaceGTE0",d,p),d.trim().replace(u[p.includePrerelease?c.GTE0PRE:c.GTE0],"")),Wt=d=>(p,y,E,m,g,$,S,w,N,L,O,re,Bi)=>(R(E)?y="":R(m)?y=`>=${E}.0.0${d?"-0":""}`:R(g)?y=`>=${E}.${m}.0${d?"-0":""}`:$?y=`>=${y}`:y=`>=${y}${d?"-0":""}`,R(N)?w="":R(L)?w=`<${+N+1}.0.0-0`:R(O)?w=`<${N}.${+L+1}.0-0`:re?w=`<=${N}.${L}.${O}-${re}`:d?w=`<${N}.${L}.${+O+1}-0`:w=`<=${w}`,`${y} ${w}`.trim()),Zt=(d,p,y)=>{for(let E=0;E<d.length;E++)if(!d[E].test(p))return!1;if(p.prerelease.length&&!y.includePrerelease){for(let E=0;E<d.length;E++)if(s(d[E].semver),d[E].semver!==i.ANY&&d[E].semver.prerelease.length>0){const m=d[E].semver;if(m.major===p.major&&m.minor===p.minor&&m.patch===p.patch)return!0}return!1}return!0};return _e}var xe,dt;function we(){if(dt)return xe;dt=1;const r=Symbol("SemVer ANY");class t{static get ANY(){return r}constructor(l,h){if(h=e(h),l instanceof t){if(l.loose===!!h.loose)return l;l=l.value}o("comparator",l,h),this.options=h,this.loose=!!h.loose,this.parse(l),this.semver===r?this.value="":this.value=this.operator+this.semver.version,o("comp",this)}parse(l){const h=this.options.loose?n[i.COMPARATORLOOSE]:n[i.COMPARATOR],I=l.match(h);if(!I)throw new TypeError(`Invalid comparator: ${l}`);this.operator=I[1]!==void 0?I[1]:"",this.operator==="="&&(this.operator=""),I[2]?this.semver=new u(I[2],this.options.loose):this.semver=r}toString(){return this.value}test(l){if(o("Comparator.test",l,this.options.loose),this.semver===r||l===r)return!0;if(typeof l=="string")try{l=new u(l,this.options)}catch{return!1}return s(l,this.operator,this.semver,this.options)}intersects(l,h){if(!(l instanceof t))throw new TypeError("a Comparator is required");if((!h||typeof h!="object")&&(h={loose:!!h,includePrerelease:!1}),this.operator==="")return this.value===""?!0:new c(l.value,h).test(this.value);if(l.operator==="")return l.value===""?!0:new c(this.value,h).test(l.semver);const I=(this.operator===">="||this.operator===">")&&(l.operator===">="||l.operator===">"),v=(this.operator==="<="||this.operator==="<")&&(l.operator==="<="||l.operator==="<"),x=this.semver.version===l.semver.version,U=(this.operator===">="||this.operator==="<=")&&(l.operator===">="||l.operator==="<="),R=s(this.semver,"<",l.semver,h)&&(this.operator===">="||this.operator===">")&&(l.operator==="<="||l.operator==="<"),B=s(this.semver,">",l.semver,h)&&(this.operator==="<="||this.operator==="<")&&(l.operator===">="||l.operator===">");return I||v||x&&U||R||B}}xe=t;const e=Ie,{re:n,t:i}=q.exports,s=Ft,o=ye,u=_,c=P();return xe}const Hn=P(),Yn=(r,t,e)=>{try{t=new Hn(t,e)}catch{return!1}return t.test(r)};var Te=Yn;const Kn=P(),Wn=(r,t)=>new Kn(r,t).set.map(e=>e.map(n=>n.value).join(" ").trim().split(" "));var Zn=Wn;const Qn=_,Jn=P(),es=(r,t,e)=>{let n=null,i=null,s=null;try{s=new Jn(t,e)}catch{return null}return r.forEach(o=>{s.test(o)&&(!n||i.compare(o)===-1)&&(n=o,i=new Qn(n,e))}),n};var ts=es;const rs=_,ns=P(),ss=(r,t,e)=>{let n=null,i=null,s=null;try{s=new ns(t,e)}catch{return null}return r.forEach(o=>{s.test(o)&&(!n||i.compare(o)===1)&&(n=o,i=new rs(n,e))}),n};var is=ss;const Le=_,os=P(),vt=$e,as=(r,t)=>{r=new os(r,t);let e=new Le("0.0.0");if(r.test(e)||(e=new Le("0.0.0-0"),r.test(e)))return e;e=null;for(let n=0;n<r.set.length;++n){const i=r.set[n];let s=null;i.forEach(o=>{const u=new Le(o.semver.version);switch(o.operator){case">":u.prerelease.length===0?u.patch++:u.prerelease.push(0),u.raw=u.format();case"":case">=":(!s||vt(u,s))&&(s=u);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${o.operator}`)}}),s&&(!e||vt(e,s))&&(e=s)}return e&&r.test(e)?e:null};var cs=as;const us=P(),ls=(r,t)=>{try{return new us(r,t).range||"*"}catch{return null}};var fs=ls;const hs=_,Gt=we(),{ANY:ps}=Gt,ds=P(),vs=Te,gt=$e,Et=ke,gs=ze,Es=qe,ms=(r,t,e,n)=>{r=new hs(r,n),t=new ds(t,n);let i,s,o,u,c;switch(e){case">":i=gt,s=gs,o=Et,u=">",c=">=";break;case"<":i=Et,s=Es,o=gt,u="<",c="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(vs(r,t,n))return!1;for(let a=0;a<t.set.length;++a){const l=t.set[a];let h=null,I=null;if(l.forEach(v=>{v.semver===ps&&(v=new Gt(">=0.0.0")),h=h||v,I=I||v,i(v.semver,h.semver,n)?h=v:o(v.semver,I.semver,n)&&(I=v)}),h.operator===u||h.operator===c||(!I.operator||I.operator===u)&&s(r,I.semver))return!1;if(I.operator===c&&o(r,I.semver))return!1}return!0};var He=ms;const ys=He,Is=(r,t,e)=>ys(r,t,">",e);var $s=Is;const ws=He,Ts=(r,t,e)=>ws(r,t,"<",e);var Ss=Ts;const mt=P(),Rs=(r,t,e)=>(r=new mt(r,e),t=new mt(t,e),r.intersects(t));var Ns=Rs;const Os=Te,bs=C;var As=(r,t,e)=>{const n=[];let i=null,s=null;const o=r.sort((l,h)=>bs(l,h,e));for(const l of o)Os(l,t,e)?(s=l,i||(i=l)):(s&&n.push([i,s]),s=null,i=null);i&&n.push([i,null]);const u=[];for(const[l,h]of n)l===h?u.push(l):!h&&l===o[0]?u.push("*"):h?l===o[0]?u.push(`<=${h}`):u.push(`${l} - ${h}`):u.push(`>=${l}`);const c=u.join(" || "),a=typeof t.raw=="string"?t.raw:String(t);return c.length<a.length?c:t};const yt=P(),pe=we(),{ANY:De}=pe,se=Te,Ye=C,_s=(r,t,e={})=>{if(r===t)return!0;r=new yt(r,e),t=new yt(t,e);let n=!1;e:for(const i of r.set){for(const s of t.set){const o=xs(i,s,e);if(n=n||o!==null,o)continue e}if(n)return!1}return!0},xs=(r,t,e)=>{if(r===t)return!0;if(r.length===1&&r[0].semver===De){if(t.length===1&&t[0].semver===De)return!0;e.includePrerelease?r=[new pe(">=0.0.0-0")]:r=[new pe(">=0.0.0")]}if(t.length===1&&t[0].semver===De){if(e.includePrerelease)return!0;t=[new pe(">=0.0.0")]}const n=new Set;let i,s;for(const v of r)v.operator===">"||v.operator===">="?i=It(i,v,e):v.operator==="<"||v.operator==="<="?s=$t(s,v,e):n.add(v.semver);if(n.size>1)return null;let o;if(i&&s){if(o=Ye(i.semver,s.semver,e),o>0)return null;if(o===0&&(i.operator!==">="||s.operator!=="<="))return null}for(const v of n){if(i&&!se(v,String(i),e)||s&&!se(v,String(s),e))return null;for(const x of t)if(!se(v,String(x),e))return!1;return!0}let u,c,a,l,h=s&&!e.includePrerelease&&s.semver.prerelease.length?s.semver:!1,I=i&&!e.includePrerelease&&i.semver.prerelease.length?i.semver:!1;h&&h.prerelease.length===1&&s.operator==="<"&&h.prerelease[0]===0&&(h=!1);for(const v of t){if(l=l||v.operator===">"||v.operator===">=",a=a||v.operator==="<"||v.operator==="<=",i){if(I&&v.semver.prerelease&&v.semver.prerelease.length&&v.semver.major===I.major&&v.semver.minor===I.minor&&v.semver.patch===I.patch&&(I=!1),v.operator===">"||v.operator===">="){if(u=It(i,v,e),u===v&&u!==i)return!1}else if(i.operator===">="&&!se(i.semver,String(v),e))return!1}if(s){if(h&&v.semver.prerelease&&v.semver.prerelease.length&&v.semver.major===h.major&&v.semver.minor===h.minor&&v.semver.patch===h.patch&&(h=!1),v.operator==="<"||v.operator==="<="){if(c=$t(s,v,e),c===v&&c!==s)return!1}else if(s.operator==="<="&&!se(s.semver,String(v),e))return!1}if(!v.operator&&(s||i)&&o!==0)return!1}return!(i&&a&&!s&&o!==0||s&&l&&!i&&o!==0||I||h)},It=(r,t,e)=>{if(!r)return t;const n=Ye(r.semver,t.semver,e);return n>0?r:n<0||t.operator===">"&&r.operator===">="?t:r},$t=(r,t,e)=>{if(!r)return t;const n=Ye(r.semver,t.semver,e);return n<0?r:n>0||t.operator==="<"&&r.operator==="<="?t:r};var Ls=_s;const Ce=q.exports,Ds=me,Cs=_,wt=Pt,Ps=te,Us=Dr,Fs=Ur,Bs=Br,Gs=kr,Ms=Hr,js=Wr,Vs=Jr,Xs=rn,ks=C,qs=on,zs=un,Hs=Xe,Ys=pn,Ks=gn,Ws=$e,Zs=ke,Qs=Ve,Js=Ut,ei=qe,ti=ze,ri=Ft,ni=Fn,si=we(),ii=P(),oi=Te,ai=Zn,ci=ts,ui=is,li=cs,fi=fs,hi=He,pi=$s,di=Ss,vi=Ns,gi=As,Ei=Ls;var Tt={parse:Ps,valid:Us,clean:Fs,inc:Bs,diff:Gs,major:Ms,minor:js,patch:Vs,prerelease:Xs,compare:ks,rcompare:qs,compareLoose:zs,compareBuild:Hs,sort:Ys,rsort:Ks,gt:Ws,lt:Zs,eq:Qs,neq:Js,gte:ei,lte:ti,cmp:ri,coerce:ni,Comparator:si,Range:ii,satisfies:oi,toComparators:ai,maxSatisfying:ci,minSatisfying:ui,minVersion:li,validRange:fi,outside:hi,gtr:pi,ltr:di,intersects:vi,simplifyRange:gi,subset:Ei,SemVer:Cs,re:Ce.re,src:Ce.src,tokens:Ce.t,SEMVER_SPEC_VERSION:Ds.SEMVER_SPEC_VERSION,compareIdentifiers:wt.compareIdentifiers,rcompareIdentifiers:wt.rcompareIdentifiers},Be=globalThis&&globalThis.__assign||function(){return Be=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=t[i])}return r},Be.apply(this,arguments)},z,A;(function(r){r.blue="blue",r.nanoS="nanoS",r.nanoSP="nanoSP",r.nanoX="nanoX",r.nanoFTS="nanoFTS"})(A||(A={}));var Ge=(z={},z[A.blue]={id:A.blue,productName:"Ledger Blue",productIdMM:0,legacyUsbProductId:0,usbOnly:!0,memorySize:480*1024,masks:[822083584,822149120],getBlockSize:function(r){return 4*1024}},z[A.nanoS]={id:A.nanoS,productName:"Ledger Nano S",productIdMM:16,legacyUsbProductId:1,usbOnly:!0,memorySize:320*1024,masks:[823132160],getBlockSize:function(r){var t;return Tt.lt((t=Tt.coerce(r))!==null&&t!==void 0?t:"","2.0.0")?4*1024:2*1024}},z[A.nanoSP]={id:A.nanoSP,productName:"Ledger Nano S Plus",productIdMM:80,legacyUsbProductId:5,usbOnly:!0,memorySize:1536*1024,masks:[856686592],getBlockSize:function(r){return 32}},z[A.nanoX]={id:A.nanoX,productName:"Ledger Nano X",productIdMM:64,legacyUsbProductId:4,usbOnly:!1,memorySize:2*1024*1024,masks:[855638016],getBlockSize:function(r){return 4*1024},bluetoothSpec:[{serviceUuid:"13d63400-2c97-0004-0000-4c6564676572",notifyUuid:"13d63400-2c97-0004-0001-4c6564676572",writeUuid:"13d63400-2c97-0004-0002-4c6564676572",writeCmdUuid:"13d63400-2c97-0004-0003-4c6564676572"}]},z[A.nanoFTS]={id:A.nanoFTS,productName:"Ledger Nano FTS",productIdMM:96,legacyUsbProductId:6,usbOnly:!1,memorySize:1536*1024,masks:[857735168],getBlockSize:function(r){return 32},bluetoothSpec:[{serviceUuid:"13d63400-2c97-6004-0000-4c6564676572",notifyUuid:"13d63400-2c97-6004-0001-4c6564676572",writeUuid:"13d63400-2c97-6004-0002-4c6564676572",writeCmdUuid:"13d63400-2c97-6004-0003-4c6564676572"}]},z);A.blue,A.nanoS,A.nanoSP,A.nanoX,A.nanoFTS;var St=Object.values(Ge),Se=11415,ve=function(r){var t=St.find(function(i){return i.legacyUsbProductId===r});if(t)return t;var e=r>>8,n=St.find(function(i){return i.productIdMM===e});return n},mi=[],Rt={};for(var yi in Ge){var Nt=Ge[yi],Pe=Nt.bluetoothSpec;if(Pe)for(var Ue=0;Ue<Pe.length;Ue++){var fe=Pe[Ue];mi.push(fe.serviceUuid),Rt[fe.serviceUuid]=Rt[fe.serviceUuid.replace(/-/g,"")]=Be({deviceModel:Nt},fe)}}var Ii=0,X=[],ge=function(r,t,e){var n={type:r,id:String(++Ii),date:new Date};t&&(n.message=t),e&&(n.data=e),wi(n)},$i=function(r){return X.push(r),function(){var t=X.indexOf(r);t!==-1&&(X[t]=X[X.length-1],X.pop())}};function wi(r){for(var t=0;t<X.length;t++)try{X[t](r)}catch(e){console.error(e)}}typeof window<"u"&&(window.__ledgerLogsListen=$i);var Ti=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(n[s]=i[s])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),j=globalThis&&globalThis.__awaiter||function(r,t,e,n){function i(s){return s instanceof e?s:new e(function(o){o(s)})}return new(e||(e=Promise))(function(s,o){function u(l){try{a(n.next(l))}catch(h){o(h)}}function c(l){try{a(n.throw(l))}catch(h){o(h)}}function a(l){l.done?s(l.value):i(l.value).then(u,c)}a((n=n.apply(r,t||[])).next())})},V=globalThis&&globalThis.__generator||function(r,t){var e={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(a){return function(l){return c([a,l])}}function c(a){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,i&&(s=a[0]&2?i.return:a[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,a[1])).done)return s;switch(i=0,s&&(a=[a[0]&2,s.value]),a[0]){case 0:case 1:s=a;break;case 4:return e.label++,{value:a[1],done:!1};case 5:e.label++,i=a[1],a=[0];continue;case 7:a=e.ops.pop(),e.trys.pop();continue;default:if(s=e.trys,!(s=s.length>0&&s[s.length-1])&&(a[0]===6||a[0]===2)){e=0;continue}if(a[0]===3&&(!s||a[1]>s[0]&&a[1]<s[3])){e.label=a[1];break}if(a[0]===6&&e.label<s[1]){e.label=s[1],s=a;break}if(s&&e.label<s[2]){e.label=s[2],e.ops.push(a);break}s[2]&&e.ops.pop(),e.trys.pop();continue}a=t.call(r,e)}catch(l){a=[6,l],i=0}finally{n=s=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},Si=globalThis&&globalThis.__read||function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),i,s=[],o;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(u){o={error:u}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(o)throw o.error}}return s},Ri=[{vendorId:Se}],Ni=function(){return Promise.resolve(!!(window.navigator&&window.navigator.hid))},Ee=function(){var r=navigator.hid;if(!r)throw new k("navigator.hid is not supported","HIDNotSupported");return r};function Mt(){return j(this,void 0,void 0,function(){var r;return V(this,function(t){switch(t.label){case 0:return[4,Ee().requestDevice({filters:Ri})];case 1:return r=t.sent(),Array.isArray(r)?[2,r]:[2,[r]]}})})}function Me(){return j(this,void 0,void 0,function(){var r;return V(this,function(t){switch(t.label){case 0:return[4,Ee().getDevices()];case 1:return r=t.sent(),[2,r.filter(function(e){return e.vendorId===Se})]}})})}function Oi(){return j(this,void 0,void 0,function(){var r,t;return V(this,function(e){switch(e.label){case 0:return[4,Me()];case 1:return r=e.sent(),r.length>0?[2,r[0]]:[4,Mt()];case 2:return t=e.sent(),[2,t[0]]}})})}var bi=function(r){Ti(t,r);function t(e){var n=r.call(this)||this;return n.channel=Math.floor(Math.random()*65535),n.packetSize=64,n.inputs=[],n.read=function(){return n.inputs.length?Promise.resolve(n.inputs.shift()):new Promise(function(i){n.inputCallback=i})},n.onInputReport=function(i){var s=Buffer.from(i.data.buffer);n.inputCallback?(n.inputCallback(s),n.inputCallback=null):n.inputs.push(s)},n._disconnectEmitted=!1,n._emitDisconnect=function(i){n._disconnectEmitted||(n._disconnectEmitted=!0,n.emit("disconnect",i))},n.exchange=function(i){return j(n,void 0,void 0,function(){var s,o=this;return V(this,function(u){switch(u.label){case 0:return[4,this.exchangeAtomicImpl(function(){return j(o,void 0,void 0,function(){var c,a,l,h,I,v,x,U,R;return V(this,function(B){switch(B.label){case 0:c=this,a=c.channel,l=c.packetSize,ge("apdu","=> "+i.toString("hex")),h=Dt(a,l),I=h.makeBlocks(i),v=0,B.label=1;case 1:return v<I.length?[4,this.device.sendReport(0,I[v])]:[3,4];case 2:B.sent(),B.label=3;case 3:return v++,[3,1];case 4:return(x=h.getReducedResult(U))?[3,6]:[4,this.read()];case 5:return R=B.sent(),U=h.reduceResponse(U,R),[3,4];case 6:return ge("apdu","<= "+x.toString("hex")),[2,x]}})})}).catch(function(c){throw c&&c.message&&c.message.includes("write")?(o._emitDisconnect(c),new _t(c.message)):c})];case 1:return s=u.sent(),[2,s]}})})},n.device=e,n.deviceModel=typeof e.productId=="number"?ve(e.productId):void 0,e.addEventListener("inputreport",n.onInputReport),n}return t.request=function(){return j(this,void 0,void 0,function(){var e,n;return V(this,function(i){switch(i.label){case 0:return[4,Mt()];case 1:return e=Si.apply(void 0,[i.sent(),1]),n=e[0],[2,t.open(n)]}})})},t.openConnected=function(){return j(this,void 0,void 0,function(){var e;return V(this,function(n){switch(n.label){case 0:return[4,Me()];case 1:return e=n.sent(),e.length===0?[2,null]:[2,t.open(e[0])]}})})},t.open=function(e){return j(this,void 0,void 0,function(){var n,i;return V(this,function(s){switch(s.label){case 0:return[4,e.open()];case 1:return s.sent(),n=new t(e),i=function(o){e===o.device&&(Ee().removeEventListener("disconnect",i),n._emitDisconnect(new At))},Ee().addEventListener("disconnect",i),[2,n]}})})},t.prototype.close=function(){return j(this,void 0,void 0,function(){return V(this,function(e){switch(e.label){case 0:return[4,this.exchangeBusyPromise];case 1:return e.sent(),this.device.removeEventListener("inputreport",this.onInputReport),[4,this.device.close()];case 2:return e.sent(),[2]}})})},t.prototype.setScrambleKey=function(){},t.isSupported=Ni,t.list=Me,t.listen=function(e){var n=!1;Oi().then(function(s){if(!s)e.error(new Fe("Access denied to use Ledger device"));else if(!n){var o=typeof s.productId=="number"?ve(s.productId):void 0;e.next({type:"add",descriptor:s,deviceModel:o}),e.complete()}},function(s){e.error(new Fe(s.message))});function i(){n=!0}return{unsubscribe:i}},t}(Lt),Ke=globalThis&&globalThis.__awaiter||function(r,t,e,n){function i(s){return s instanceof e?s:new e(function(o){o(s)})}return new(e||(e=Promise))(function(s,o){function u(l){try{a(n.next(l))}catch(h){o(h)}}function c(l){try{a(n.throw(l))}catch(h){o(h)}}function a(l){l.done?s(l.value):i(l.value).then(u,c)}a((n=n.apply(r,t||[])).next())})},We=globalThis&&globalThis.__generator||function(r,t){var e={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(a){return function(l){return c([a,l])}}function c(a){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,i&&(s=a[0]&2?i.return:a[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,a[1])).done)return s;switch(i=0,s&&(a=[a[0]&2,s.value]),a[0]){case 0:case 1:s=a;break;case 4:return e.label++,{value:a[1],done:!1};case 5:e.label++,i=a[1],a=[0];continue;case 7:a=e.ops.pop(),e.trys.pop();continue;default:if(s=e.trys,!(s=s.length>0&&s[s.length-1])&&(a[0]===6||a[0]===2)){e=0;continue}if(a[0]===3&&(!s||a[1]>s[0]&&a[1]<s[3])){e.label=a[1];break}if(a[0]===6&&e.label<s[1]){e.label=s[1],s=a;break}if(s&&e.label<s[2]){e.label=s[2],e.ops.push(a);break}s[2]&&e.ops.pop(),e.trys.pop();continue}a=t.call(r,e)}catch(l){a=[6,l],i=0}finally{n=s=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},Ai=[{vendorId:Se}];function jt(){return Ke(this,void 0,void 0,function(){var r;return We(this,function(t){switch(t.label){case 0:return[4,navigator.usb.requestDevice({filters:Ai})];case 1:return r=t.sent(),[2,r]}})})}function je(){return Ke(this,void 0,void 0,function(){var r;return We(this,function(t){switch(t.label){case 0:return[4,navigator.usb.getDevices()];case 1:return r=t.sent(),[2,r.filter(function(e){return e.vendorId===Se})]}})})}function _i(){return Ke(this,void 0,void 0,function(){var r;return We(this,function(t){switch(t.label){case 0:return[4,je()];case 1:return r=t.sent(),r.length>0?[2,r[0]]:[2,jt()]}})})}var xi=function(){return Promise.resolve(!!navigator&&!!navigator.usb&&typeof navigator.usb.getDevices=="function")},Li=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(n[s]=i[s])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),H=globalThis&&globalThis.__awaiter||function(r,t,e,n){function i(s){return s instanceof e?s:new e(function(o){o(s)})}return new(e||(e=Promise))(function(s,o){function u(l){try{a(n.next(l))}catch(h){o(h)}}function c(l){try{a(n.throw(l))}catch(h){o(h)}}function a(l){l.done?s(l.value):i(l.value).then(u,c)}a((n=n.apply(r,t||[])).next())})},Y=globalThis&&globalThis.__generator||function(r,t){var e={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,o;return o={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function u(a){return function(l){return c([a,l])}}function c(a){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,i&&(s=a[0]&2?i.return:a[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,a[1])).done)return s;switch(i=0,s&&(a=[a[0]&2,s.value]),a[0]){case 0:case 1:s=a;break;case 4:return e.label++,{value:a[1],done:!1};case 5:e.label++,i=a[1],a=[0];continue;case 7:a=e.ops.pop(),e.trys.pop();continue;default:if(s=e.trys,!(s=s.length>0&&s[s.length-1])&&(a[0]===6||a[0]===2)){e=0;continue}if(a[0]===3&&(!s||a[1]>s[0]&&a[1]<s[3])){e.label=a[1];break}if(a[0]===6&&e.label<s[1]){e.label=s[1],s=a;break}if(s&&e.label<s[2]){e.label=s[2],e.ops.push(a);break}s[2]&&e.ops.pop(),e.trys.pop();continue}a=t.call(r,e)}catch(l){a=[6,l],i=0}finally{n=s=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},Di=1,Ot=3,Ci=function(r){Li(t,r);function t(e,n){var i=r.call(this)||this;return i.channel=Math.floor(Math.random()*65535),i.packetSize=64,i._disconnectEmitted=!1,i._emitDisconnect=function(s){i._disconnectEmitted||(i._disconnectEmitted=!0,i.emit("disconnect",s))},i.device=e,i.interfaceNumber=n,i.deviceModel=ve(e.productId),i}return t.request=function(){return H(this,void 0,void 0,function(){var e;return Y(this,function(n){switch(n.label){case 0:return[4,jt()];case 1:return e=n.sent(),[2,t.open(e)]}})})},t.openConnected=function(){return H(this,void 0,void 0,function(){var e;return Y(this,function(n){switch(n.label){case 0:return[4,je()];case 1:return e=n.sent(),e.length===0?[2,null]:[2,t.open(e[0])]}})})},t.open=function(e){return H(this,void 0,void 0,function(){var n,i,s,o,u;return Y(this,function(c){switch(c.label){case 0:return[4,e.open()];case 1:return c.sent(),e.configuration!==null?[3,3]:[4,e.selectConfiguration(Di)];case 2:c.sent(),c.label=3;case 3:return[4,bt(e)];case 4:if(c.sent(),n=e.configurations[0].interfaces.find(function(a){var l=a.alternates;return l.some(function(h){return h.interfaceClass===255})}),!n)throw new Ze("No WebUSB interface found for your Ledger device. Please upgrade firmware or contact techsupport.");i=n.interfaceNumber,c.label=5;case 5:return c.trys.push([5,7,,9]),[4,e.claimInterface(i)];case 6:return c.sent(),[3,9];case 7:return s=c.sent(),[4,e.close()];case 8:throw c.sent(),new Ze(s.message);case 9:return o=new t(e,i),u=function(a){e===a.device&&(navigator.usb.removeEventListener("disconnect",u),o._emitDisconnect(new At))},navigator.usb.addEventListener("disconnect",u),[2,o]}})})},t.prototype.close=function(){return H(this,void 0,void 0,function(){return Y(this,function(e){switch(e.label){case 0:return[4,this.exchangeBusyPromise];case 1:return e.sent(),[4,this.device.releaseInterface(this.interfaceNumber)];case 2:return e.sent(),[4,bt(this.device)];case 3:return e.sent(),[4,this.device.close()];case 4:return e.sent(),[2]}})})},t.prototype.exchange=function(e){return H(this,void 0,void 0,function(){var n,i=this;return Y(this,function(s){switch(s.label){case 0:return[4,this.exchangeAtomicImpl(function(){return H(i,void 0,void 0,function(){var o,u,c,a,l,h,I,v,x,U;return Y(this,function(R){switch(R.label){case 0:o=this,u=o.channel,c=o.packetSize,ge("apdu","=> "+e.toString("hex")),a=Dt(u,c),l=a.makeBlocks(e),h=0,R.label=1;case 1:return h<l.length?[4,this.device.transferOut(Ot,l[h])]:[3,4];case 2:R.sent(),R.label=3;case 3:return h++,[3,1];case 4:return(I=a.getReducedResult(v))?[3,6]:[4,this.device.transferIn(Ot,c)];case 5:return x=R.sent(),U=Buffer.from(x.data.buffer),v=a.reduceResponse(v,U),[3,4];case 6:return ge("apdu","<= "+I.toString("hex")),[2,I]}})})}).catch(function(o){throw o&&o.message&&o.message.includes("disconnected")?(i._emitDisconnect(o),new _t(o.message)):o})];case 1:return n=s.sent(),[2,n]}})})},t.prototype.setScrambleKey=function(){},t.isSupported=xi,t.list=je,t.listen=function(e){var n=!1;_i().then(function(s){if(!n){var o=ve(s.productId);e.next({type:"add",descriptor:s,deviceModel:o}),e.complete()}},function(s){window.DOMException&&s instanceof window.DOMException&&s.code===18?e.error(new hr(s.message)):e.error(new Fe(s.message))});function i(){n=!0}return{unsubscribe:i}},t}(Lt);function bt(r){return H(this,void 0,void 0,function(){var t;return Y(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,r.reset()];case 1:return e.sent(),[3,3];case 2:return t=e.sent(),console.warn(t),[3,3];case 3:return[2]}})})}const Pi=async()=>{try{return await Ci.create()}catch(r){return console.log(r),await bi.create()}},Ui=async(r,t)=>{const{create_toolkit:e}=await ir(()=>import("./taquito-c350d5de.js"),["assets/taquito-c350d5de.js","assets/taquito.es6-a47a8eec.js","assets/taquito-utils.es6-82c03c39.js","assets/_commonjsHelpers-6dff16f2.js","assets/index-9aada285.js","assets/index-6f227088.js"]),{tezos:n,forger:i}=await e(t.rpc),s=new or(r,t.derivationPath,void 0,t.derivationType);n.setSignerProvider(s);const o=await n.signer.publicKeyHash(),u=o?await n.rpc.getManagerKey(o):void 0;return{account:o,tezos:n,forger:i,managerKey:u==null?void 0:u.toString()}},{request_ledger_setup:Fi}=rr();class Vt extends nr{constructor(t,e,n,i,s){super(t,n,i,s),this.transport=e}get AccountType(){return Qt.Ledger}get Icon(){return new Jt("/assets/svg/ledger-wallet-icon.svg",er.raw)}get IsAccountSwitchSupported(){return!1}static async create(t,e,n){const i=tr[e];if(!i)throw new Error("Invalid network specification!");const{account:s,tezos:o,forger:u,managerKey:c}=await Ui(t,{...n,rpc:(n==null?void 0:n.rpc)??i.rpc});return new Vt(s??"",t,o,u,{networkId:e,managerKey:c})}static async create_transport(){return Pi()}static async create_from_cache(){}logout(){this.transport.close()}async switch_wallet(){const t=await Fi({networkId:this.NetworkId,rpc:this.Tezos.rpc.getRpcUrl()});if(!t)throw new Error("Aborted.");return t}async vote(t){const e=await this.forge_ballot_op(t),n=async()=>{const i=this.Tezos.wallet.context,s=await this.Tezos.signer.sign(e,new Uint8Array([3])),o=await this.Tezos.rpc.injectOperation(s.sbytes);return i.operationFactory.createOperation(o)};return new oe(n,"Vote",{account:this.Account,ballot:t})}async propose(t){const e=await this.forge_proposals_op(t),n=async()=>{const i=this.Tezos.wallet.context,s=await this.Tezos.signer.sign(e,new Uint8Array([3])),o=await this.Tezos.rpc.injectOperation(s.sbytes);return i.operationFactory.createOperation(o)};return new oe(n,"Propose",{account:this.Account,proposals:t})}async set_deposits_limit(t){const e=await this.forge_set_deposit_op(t),n=async()=>{const i=this.Tezos.wallet.context,s=await this.Tezos.signer.sign(e,new Uint8Array([3])),o=await this.Tezos.rpc.injectOperation(s.sbytes);return i.operationFactory.createOperation(o)};return new oe(n,"Propose",{account:this.Account,limit:t.toString()})}async update_consensus_key(t){const e=await this.forge_update_consensus_key_op(t),n=async()=>{const i=this.Tezos.wallet.context,s=await this.Tezos.signer.sign(e,new Uint8Array([3])),o=await this.Tezos.rpc.injectOperation(s.sbytes);return i.operationFactory.createOperation(o)};return new oe(n,"Propose",{account:this.Account,"Consensus Key":t})}}export{Vt as LedgerSession};
