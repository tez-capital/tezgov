import{J as tr,_ as rr,E as nr,z as sr,A as ir,O as oe,K as ar,B as or}from"./main-34b72f39.js";import{S as cr}from"./SessionBase-8b70e21a.js";import{L as ur}from"./LedgerDialog-531562c5.js";import"./taquito.es6-f55643bf.js";import"./DAppClient-0e874b97.js";var lr=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(n[s]=i[s])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();globalThis&&globalThis.__values;var f=function(r){var t=function(e){lr(n,e);function n(i,s,a){var u=e.call(this,i||r,a)||this;if(Object.setPrototypeOf(u,n.prototype),u.name=r,s)for(var c in s)u[c]=s[c];if(a&&fr(a)&&"cause"in a&&!("cause"in u)){var o=a.cause;u.cause=o,"stack"in o&&(u.stack=u.stack+`
CAUSE: `+o.stack)}return u}return n}(Error);return t};function fr(r){return typeof r=="object"}var Lt=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(n[s]=i[s])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();f("AccountNameRequired");f("AccountNotSupported");f("AmountRequired");f("BluetoothRequired");f("BtcUnmatchedApp");f("CantOpenDevice");f("CashAddrNotSupported");f("CurrencyNotSupported");f("DeviceAppVerifyNotSupported");f("DeviceGenuineSocketEarlyClose");f("DeviceNotGenuine");f("DeviceOnDashboardExpected");f("DeviceOnDashboardUnexpected");f("DeviceInOSUExpected");f("DeviceHalted");f("DeviceNameInvalid");f("DeviceSocketFail");f("DeviceSocketNoBulkStatus");var hr=f("LockedDeviceError"),Dt=f("DisconnectedDevice"),Ct=f("DisconnectedDeviceDuringOperation");f("DeviceExtractOnboardingStateError");f("DeviceOnboardingStatePollingError");f("EnpointConfig");f("EthAppPleaseEnableContractData");f("FeeEstimationFailed");f("FirmwareNotRecognized");f("HardResetFail");f("InvalidXRPTag");f("InvalidAddress");f("InvalidAddressBecauseDestinationIsAlsoSource");f("LatestMCUInstalledError");f("UnknownMCU");f("LedgerAPIError");f("LedgerAPIErrorWithMessage");f("LedgerAPINotAvailable");f("ManagerAppAlreadyInstalled");f("ManagerAppRelyOnBTC");f("ManagerAppDepInstallRequired");f("ManagerAppDepUninstallRequired");f("ManagerDeviceLocked");f("ManagerFirmwareNotEnoughSpace");f("ManagerNotEnoughSpace");f("ManagerUninstallBTCDep");f("NetworkDown");f("NoAddressesFound");f("NotEnoughBalance");f("NotEnoughBalanceToDelegate");f("NotEnoughBalanceInParentAccount");f("NotEnoughSpendableBalance");f("NotEnoughBalanceBecauseDestinationNotCreated");f("NoAccessToCamera");f("NotEnoughGas");f("NotSupportedLegacyAddress");f("GasLessThanEstimate");f("PriorityFeeTooLow");f("PriorityFeeTooHigh");f("PriorityFeeHigherThanMaxFee");f("MaxFeeTooLow");f("PasswordsDontMatch");f("PasswordIncorrect");f("RecommendSubAccountsToEmpty");f("RecommendUndelegation");f("TimeoutTagged");f("UnexpectedBootloader");f("MCUNotGenuineToDashboard");f("RecipientRequired");f("UnavailableTezosOriginatedAccountReceive");f("UnavailableTezosOriginatedAccountSend");f("UpdateFetchFileFail");f("UpdateIncorrectHash");f("UpdateIncorrectSig");f("UpdateYourApp");f("UserRefusedDeviceNameChange");f("UserRefusedAddress");f("UserRefusedFirmwareUpdate");f("UserRefusedAllowManager");f("UserRefusedOnDevice");var Be=f("TransportOpenUserCancelled"),Je=f("TransportInterfaceNotAvailable"),dr=f("TransportRaceCondition"),pr=f("TransportWebUSBGestureRequired");f("DeviceShouldStayInApp");f("WebsocketConnectionError");f("WebsocketConnectionFailed");f("WrongDeviceForAccount");f("WrongAppForCurrency");f("ETHAddressNonEIP");f("CantScanQRCode");f("FeeNotLoaded");f("FeeRequired");f("FeeTooHigh");f("PendingOperation");f("SyncError");f("PairingFailed");f("GenuineCheckFailed");f("LedgerAPI4xx");f("LedgerAPI5xx");f("FirmwareOrAppUpdateRequired");f("OpReturnSizeLimit");f("DustLimit");f("LanguageNotFound");f("NoDBPathGiven");f("DBWrongPassword");f("DBNotReset");var Qe;(function(r){r.Unknown="Unknown",r.LocationServicesDisabled="LocationServicesDisabled",r.LocationServicesUnauthorized="LocationServicesUnauthorized",r.BluetoothScanStartFailed="BluetoothScanStartFailed"})(Qe||(Qe={}));(function(r){Lt(t,r);function t(e,n){var i=r.call(this,n)||this;return i.name="HwTransportError",i.type=e,Object.setPrototypeOf(i,t.prototype),i}return t})(Error);var z=function(r){Lt(t,r);function t(e,n){var i=this,s="TransportError";return i=r.call(this,e||s)||this,i.name=s,i.message=e,i.stack=new Error().stack,i.id=n,i}return t}(Error),ie={ACCESS_CONDITION_NOT_FULFILLED:38916,ALGORITHM_NOT_SUPPORTED:38020,CLA_NOT_SUPPORTED:28160,CODE_BLOCKED:38976,CODE_NOT_INITIALIZED:38914,COMMAND_INCOMPATIBLE_FILE_STRUCTURE:27009,CONDITIONS_OF_USE_NOT_SATISFIED:27013,CONTRADICTION_INVALIDATION:38928,CONTRADICTION_SECRET_CODE_STATUS:38920,CUSTOM_IMAGE_BOOTLOADER:26159,CUSTOM_IMAGE_EMPTY:26158,FILE_ALREADY_EXISTS:27273,FILE_NOT_FOUND:37892,GP_AUTH_FAILED:25344,HALTED:28586,INCONSISTENT_FILE:37896,INCORRECT_DATA:27264,INCORRECT_LENGTH:26368,INCORRECT_P1_P2:27392,INS_NOT_SUPPORTED:27904,DEVICE_NOT_ONBOARDED:27911,DEVICE_NOT_ONBOARDED_2:26129,INVALID_KCV:38021,INVALID_OFFSET:37890,LICENSING:28482,LOCKED_DEVICE:21781,MAX_VALUE_REACHED:38992,MEMORY_PROBLEM:37440,MISSING_CRITICAL_PARAMETER:26624,NO_EF_SELECTED:37888,NOT_ENOUGH_MEMORY_SPACE:27268,OK:36864,PIN_REMAINING_ATTEMPTS:25536,REFERENCED_DATA_NOT_FOUND:27272,SECURITY_STATUS_NOT_SATISFIED:27010,TECHNICAL_PROBLEM:28416,UNKNOWN_APDU:27906,USER_REFUSED_ON_DEVICE:21761,NOT_ENOUGH_SPACE:20738};function vr(r){switch(r){case 26368:return"Incorrect length";case 26624:return"Missing critical parameter";case 27010:return"Security not satisfied (dongle locked or have invalid access rights)";case 27013:return"Condition of use not satisfied (denied by the user?)";case 27264:return"Invalid data received";case 27392:return"Invalid parameter received";case 21781:return"Locked device"}if(28416<=r&&r<=28671)return"Internal error, please report"}function Fe(r){var t=Object.keys(ie).find(function(s){return ie[s]===r})||"UNKNOWN_ERROR",e=vr(r)||t,n=r.toString(16),i="Ledger device: ".concat(e," (0x").concat(n,")");if(r===ie.LOCKED_DEVICE)throw new hr(i);this.name="TransportStatusError",this.message=i,this.stack=new Error().stack,this.statusCode=r,this.statusText=t}Fe.prototype=new Error;var ce=globalThis&&globalThis.__awaiter||function(r,t,e,n){function i(s){return s instanceof e?s:new e(function(a){a(s)})}return new(e||(e=Promise))(function(s,a){function u(l){try{o(n.next(l))}catch(h){a(h)}}function c(l){try{o(n.throw(l))}catch(h){a(h)}}function o(l){l.done?s(l.value):i(l.value).then(u,c)}o((n=n.apply(r,t||[])).next())})},ue=globalThis&&globalThis.__generator||function(r,t){var e={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(o){return function(l){return c([o,l])}}function c(o){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,i&&(s=o[0]&2?i.return:o[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,o[1])).done)return s;switch(i=0,s&&(o=[o[0]&2,s.value]),o[0]){case 0:case 1:s=o;break;case 4:return e.label++,{value:o[1],done:!1};case 5:e.label++,i=o[1],o=[0];continue;case 7:o=e.ops.pop(),e.trys.pop();continue;default:if(s=e.trys,!(s=s.length>0&&s[s.length-1])&&(o[0]===6||o[0]===2)){e=0;continue}if(o[0]===3&&(!s||o[1]>s[0]&&o[1]<s[3])){e.label=o[1];break}if(o[0]===6&&e.label<s[1]){e.label=s[1],s=o;break}if(s&&e.label<s[2]){e.label=s[2],e.ops.push(o);break}s[2]&&e.ops.pop(),e.trys.pop();continue}o=t.call(r,e)}catch(l){o=[6,l],i=0}finally{n=s=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},et=globalThis&&globalThis.__values||function(r){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&r[t],n=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Er=globalThis&&globalThis.__read||function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),i,s=[],a;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(u){a={error:u}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return s},gr=globalThis&&globalThis.__spreadArray||function(r,t,e){if(e||arguments.length===2)for(var n=0,i=t.length,s;n<i;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return r.concat(s||Array.prototype.slice.call(t))},Pt=function(){function r(){var t=this;this.exchangeTimeout=3e4,this.unresponsiveTimeout=15e3,this.deviceModel=null,this._events=new tr,this.send=function(e,n,i,s,a,u){return a===void 0&&(a=Buffer.alloc(0)),u===void 0&&(u=[ie.OK]),ce(t,void 0,void 0,function(){var c,o;return ue(this,function(l){switch(l.label){case 0:if(a.length>=256)throw new z("data.length exceed 256 bytes limit. Got: "+a.length,"DataLengthTooBig");return[4,this.exchange(Buffer.concat([Buffer.from([e,n,i,s]),Buffer.from([a.length]),a]))];case 1:if(c=l.sent(),o=c.readUInt16BE(c.length-2),!u.some(function(h){return h===o}))throw new Fe(o);return[2,c]}})})},this.exchangeAtomicImpl=function(e){return ce(t,void 0,void 0,function(){var n,i,s,a,u,c=this;return ue(this,function(o){switch(o.label){case 0:if(this.exchangeBusyPromise)throw new dr("An action was already pending on the Ledger device. Please deny or reconnect.");i=new Promise(function(l){n=l}),this.exchangeBusyPromise=i,s=!1,a=setTimeout(function(){s=!0,c.emit("unresponsive")},this.unresponsiveTimeout),o.label=1;case 1:return o.trys.push([1,,3,4]),[4,e()];case 2:return u=o.sent(),s&&this.emit("responsive"),[2,u];case 3:return clearTimeout(a),n&&n(),this.exchangeBusyPromise=null,[7];case 4:return[2]}})})},this._appAPIlock=null}return r.prototype.exchange=function(t){throw new Error("exchange not implemented")},r.prototype.exchangeBulk=function(t,e){var n=this,i=!1,s=function(){i=!0},a=function(){return ce(n,void 0,void 0,function(){var u,c,o,l,h,I,p,x;return ue(this,function(b){switch(b.label){case 0:if(i)return[2];b.label=1;case 1:b.trys.push([1,6,7,8]),u=et(t),c=u.next(),b.label=2;case 2:return c.done?[3,5]:(o=c.value,[4,this.exchange(o)]);case 3:if(l=b.sent(),i)return[2];if(h=l.readUInt16BE(l.length-2),h!==ie.OK)throw new Fe(h);e.next(l),b.label=4;case 4:return c=u.next(),[3,2];case 5:return[3,8];case 6:return I=b.sent(),p={error:I},[3,8];case 7:try{c&&!c.done&&(x=u.return)&&x.call(u)}finally{if(p)throw p.error}return[7];case 8:return[2]}})})};return a().then(function(){return!i&&e.complete()},function(u){return!i&&e.error(u)}),{unsubscribe:s}},r.prototype.setScrambleKey=function(t){},r.prototype.close=function(){return Promise.resolve()},r.prototype.on=function(t,e){this._events.on(t,e)},r.prototype.off=function(t,e){this._events.removeListener(t,e)},r.prototype.emit=function(t){for(var e,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];(e=this._events).emit.apply(e,gr([t],Er(n),!1))},r.prototype.setDebugMode=function(){console.warn("setDebugMode is deprecated. use @ledgerhq/logs instead. No logs are emitted in this anymore.")},r.prototype.setExchangeTimeout=function(t){this.exchangeTimeout=t},r.prototype.setExchangeUnresponsiveTimeout=function(t){this.unresponsiveTimeout=t},r.create=function(t,e){var n=this;return t===void 0&&(t=3e3),new Promise(function(i,s){var a=!1,u=n.listen({next:function(o){a=!0,u&&u.unsubscribe(),c&&clearTimeout(c),n.open(o.descriptor,t).then(i,s)},error:function(o){c&&clearTimeout(c),s(o)},complete:function(){c&&clearTimeout(c),a||s(new z(n.ErrorMessage_NoDeviceFound,"NoDeviceFound"))}}),c=e?setTimeout(function(){u.unsubscribe(),s(new z(n.ErrorMessage_ListenTimeout,"ListenTimeout"))},e):null})},r.prototype.decorateAppAPIMethods=function(t,e,n){var i,s;try{for(var a=et(e),u=a.next();!u.done;u=a.next()){var c=u.value;t[c]=this.decorateAppAPIMethod(c,t[c],t,n)}}catch(o){i={error:o}}finally{try{u&&!u.done&&(s=a.return)&&s.call(a)}finally{if(i)throw i.error}}},r.prototype.decorateAppAPIMethod=function(t,e,n,i){var s=this;return function(){for(var a=[],u=0;u<arguments.length;u++)a[u]=arguments[u];return ce(s,void 0,void 0,function(){var c;return ue(this,function(o){switch(o.label){case 0:if(c=this._appAPIlock,c)return[2,Promise.reject(new z("Ledger Device is busy (lock "+c+")","TransportLocked"))];o.label=1;case 1:return o.trys.push([1,,3,4]),this._appAPIlock=t,this.setScrambleKey(i),[4,e.apply(n,a)];case 2:return[2,o.sent()];case 3:return this._appAPIlock=null,[7];case 4:return[2]}})})}},r.ErrorMessage_ListenTimeout="No Ledger device found (timeout)",r.ErrorMessage_NoDeviceFound="No Ledger device found",r}(),tt=5;function mr(r){var t=Buffer.alloc(2);return t.writeUInt16BE(r,0),t}var yr={data:Buffer.alloc(0),dataLength:0,sequence:0},Ut=function(r,t){return{makeBlocks:function(e){var n=Buffer.concat([mr(e.length),e]),i=t-5,s=Math.ceil(n.length/i);n=Buffer.concat([n,Buffer.alloc(s*i-n.length+1).fill(0)]);for(var a=[],u=0;u<s;u++){var c=Buffer.alloc(5);c.writeUInt16BE(r,0),c.writeUInt8(tt,2),c.writeUInt16BE(u,3);var o=n.slice(u*i,(u+1)*i);a.push(Buffer.concat([c,o]))}return a},reduceResponse:function(e,n){var i=e||yr,s=i.data,a=i.dataLength,u=i.sequence;if(n.readUInt16BE(0)!==r)throw new z("Invalid channel","InvalidChannel");if(n.readUInt8(2)!==tt)throw new z("Invalid tag","InvalidTag");if(n.readUInt16BE(3)!==u)throw new z("Invalid sequence","InvalidSequence");e||(a=n.readUInt16BE(5)),u++;var c=n.slice(e?5:7);return s=Buffer.concat([s,c]),s.length>a&&(s=s.slice(0,a)),{data:s,dataLength:a,sequence:u}},getReducedResult:function(e){if(e&&e.dataLength===e.data.length)return e.data}}},X={},Ir={get exports(){return X},set exports(r){X=r}};const wr="2.0.0",$r=256,Tr=Number.MAX_SAFE_INTEGER||9007199254740991,Sr=16;var Ie={SEMVER_SPEC_VERSION:wr,MAX_LENGTH:$r,MAX_SAFE_INTEGER:Tr,MAX_SAFE_COMPONENT_LENGTH:Sr};const Rr=typeof process=="object"&&{}&&{}.NODE_DEBUG&&/\bsemver\b/i.test({}.NODE_DEBUG)?(...r)=>console.error("SEMVER",...r):()=>{};var we=Rr;(function(r,t){const{MAX_SAFE_COMPONENT_LENGTH:e}=Ie,n=we;t=r.exports={};const i=t.re=[],s=t.src=[],a=t.t={};let u=0;const c=(o,l,h)=>{const I=u++;n(o,I,l),a[o]=I,s[I]=l,i[I]=new RegExp(l,h?"g":void 0)};c("NUMERICIDENTIFIER","0|[1-9]\\d*"),c("NUMERICIDENTIFIERLOOSE","[0-9]+"),c("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),c("MAINVERSION",`(${s[a.NUMERICIDENTIFIER]})\\.(${s[a.NUMERICIDENTIFIER]})\\.(${s[a.NUMERICIDENTIFIER]})`),c("MAINVERSIONLOOSE",`(${s[a.NUMERICIDENTIFIERLOOSE]})\\.(${s[a.NUMERICIDENTIFIERLOOSE]})\\.(${s[a.NUMERICIDENTIFIERLOOSE]})`),c("PRERELEASEIDENTIFIER",`(?:${s[a.NUMERICIDENTIFIER]}|${s[a.NONNUMERICIDENTIFIER]})`),c("PRERELEASEIDENTIFIERLOOSE",`(?:${s[a.NUMERICIDENTIFIERLOOSE]}|${s[a.NONNUMERICIDENTIFIER]})`),c("PRERELEASE",`(?:-(${s[a.PRERELEASEIDENTIFIER]}(?:\\.${s[a.PRERELEASEIDENTIFIER]})*))`),c("PRERELEASELOOSE",`(?:-?(${s[a.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${s[a.PRERELEASEIDENTIFIERLOOSE]})*))`),c("BUILDIDENTIFIER","[0-9A-Za-z-]+"),c("BUILD",`(?:\\+(${s[a.BUILDIDENTIFIER]}(?:\\.${s[a.BUILDIDENTIFIER]})*))`),c("FULLPLAIN",`v?${s[a.MAINVERSION]}${s[a.PRERELEASE]}?${s[a.BUILD]}?`),c("FULL",`^${s[a.FULLPLAIN]}$`),c("LOOSEPLAIN",`[v=\\s]*${s[a.MAINVERSIONLOOSE]}${s[a.PRERELEASELOOSE]}?${s[a.BUILD]}?`),c("LOOSE",`^${s[a.LOOSEPLAIN]}$`),c("GTLT","((?:<|>)?=?)"),c("XRANGEIDENTIFIERLOOSE",`${s[a.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),c("XRANGEIDENTIFIER",`${s[a.NUMERICIDENTIFIER]}|x|X|\\*`),c("XRANGEPLAIN",`[v=\\s]*(${s[a.XRANGEIDENTIFIER]})(?:\\.(${s[a.XRANGEIDENTIFIER]})(?:\\.(${s[a.XRANGEIDENTIFIER]})(?:${s[a.PRERELEASE]})?${s[a.BUILD]}?)?)?`),c("XRANGEPLAINLOOSE",`[v=\\s]*(${s[a.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[a.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[a.XRANGEIDENTIFIERLOOSE]})(?:${s[a.PRERELEASELOOSE]})?${s[a.BUILD]}?)?)?`),c("XRANGE",`^${s[a.GTLT]}\\s*${s[a.XRANGEPLAIN]}$`),c("XRANGELOOSE",`^${s[a.GTLT]}\\s*${s[a.XRANGEPLAINLOOSE]}$`),c("COERCE",`(^|[^\\d])(\\d{1,${e}})(?:\\.(\\d{1,${e}}))?(?:\\.(\\d{1,${e}}))?(?:$|[^\\d])`),c("COERCERTL",s[a.COERCE],!0),c("LONETILDE","(?:~>?)"),c("TILDETRIM",`(\\s*)${s[a.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",c("TILDE",`^${s[a.LONETILDE]}${s[a.XRANGEPLAIN]}$`),c("TILDELOOSE",`^${s[a.LONETILDE]}${s[a.XRANGEPLAINLOOSE]}$`),c("LONECARET","(?:\\^)"),c("CARETTRIM",`(\\s*)${s[a.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",c("CARET",`^${s[a.LONECARET]}${s[a.XRANGEPLAIN]}$`),c("CARETLOOSE",`^${s[a.LONECARET]}${s[a.XRANGEPLAINLOOSE]}$`),c("COMPARATORLOOSE",`^${s[a.GTLT]}\\s*(${s[a.LOOSEPLAIN]})$|^$`),c("COMPARATOR",`^${s[a.GTLT]}\\s*(${s[a.FULLPLAIN]})$|^$`),c("COMPARATORTRIM",`(\\s*)${s[a.GTLT]}\\s*(${s[a.LOOSEPLAIN]}|${s[a.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",c("HYPHENRANGE",`^\\s*(${s[a.XRANGEPLAIN]})\\s+-\\s+(${s[a.XRANGEPLAIN]})\\s*$`),c("HYPHENRANGELOOSE",`^\\s*(${s[a.XRANGEPLAINLOOSE]})\\s+-\\s+(${s[a.XRANGEPLAINLOOSE]})\\s*$`),c("STAR","(<|>)?=?\\s*\\*"),c("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),c("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")})(Ir,X);const Or=["includePrerelease","loose","rtl"],Nr=r=>r?typeof r!="object"?{loose:!0}:Or.filter(t=>r[t]).reduce((t,e)=>(t[e]=!0,t),{}):{};var $e=Nr;const rt=/^[0-9]+$/,Bt=(r,t)=>{const e=rt.test(r),n=rt.test(t);return e&&n&&(r=+r,t=+t),r===t?0:e&&!n?-1:n&&!e?1:r<t?-1:1},br=(r,t)=>Bt(t,r);var Ft={compareIdentifiers:Bt,rcompareIdentifiers:br};const le=we,{MAX_LENGTH:nt,MAX_SAFE_INTEGER:fe}=Ie,{re:st,t:it}=X,Ar=$e,{compareIdentifiers:J}=Ft;let _r=class B{constructor(t,e){if(e=Ar(e),t instanceof B){if(t.loose===!!e.loose&&t.includePrerelease===!!e.includePrerelease)return t;t=t.version}else if(typeof t!="string")throw new TypeError(`Invalid Version: ${t}`);if(t.length>nt)throw new TypeError(`version is longer than ${nt} characters`);le("SemVer",t,e),this.options=e,this.loose=!!e.loose,this.includePrerelease=!!e.includePrerelease;const n=t.trim().match(e.loose?st[it.LOOSE]:st[it.FULL]);if(!n)throw new TypeError(`Invalid Version: ${t}`);if(this.raw=t,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>fe||this.major<0)throw new TypeError("Invalid major version");if(this.minor>fe||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>fe||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(i=>{if(/^[0-9]+$/.test(i)){const s=+i;if(s>=0&&s<fe)return s}return i}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(le("SemVer.compare",this.version,this.options,t),!(t instanceof B)){if(typeof t=="string"&&t===this.version)return 0;t=new B(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof B||(t=new B(t,this.options)),J(this.major,t.major)||J(this.minor,t.minor)||J(this.patch,t.patch)}comparePre(t){if(t instanceof B||(t=new B(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let e=0;do{const n=this.prerelease[e],i=t.prerelease[e];if(le("prerelease compare",e,n,i),n===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(n===void 0)return-1;if(n===i)continue;return J(n,i)}while(++e)}compareBuild(t){t instanceof B||(t=new B(t,this.options));let e=0;do{const n=this.build[e],i=t.build[e];if(le("prerelease compare",e,n,i),n===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(n===void 0)return-1;if(n===i)continue;return J(n,i)}while(++e)}inc(t,e){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",e);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",e);break;case"prepatch":this.prerelease.length=0,this.inc("patch",e),this.inc("pre",e);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",e),this.inc("pre",e);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{let n=this.prerelease.length;for(;--n>=0;)typeof this.prerelease[n]=="number"&&(this.prerelease[n]++,n=-2);n===-1&&this.prerelease.push(0)}e&&(J(this.prerelease[0],e)===0?isNaN(this.prerelease[1])&&(this.prerelease=[e,0]):this.prerelease=[e,0]);break;default:throw new Error(`invalid increment argument: ${t}`)}return this.format(),this.raw=this.version,this}};var L=_r;const{MAX_LENGTH:xr}=Ie,{re:at,t:ot}=X,ct=L,Lr=$e,Dr=(r,t)=>{if(t=Lr(t),r instanceof ct)return r;if(typeof r!="string"||r.length>xr||!(t.loose?at[ot.LOOSE]:at[ot.FULL]).test(r))return null;try{return new ct(r,t)}catch{return null}};var te=Dr;const Cr=te,Pr=(r,t)=>{const e=Cr(r,t);return e?e.version:null};var Ur=Pr;const Br=te,Fr=(r,t)=>{const e=Br(r.trim().replace(/^[=v]+/,""),t);return e?e.version:null};var Gr=Fr;const ut=L,Mr=(r,t,e,n)=>{typeof e=="string"&&(n=e,e=void 0);try{return new ut(r instanceof ut?r.version:r,e).inc(t,n).version}catch{return null}};var jr=Mr;const lt=L,Vr=(r,t,e)=>new lt(r,e).compare(new lt(t,e));var P=Vr;const Xr=P,kr=(r,t,e)=>Xr(r,t,e)===0;var Xe=kr;const ft=te,zr=Xe,qr=(r,t)=>{if(zr(r,t))return null;{const e=ft(r),n=ft(t),i=e.prerelease.length||n.prerelease.length,s=i?"pre":"",a=i?"prerelease":"";for(const u in e)if((u==="major"||u==="minor"||u==="patch")&&e[u]!==n[u])return s+u;return a}};var Hr=qr;const Kr=L,Yr=(r,t)=>new Kr(r,t).major;var Wr=Yr;const Zr=L,Jr=(r,t)=>new Zr(r,t).minor;var Qr=Jr;const en=L,tn=(r,t)=>new en(r,t).patch;var rn=tn;const nn=te,sn=(r,t)=>{const e=nn(r,t);return e&&e.prerelease.length?e.prerelease:null};var an=sn;const on=P,cn=(r,t,e)=>on(t,r,e);var un=cn;const ln=P,fn=(r,t)=>ln(r,t,!0);var hn=fn;const ht=L,dn=(r,t,e)=>{const n=new ht(r,e),i=new ht(t,e);return n.compare(i)||n.compareBuild(i)};var ke=dn;const pn=ke,vn=(r,t)=>r.sort((e,n)=>pn(e,n,t));var En=vn;const gn=ke,mn=(r,t)=>r.sort((e,n)=>gn(n,e,t));var yn=mn;const In=P,wn=(r,t,e)=>In(r,t,e)>0;var Te=wn;const $n=P,Tn=(r,t,e)=>$n(r,t,e)<0;var ze=Tn;const Sn=P,Rn=(r,t,e)=>Sn(r,t,e)!==0;var Gt=Rn;const On=P,Nn=(r,t,e)=>On(r,t,e)>=0;var qe=Nn;const bn=P,An=(r,t,e)=>bn(r,t,e)<=0;var He=An;const _n=Xe,xn=Gt,Ln=Te,Dn=qe,Cn=ze,Pn=He,Un=(r,t,e,n)=>{switch(t){case"===":return typeof r=="object"&&(r=r.version),typeof e=="object"&&(e=e.version),r===e;case"!==":return typeof r=="object"&&(r=r.version),typeof e=="object"&&(e=e.version),r!==e;case"":case"=":case"==":return _n(r,e,n);case"!=":return xn(r,e,n);case">":return Ln(r,e,n);case">=":return Dn(r,e,n);case"<":return Cn(r,e,n);case"<=":return Pn(r,e,n);default:throw new TypeError(`Invalid operator: ${t}`)}};var Mt=Un;const Bn=L,Fn=te,{re:he,t:de}=X,Gn=(r,t)=>{if(r instanceof Bn)return r;if(typeof r=="number"&&(r=String(r)),typeof r!="string")return null;t=t||{};let e=null;if(!t.rtl)e=r.match(he[de.COERCE]);else{let n;for(;(n=he[de.COERCERTL].exec(r))&&(!e||e.index+e[0].length!==r.length);)(!e||n.index+n[0].length!==e.index+e[0].length)&&(e=n),he[de.COERCERTL].lastIndex=n.index+n[1].length+n[2].length;he[de.COERCERTL].lastIndex=-1}return e===null?null:Fn(`${e[2]}.${e[3]||"0"}.${e[4]||"0"}`,t)};var Mn=Gn,Ne,dt;function jn(){return dt||(dt=1,Ne=function(r){r.prototype[Symbol.iterator]=function*(){for(let t=this.head;t;t=t.next)yield t.value}}),Ne}var Vn=T;T.Node=Z;T.create=T;function T(r){var t=this;if(t instanceof T||(t=new T),t.tail=null,t.head=null,t.length=0,r&&typeof r.forEach=="function")r.forEach(function(i){t.push(i)});else if(arguments.length>0)for(var e=0,n=arguments.length;e<n;e++)t.push(arguments[e]);return t}T.prototype.removeNode=function(r){if(r.list!==this)throw new Error("removing node which does not belong to this list");var t=r.next,e=r.prev;return t&&(t.prev=e),e&&(e.next=t),r===this.head&&(this.head=t),r===this.tail&&(this.tail=e),r.list.length--,r.next=null,r.prev=null,r.list=null,t};T.prototype.unshiftNode=function(r){if(r!==this.head){r.list&&r.list.removeNode(r);var t=this.head;r.list=this,r.next=t,t&&(t.prev=r),this.head=r,this.tail||(this.tail=r),this.length++}};T.prototype.pushNode=function(r){if(r!==this.tail){r.list&&r.list.removeNode(r);var t=this.tail;r.list=this,r.prev=t,t&&(t.next=r),this.tail=r,this.head||(this.head=r),this.length++}};T.prototype.push=function(){for(var r=0,t=arguments.length;r<t;r++)kn(this,arguments[r]);return this.length};T.prototype.unshift=function(){for(var r=0,t=arguments.length;r<t;r++)zn(this,arguments[r]);return this.length};T.prototype.pop=function(){if(this.tail){var r=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,r}};T.prototype.shift=function(){if(this.head){var r=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,r}};T.prototype.forEach=function(r,t){t=t||this;for(var e=this.head,n=0;e!==null;n++)r.call(t,e.value,n,this),e=e.next};T.prototype.forEachReverse=function(r,t){t=t||this;for(var e=this.tail,n=this.length-1;e!==null;n--)r.call(t,e.value,n,this),e=e.prev};T.prototype.get=function(r){for(var t=0,e=this.head;e!==null&&t<r;t++)e=e.next;if(t===r&&e!==null)return e.value};T.prototype.getReverse=function(r){for(var t=0,e=this.tail;e!==null&&t<r;t++)e=e.prev;if(t===r&&e!==null)return e.value};T.prototype.map=function(r,t){t=t||this;for(var e=new T,n=this.head;n!==null;)e.push(r.call(t,n.value,this)),n=n.next;return e};T.prototype.mapReverse=function(r,t){t=t||this;for(var e=new T,n=this.tail;n!==null;)e.push(r.call(t,n.value,this)),n=n.prev;return e};T.prototype.reduce=function(r,t){var e,n=this.head;if(arguments.length>1)e=t;else if(this.head)n=this.head.next,e=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=0;n!==null;i++)e=r(e,n.value,i),n=n.next;return e};T.prototype.reduceReverse=function(r,t){var e,n=this.tail;if(arguments.length>1)e=t;else if(this.tail)n=this.tail.prev,e=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=this.length-1;n!==null;i--)e=r(e,n.value,i),n=n.prev;return e};T.prototype.toArray=function(){for(var r=new Array(this.length),t=0,e=this.head;e!==null;t++)r[t]=e.value,e=e.next;return r};T.prototype.toArrayReverse=function(){for(var r=new Array(this.length),t=0,e=this.tail;e!==null;t++)r[t]=e.value,e=e.prev;return r};T.prototype.slice=function(r,t){t=t||this.length,t<0&&(t+=this.length),r=r||0,r<0&&(r+=this.length);var e=new T;if(t<r||t<0)return e;r<0&&(r=0),t>this.length&&(t=this.length);for(var n=0,i=this.head;i!==null&&n<r;n++)i=i.next;for(;i!==null&&n<t;n++,i=i.next)e.push(i.value);return e};T.prototype.sliceReverse=function(r,t){t=t||this.length,t<0&&(t+=this.length),r=r||0,r<0&&(r+=this.length);var e=new T;if(t<r||t<0)return e;r<0&&(r=0),t>this.length&&(t=this.length);for(var n=this.length,i=this.tail;i!==null&&n>t;n--)i=i.prev;for(;i!==null&&n>r;n--,i=i.prev)e.push(i.value);return e};T.prototype.splice=function(r,t,...e){r>this.length&&(r=this.length-1),r<0&&(r=this.length+r);for(var n=0,i=this.head;i!==null&&n<r;n++)i=i.next;for(var s=[],n=0;i&&n<t;n++)s.push(i.value),i=this.removeNode(i);i===null&&(i=this.tail),i!==this.head&&i!==this.tail&&(i=i.prev);for(var n=0;n<e.length;n++)i=Xn(this,i,e[n]);return s};T.prototype.reverse=function(){for(var r=this.head,t=this.tail,e=r;e!==null;e=e.prev){var n=e.prev;e.prev=e.next,e.next=n}return this.head=t,this.tail=r,this};function Xn(r,t,e){var n=t===r.head?new Z(e,null,t,r):new Z(e,t,t.next,r);return n.next===null&&(r.tail=n),n.prev===null&&(r.head=n),r.length++,n}function kn(r,t){r.tail=new Z(t,r.tail,null,r),r.head||(r.head=r.tail),r.length++}function zn(r,t){r.head=new Z(t,null,r.head,r),r.tail||(r.tail=r.head),r.length++}function Z(r,t,e,n){if(!(this instanceof Z))return new Z(r,t,e,n);this.list=n,this.value=r,t?(t.next=this,this.prev=t):this.prev=null,e?(e.prev=this,this.next=e):this.next=null}try{jn()(T)}catch{}const qn=Vn,Y=Symbol("max"),M=Symbol("length"),Q=Symbol("lengthCalculator"),ae=Symbol("allowStale"),W=Symbol("maxAge"),G=Symbol("dispose"),pt=Symbol("noDisposeOnSet"),A=Symbol("lruList"),C=Symbol("cache"),jt=Symbol("updateAgeOnGet"),be=()=>1;class Hn{constructor(t){if(typeof t=="number"&&(t={max:t}),t||(t={}),t.max&&(typeof t.max!="number"||t.max<0))throw new TypeError("max must be a non-negative number");this[Y]=t.max||1/0;const e=t.length||be;if(this[Q]=typeof e!="function"?be:e,this[ae]=t.stale||!1,t.maxAge&&typeof t.maxAge!="number")throw new TypeError("maxAge must be a number");this[W]=t.maxAge||0,this[G]=t.dispose,this[pt]=t.noDisposeOnSet||!1,this[jt]=t.updateAgeOnGet||!1,this.reset()}set max(t){if(typeof t!="number"||t<0)throw new TypeError("max must be a non-negative number");this[Y]=t||1/0,ne(this)}get max(){return this[Y]}set allowStale(t){this[ae]=!!t}get allowStale(){return this[ae]}set maxAge(t){if(typeof t!="number")throw new TypeError("maxAge must be a non-negative number");this[W]=t,ne(this)}get maxAge(){return this[W]}set lengthCalculator(t){typeof t!="function"&&(t=be),t!==this[Q]&&(this[Q]=t,this[M]=0,this[A].forEach(e=>{e.length=this[Q](e.value,e.key),this[M]+=e.length})),ne(this)}get lengthCalculator(){return this[Q]}get length(){return this[M]}get itemCount(){return this[A].length}rforEach(t,e){e=e||this;for(let n=this[A].tail;n!==null;){const i=n.prev;vt(this,t,n,e),n=i}}forEach(t,e){e=e||this;for(let n=this[A].head;n!==null;){const i=n.next;vt(this,t,n,e),n=i}}keys(){return this[A].toArray().map(t=>t.key)}values(){return this[A].toArray().map(t=>t.value)}reset(){this[G]&&this[A]&&this[A].length&&this[A].forEach(t=>this[G](t.key,t.value)),this[C]=new Map,this[A]=new qn,this[M]=0}dump(){return this[A].map(t=>Ee(this,t)?!1:{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}).toArray().filter(t=>t)}dumpLru(){return this[A]}set(t,e,n){if(n=n||this[W],n&&typeof n!="number")throw new TypeError("maxAge must be a number");const i=n?Date.now():0,s=this[Q](e,t);if(this[C].has(t)){if(s>this[Y])return ee(this,this[C].get(t)),!1;const c=this[C].get(t).value;return this[G]&&(this[pt]||this[G](t,c.value)),c.now=i,c.maxAge=n,c.value=e,this[M]+=s-c.length,c.length=s,this.get(t),ne(this),!0}const a=new Kn(t,e,s,i,n);return a.length>this[Y]?(this[G]&&this[G](t,e),!1):(this[M]+=a.length,this[A].unshift(a),this[C].set(t,this[A].head),ne(this),!0)}has(t){if(!this[C].has(t))return!1;const e=this[C].get(t).value;return!Ee(this,e)}get(t){return Ae(this,t,!0)}peek(t){return Ae(this,t,!1)}pop(){const t=this[A].tail;return t?(ee(this,t),t.value):null}del(t){ee(this,this[C].get(t))}load(t){this.reset();const e=Date.now();for(let n=t.length-1;n>=0;n--){const i=t[n],s=i.e||0;if(s===0)this.set(i.k,i.v);else{const a=s-e;a>0&&this.set(i.k,i.v,a)}}}prune(){this[C].forEach((t,e)=>Ae(this,e,!1))}}const Ae=(r,t,e)=>{const n=r[C].get(t);if(n){const i=n.value;if(Ee(r,i)){if(ee(r,n),!r[ae])return}else e&&(r[jt]&&(n.value.now=Date.now()),r[A].unshiftNode(n));return i.value}},Ee=(r,t)=>{if(!t||!t.maxAge&&!r[W])return!1;const e=Date.now()-t.now;return t.maxAge?e>t.maxAge:r[W]&&e>r[W]},ne=r=>{if(r[M]>r[Y])for(let t=r[A].tail;r[M]>r[Y]&&t!==null;){const e=t.prev;ee(r,t),t=e}},ee=(r,t)=>{if(t){const e=t.value;r[G]&&r[G](e.key,e.value),r[M]-=e.length,r[C].delete(e.key),r[A].removeNode(t)}};class Kn{constructor(t,e,n,i,s){this.key=t,this.value=e,this.length=n,this.now=i,this.maxAge=s||0}}const vt=(r,t,e,n)=>{let i=e.value;Ee(r,i)&&(ee(r,e),r[ae]||(i=void 0)),i&&t.call(n,i.value,i.key,r)};var Yn=Hn,_e,Et;function U(){if(Et)return _e;Et=1;class r{constructor(d,y){if(y=n(y),d instanceof r)return d.loose===!!y.loose&&d.includePrerelease===!!y.includePrerelease?d:new r(d.raw,y);if(d instanceof i)return this.raw=d.value,this.set=[[d]],this.format(),this;if(this.options=y,this.loose=!!y.loose,this.includePrerelease=!!y.includePrerelease,this.raw=d,this.set=d.split("||").map(g=>this.parseRange(g.trim())).filter(g=>g.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${d}`);if(this.set.length>1){const g=this.set[0];if(this.set=this.set.filter(m=>!I(m[0])),this.set.length===0)this.set=[g];else if(this.set.length>1){for(const m of this.set)if(m.length===1&&p(m[0])){this.set=[m];break}}}this.format()}format(){return this.range=this.set.map(d=>d.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(d){d=d.trim();const g=`parseRange:${Object.keys(this.options).join(",")}:${d}`,m=e.get(g);if(m)return m;const E=this.options.loose,w=E?u[c.HYPHENRANGELOOSE]:u[c.HYPHENRANGE];d=d.replace(w,Qt(this.options.includePrerelease)),s("hyphen replace",d),d=d.replace(u[c.COMPARATORTRIM],o),s("comparator trim",d),d=d.replace(u[c.TILDETRIM],l),d=d.replace(u[c.CARETTRIM],h),d=d.split(/\s+/).join(" ");let S=d.split(" ").map(N=>b(N,this.options)).join(" ").split(/\s+/).map(N=>Jt(N,this.options));E&&(S=S.filter(N=>(s("loose invalid filter",N,this.options),!!N.match(u[c.COMPARATORLOOSE])))),s("range list",S);const $=new Map,O=S.map(N=>new i(N,this.options));for(const N of O){if(I(N))return[N];$.set(N.value,N)}$.size>1&&$.has("")&&$.delete("");const D=[...$.values()];return e.set(g,D),D}intersects(d,y){if(!(d instanceof r))throw new TypeError("a Range is required");return this.set.some(g=>x(g,y)&&d.set.some(m=>x(m,y)&&g.every(E=>m.every(w=>E.intersects(w,y)))))}test(d){if(!d)return!1;if(typeof d=="string")try{d=new a(d,this.options)}catch{return!1}for(let y=0;y<this.set.length;y++)if(er(this.set[y],d,this.options))return!0;return!1}}_e=r;const t=Yn,e=new t({max:1e3}),n=$e,i=Se(),s=we,a=L,{re:u,t:c,comparatorTrimReplace:o,tildeTrimReplace:l,caretTrimReplace:h}=X,I=v=>v.value==="<0.0.0-0",p=v=>v.value==="",x=(v,d)=>{let y=!0;const g=v.slice();let m=g.pop();for(;y&&g.length;)y=g.every(E=>m.intersects(E,d)),m=g.pop();return y},b=(v,d)=>(s("comp",v,d),v=Ht(v,d),s("caret",v),v=F(v,d),s("tildes",v),v=Yt(v,d),s("xrange",v),v=Zt(v,d),s("stars",v),v),R=v=>!v||v.toLowerCase()==="x"||v==="*",F=(v,d)=>v.trim().split(/\s+/).map(y=>qt(y,d)).join(" "),qt=(v,d)=>{const y=d.loose?u[c.TILDELOOSE]:u[c.TILDE];return v.replace(y,(g,m,E,w,S)=>{s("tilde",v,g,m,E,w,S);let $;return R(m)?$="":R(E)?$=`>=${m}.0.0 <${+m+1}.0.0-0`:R(w)?$=`>=${m}.${E}.0 <${m}.${+E+1}.0-0`:S?(s("replaceTilde pr",S),$=`>=${m}.${E}.${w}-${S} <${m}.${+E+1}.0-0`):$=`>=${m}.${E}.${w} <${m}.${+E+1}.0-0`,s("tilde return",$),$})},Ht=(v,d)=>v.trim().split(/\s+/).map(y=>Kt(y,d)).join(" "),Kt=(v,d)=>{s("caret",v,d);const y=d.loose?u[c.CARETLOOSE]:u[c.CARET],g=d.includePrerelease?"-0":"";return v.replace(y,(m,E,w,S,$)=>{s("caret",v,m,E,w,S,$);let O;return R(E)?O="":R(w)?O=`>=${E}.0.0${g} <${+E+1}.0.0-0`:R(S)?E==="0"?O=`>=${E}.${w}.0${g} <${E}.${+w+1}.0-0`:O=`>=${E}.${w}.0${g} <${+E+1}.0.0-0`:$?(s("replaceCaret pr",$),E==="0"?w==="0"?O=`>=${E}.${w}.${S}-${$} <${E}.${w}.${+S+1}-0`:O=`>=${E}.${w}.${S}-${$} <${E}.${+w+1}.0-0`:O=`>=${E}.${w}.${S}-${$} <${+E+1}.0.0-0`):(s("no pr"),E==="0"?w==="0"?O=`>=${E}.${w}.${S}${g} <${E}.${w}.${+S+1}-0`:O=`>=${E}.${w}.${S}${g} <${E}.${+w+1}.0-0`:O=`>=${E}.${w}.${S} <${+E+1}.0.0-0`),s("caret return",O),O})},Yt=(v,d)=>(s("replaceXRanges",v,d),v.split(/\s+/).map(y=>Wt(y,d)).join(" ")),Wt=(v,d)=>{v=v.trim();const y=d.loose?u[c.XRANGELOOSE]:u[c.XRANGE];return v.replace(y,(g,m,E,w,S,$)=>{s("xRange",v,g,m,E,w,S,$);const O=R(E),D=O||R(w),N=D||R(S),re=N;return m==="="&&re&&(m=""),$=d.includePrerelease?"-0":"",O?m===">"||m==="<"?g="<0.0.0-0":g="*":m&&re?(D&&(w=0),S=0,m===">"?(m=">=",D?(E=+E+1,w=0,S=0):(w=+w+1,S=0)):m==="<="&&(m="<",D?E=+E+1:w=+w+1),m==="<"&&($="-0"),g=`${m+E}.${w}.${S}${$}`):D?g=`>=${E}.0.0${$} <${+E+1}.0.0-0`:N&&(g=`>=${E}.${w}.0${$} <${E}.${+w+1}.0-0`),s("xRange return",g),g})},Zt=(v,d)=>(s("replaceStars",v,d),v.trim().replace(u[c.STAR],"")),Jt=(v,d)=>(s("replaceGTE0",v,d),v.trim().replace(u[d.includePrerelease?c.GTE0PRE:c.GTE0],"")),Qt=v=>(d,y,g,m,E,w,S,$,O,D,N,re,ji)=>(R(g)?y="":R(m)?y=`>=${g}.0.0${v?"-0":""}`:R(E)?y=`>=${g}.${m}.0${v?"-0":""}`:w?y=`>=${y}`:y=`>=${y}${v?"-0":""}`,R(O)?$="":R(D)?$=`<${+O+1}.0.0-0`:R(N)?$=`<${O}.${+D+1}.0-0`:re?$=`<=${O}.${D}.${N}-${re}`:v?$=`<${O}.${D}.${+N+1}-0`:$=`<=${$}`,`${y} ${$}`.trim()),er=(v,d,y)=>{for(let g=0;g<v.length;g++)if(!v[g].test(d))return!1;if(d.prerelease.length&&!y.includePrerelease){for(let g=0;g<v.length;g++)if(s(v[g].semver),v[g].semver!==i.ANY&&v[g].semver.prerelease.length>0){const m=v[g].semver;if(m.major===d.major&&m.minor===d.minor&&m.patch===d.patch)return!0}return!1}return!0};return _e}var xe,gt;function Se(){if(gt)return xe;gt=1;const r=Symbol("SemVer ANY");class t{static get ANY(){return r}constructor(l,h){if(h=e(h),l instanceof t){if(l.loose===!!h.loose)return l;l=l.value}a("comparator",l,h),this.options=h,this.loose=!!h.loose,this.parse(l),this.semver===r?this.value="":this.value=this.operator+this.semver.version,a("comp",this)}parse(l){const h=this.options.loose?n[i.COMPARATORLOOSE]:n[i.COMPARATOR],I=l.match(h);if(!I)throw new TypeError(`Invalid comparator: ${l}`);this.operator=I[1]!==void 0?I[1]:"",this.operator==="="&&(this.operator=""),I[2]?this.semver=new u(I[2],this.options.loose):this.semver=r}toString(){return this.value}test(l){if(a("Comparator.test",l,this.options.loose),this.semver===r||l===r)return!0;if(typeof l=="string")try{l=new u(l,this.options)}catch{return!1}return s(l,this.operator,this.semver,this.options)}intersects(l,h){if(!(l instanceof t))throw new TypeError("a Comparator is required");if((!h||typeof h!="object")&&(h={loose:!!h,includePrerelease:!1}),this.operator==="")return this.value===""?!0:new c(l.value,h).test(this.value);if(l.operator==="")return l.value===""?!0:new c(this.value,h).test(l.semver);const I=(this.operator===">="||this.operator===">")&&(l.operator===">="||l.operator===">"),p=(this.operator==="<="||this.operator==="<")&&(l.operator==="<="||l.operator==="<"),x=this.semver.version===l.semver.version,b=(this.operator===">="||this.operator==="<=")&&(l.operator===">="||l.operator==="<="),R=s(this.semver,"<",l.semver,h)&&(this.operator===">="||this.operator===">")&&(l.operator==="<="||l.operator==="<"),F=s(this.semver,">",l.semver,h)&&(this.operator==="<="||this.operator==="<")&&(l.operator===">="||l.operator===">");return I||p||x&&b||R||F}}xe=t;const e=$e,{re:n,t:i}=X,s=Mt,a=we,u=L,c=U();return xe}const Wn=U(),Zn=(r,t,e)=>{try{t=new Wn(t,e)}catch{return!1}return t.test(r)};var Re=Zn;const Jn=U(),Qn=(r,t)=>new Jn(r,t).set.map(e=>e.map(n=>n.value).join(" ").trim().split(" "));var es=Qn;const ts=L,rs=U(),ns=(r,t,e)=>{let n=null,i=null,s=null;try{s=new rs(t,e)}catch{return null}return r.forEach(a=>{s.test(a)&&(!n||i.compare(a)===-1)&&(n=a,i=new ts(n,e))}),n};var ss=ns;const is=L,as=U(),os=(r,t,e)=>{let n=null,i=null,s=null;try{s=new as(t,e)}catch{return null}return r.forEach(a=>{s.test(a)&&(!n||i.compare(a)===1)&&(n=a,i=new is(n,e))}),n};var cs=os;const Le=L,us=U(),mt=Te,ls=(r,t)=>{r=new us(r,t);let e=new Le("0.0.0");if(r.test(e)||(e=new Le("0.0.0-0"),r.test(e)))return e;e=null;for(let n=0;n<r.set.length;++n){const i=r.set[n];let s=null;i.forEach(a=>{const u=new Le(a.semver.version);switch(a.operator){case">":u.prerelease.length===0?u.patch++:u.prerelease.push(0),u.raw=u.format();case"":case">=":(!s||mt(u,s))&&(s=u);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${a.operator}`)}}),s&&(!e||mt(e,s))&&(e=s)}return e&&r.test(e)?e:null};var fs=ls;const hs=U(),ds=(r,t)=>{try{return new hs(r,t).range||"*"}catch{return null}};var ps=ds;const vs=L,Vt=Se(),{ANY:Es}=Vt,gs=U(),ms=Re,yt=Te,It=ze,ys=He,Is=qe,ws=(r,t,e,n)=>{r=new vs(r,n),t=new gs(t,n);let i,s,a,u,c;switch(e){case">":i=yt,s=ys,a=It,u=">",c=">=";break;case"<":i=It,s=Is,a=yt,u="<",c="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(ms(r,t,n))return!1;for(let o=0;o<t.set.length;++o){const l=t.set[o];let h=null,I=null;if(l.forEach(p=>{p.semver===Es&&(p=new Vt(">=0.0.0")),h=h||p,I=I||p,i(p.semver,h.semver,n)?h=p:a(p.semver,I.semver,n)&&(I=p)}),h.operator===u||h.operator===c||(!I.operator||I.operator===u)&&s(r,I.semver))return!1;if(I.operator===c&&a(r,I.semver))return!1}return!0};var Ke=ws;const $s=Ke,Ts=(r,t,e)=>$s(r,t,">",e);var Ss=Ts;const Rs=Ke,Os=(r,t,e)=>Rs(r,t,"<",e);var Ns=Os;const wt=U(),bs=(r,t,e)=>(r=new wt(r,e),t=new wt(t,e),r.intersects(t));var As=bs;const _s=Re,xs=P;var Ls=(r,t,e)=>{const n=[];let i=null,s=null;const a=r.sort((l,h)=>xs(l,h,e));for(const l of a)_s(l,t,e)?(s=l,i||(i=l)):(s&&n.push([i,s]),s=null,i=null);i&&n.push([i,null]);const u=[];for(const[l,h]of n)l===h?u.push(l):!h&&l===a[0]?u.push("*"):h?l===a[0]?u.push(`<=${h}`):u.push(`${l} - ${h}`):u.push(`>=${l}`);const c=u.join(" || "),o=typeof t.raw=="string"?t.raw:String(t);return c.length<o.length?c:t};const $t=U(),ve=Se(),{ANY:De}=ve,se=Re,Ye=P,Ds=(r,t,e={})=>{if(r===t)return!0;r=new $t(r,e),t=new $t(t,e);let n=!1;e:for(const i of r.set){for(const s of t.set){const a=Cs(i,s,e);if(n=n||a!==null,a)continue e}if(n)return!1}return!0},Cs=(r,t,e)=>{if(r===t)return!0;if(r.length===1&&r[0].semver===De){if(t.length===1&&t[0].semver===De)return!0;e.includePrerelease?r=[new ve(">=0.0.0-0")]:r=[new ve(">=0.0.0")]}if(t.length===1&&t[0].semver===De){if(e.includePrerelease)return!0;t=[new ve(">=0.0.0")]}const n=new Set;let i,s;for(const p of r)p.operator===">"||p.operator===">="?i=Tt(i,p,e):p.operator==="<"||p.operator==="<="?s=St(s,p,e):n.add(p.semver);if(n.size>1)return null;let a;if(i&&s){if(a=Ye(i.semver,s.semver,e),a>0)return null;if(a===0&&(i.operator!==">="||s.operator!=="<="))return null}for(const p of n){if(i&&!se(p,String(i),e)||s&&!se(p,String(s),e))return null;for(const x of t)if(!se(p,String(x),e))return!1;return!0}let u,c,o,l,h=s&&!e.includePrerelease&&s.semver.prerelease.length?s.semver:!1,I=i&&!e.includePrerelease&&i.semver.prerelease.length?i.semver:!1;h&&h.prerelease.length===1&&s.operator==="<"&&h.prerelease[0]===0&&(h=!1);for(const p of t){if(l=l||p.operator===">"||p.operator===">=",o=o||p.operator==="<"||p.operator==="<=",i){if(I&&p.semver.prerelease&&p.semver.prerelease.length&&p.semver.major===I.major&&p.semver.minor===I.minor&&p.semver.patch===I.patch&&(I=!1),p.operator===">"||p.operator===">="){if(u=Tt(i,p,e),u===p&&u!==i)return!1}else if(i.operator===">="&&!se(i.semver,String(p),e))return!1}if(s){if(h&&p.semver.prerelease&&p.semver.prerelease.length&&p.semver.major===h.major&&p.semver.minor===h.minor&&p.semver.patch===h.patch&&(h=!1),p.operator==="<"||p.operator==="<="){if(c=St(s,p,e),c===p&&c!==s)return!1}else if(s.operator==="<="&&!se(s.semver,String(p),e))return!1}if(!p.operator&&(s||i)&&a!==0)return!1}return!(i&&o&&!s&&a!==0||s&&l&&!i&&a!==0||I||h)},Tt=(r,t,e)=>{if(!r)return t;const n=Ye(r.semver,t.semver,e);return n>0?r:n<0||t.operator===">"&&r.operator===">="?t:r},St=(r,t,e)=>{if(!r)return t;const n=Ye(r.semver,t.semver,e);return n<0?r:n>0||t.operator==="<"&&r.operator==="<="?t:r};var Ps=Ds;const Ce=X,Us=Ie,Bs=L,Rt=Ft,Fs=te,Gs=Ur,Ms=Gr,js=jr,Vs=Hr,Xs=Wr,ks=Qr,zs=rn,qs=an,Hs=P,Ks=un,Ys=hn,Ws=ke,Zs=En,Js=yn,Qs=Te,ei=ze,ti=Xe,ri=Gt,ni=qe,si=He,ii=Mt,ai=Mn,oi=Se(),ci=U(),ui=Re,li=es,fi=ss,hi=cs,di=fs,pi=ps,vi=Ke,Ei=Ss,gi=Ns,mi=As,yi=Ls,Ii=Ps;var Ot={parse:Fs,valid:Gs,clean:Ms,inc:js,diff:Vs,major:Xs,minor:ks,patch:zs,prerelease:qs,compare:Hs,rcompare:Ks,compareLoose:Ys,compareBuild:Ws,sort:Zs,rsort:Js,gt:Qs,lt:ei,eq:ti,neq:ri,gte:ni,lte:si,cmp:ii,coerce:ai,Comparator:oi,Range:ci,satisfies:ui,toComparators:li,maxSatisfying:fi,minSatisfying:hi,minVersion:di,validRange:pi,outside:vi,gtr:Ei,ltr:gi,intersects:mi,simplifyRange:yi,subset:Ii,SemVer:Bs,re:Ce.re,src:Ce.src,tokens:Ce.t,SEMVER_SPEC_VERSION:Us.SEMVER_SPEC_VERSION,compareIdentifiers:Rt.compareIdentifiers,rcompareIdentifiers:Rt.rcompareIdentifiers},Ge=globalThis&&globalThis.__assign||function(){return Ge=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=t[i])}return r},Ge.apply(this,arguments)},q,_;(function(r){r.blue="blue",r.nanoS="nanoS",r.nanoSP="nanoSP",r.nanoX="nanoX",r.stax="stax"})(_||(_={}));var Me=(q={},q[_.blue]={id:_.blue,productName:"Ledger Blue",productIdMM:0,legacyUsbProductId:0,usbOnly:!0,memorySize:480*1024,masks:[822083584,822149120],getBlockSize:function(r){return 4*1024}},q[_.nanoS]={id:_.nanoS,productName:"Ledger Nano S",productIdMM:16,legacyUsbProductId:1,usbOnly:!0,memorySize:320*1024,masks:[823132160],getBlockSize:function(r){var t;return Ot.lt((t=Ot.coerce(r))!==null&&t!==void 0?t:"","2.0.0")?4*1024:2*1024}},q[_.nanoSP]={id:_.nanoSP,productName:"Ledger Nano S Plus",productIdMM:80,legacyUsbProductId:5,usbOnly:!0,memorySize:1536*1024,masks:[856686592],getBlockSize:function(r){return 32}},q[_.nanoX]={id:_.nanoX,productName:"Ledger Nano X",productIdMM:64,legacyUsbProductId:4,usbOnly:!1,memorySize:2*1024*1024,masks:[855638016],getBlockSize:function(r){return 4*1024},bluetoothSpec:[{serviceUuid:"13d63400-2c97-0004-0000-4c6564676572",notifyUuid:"13d63400-2c97-0004-0001-4c6564676572",writeUuid:"13d63400-2c97-0004-0002-4c6564676572",writeCmdUuid:"13d63400-2c97-0004-0003-4c6564676572"}]},q[_.stax]={id:_.stax,productName:"Ledger Stax",productIdMM:96,legacyUsbProductId:6,usbOnly:!1,memorySize:1536*1024,masks:[857735168],getBlockSize:function(r){return 32},bluetoothSpec:[{serviceUuid:"13d63400-2c97-6004-0000-4c6564676572",notifyUuid:"13d63400-2c97-6004-0001-4c6564676572",writeUuid:"13d63400-2c97-6004-0002-4c6564676572",writeCmdUuid:"13d63400-2c97-6004-0003-4c6564676572"}]},q);_.blue,_.nanoS,_.nanoSP,_.nanoX,_.stax;var Nt=Object.values(Me),Oe=11415,ge=function(r){var t=Nt.find(function(i){return i.legacyUsbProductId===r});if(t)return t;var e=r>>8,n=Nt.find(function(i){return i.productIdMM===e});return n},wi=[],bt={};for(var $i in Me){var At=Me[$i],Pe=At.bluetoothSpec;if(Pe)for(var Ue=0;Ue<Pe.length;Ue++){var pe=Pe[Ue];wi.push(pe.serviceUuid),bt[pe.serviceUuid]=bt[pe.serviceUuid.replace(/-/g,"")]=Ge({deviceModel:At},pe)}}var Ti=0,k=[],me=function(r,t,e){var n={type:r,id:String(++Ti),date:new Date};t&&(n.message=t),e&&(n.data=e),Ri(n)},Si=function(r){return k.push(r),function(){var t=k.indexOf(r);t!==-1&&(k[t]=k[k.length-1],k.pop())}};function Ri(r){for(var t=0;t<k.length;t++)try{k[t](r)}catch(e){console.error(e)}}typeof window<"u"&&(window.__ledgerLogsListen=Si);var Oi=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(n[s]=i[s])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),j=globalThis&&globalThis.__awaiter||function(r,t,e,n){function i(s){return s instanceof e?s:new e(function(a){a(s)})}return new(e||(e=Promise))(function(s,a){function u(l){try{o(n.next(l))}catch(h){a(h)}}function c(l){try{o(n.throw(l))}catch(h){a(h)}}function o(l){l.done?s(l.value):i(l.value).then(u,c)}o((n=n.apply(r,t||[])).next())})},V=globalThis&&globalThis.__generator||function(r,t){var e={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(o){return function(l){return c([o,l])}}function c(o){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,i&&(s=o[0]&2?i.return:o[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,o[1])).done)return s;switch(i=0,s&&(o=[o[0]&2,s.value]),o[0]){case 0:case 1:s=o;break;case 4:return e.label++,{value:o[1],done:!1};case 5:e.label++,i=o[1],o=[0];continue;case 7:o=e.ops.pop(),e.trys.pop();continue;default:if(s=e.trys,!(s=s.length>0&&s[s.length-1])&&(o[0]===6||o[0]===2)){e=0;continue}if(o[0]===3&&(!s||o[1]>s[0]&&o[1]<s[3])){e.label=o[1];break}if(o[0]===6&&e.label<s[1]){e.label=s[1],s=o;break}if(s&&e.label<s[2]){e.label=s[2],e.ops.push(o);break}s[2]&&e.ops.pop(),e.trys.pop();continue}o=t.call(r,e)}catch(l){o=[6,l],i=0}finally{n=s=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},Ni=globalThis&&globalThis.__read||function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),i,s=[],a;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(u){a={error:u}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return s},bi=[{vendorId:Oe}],Ai=function(){return Promise.resolve(!!(window.navigator&&window.navigator.hid))},ye=function(){var r=navigator.hid;if(!r)throw new z("navigator.hid is not supported","HIDNotSupported");return r};function Xt(){return j(this,void 0,void 0,function(){var r;return V(this,function(t){switch(t.label){case 0:return[4,ye().requestDevice({filters:bi})];case 1:return r=t.sent(),Array.isArray(r)?[2,r]:[2,[r]]}})})}function je(){return j(this,void 0,void 0,function(){var r;return V(this,function(t){switch(t.label){case 0:return[4,ye().getDevices()];case 1:return r=t.sent(),[2,r.filter(function(e){return e.vendorId===Oe})]}})})}function _i(){return j(this,void 0,void 0,function(){var r,t;return V(this,function(e){switch(e.label){case 0:return[4,je()];case 1:return r=e.sent(),r.length>0?[2,r[0]]:[4,Xt()];case 2:return t=e.sent(),[2,t[0]]}})})}var xi=function(r){Oi(t,r);function t(e){var n=r.call(this)||this;return n.channel=Math.floor(Math.random()*65535),n.packetSize=64,n.inputs=[],n.read=function(){return n.inputs.length?Promise.resolve(n.inputs.shift()):new Promise(function(i){n.inputCallback=i})},n.onInputReport=function(i){var s=Buffer.from(i.data.buffer);n.inputCallback?(n.inputCallback(s),n.inputCallback=null):n.inputs.push(s)},n._disconnectEmitted=!1,n._emitDisconnect=function(i){n._disconnectEmitted||(n._disconnectEmitted=!0,n.emit("disconnect",i))},n.exchange=function(i){return j(n,void 0,void 0,function(){var s,a=this;return V(this,function(u){switch(u.label){case 0:return[4,this.exchangeAtomicImpl(function(){return j(a,void 0,void 0,function(){var c,o,l,h,I,p,x,b,R;return V(this,function(F){switch(F.label){case 0:c=this,o=c.channel,l=c.packetSize,me("apdu","=> "+i.toString("hex")),h=Ut(o,l),I=h.makeBlocks(i),p=0,F.label=1;case 1:return p<I.length?[4,this.device.sendReport(0,I[p])]:[3,4];case 2:F.sent(),F.label=3;case 3:return p++,[3,1];case 4:return(x=h.getReducedResult(b))?[3,6]:[4,this.read()];case 5:return R=F.sent(),b=h.reduceResponse(b,R),[3,4];case 6:return me("apdu","<= "+x.toString("hex")),[2,x]}})})}).catch(function(c){throw c&&c.message&&c.message.includes("write")?(a._emitDisconnect(c),new Ct(c.message)):c})];case 1:return s=u.sent(),[2,s]}})})},n.device=e,n.deviceModel=typeof e.productId=="number"?ge(e.productId):void 0,e.addEventListener("inputreport",n.onInputReport),n}return t.request=function(){return j(this,void 0,void 0,function(){var e,n;return V(this,function(i){switch(i.label){case 0:return[4,Xt()];case 1:return e=Ni.apply(void 0,[i.sent(),1]),n=e[0],[2,t.open(n)]}})})},t.openConnected=function(){return j(this,void 0,void 0,function(){var e;return V(this,function(n){switch(n.label){case 0:return[4,je()];case 1:return e=n.sent(),e.length===0?[2,null]:[2,t.open(e[0])]}})})},t.open=function(e){return j(this,void 0,void 0,function(){var n,i;return V(this,function(s){switch(s.label){case 0:return[4,e.open()];case 1:return s.sent(),n=new t(e),i=function(a){e===a.device&&(ye().removeEventListener("disconnect",i),n._emitDisconnect(new Dt))},ye().addEventListener("disconnect",i),[2,n]}})})},t.prototype.close=function(){return j(this,void 0,void 0,function(){return V(this,function(e){switch(e.label){case 0:return[4,this.exchangeBusyPromise];case 1:return e.sent(),this.device.removeEventListener("inputreport",this.onInputReport),[4,this.device.close()];case 2:return e.sent(),[2]}})})},t.prototype.setScrambleKey=function(){},t.isSupported=Ai,t.list=je,t.listen=function(e){var n=!1;_i().then(function(s){if(!s)e.error(new Be("Access denied to use Ledger device"));else if(!n){var a=typeof s.productId=="number"?ge(s.productId):void 0;e.next({type:"add",descriptor:s,deviceModel:a}),e.complete()}},function(s){e.error(new Be(s.message))});function i(){n=!0}return{unsubscribe:i}},t}(Pt),We=globalThis&&globalThis.__awaiter||function(r,t,e,n){function i(s){return s instanceof e?s:new e(function(a){a(s)})}return new(e||(e=Promise))(function(s,a){function u(l){try{o(n.next(l))}catch(h){a(h)}}function c(l){try{o(n.throw(l))}catch(h){a(h)}}function o(l){l.done?s(l.value):i(l.value).then(u,c)}o((n=n.apply(r,t||[])).next())})},Ze=globalThis&&globalThis.__generator||function(r,t){var e={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(o){return function(l){return c([o,l])}}function c(o){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,i&&(s=o[0]&2?i.return:o[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,o[1])).done)return s;switch(i=0,s&&(o=[o[0]&2,s.value]),o[0]){case 0:case 1:s=o;break;case 4:return e.label++,{value:o[1],done:!1};case 5:e.label++,i=o[1],o=[0];continue;case 7:o=e.ops.pop(),e.trys.pop();continue;default:if(s=e.trys,!(s=s.length>0&&s[s.length-1])&&(o[0]===6||o[0]===2)){e=0;continue}if(o[0]===3&&(!s||o[1]>s[0]&&o[1]<s[3])){e.label=o[1];break}if(o[0]===6&&e.label<s[1]){e.label=s[1],s=o;break}if(s&&e.label<s[2]){e.label=s[2],e.ops.push(o);break}s[2]&&e.ops.pop(),e.trys.pop();continue}o=t.call(r,e)}catch(l){o=[6,l],i=0}finally{n=s=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},Li=[{vendorId:Oe}];function kt(){return We(this,void 0,void 0,function(){var r;return Ze(this,function(t){switch(t.label){case 0:return[4,navigator.usb.requestDevice({filters:Li})];case 1:return r=t.sent(),[2,r]}})})}function Ve(){return We(this,void 0,void 0,function(){var r;return Ze(this,function(t){switch(t.label){case 0:return[4,navigator.usb.getDevices()];case 1:return r=t.sent(),[2,r.filter(function(e){return e.vendorId===Oe})]}})})}function Di(){return We(this,void 0,void 0,function(){var r;return Ze(this,function(t){switch(t.label){case 0:return[4,Ve()];case 1:return r=t.sent(),r.length>0?[2,r[0]]:[2,kt()]}})})}var Ci=function(){return Promise.resolve(!!navigator&&!!navigator.usb&&typeof navigator.usb.getDevices=="function")},Pi=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(n[s]=i[s])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),H=globalThis&&globalThis.__awaiter||function(r,t,e,n){function i(s){return s instanceof e?s:new e(function(a){a(s)})}return new(e||(e=Promise))(function(s,a){function u(l){try{o(n.next(l))}catch(h){a(h)}}function c(l){try{o(n.throw(l))}catch(h){a(h)}}function o(l){l.done?s(l.value):i(l.value).then(u,c)}o((n=n.apply(r,t||[])).next())})},K=globalThis&&globalThis.__generator||function(r,t){var e={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(o){return function(l){return c([o,l])}}function c(o){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,i&&(s=o[0]&2?i.return:o[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,o[1])).done)return s;switch(i=0,s&&(o=[o[0]&2,s.value]),o[0]){case 0:case 1:s=o;break;case 4:return e.label++,{value:o[1],done:!1};case 5:e.label++,i=o[1],o=[0];continue;case 7:o=e.ops.pop(),e.trys.pop();continue;default:if(s=e.trys,!(s=s.length>0&&s[s.length-1])&&(o[0]===6||o[0]===2)){e=0;continue}if(o[0]===3&&(!s||o[1]>s[0]&&o[1]<s[3])){e.label=o[1];break}if(o[0]===6&&e.label<s[1]){e.label=s[1],s=o;break}if(s&&e.label<s[2]){e.label=s[2],e.ops.push(o);break}s[2]&&e.ops.pop(),e.trys.pop();continue}o=t.call(r,e)}catch(l){o=[6,l],i=0}finally{n=s=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},Ui=1,_t=3,Bi=function(r){Pi(t,r);function t(e,n){var i=r.call(this)||this;return i.channel=Math.floor(Math.random()*65535),i.packetSize=64,i._disconnectEmitted=!1,i._emitDisconnect=function(s){i._disconnectEmitted||(i._disconnectEmitted=!0,i.emit("disconnect",s))},i.device=e,i.interfaceNumber=n,i.deviceModel=ge(e.productId),i}return t.request=function(){return H(this,void 0,void 0,function(){var e;return K(this,function(n){switch(n.label){case 0:return[4,kt()];case 1:return e=n.sent(),[2,t.open(e)]}})})},t.openConnected=function(){return H(this,void 0,void 0,function(){var e;return K(this,function(n){switch(n.label){case 0:return[4,Ve()];case 1:return e=n.sent(),e.length===0?[2,null]:[2,t.open(e[0])]}})})},t.open=function(e){return H(this,void 0,void 0,function(){var n,i,s,a,u;return K(this,function(c){switch(c.label){case 0:return[4,e.open()];case 1:return c.sent(),e.configuration!==null?[3,3]:[4,e.selectConfiguration(Ui)];case 2:c.sent(),c.label=3;case 3:return[4,xt(e)];case 4:if(c.sent(),n=e.configurations[0].interfaces.find(function(o){var l=o.alternates;return l.some(function(h){return h.interfaceClass===255})}),!n)throw new Je("No WebUSB interface found for your Ledger device. Please upgrade firmware or contact techsupport.");i=n.interfaceNumber,c.label=5;case 5:return c.trys.push([5,7,,9]),[4,e.claimInterface(i)];case 6:return c.sent(),[3,9];case 7:return s=c.sent(),[4,e.close()];case 8:throw c.sent(),new Je(s.message);case 9:return a=new t(e,i),u=function(o){e===o.device&&(navigator.usb.removeEventListener("disconnect",u),a._emitDisconnect(new Dt))},navigator.usb.addEventListener("disconnect",u),[2,a]}})})},t.prototype.close=function(){return H(this,void 0,void 0,function(){return K(this,function(e){switch(e.label){case 0:return[4,this.exchangeBusyPromise];case 1:return e.sent(),[4,this.device.releaseInterface(this.interfaceNumber)];case 2:return e.sent(),[4,xt(this.device)];case 3:return e.sent(),[4,this.device.close()];case 4:return e.sent(),[2]}})})},t.prototype.exchange=function(e){return H(this,void 0,void 0,function(){var n,i=this;return K(this,function(s){switch(s.label){case 0:return[4,this.exchangeAtomicImpl(function(){return H(i,void 0,void 0,function(){var a,u,c,o,l,h,I,p,x,b;return K(this,function(R){switch(R.label){case 0:a=this,u=a.channel,c=a.packetSize,me("apdu","=> "+e.toString("hex")),o=Ut(u,c),l=o.makeBlocks(e),h=0,R.label=1;case 1:return h<l.length?[4,this.device.transferOut(_t,l[h])]:[3,4];case 2:R.sent(),R.label=3;case 3:return h++,[3,1];case 4:return(I=o.getReducedResult(p))?[3,6]:[4,this.device.transferIn(_t,c)];case 5:return x=R.sent(),b=Buffer.from(x.data.buffer),p=o.reduceResponse(p,b),[3,4];case 6:return me("apdu","<= "+I.toString("hex")),[2,I]}})})}).catch(function(a){throw a&&a.message&&a.message.includes("disconnected")?(i._emitDisconnect(a),new Ct(a.message)):a})];case 1:return n=s.sent(),[2,n]}})})},t.prototype.setScrambleKey=function(){},t.isSupported=Ci,t.list=Ve,t.listen=function(e){var n=!1;Di().then(function(s){if(!n){var a=ge(s.productId);e.next({type:"add",descriptor:s,deviceModel:a}),e.complete()}},function(s){window.DOMException&&s instanceof window.DOMException&&s.code===18?e.error(new pr(s.message)):e.error(new Be(s.message))});function i(){n=!0}return{unsubscribe:i}},t}(Pt);function xt(r){return H(this,void 0,void 0,function(){var t;return K(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,r.reset()];case 1:return e.sent(),[3,3];case 2:return t=e.sent(),console.warn(t),[3,3];case 3:return[2]}})})}const Fi=async()=>{try{return await Bi.create()}catch(r){return console.log(r),await xi.create()}},Gi=async(r,t)=>{const{create_toolkit:e}=await rr(()=>import("./taquito-249c6cca.js"),["assets/taquito-249c6cca.js","assets/taquito.es6-f55643bf.js","assets/main-34b72f39.js","assets/index-b9d33df4.css","assets/DAppClient-0e874b97.js"]),{tezos:n,forger:i}=await e(t.rpc),s=new ur(r,t.derivationPath,void 0,t.derivationType);n.setSignerProvider(s);const a=await n.signer.publicKeyHash(),u=a?await n.rpc.getManagerKey(a):void 0;return{account:a,tezos:n,forger:i,managerKey:u==null?void 0:u.toString()}},{request_ledger_setup:Mi}=ar();class zt extends cr{constructor(t,e,n,i,s){super(t,n,i,s),this.transport=e}get AccountType(){return nr.Ledger}get Icon(){return new sr("/assets/svg/ledger-wallet-icon.svg",ir.raw)}get IsAccountSwitchSupported(){return!1}static async create(t,e,n){const i=or[e];if(!i)throw new Error("Invalid network specification!");const{account:s,tezos:a,forger:u,managerKey:c}=await Gi(t,{...n,rpc:(n==null?void 0:n.rpc)??i.rpc});return new zt(s??"",t,a,u,{networkId:e,managerKey:c})}static async create_transport(){return Fi()}static async create_from_cache(){}logout(){this.transport.close()}async switch_wallet(){const t=await Mi({networkId:this.NetworkId,rpc:this.Tezos.rpc.getRpcUrl()});if(!t)throw new Error("Aborted.");return t}async vote(t){const e=await this.forge_ballot_op(t),n=async()=>{const i=this.Tezos.wallet.context,s=await this.Tezos.signer.sign(e,new Uint8Array([3])),a=await this.Tezos.rpc.injectOperation(s.sbytes);return i.operationFactory.createOperation(a)};return new oe(n,"Vote",{account:this.Account,ballot:t})}async propose(t){const e=await this.forge_proposals_op(t),n=async()=>{const i=this.Tezos.wallet.context,s=await this.Tezos.signer.sign(e,new Uint8Array([3])),a=await this.Tezos.rpc.injectOperation(s.sbytes);return i.operationFactory.createOperation(a)};return new oe(n,"Propose",{account:this.Account,proposals:t})}async set_deposits_limit(t){const e=await this.forge_set_deposit_op(t),n=async()=>{const i=this.Tezos.wallet.context,s=await this.Tezos.signer.sign(e,new Uint8Array([3])),a=await this.Tezos.rpc.injectOperation(s.sbytes);return i.operationFactory.createOperation(a)};return new oe(n,"Propose",{account:this.Account,limit:t.toString()})}async update_consensus_key(t){const e=await this.forge_update_consensus_key_op(t),n=async()=>{const i=this.Tezos.wallet.context,s=await this.Tezos.signer.sign(e,new Uint8Array([3])),a=await this.Tezos.rpc.injectOperation(s.sbytes);return i.operationFactory.createOperation(a)};return new oe(n,"Propose",{account:this.Account,"Consensus Key":t})}}export{zt as LedgerSession};
