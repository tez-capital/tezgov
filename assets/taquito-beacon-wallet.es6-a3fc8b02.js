import{D as y,P as v}from"./DAppClient-e2aae175.js";import{d as p,e as g,f as w}from"./taquito.es6-14c09632.js";import"./main-0e7f43b8.js";import"./taquito-utils.es6-2790dd94.js";import"./_commonjsHelpers-6dff16f2.js";import"./index-9aada285.js";let n;const P=(s,e)=>(n&&e&&(n.disconnect(),n=void 0),n||(n||(n=new y(s)),n));function r(s,e,t,i){function a(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function h(o){try{d(i.next(o))}catch(u){l(u)}}function m(o){try{d(i.throw(o))}catch(u){l(u)}}function d(o){o.done?c(o.value):a(o.value).then(h,m)}d((i=i.apply(s,e||[])).next())})}const R={commitHash:"ebe5353579be0da07c664f4b294516acdc429f6e",version:"15.0.0"};class f extends Error{constructor(){super("You need to initialize BeaconWallet by calling beaconWallet.requestPermissions first"),this.name="BeaconWalletNotInitialized"}}class S extends Error{constructor(e){super(`Required permissions scopes were not granted: ${e.join(",")}`),this.requiredScopes=e,this.name="MissingRequiredScopes"}}class W{constructor(e){this.client=P(e)}validateRequiredScopesOrFail(e,t){const i=new Set(t);for(const a of e)i.has(a)&&i.delete(a);if(i.size>0)throw new S(Array.from(i))}requestPermissions(e){return r(this,void 0,void 0,function*(){yield this.client.requestPermissions(e)})}getPKH(){return r(this,void 0,void 0,function*(){const e=yield this.client.getActiveAccount();if(!e)throw new f;return e.address})}mapTransferParamsToWalletParams(e){return r(this,void 0,void 0,function*(){let t;yield this.client.showPrepare();try{t=yield e()}catch(i){throw yield this.client.hideUI(),i}return this.removeDefaultParams(t,yield p(this.formatParameters(t)))})}mapOriginateParamsToWalletParams(e){return r(this,void 0,void 0,function*(){let t;yield this.client.showPrepare();try{t=yield e()}catch(i){throw yield this.client.hideUI(),i}return this.removeDefaultParams(t,yield g(this.formatParameters(t)))})}mapDelegateParamsToWalletParams(e){return r(this,void 0,void 0,function*(){let t;yield this.client.showPrepare();try{t=yield e()}catch(i){throw yield this.client.hideUI(),i}return this.removeDefaultParams(t,yield w(this.formatParameters(t)))})}formatParameters(e){return e.fee&&(e.fee=e.fee.toString()),e.storageLimit&&(e.storageLimit=e.storageLimit.toString()),e.gasLimit&&(e.gasLimit=e.gasLimit.toString()),e}removeDefaultParams(e,t){return e.fee||delete t.fee,e.storageLimit||delete t.storage_limit,e.gasLimit||delete t.gas_limit,t}sendOperations(e){return r(this,void 0,void 0,function*(){const t=yield this.client.getActiveAccount();if(!t)throw new f;const i=t.scopes;this.validateRequiredScopesOrFail(i,[v.OPERATION_REQUEST]);const{transactionHash:a}=yield this.client.requestOperation({operationDetails:e});return a})}disconnect(){return r(this,void 0,void 0,function*(){yield this.client.destroy()})}clearActiveAccount(){return r(this,void 0,void 0,function*(){yield this.client.setActiveAccount()})}}export{W as BeaconWallet,f as BeaconWalletNotInitialized,S as MissingRequiredScopes,R as VERSION};
