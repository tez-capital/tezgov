var Jt=Object.defineProperty;var er=(r,t,e)=>t in r?Jt(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var Ke=(r,t,e)=>(er(r,typeof t!="symbol"?t+"":t,e),e);import{_ as tr,E as rr,x as nr,y as sr,z as ir,O as Ze,Q as ar}from"./main.fcc73858.js";import{S as or}from"./SessionBase.0da79371.js";import{f as cr}from"./index.558d09ea.js";import{L as ur}from"./LedgerDialog.56643201.js";import"./taquito-utils.es6.9e1a8ea2.js";import"./DAppClient.ffc3f8ec.js";import"./rules.191cbc32.js";var lr=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(n[s]=i[s])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();globalThis&&globalThis.__values;var f=function(r){var t=function(e){lr(n,e);function n(i,s,a){var u=e.call(this,i||r,a)||this;if(Object.setPrototypeOf(u,n.prototype),u.name=r,s)for(var c in s)u[c]=s[c];if(fr(a)&&"cause"in a&&!("cause"in u)){var o=a.cause;u.cause=o,"stack"in o&&(u.stack=u.stack+`
CAUSE: `+o.stack)}return u}return n}(Error);return t};function fr(r){return r!==null&&typeof r=="object"}var hr=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(n[s]=i[s])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();f("AccountNameRequired");f("AccountNotSupported");f("AmountRequired");f("BluetoothRequired");f("BtcUnmatchedApp");f("CantOpenDevice");f("CashAddrNotSupported");f("CurrencyNotSupported");f("DeviceAppVerifyNotSupported");f("DeviceGenuineSocketEarlyClose");f("DeviceNotGenuine");f("DeviceOnDashboardExpected");f("DeviceOnDashboardUnexpected");f("DeviceInOSUExpected");f("DeviceHalted");f("DeviceNameInvalid");f("DeviceSocketFail");f("DeviceSocketNoBulkStatus");var _t=f("DisconnectedDevice"),xt=f("DisconnectedDeviceDuringOperation");f("DeviceExtractOnboardingStateError");f("DeviceOnboardingStatePollingError");f("EnpointConfig");f("EthAppPleaseEnableContractData");f("FeeEstimationFailed");f("FirmwareNotRecognized");f("HardResetFail");f("InvalidXRPTag");f("InvalidAddress");f("InvalidAddressBecauseDestinationIsAlsoSource");f("LatestMCUInstalledError");f("UnknownMCU");f("LedgerAPIError");f("LedgerAPIErrorWithMessage");f("LedgerAPINotAvailable");f("ManagerAppAlreadyInstalled");f("ManagerAppRelyOnBTC");f("ManagerAppDepInstallRequired");f("ManagerAppDepUninstallRequired");f("ManagerDeviceLocked");f("ManagerFirmwareNotEnoughSpace");f("ManagerNotEnoughSpace");f("ManagerUninstallBTCDep");f("NetworkDown");f("NoAddressesFound");f("NotEnoughBalance");f("NotEnoughBalanceToDelegate");f("NotEnoughBalanceInParentAccount");f("NotEnoughSpendableBalance");f("NotEnoughBalanceBecauseDestinationNotCreated");f("NoAccessToCamera");f("NotEnoughGas");f("NotSupportedLegacyAddress");f("GasLessThanEstimate");f("PasswordsDontMatch");f("PasswordIncorrect");f("RecommendSubAccountsToEmpty");f("RecommendUndelegation");f("TimeoutTagged");f("UnexpectedBootloader");f("MCUNotGenuineToDashboard");f("RecipientRequired");f("UnavailableTezosOriginatedAccountReceive");f("UnavailableTezosOriginatedAccountSend");f("UpdateFetchFileFail");f("UpdateIncorrectHash");f("UpdateIncorrectSig");f("UpdateYourApp");f("UserRefusedDeviceNameChange");f("UserRefusedAddress");f("UserRefusedFirmwareUpdate");f("UserRefusedAllowManager");f("UserRefusedOnDevice");var Pe=f("TransportOpenUserCancelled"),Qe=f("TransportInterfaceNotAvailable"),pr=f("TransportRaceCondition"),dr=f("TransportWebUSBGestureRequired");f("DeviceShouldStayInApp");f("WebsocketConnectionError");f("WebsocketConnectionFailed");f("WrongDeviceForAccount");f("WrongAppForCurrency");f("ETHAddressNonEIP");f("CantScanQRCode");f("FeeNotLoaded");f("FeeRequired");f("FeeTooHigh");f("PendingOperation");f("SyncError");f("PairingFailed");f("GenuineCheckFailed");f("LedgerAPI4xx");f("LedgerAPI5xx");f("FirmwareOrAppUpdateRequired");f("LanguageNotFound");f("NoDBPathGiven");f("DBWrongPassword");f("DBNotReset");var V=function(r){hr(t,r);function t(e,n){var i=this,s="TransportError";return i=r.call(this,e||s)||this,i.name=s,i.message=e,i.stack=new Error().stack,i.id=n,i}return t}(Error),Ue={PIN_REMAINING_ATTEMPTS:25536,INCORRECT_LENGTH:26368,MISSING_CRITICAL_PARAMETER:26624,COMMAND_INCOMPATIBLE_FILE_STRUCTURE:27009,SECURITY_STATUS_NOT_SATISFIED:27010,CONDITIONS_OF_USE_NOT_SATISFIED:27013,INCORRECT_DATA:27264,NOT_ENOUGH_MEMORY_SPACE:27268,REFERENCED_DATA_NOT_FOUND:27272,FILE_ALREADY_EXISTS:27273,INCORRECT_P1_P2:27392,INS_NOT_SUPPORTED:27904,CLA_NOT_SUPPORTED:28160,TECHNICAL_PROBLEM:28416,OK:36864,MEMORY_PROBLEM:37440,NO_EF_SELECTED:37888,INVALID_OFFSET:37890,FILE_NOT_FOUND:37892,INCONSISTENT_FILE:37896,ALGORITHM_NOT_SUPPORTED:38020,INVALID_KCV:38021,CODE_NOT_INITIALIZED:38914,ACCESS_CONDITION_NOT_FULFILLED:38916,CONTRADICTION_SECRET_CODE_STATUS:38920,CONTRADICTION_INVALIDATION:38928,CODE_BLOCKED:38976,MAX_VALUE_REACHED:38992,GP_AUTH_FAILED:25344,LICENSING:28482,HALTED:28586};function vr(r){switch(r){case 26368:return"Incorrect length";case 26624:return"Missing critical parameter";case 27010:return"Security not satisfied (dongle locked or have invalid access rights)";case 27013:return"Condition of use not satisfied (denied by the user?)";case 27264:return"Invalid data received";case 27392:return"Invalid parameter received"}if(28416<=r&&r<=28671)return"Internal error, please report"}function Lt(r){this.name="TransportStatusError";var t=Object.keys(Ue).find(function(i){return Ue[i]===r})||"UNKNOWN_ERROR",e=vr(r)||t,n=r.toString(16);this.message="Ledger device: ".concat(e," (0x").concat(n,")"),this.stack=new Error().stack,this.statusCode=r,this.statusText=t}Lt.prototype=new Error;var we=globalThis&&globalThis.__awaiter||function(r,t,e,n){function i(s){return s instanceof e?s:new e(function(a){a(s)})}return new(e||(e=Promise))(function(s,a){function u(l){try{o(n.next(l))}catch(h){a(h)}}function c(l){try{o(n.throw(l))}catch(h){a(h)}}function o(l){l.done?s(l.value):i(l.value).then(u,c)}o((n=n.apply(r,t||[])).next())})},Se=globalThis&&globalThis.__generator||function(r,t){var e={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(o){return function(l){return c([o,l])}}function c(o){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,i&&(s=o[0]&2?i.return:o[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,o[1])).done)return s;switch(i=0,s&&(o=[o[0]&2,s.value]),o[0]){case 0:case 1:s=o;break;case 4:return e.label++,{value:o[1],done:!1};case 5:e.label++,i=o[1],o=[0];continue;case 7:o=e.ops.pop(),e.trys.pop();continue;default:if(s=e.trys,!(s=s.length>0&&s[s.length-1])&&(o[0]===6||o[0]===2)){e=0;continue}if(o[0]===3&&(!s||o[1]>s[0]&&o[1]<s[3])){e.label=o[1];break}if(o[0]===6&&e.label<s[1]){e.label=s[1],s=o;break}if(s&&e.label<s[2]){e.label=s[2],e.ops.push(o);break}s[2]&&e.ops.pop(),e.trys.pop();continue}o=t.call(r,e)}catch(l){o=[6,l],i=0}finally{n=s=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},gr=globalThis&&globalThis.__read||function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),i,s=[],a;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(u){a={error:u}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return s},Er=globalThis&&globalThis.__spreadArray||function(r,t,e){if(e||arguments.length===2)for(var n=0,i=t.length,s;n<i;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return r.concat(s||Array.prototype.slice.call(t))},mr=globalThis&&globalThis.__values||function(r){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&r[t],n=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Dt=function(){function r(){var t=this;this.exchangeTimeout=3e4,this.unresponsiveTimeout=15e3,this.deviceModel=null,this._events=new cr.exports,this.send=function(e,n,i,s,a,u){return a===void 0&&(a=Buffer.alloc(0)),u===void 0&&(u=[Ue.OK]),we(t,void 0,void 0,function(){var c,o;return Se(this,function(l){switch(l.label){case 0:if(a.length>=256)throw new V("data.length exceed 256 bytes limit. Got: "+a.length,"DataLengthTooBig");return[4,this.exchange(Buffer.concat([Buffer.from([e,n,i,s]),Buffer.from([a.length]),a]))];case 1:if(c=l.sent(),o=c.readUInt16BE(c.length-2),!u.some(function(h){return h===o}))throw new Lt(o);return[2,c]}})})},this.exchangeAtomicImpl=function(e){return we(t,void 0,void 0,function(){var n,i,s,a,u,c=this;return Se(this,function(o){switch(o.label){case 0:if(this.exchangeBusyPromise)throw new pr("An action was already pending on the Ledger device. Please deny or reconnect.");i=new Promise(function(l){n=l}),this.exchangeBusyPromise=i,s=!1,a=setTimeout(function(){s=!0,c.emit("unresponsive")},this.unresponsiveTimeout),o.label=1;case 1:return o.trys.push([1,,3,4]),[4,e()];case 2:return u=o.sent(),s&&this.emit("responsive"),[2,u];case 3:return clearTimeout(a),n&&n(),this.exchangeBusyPromise=null,[7];case 4:return[2]}})})},this._appAPIlock=null}return r.prototype.exchange=function(t){throw new Error("exchange not implemented")},r.prototype.setScrambleKey=function(t){},r.prototype.close=function(){return Promise.resolve()},r.prototype.on=function(t,e){this._events.on(t,e)},r.prototype.off=function(t,e){this._events.removeListener(t,e)},r.prototype.emit=function(t){for(var e,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];(e=this._events).emit.apply(e,Er([t],gr(n),!1))},r.prototype.setDebugMode=function(){console.warn("setDebugMode is deprecated. use @ledgerhq/logs instead. No logs are emitted in this anymore.")},r.prototype.setExchangeTimeout=function(t){this.exchangeTimeout=t},r.prototype.setExchangeUnresponsiveTimeout=function(t){this.unresponsiveTimeout=t},r.create=function(t,e){var n=this;return t===void 0&&(t=3e3),new Promise(function(i,s){var a=!1,u=n.listen({next:function(o){a=!0,u&&u.unsubscribe(),c&&clearTimeout(c),n.open(o.descriptor,t).then(i,s)},error:function(o){c&&clearTimeout(c),s(o)},complete:function(){c&&clearTimeout(c),a||s(new V(n.ErrorMessage_NoDeviceFound,"NoDeviceFound"))}}),c=e?setTimeout(function(){u.unsubscribe(),s(new V(n.ErrorMessage_ListenTimeout,"ListenTimeout"))},e):null})},r.prototype.decorateAppAPIMethods=function(t,e,n){var i,s;try{for(var a=mr(e),u=a.next();!u.done;u=a.next()){var c=u.value;t[c]=this.decorateAppAPIMethod(c,t[c],t,n)}}catch(o){i={error:o}}finally{try{u&&!u.done&&(s=a.return)&&s.call(a)}finally{if(i)throw i.error}}},r.prototype.decorateAppAPIMethod=function(t,e,n,i){var s=this;return function(){for(var a=[],u=0;u<arguments.length;u++)a[u]=arguments[u];return we(s,void 0,void 0,function(){var c;return Se(this,function(o){switch(o.label){case 0:if(c=this._appAPIlock,c)return[2,Promise.reject(new V("Ledger Device is busy (lock "+c+")","TransportLocked"))];o.label=1;case 1:return o.trys.push([1,,3,4]),this._appAPIlock=t,this.setScrambleKey(i),[4,e.apply(n,a)];case 2:return[2,o.sent()];case 3:return this._appAPIlock=null,[7];case 4:return[2]}})})}},r.ErrorMessage_ListenTimeout="No Ledger device found (timeout)",r.ErrorMessage_NoDeviceFound="No Ledger device found",r}(),Je=5;function yr(r){var t=Buffer.alloc(2);return t.writeUInt16BE(r,0),t}var Ir={data:Buffer.alloc(0),dataLength:0,sequence:0},Ct=function(r,t){return{makeBlocks:function(e){var n=Buffer.concat([yr(e.length),e]),i=t-5,s=Math.ceil(n.length/i);n=Buffer.concat([n,Buffer.alloc(s*i-n.length+1).fill(0)]);for(var a=[],u=0;u<s;u++){var c=Buffer.alloc(5);c.writeUInt16BE(r,0),c.writeUInt8(Je,2),c.writeUInt16BE(u,3);var o=n.slice(u*i,(u+1)*i);a.push(Buffer.concat([c,o]))}return a},reduceResponse:function(e,n){var i=e||Ir,s=i.data,a=i.dataLength,u=i.sequence;if(n.readUInt16BE(0)!==r)throw new V("Invalid channel","InvalidChannel");if(n.readUInt8(2)!==Je)throw new V("Invalid tag","InvalidTag");if(n.readUInt16BE(3)!==u)throw new V("Invalid sequence","InvalidSequence");e||(a=n.readUInt16BE(5)),u++;var c=n.slice(e?5:7);return s=Buffer.concat([s,c]),s.length>a&&(s=s.slice(0,a)),{data:s,dataLength:a,sequence:u}},getReducedResult:function(e){if(e&&e.dataLength===e.data.length)return e.data}}},q={exports:{}};const $r="2.0.0",Tr=256,wr=Number.MAX_SAFE_INTEGER||9007199254740991,Sr=16;var ge={SEMVER_SPEC_VERSION:$r,MAX_LENGTH:Tr,MAX_SAFE_INTEGER:wr,MAX_SAFE_COMPONENT_LENGTH:Sr};const Rr=typeof process=="object"&&{}&&{}.NODE_DEBUG&&/\bsemver\b/i.test({}.NODE_DEBUG)?(...r)=>console.error("SEMVER",...r):()=>{};var Ee=Rr;(function(r,t){const{MAX_SAFE_COMPONENT_LENGTH:e}=ge,n=Ee;t=r.exports={};const i=t.re=[],s=t.src=[],a=t.t={};let u=0;const c=(o,l,h)=>{const I=u++;n(o,I,l),a[o]=I,s[I]=l,i[I]=new RegExp(l,h?"g":void 0)};c("NUMERICIDENTIFIER","0|[1-9]\\d*"),c("NUMERICIDENTIFIERLOOSE","[0-9]+"),c("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),c("MAINVERSION",`(${s[a.NUMERICIDENTIFIER]})\\.(${s[a.NUMERICIDENTIFIER]})\\.(${s[a.NUMERICIDENTIFIER]})`),c("MAINVERSIONLOOSE",`(${s[a.NUMERICIDENTIFIERLOOSE]})\\.(${s[a.NUMERICIDENTIFIERLOOSE]})\\.(${s[a.NUMERICIDENTIFIERLOOSE]})`),c("PRERELEASEIDENTIFIER",`(?:${s[a.NUMERICIDENTIFIER]}|${s[a.NONNUMERICIDENTIFIER]})`),c("PRERELEASEIDENTIFIERLOOSE",`(?:${s[a.NUMERICIDENTIFIERLOOSE]}|${s[a.NONNUMERICIDENTIFIER]})`),c("PRERELEASE",`(?:-(${s[a.PRERELEASEIDENTIFIER]}(?:\\.${s[a.PRERELEASEIDENTIFIER]})*))`),c("PRERELEASELOOSE",`(?:-?(${s[a.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${s[a.PRERELEASEIDENTIFIERLOOSE]})*))`),c("BUILDIDENTIFIER","[0-9A-Za-z-]+"),c("BUILD",`(?:\\+(${s[a.BUILDIDENTIFIER]}(?:\\.${s[a.BUILDIDENTIFIER]})*))`),c("FULLPLAIN",`v?${s[a.MAINVERSION]}${s[a.PRERELEASE]}?${s[a.BUILD]}?`),c("FULL",`^${s[a.FULLPLAIN]}$`),c("LOOSEPLAIN",`[v=\\s]*${s[a.MAINVERSIONLOOSE]}${s[a.PRERELEASELOOSE]}?${s[a.BUILD]}?`),c("LOOSE",`^${s[a.LOOSEPLAIN]}$`),c("GTLT","((?:<|>)?=?)"),c("XRANGEIDENTIFIERLOOSE",`${s[a.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),c("XRANGEIDENTIFIER",`${s[a.NUMERICIDENTIFIER]}|x|X|\\*`),c("XRANGEPLAIN",`[v=\\s]*(${s[a.XRANGEIDENTIFIER]})(?:\\.(${s[a.XRANGEIDENTIFIER]})(?:\\.(${s[a.XRANGEIDENTIFIER]})(?:${s[a.PRERELEASE]})?${s[a.BUILD]}?)?)?`),c("XRANGEPLAINLOOSE",`[v=\\s]*(${s[a.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[a.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[a.XRANGEIDENTIFIERLOOSE]})(?:${s[a.PRERELEASELOOSE]})?${s[a.BUILD]}?)?)?`),c("XRANGE",`^${s[a.GTLT]}\\s*${s[a.XRANGEPLAIN]}$`),c("XRANGELOOSE",`^${s[a.GTLT]}\\s*${s[a.XRANGEPLAINLOOSE]}$`),c("COERCE",`(^|[^\\d])(\\d{1,${e}})(?:\\.(\\d{1,${e}}))?(?:\\.(\\d{1,${e}}))?(?:$|[^\\d])`),c("COERCERTL",s[a.COERCE],!0),c("LONETILDE","(?:~>?)"),c("TILDETRIM",`(\\s*)${s[a.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",c("TILDE",`^${s[a.LONETILDE]}${s[a.XRANGEPLAIN]}$`),c("TILDELOOSE",`^${s[a.LONETILDE]}${s[a.XRANGEPLAINLOOSE]}$`),c("LONECARET","(?:\\^)"),c("CARETTRIM",`(\\s*)${s[a.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",c("CARET",`^${s[a.LONECARET]}${s[a.XRANGEPLAIN]}$`),c("CARETLOOSE",`^${s[a.LONECARET]}${s[a.XRANGEPLAINLOOSE]}$`),c("COMPARATORLOOSE",`^${s[a.GTLT]}\\s*(${s[a.LOOSEPLAIN]})$|^$`),c("COMPARATOR",`^${s[a.GTLT]}\\s*(${s[a.FULLPLAIN]})$|^$`),c("COMPARATORTRIM",`(\\s*)${s[a.GTLT]}\\s*(${s[a.LOOSEPLAIN]}|${s[a.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",c("HYPHENRANGE",`^\\s*(${s[a.XRANGEPLAIN]})\\s+-\\s+(${s[a.XRANGEPLAIN]})\\s*$`),c("HYPHENRANGELOOSE",`^\\s*(${s[a.XRANGEPLAINLOOSE]})\\s+-\\s+(${s[a.XRANGEPLAINLOOSE]})\\s*$`),c("STAR","(<|>)?=?\\s*\\*"),c("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),c("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")})(q,q.exports);const Nr=["includePrerelease","loose","rtl"],br=r=>r?typeof r!="object"?{loose:!0}:Nr.filter(t=>r[t]).reduce((t,e)=>(t[e]=!0,t),{}):{};var me=br;const et=/^[0-9]+$/,Pt=(r,t)=>{const e=et.test(r),n=et.test(t);return e&&n&&(r=+r,t=+t),r===t?0:e&&!n?-1:n&&!e?1:r<t?-1:1},Or=(r,t)=>Pt(t,r);var Ut={compareIdentifiers:Pt,rcompareIdentifiers:Or};const ae=Ee,{MAX_LENGTH:tt,MAX_SAFE_INTEGER:oe}=ge,{re:rt,t:nt}=q.exports,Ar=me,{compareIdentifiers:Q}=Ut;class D{constructor(t,e){if(e=Ar(e),t instanceof D){if(t.loose===!!e.loose&&t.includePrerelease===!!e.includePrerelease)return t;t=t.version}else if(typeof t!="string")throw new TypeError(`Invalid Version: ${t}`);if(t.length>tt)throw new TypeError(`version is longer than ${tt} characters`);ae("SemVer",t,e),this.options=e,this.loose=!!e.loose,this.includePrerelease=!!e.includePrerelease;const n=t.trim().match(e.loose?rt[nt.LOOSE]:rt[nt.FULL]);if(!n)throw new TypeError(`Invalid Version: ${t}`);if(this.raw=t,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>oe||this.major<0)throw new TypeError("Invalid major version");if(this.minor>oe||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>oe||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(i=>{if(/^[0-9]+$/.test(i)){const s=+i;if(s>=0&&s<oe)return s}return i}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(ae("SemVer.compare",this.version,this.options,t),!(t instanceof D)){if(typeof t=="string"&&t===this.version)return 0;t=new D(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof D||(t=new D(t,this.options)),Q(this.major,t.major)||Q(this.minor,t.minor)||Q(this.patch,t.patch)}comparePre(t){if(t instanceof D||(t=new D(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let e=0;do{const n=this.prerelease[e],i=t.prerelease[e];if(ae("prerelease compare",e,n,i),n===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(n===void 0)return-1;if(n===i)continue;return Q(n,i)}while(++e)}compareBuild(t){t instanceof D||(t=new D(t,this.options));let e=0;do{const n=this.build[e],i=t.build[e];if(ae("prerelease compare",e,n,i),n===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(n===void 0)return-1;if(n===i)continue;return Q(n,i)}while(++e)}inc(t,e){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",e);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",e);break;case"prepatch":this.prerelease.length=0,this.inc("patch",e),this.inc("pre",e);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",e),this.inc("pre",e);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{let n=this.prerelease.length;for(;--n>=0;)typeof this.prerelease[n]=="number"&&(this.prerelease[n]++,n=-2);n===-1&&this.prerelease.push(0)}e&&(Q(this.prerelease[0],e)===0?isNaN(this.prerelease[1])&&(this.prerelease=[e,0]):this.prerelease=[e,0]);break;default:throw new Error(`invalid increment argument: ${t}`)}return this.format(),this.raw=this.version,this}}var _=D;const{MAX_LENGTH:_r}=ge,{re:st,t:it}=q.exports,at=_,xr=me,Lr=(r,t)=>{if(t=xr(t),r instanceof at)return r;if(typeof r!="string"||r.length>_r||!(t.loose?st[it.LOOSE]:st[it.FULL]).test(r))return null;try{return new at(r,t)}catch{return null}};var te=Lr;const Dr=te,Cr=(r,t)=>{const e=Dr(r,t);return e?e.version:null};var Pr=Cr;const Ur=te,Fr=(r,t)=>{const e=Ur(r.trim().replace(/^[=v]+/,""),t);return e?e.version:null};var Br=Fr;const ot=_,Gr=(r,t,e,n)=>{typeof e=="string"&&(n=e,e=void 0);try{return new ot(r instanceof ot?r.version:r,e).inc(t,n).version}catch{return null}};var Mr=Gr;const ct=_,jr=(r,t,e)=>new ct(r,e).compare(new ct(t,e));var P=jr;const Xr=P,kr=(r,t,e)=>Xr(r,t,e)===0;var je=kr;const ut=te,Vr=je,qr=(r,t)=>{if(Vr(r,t))return null;{const e=ut(r),n=ut(t),i=e.prerelease.length||n.prerelease.length,s=i?"pre":"",a=i?"prerelease":"";for(const u in e)if((u==="major"||u==="minor"||u==="patch")&&e[u]!==n[u])return s+u;return a}};var zr=qr;const Hr=_,Yr=(r,t)=>new Hr(r,t).major;var Wr=Yr;const Kr=_,Zr=(r,t)=>new Kr(r,t).minor;var Qr=Zr;const Jr=_,en=(r,t)=>new Jr(r,t).patch;var tn=en;const rn=te,nn=(r,t)=>{const e=rn(r,t);return e&&e.prerelease.length?e.prerelease:null};var sn=nn;const an=P,on=(r,t,e)=>an(t,r,e);var cn=on;const un=P,ln=(r,t)=>un(r,t,!0);var fn=ln;const lt=_,hn=(r,t,e)=>{const n=new lt(r,e),i=new lt(t,e);return n.compare(i)||n.compareBuild(i)};var Xe=hn;const pn=Xe,dn=(r,t)=>r.sort((e,n)=>pn(e,n,t));var vn=dn;const gn=Xe,En=(r,t)=>r.sort((e,n)=>gn(n,e,t));var mn=En;const yn=P,In=(r,t,e)=>yn(r,t,e)>0;var ye=In;const $n=P,Tn=(r,t,e)=>$n(r,t,e)<0;var ke=Tn;const wn=P,Sn=(r,t,e)=>wn(r,t,e)!==0;var Ft=Sn;const Rn=P,Nn=(r,t,e)=>Rn(r,t,e)>=0;var Ve=Nn;const bn=P,On=(r,t,e)=>bn(r,t,e)<=0;var qe=On;const An=je,_n=Ft,xn=ye,Ln=Ve,Dn=ke,Cn=qe,Pn=(r,t,e,n)=>{switch(t){case"===":return typeof r=="object"&&(r=r.version),typeof e=="object"&&(e=e.version),r===e;case"!==":return typeof r=="object"&&(r=r.version),typeof e=="object"&&(e=e.version),r!==e;case"":case"=":case"==":return An(r,e,n);case"!=":return _n(r,e,n);case">":return xn(r,e,n);case">=":return Ln(r,e,n);case"<":return Dn(r,e,n);case"<=":return Cn(r,e,n);default:throw new TypeError(`Invalid operator: ${t}`)}};var Bt=Pn;const Un=_,Fn=te,{re:ce,t:ue}=q.exports,Bn=(r,t)=>{if(r instanceof Un)return r;if(typeof r=="number"&&(r=String(r)),typeof r!="string")return null;t=t||{};let e=null;if(!t.rtl)e=r.match(ce[ue.COERCE]);else{let n;for(;(n=ce[ue.COERCERTL].exec(r))&&(!e||e.index+e[0].length!==r.length);)(!e||n.index+n[0].length!==e.index+e[0].length)&&(e=n),ce[ue.COERCERTL].lastIndex=n.index+n[1].length+n[2].length;ce[ue.COERCERTL].lastIndex=-1}return e===null?null:Fn(`${e[2]}.${e[3]||"0"}.${e[4]||"0"}`,t)};var Gn=Bn,Re,ft;function Mn(){return ft||(ft=1,Re=function(r){r.prototype[Symbol.iterator]=function*(){for(let t=this.head;t;t=t.next)yield t.value}}),Re}var jn=w;w.Node=Z;w.create=w;function w(r){var t=this;if(t instanceof w||(t=new w),t.tail=null,t.head=null,t.length=0,r&&typeof r.forEach=="function")r.forEach(function(i){t.push(i)});else if(arguments.length>0)for(var e=0,n=arguments.length;e<n;e++)t.push(arguments[e]);return t}w.prototype.removeNode=function(r){if(r.list!==this)throw new Error("removing node which does not belong to this list");var t=r.next,e=r.prev;return t&&(t.prev=e),e&&(e.next=t),r===this.head&&(this.head=t),r===this.tail&&(this.tail=e),r.list.length--,r.next=null,r.prev=null,r.list=null,t};w.prototype.unshiftNode=function(r){if(r!==this.head){r.list&&r.list.removeNode(r);var t=this.head;r.list=this,r.next=t,t&&(t.prev=r),this.head=r,this.tail||(this.tail=r),this.length++}};w.prototype.pushNode=function(r){if(r!==this.tail){r.list&&r.list.removeNode(r);var t=this.tail;r.list=this,r.prev=t,t&&(t.next=r),this.tail=r,this.head||(this.head=r),this.length++}};w.prototype.push=function(){for(var r=0,t=arguments.length;r<t;r++)kn(this,arguments[r]);return this.length};w.prototype.unshift=function(){for(var r=0,t=arguments.length;r<t;r++)Vn(this,arguments[r]);return this.length};w.prototype.pop=function(){if(!!this.tail){var r=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,r}};w.prototype.shift=function(){if(!!this.head){var r=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,r}};w.prototype.forEach=function(r,t){t=t||this;for(var e=this.head,n=0;e!==null;n++)r.call(t,e.value,n,this),e=e.next};w.prototype.forEachReverse=function(r,t){t=t||this;for(var e=this.tail,n=this.length-1;e!==null;n--)r.call(t,e.value,n,this),e=e.prev};w.prototype.get=function(r){for(var t=0,e=this.head;e!==null&&t<r;t++)e=e.next;if(t===r&&e!==null)return e.value};w.prototype.getReverse=function(r){for(var t=0,e=this.tail;e!==null&&t<r;t++)e=e.prev;if(t===r&&e!==null)return e.value};w.prototype.map=function(r,t){t=t||this;for(var e=new w,n=this.head;n!==null;)e.push(r.call(t,n.value,this)),n=n.next;return e};w.prototype.mapReverse=function(r,t){t=t||this;for(var e=new w,n=this.tail;n!==null;)e.push(r.call(t,n.value,this)),n=n.prev;return e};w.prototype.reduce=function(r,t){var e,n=this.head;if(arguments.length>1)e=t;else if(this.head)n=this.head.next,e=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=0;n!==null;i++)e=r(e,n.value,i),n=n.next;return e};w.prototype.reduceReverse=function(r,t){var e,n=this.tail;if(arguments.length>1)e=t;else if(this.tail)n=this.tail.prev,e=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=this.length-1;n!==null;i--)e=r(e,n.value,i),n=n.prev;return e};w.prototype.toArray=function(){for(var r=new Array(this.length),t=0,e=this.head;e!==null;t++)r[t]=e.value,e=e.next;return r};w.prototype.toArrayReverse=function(){for(var r=new Array(this.length),t=0,e=this.tail;e!==null;t++)r[t]=e.value,e=e.prev;return r};w.prototype.slice=function(r,t){t=t||this.length,t<0&&(t+=this.length),r=r||0,r<0&&(r+=this.length);var e=new w;if(t<r||t<0)return e;r<0&&(r=0),t>this.length&&(t=this.length);for(var n=0,i=this.head;i!==null&&n<r;n++)i=i.next;for(;i!==null&&n<t;n++,i=i.next)e.push(i.value);return e};w.prototype.sliceReverse=function(r,t){t=t||this.length,t<0&&(t+=this.length),r=r||0,r<0&&(r+=this.length);var e=new w;if(t<r||t<0)return e;r<0&&(r=0),t>this.length&&(t=this.length);for(var n=this.length,i=this.tail;i!==null&&n>t;n--)i=i.prev;for(;i!==null&&n>r;n--,i=i.prev)e.push(i.value);return e};w.prototype.splice=function(r,t,...e){r>this.length&&(r=this.length-1),r<0&&(r=this.length+r);for(var n=0,i=this.head;i!==null&&n<r;n++)i=i.next;for(var s=[],n=0;i&&n<t;n++)s.push(i.value),i=this.removeNode(i);i===null&&(i=this.tail),i!==this.head&&i!==this.tail&&(i=i.prev);for(var n=0;n<e.length;n++)i=Xn(this,i,e[n]);return s};w.prototype.reverse=function(){for(var r=this.head,t=this.tail,e=r;e!==null;e=e.prev){var n=e.prev;e.prev=e.next,e.next=n}return this.head=t,this.tail=r,this};function Xn(r,t,e){var n=t===r.head?new Z(e,null,t,r):new Z(e,t,t.next,r);return n.next===null&&(r.tail=n),n.prev===null&&(r.head=n),r.length++,n}function kn(r,t){r.tail=new Z(t,r.tail,null,r),r.head||(r.head=r.tail),r.length++}function Vn(r,t){r.head=new Z(t,null,r.head,r),r.tail||(r.tail=r.head),r.length++}function Z(r,t,e,n){if(!(this instanceof Z))return new Z(r,t,e,n);this.list=n,this.value=r,t?(t.next=this,this.prev=t):this.prev=null,e?(e.prev=this,this.next=e):this.next=null}try{Mn()(w)}catch{}const qn=jn,W=Symbol("max"),M=Symbol("length"),J=Symbol("lengthCalculator"),ie=Symbol("allowStale"),K=Symbol("maxAge"),G=Symbol("dispose"),ht=Symbol("noDisposeOnSet"),O=Symbol("lruList"),C=Symbol("cache"),Gt=Symbol("updateAgeOnGet"),Ne=()=>1;class zn{constructor(t){if(typeof t=="number"&&(t={max:t}),t||(t={}),t.max&&(typeof t.max!="number"||t.max<0))throw new TypeError("max must be a non-negative number");this[W]=t.max||1/0;const e=t.length||Ne;if(this[J]=typeof e!="function"?Ne:e,this[ie]=t.stale||!1,t.maxAge&&typeof t.maxAge!="number")throw new TypeError("maxAge must be a number");this[K]=t.maxAge||0,this[G]=t.dispose,this[ht]=t.noDisposeOnSet||!1,this[Gt]=t.updateAgeOnGet||!1,this.reset()}set max(t){if(typeof t!="number"||t<0)throw new TypeError("max must be a non-negative number");this[W]=t||1/0,ne(this)}get max(){return this[W]}set allowStale(t){this[ie]=!!t}get allowStale(){return this[ie]}set maxAge(t){if(typeof t!="number")throw new TypeError("maxAge must be a non-negative number");this[K]=t,ne(this)}get maxAge(){return this[K]}set lengthCalculator(t){typeof t!="function"&&(t=Ne),t!==this[J]&&(this[J]=t,this[M]=0,this[O].forEach(e=>{e.length=this[J](e.value,e.key),this[M]+=e.length})),ne(this)}get lengthCalculator(){return this[J]}get length(){return this[M]}get itemCount(){return this[O].length}rforEach(t,e){e=e||this;for(let n=this[O].tail;n!==null;){const i=n.prev;pt(this,t,n,e),n=i}}forEach(t,e){e=e||this;for(let n=this[O].head;n!==null;){const i=n.next;pt(this,t,n,e),n=i}}keys(){return this[O].toArray().map(t=>t.key)}values(){return this[O].toArray().map(t=>t.value)}reset(){this[G]&&this[O]&&this[O].length&&this[O].forEach(t=>this[G](t.key,t.value)),this[C]=new Map,this[O]=new qn,this[M]=0}dump(){return this[O].map(t=>he(this,t)?!1:{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}).toArray().filter(t=>t)}dumpLru(){return this[O]}set(t,e,n){if(n=n||this[K],n&&typeof n!="number")throw new TypeError("maxAge must be a number");const i=n?Date.now():0,s=this[J](e,t);if(this[C].has(t)){if(s>this[W])return ee(this,this[C].get(t)),!1;const c=this[C].get(t).value;return this[G]&&(this[ht]||this[G](t,c.value)),c.now=i,c.maxAge=n,c.value=e,this[M]+=s-c.length,c.length=s,this.get(t),ne(this),!0}const a=new Hn(t,e,s,i,n);return a.length>this[W]?(this[G]&&this[G](t,e),!1):(this[M]+=a.length,this[O].unshift(a),this[C].set(t,this[O].head),ne(this),!0)}has(t){if(!this[C].has(t))return!1;const e=this[C].get(t).value;return!he(this,e)}get(t){return be(this,t,!0)}peek(t){return be(this,t,!1)}pop(){const t=this[O].tail;return t?(ee(this,t),t.value):null}del(t){ee(this,this[C].get(t))}load(t){this.reset();const e=Date.now();for(let n=t.length-1;n>=0;n--){const i=t[n],s=i.e||0;if(s===0)this.set(i.k,i.v);else{const a=s-e;a>0&&this.set(i.k,i.v,a)}}}prune(){this[C].forEach((t,e)=>be(this,e,!1))}}const be=(r,t,e)=>{const n=r[C].get(t);if(n){const i=n.value;if(he(r,i)){if(ee(r,n),!r[ie])return}else e&&(r[Gt]&&(n.value.now=Date.now()),r[O].unshiftNode(n));return i.value}},he=(r,t)=>{if(!t||!t.maxAge&&!r[K])return!1;const e=Date.now()-t.now;return t.maxAge?e>t.maxAge:r[K]&&e>r[K]},ne=r=>{if(r[M]>r[W])for(let t=r[O].tail;r[M]>r[W]&&t!==null;){const e=t.prev;ee(r,t),t=e}},ee=(r,t)=>{if(t){const e=t.value;r[G]&&r[G](e.key,e.value),r[M]-=e.length,r[C].delete(e.key),r[O].removeNode(t)}};class Hn{constructor(t,e,n,i,s){this.key=t,this.value=e,this.length=n,this.now=i,this.maxAge=s||0}}const pt=(r,t,e,n)=>{let i=e.value;he(r,i)&&(ee(r,e),r[ie]||(i=void 0)),i&&t.call(n,i.value,i.key,r)};var Yn=zn,Oe,dt;function U(){if(dt)return Oe;dt=1;class r{constructor(p,y){if(y=n(y),p instanceof r)return p.loose===!!y.loose&&p.includePrerelease===!!y.includePrerelease?p:new r(p.raw,y);if(p instanceof i)return this.raw=p.value,this.set=[[p]],this.format(),this;if(this.options=y,this.loose=!!y.loose,this.includePrerelease=!!y.includePrerelease,this.raw=p,this.set=p.split("||").map(E=>this.parseRange(E.trim())).filter(E=>E.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${p}`);if(this.set.length>1){const E=this.set[0];if(this.set=this.set.filter(m=>!I(m[0])),this.set.length===0)this.set=[E];else if(this.set.length>1){for(const m of this.set)if(m.length===1&&v(m[0])){this.set=[m];break}}}this.format()}format(){return this.range=this.set.map(p=>p.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(p){p=p.trim();const E=`parseRange:${Object.keys(this.options).join(",")}:${p}`,m=e.get(E);if(m)return m;const g=this.options.loose,$=g?u[c.HYPHENRANGELOOSE]:u[c.HYPHENRANGE];p=p.replace($,Zt(this.options.includePrerelease)),s("hyphen replace",p),p=p.replace(u[c.COMPARATORTRIM],o),s("comparator trim",p),p=p.replace(u[c.TILDETRIM],l),p=p.replace(u[c.CARETTRIM],h),p=p.split(/\s+/).join(" ");let S=p.split(" ").map(b=>F(b,this.options)).join(" ").split(/\s+/).map(b=>Kt(b,this.options));g&&(S=S.filter(b=>(s("loose invalid filter",b,this.options),!!b.match(u[c.COMPARATORLOOSE])))),s("range list",S);const T=new Map,N=S.map(b=>new i(b,this.options));for(const b of N){if(I(b))return[b];T.set(b.value,b)}T.size>1&&T.has("")&&T.delete("");const L=[...T.values()];return e.set(E,L),L}intersects(p,y){if(!(p instanceof r))throw new TypeError("a Range is required");return this.set.some(E=>x(E,y)&&p.set.some(m=>x(m,y)&&E.every(g=>m.every($=>g.intersects($,y)))))}test(p){if(!p)return!1;if(typeof p=="string")try{p=new a(p,this.options)}catch{return!1}for(let y=0;y<this.set.length;y++)if(Qt(this.set[y],p,this.options))return!0;return!1}}Oe=r;const t=Yn,e=new t({max:1e3}),n=me,i=Ie(),s=Ee,a=_,{re:u,t:c,comparatorTrimReplace:o,tildeTrimReplace:l,caretTrimReplace:h}=q.exports,I=d=>d.value==="<0.0.0-0",v=d=>d.value==="",x=(d,p)=>{let y=!0;const E=d.slice();let m=E.pop();for(;y&&E.length;)y=E.every(g=>m.intersects(g,p)),m=E.pop();return y},F=(d,p)=>(s("comp",d,p),d=qt(d,p),s("caret",d),d=B(d,p),s("tildes",d),d=Ht(d,p),s("xrange",d),d=Wt(d,p),s("stars",d),d),R=d=>!d||d.toLowerCase()==="x"||d==="*",B=(d,p)=>d.trim().split(/\s+/).map(y=>Vt(y,p)).join(" "),Vt=(d,p)=>{const y=p.loose?u[c.TILDELOOSE]:u[c.TILDE];return d.replace(y,(E,m,g,$,S)=>{s("tilde",d,E,m,g,$,S);let T;return R(m)?T="":R(g)?T=`>=${m}.0.0 <${+m+1}.0.0-0`:R($)?T=`>=${m}.${g}.0 <${m}.${+g+1}.0-0`:S?(s("replaceTilde pr",S),T=`>=${m}.${g}.${$}-${S} <${m}.${+g+1}.0-0`):T=`>=${m}.${g}.${$} <${m}.${+g+1}.0-0`,s("tilde return",T),T})},qt=(d,p)=>d.trim().split(/\s+/).map(y=>zt(y,p)).join(" "),zt=(d,p)=>{s("caret",d,p);const y=p.loose?u[c.CARETLOOSE]:u[c.CARET],E=p.includePrerelease?"-0":"";return d.replace(y,(m,g,$,S,T)=>{s("caret",d,m,g,$,S,T);let N;return R(g)?N="":R($)?N=`>=${g}.0.0${E} <${+g+1}.0.0-0`:R(S)?g==="0"?N=`>=${g}.${$}.0${E} <${g}.${+$+1}.0-0`:N=`>=${g}.${$}.0${E} <${+g+1}.0.0-0`:T?(s("replaceCaret pr",T),g==="0"?$==="0"?N=`>=${g}.${$}.${S}-${T} <${g}.${$}.${+S+1}-0`:N=`>=${g}.${$}.${S}-${T} <${g}.${+$+1}.0-0`:N=`>=${g}.${$}.${S}-${T} <${+g+1}.0.0-0`):(s("no pr"),g==="0"?$==="0"?N=`>=${g}.${$}.${S}${E} <${g}.${$}.${+S+1}-0`:N=`>=${g}.${$}.${S}${E} <${g}.${+$+1}.0-0`:N=`>=${g}.${$}.${S} <${+g+1}.0.0-0`),s("caret return",N),N})},Ht=(d,p)=>(s("replaceXRanges",d,p),d.split(/\s+/).map(y=>Yt(y,p)).join(" ")),Yt=(d,p)=>{d=d.trim();const y=p.loose?u[c.XRANGELOOSE]:u[c.XRANGE];return d.replace(y,(E,m,g,$,S,T)=>{s("xRange",d,E,m,g,$,S,T);const N=R(g),L=N||R($),b=L||R(S),re=b;return m==="="&&re&&(m=""),T=p.includePrerelease?"-0":"",N?m===">"||m==="<"?E="<0.0.0-0":E="*":m&&re?(L&&($=0),S=0,m===">"?(m=">=",L?(g=+g+1,$=0,S=0):($=+$+1,S=0)):m==="<="&&(m="<",L?g=+g+1:$=+$+1),m==="<"&&(T="-0"),E=`${m+g}.${$}.${S}${T}`):L?E=`>=${g}.0.0${T} <${+g+1}.0.0-0`:b&&(E=`>=${g}.${$}.0${T} <${g}.${+$+1}.0-0`),s("xRange return",E),E})},Wt=(d,p)=>(s("replaceStars",d,p),d.trim().replace(u[c.STAR],"")),Kt=(d,p)=>(s("replaceGTE0",d,p),d.trim().replace(u[p.includePrerelease?c.GTE0PRE:c.GTE0],"")),Zt=d=>(p,y,E,m,g,$,S,T,N,L,b,re,Mi)=>(R(E)?y="":R(m)?y=`>=${E}.0.0${d?"-0":""}`:R(g)?y=`>=${E}.${m}.0${d?"-0":""}`:$?y=`>=${y}`:y=`>=${y}${d?"-0":""}`,R(N)?T="":R(L)?T=`<${+N+1}.0.0-0`:R(b)?T=`<${N}.${+L+1}.0-0`:re?T=`<=${N}.${L}.${b}-${re}`:d?T=`<${N}.${L}.${+b+1}-0`:T=`<=${T}`,`${y} ${T}`.trim()),Qt=(d,p,y)=>{for(let E=0;E<d.length;E++)if(!d[E].test(p))return!1;if(p.prerelease.length&&!y.includePrerelease){for(let E=0;E<d.length;E++)if(s(d[E].semver),d[E].semver!==i.ANY&&d[E].semver.prerelease.length>0){const m=d[E].semver;if(m.major===p.major&&m.minor===p.minor&&m.patch===p.patch)return!0}return!1}return!0};return Oe}var Ae,vt;function Ie(){if(vt)return Ae;vt=1;const r=Symbol("SemVer ANY");class t{static get ANY(){return r}constructor(l,h){if(h=e(h),l instanceof t){if(l.loose===!!h.loose)return l;l=l.value}a("comparator",l,h),this.options=h,this.loose=!!h.loose,this.parse(l),this.semver===r?this.value="":this.value=this.operator+this.semver.version,a("comp",this)}parse(l){const h=this.options.loose?n[i.COMPARATORLOOSE]:n[i.COMPARATOR],I=l.match(h);if(!I)throw new TypeError(`Invalid comparator: ${l}`);this.operator=I[1]!==void 0?I[1]:"",this.operator==="="&&(this.operator=""),I[2]?this.semver=new u(I[2],this.options.loose):this.semver=r}toString(){return this.value}test(l){if(a("Comparator.test",l,this.options.loose),this.semver===r||l===r)return!0;if(typeof l=="string")try{l=new u(l,this.options)}catch{return!1}return s(l,this.operator,this.semver,this.options)}intersects(l,h){if(!(l instanceof t))throw new TypeError("a Comparator is required");if((!h||typeof h!="object")&&(h={loose:!!h,includePrerelease:!1}),this.operator==="")return this.value===""?!0:new c(l.value,h).test(this.value);if(l.operator==="")return l.value===""?!0:new c(this.value,h).test(l.semver);const I=(this.operator===">="||this.operator===">")&&(l.operator===">="||l.operator===">"),v=(this.operator==="<="||this.operator==="<")&&(l.operator==="<="||l.operator==="<"),x=this.semver.version===l.semver.version,F=(this.operator===">="||this.operator==="<=")&&(l.operator===">="||l.operator==="<="),R=s(this.semver,"<",l.semver,h)&&(this.operator===">="||this.operator===">")&&(l.operator==="<="||l.operator==="<"),B=s(this.semver,">",l.semver,h)&&(this.operator==="<="||this.operator==="<")&&(l.operator===">="||l.operator===">");return I||v||x&&F||R||B}}Ae=t;const e=me,{re:n,t:i}=q.exports,s=Bt,a=Ee,u=_,c=U();return Ae}const Wn=U(),Kn=(r,t,e)=>{try{t=new Wn(t,e)}catch{return!1}return t.test(r)};var $e=Kn;const Zn=U(),Qn=(r,t)=>new Zn(r,t).set.map(e=>e.map(n=>n.value).join(" ").trim().split(" "));var Jn=Qn;const es=_,ts=U(),rs=(r,t,e)=>{let n=null,i=null,s=null;try{s=new ts(t,e)}catch{return null}return r.forEach(a=>{s.test(a)&&(!n||i.compare(a)===-1)&&(n=a,i=new es(n,e))}),n};var ns=rs;const ss=_,is=U(),as=(r,t,e)=>{let n=null,i=null,s=null;try{s=new is(t,e)}catch{return null}return r.forEach(a=>{s.test(a)&&(!n||i.compare(a)===1)&&(n=a,i=new ss(n,e))}),n};var os=as;const _e=_,cs=U(),gt=ye,us=(r,t)=>{r=new cs(r,t);let e=new _e("0.0.0");if(r.test(e)||(e=new _e("0.0.0-0"),r.test(e)))return e;e=null;for(let n=0;n<r.set.length;++n){const i=r.set[n];let s=null;i.forEach(a=>{const u=new _e(a.semver.version);switch(a.operator){case">":u.prerelease.length===0?u.patch++:u.prerelease.push(0),u.raw=u.format();case"":case">=":(!s||gt(u,s))&&(s=u);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${a.operator}`)}}),s&&(!e||gt(e,s))&&(e=s)}return e&&r.test(e)?e:null};var ls=us;const fs=U(),hs=(r,t)=>{try{return new fs(r,t).range||"*"}catch{return null}};var ps=hs;const ds=_,Mt=Ie(),{ANY:vs}=Mt,gs=U(),Es=$e,Et=ye,mt=ke,ms=qe,ys=Ve,Is=(r,t,e,n)=>{r=new ds(r,n),t=new gs(t,n);let i,s,a,u,c;switch(e){case">":i=Et,s=ms,a=mt,u=">",c=">=";break;case"<":i=mt,s=ys,a=Et,u="<",c="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(Es(r,t,n))return!1;for(let o=0;o<t.set.length;++o){const l=t.set[o];let h=null,I=null;if(l.forEach(v=>{v.semver===vs&&(v=new Mt(">=0.0.0")),h=h||v,I=I||v,i(v.semver,h.semver,n)?h=v:a(v.semver,I.semver,n)&&(I=v)}),h.operator===u||h.operator===c||(!I.operator||I.operator===u)&&s(r,I.semver))return!1;if(I.operator===c&&a(r,I.semver))return!1}return!0};var ze=Is;const $s=ze,Ts=(r,t,e)=>$s(r,t,">",e);var ws=Ts;const Ss=ze,Rs=(r,t,e)=>Ss(r,t,"<",e);var Ns=Rs;const yt=U(),bs=(r,t,e)=>(r=new yt(r,e),t=new yt(t,e),r.intersects(t));var Os=bs;const As=$e,_s=P;var xs=(r,t,e)=>{const n=[];let i=null,s=null;const a=r.sort((l,h)=>_s(l,h,e));for(const l of a)As(l,t,e)?(s=l,i||(i=l)):(s&&n.push([i,s]),s=null,i=null);i&&n.push([i,null]);const u=[];for(const[l,h]of n)l===h?u.push(l):!h&&l===a[0]?u.push("*"):h?l===a[0]?u.push(`<=${h}`):u.push(`${l} - ${h}`):u.push(`>=${l}`);const c=u.join(" || "),o=typeof t.raw=="string"?t.raw:String(t);return c.length<o.length?c:t};const It=U(),fe=Ie(),{ANY:xe}=fe,se=$e,He=P,Ls=(r,t,e={})=>{if(r===t)return!0;r=new It(r,e),t=new It(t,e);let n=!1;e:for(const i of r.set){for(const s of t.set){const a=Ds(i,s,e);if(n=n||a!==null,a)continue e}if(n)return!1}return!0},Ds=(r,t,e)=>{if(r===t)return!0;if(r.length===1&&r[0].semver===xe){if(t.length===1&&t[0].semver===xe)return!0;e.includePrerelease?r=[new fe(">=0.0.0-0")]:r=[new fe(">=0.0.0")]}if(t.length===1&&t[0].semver===xe){if(e.includePrerelease)return!0;t=[new fe(">=0.0.0")]}const n=new Set;let i,s;for(const v of r)v.operator===">"||v.operator===">="?i=$t(i,v,e):v.operator==="<"||v.operator==="<="?s=Tt(s,v,e):n.add(v.semver);if(n.size>1)return null;let a;if(i&&s){if(a=He(i.semver,s.semver,e),a>0)return null;if(a===0&&(i.operator!==">="||s.operator!=="<="))return null}for(const v of n){if(i&&!se(v,String(i),e)||s&&!se(v,String(s),e))return null;for(const x of t)if(!se(v,String(x),e))return!1;return!0}let u,c,o,l,h=s&&!e.includePrerelease&&s.semver.prerelease.length?s.semver:!1,I=i&&!e.includePrerelease&&i.semver.prerelease.length?i.semver:!1;h&&h.prerelease.length===1&&s.operator==="<"&&h.prerelease[0]===0&&(h=!1);for(const v of t){if(l=l||v.operator===">"||v.operator===">=",o=o||v.operator==="<"||v.operator==="<=",i){if(I&&v.semver.prerelease&&v.semver.prerelease.length&&v.semver.major===I.major&&v.semver.minor===I.minor&&v.semver.patch===I.patch&&(I=!1),v.operator===">"||v.operator===">="){if(u=$t(i,v,e),u===v&&u!==i)return!1}else if(i.operator===">="&&!se(i.semver,String(v),e))return!1}if(s){if(h&&v.semver.prerelease&&v.semver.prerelease.length&&v.semver.major===h.major&&v.semver.minor===h.minor&&v.semver.patch===h.patch&&(h=!1),v.operator==="<"||v.operator==="<="){if(c=Tt(s,v,e),c===v&&c!==s)return!1}else if(s.operator==="<="&&!se(s.semver,String(v),e))return!1}if(!v.operator&&(s||i)&&a!==0)return!1}return!(i&&o&&!s&&a!==0||s&&l&&!i&&a!==0||I||h)},$t=(r,t,e)=>{if(!r)return t;const n=He(r.semver,t.semver,e);return n>0?r:n<0||t.operator===">"&&r.operator===">="?t:r},Tt=(r,t,e)=>{if(!r)return t;const n=He(r.semver,t.semver,e);return n<0?r:n>0||t.operator==="<"&&r.operator==="<="?t:r};var Cs=Ls;const Le=q.exports,Ps=ge,Us=_,wt=Ut,Fs=te,Bs=Pr,Gs=Br,Ms=Mr,js=zr,Xs=Wr,ks=Qr,Vs=tn,qs=sn,zs=P,Hs=cn,Ys=fn,Ws=Xe,Ks=vn,Zs=mn,Qs=ye,Js=ke,ei=je,ti=Ft,ri=Ve,ni=qe,si=Bt,ii=Gn,ai=Ie(),oi=U(),ci=$e,ui=Jn,li=ns,fi=os,hi=ls,pi=ps,di=ze,vi=ws,gi=Ns,Ei=Os,mi=xs,yi=Cs;var St={parse:Fs,valid:Bs,clean:Gs,inc:Ms,diff:js,major:Xs,minor:ks,patch:Vs,prerelease:qs,compare:zs,rcompare:Hs,compareLoose:Ys,compareBuild:Ws,sort:Ks,rsort:Zs,gt:Qs,lt:Js,eq:ei,neq:ti,gte:ri,lte:ni,cmp:si,coerce:ii,Comparator:ai,Range:oi,satisfies:ci,toComparators:ui,maxSatisfying:li,minSatisfying:fi,minVersion:hi,validRange:pi,outside:di,gtr:vi,ltr:gi,intersects:Ei,simplifyRange:mi,subset:yi,SemVer:Us,re:Le.re,src:Le.src,tokens:Le.t,SEMVER_SPEC_VERSION:Ps.SEMVER_SPEC_VERSION,compareIdentifiers:wt.compareIdentifiers,rcompareIdentifiers:wt.rcompareIdentifiers},Fe=globalThis&&globalThis.__assign||function(){return Fe=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=t[i])}return r},Fe.apply(this,arguments)},z,A;(function(r){r.blue="blue",r.nanoS="nanoS",r.nanoSP="nanoSP",r.nanoX="nanoX",r.nanoFTS="nanoFTS"})(A||(A={}));var Be=(z={},z[A.blue]={id:A.blue,productName:"Ledger\xA0Blue",productIdMM:0,legacyUsbProductId:0,usbOnly:!0,memorySize:480*1024,masks:[822083584,822149120],getBlockSize:function(r){return 4*1024}},z[A.nanoS]={id:A.nanoS,productName:"Ledger\xA0Nano\xA0S",productIdMM:16,legacyUsbProductId:1,usbOnly:!0,memorySize:320*1024,masks:[823132160],getBlockSize:function(r){var t;return St.lt((t=St.coerce(r))!==null&&t!==void 0?t:"","2.0.0")?4*1024:2*1024}},z[A.nanoSP]={id:A.nanoSP,productName:"Ledger Nano S Plus",productIdMM:80,legacyUsbProductId:5,usbOnly:!0,memorySize:1536*1024,masks:[856686592],getBlockSize:function(r){return 32}},z[A.nanoX]={id:A.nanoX,productName:"Ledger\xA0Nano\xA0X",productIdMM:64,legacyUsbProductId:4,usbOnly:!1,memorySize:2*1024*1024,masks:[855638016],getBlockSize:function(r){return 4*1024},bluetoothSpec:[{serviceUuid:"13d63400-2c97-0004-0000-4c6564676572",notifyUuid:"13d63400-2c97-0004-0001-4c6564676572",writeUuid:"13d63400-2c97-0004-0002-4c6564676572",writeCmdUuid:"13d63400-2c97-0004-0003-4c6564676572"}]},z[A.nanoFTS]={id:A.nanoFTS,productName:"Ledger\xA0Nano\xA0FTS",productIdMM:96,legacyUsbProductId:6,usbOnly:!1,memorySize:1536*1024,masks:[857735168],getBlockSize:function(r){return 32},bluetoothSpec:[{serviceUuid:"13d63400-2c97-6004-0000-4c6564676572",notifyUuid:"13d63400-2c97-6004-0001-4c6564676572",writeUuid:"13d63400-2c97-6004-0002-4c6564676572",writeCmdUuid:"13d63400-2c97-6004-0003-4c6564676572"}]},z);A.blue,A.nanoS,A.nanoSP,A.nanoX,A.nanoFTS;var Rt=Object.values(Be),Te=11415,pe=function(r){var t=Rt.find(function(i){return i.legacyUsbProductId===r});if(t)return t;var e=r>>8,n=Rt.find(function(i){return i.productIdMM===e});return n},Ii=[],Nt={};for(var $i in Be){var bt=Be[$i],De=bt.bluetoothSpec;if(De)for(var Ce=0;Ce<De.length;Ce++){var le=De[Ce];Ii.push(le.serviceUuid),Nt[le.serviceUuid]=Nt[le.serviceUuid.replace(/-/g,"")]=Fe({deviceModel:bt},le)}}var Ti=0,k=[],de=function(r,t,e){var n={type:r,id:String(++Ti),date:new Date};t&&(n.message=t),e&&(n.data=e),Si(n)},wi=function(r){return k.push(r),function(){var t=k.indexOf(r);t!==-1&&(k[t]=k[k.length-1],k.pop())}};function Si(r){for(var t=0;t<k.length;t++)try{k[t](r)}catch(e){console.error(e)}}typeof window<"u"&&(window.__ledgerLogsListen=wi);var Ri=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(n[s]=i[s])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),j=globalThis&&globalThis.__awaiter||function(r,t,e,n){function i(s){return s instanceof e?s:new e(function(a){a(s)})}return new(e||(e=Promise))(function(s,a){function u(l){try{o(n.next(l))}catch(h){a(h)}}function c(l){try{o(n.throw(l))}catch(h){a(h)}}function o(l){l.done?s(l.value):i(l.value).then(u,c)}o((n=n.apply(r,t||[])).next())})},X=globalThis&&globalThis.__generator||function(r,t){var e={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(o){return function(l){return c([o,l])}}function c(o){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,i&&(s=o[0]&2?i.return:o[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,o[1])).done)return s;switch(i=0,s&&(o=[o[0]&2,s.value]),o[0]){case 0:case 1:s=o;break;case 4:return e.label++,{value:o[1],done:!1};case 5:e.label++,i=o[1],o=[0];continue;case 7:o=e.ops.pop(),e.trys.pop();continue;default:if(s=e.trys,!(s=s.length>0&&s[s.length-1])&&(o[0]===6||o[0]===2)){e=0;continue}if(o[0]===3&&(!s||o[1]>s[0]&&o[1]<s[3])){e.label=o[1];break}if(o[0]===6&&e.label<s[1]){e.label=s[1],s=o;break}if(s&&e.label<s[2]){e.label=s[2],e.ops.push(o);break}s[2]&&e.ops.pop(),e.trys.pop();continue}o=t.call(r,e)}catch(l){o=[6,l],i=0}finally{n=s=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},Ni=globalThis&&globalThis.__read||function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),i,s=[],a;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(u){a={error:u}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(a)throw a.error}}return s},bi=[{vendorId:Te}],Oi=function(){return Promise.resolve(!!(window.navigator&&window.navigator.hid))},ve=function(){var r=navigator.hid;if(!r)throw new V("navigator.hid is not supported","HIDNotSupported");return r};function jt(){return j(this,void 0,void 0,function(){var r;return X(this,function(t){switch(t.label){case 0:return[4,ve().requestDevice({filters:bi})];case 1:return r=t.sent(),Array.isArray(r)?[2,r]:[2,[r]]}})})}function Ge(){return j(this,void 0,void 0,function(){var r;return X(this,function(t){switch(t.label){case 0:return[4,ve().getDevices()];case 1:return r=t.sent(),[2,r.filter(function(e){return e.vendorId===Te})]}})})}function Ai(){return j(this,void 0,void 0,function(){var r,t;return X(this,function(e){switch(e.label){case 0:return[4,Ge()];case 1:return r=e.sent(),r.length>0?[2,r[0]]:[4,jt()];case 2:return t=e.sent(),[2,t[0]]}})})}var _i=function(r){Ri(t,r);function t(e){var n=r.call(this)||this;return n.channel=Math.floor(Math.random()*65535),n.packetSize=64,n.inputs=[],n.read=function(){return n.inputs.length?Promise.resolve(n.inputs.shift()):new Promise(function(i){n.inputCallback=i})},n.onInputReport=function(i){var s=Buffer.from(i.data.buffer);n.inputCallback?(n.inputCallback(s),n.inputCallback=null):n.inputs.push(s)},n._disconnectEmitted=!1,n._emitDisconnect=function(i){n._disconnectEmitted||(n._disconnectEmitted=!0,n.emit("disconnect",i))},n.exchange=function(i){return j(n,void 0,void 0,function(){var s,a=this;return X(this,function(u){switch(u.label){case 0:return[4,this.exchangeAtomicImpl(function(){return j(a,void 0,void 0,function(){var c,o,l,h,I,v,x,F,R;return X(this,function(B){switch(B.label){case 0:c=this,o=c.channel,l=c.packetSize,de("apdu","=> "+i.toString("hex")),h=Ct(o,l),I=h.makeBlocks(i),v=0,B.label=1;case 1:return v<I.length?[4,this.device.sendReport(0,I[v])]:[3,4];case 2:B.sent(),B.label=3;case 3:return v++,[3,1];case 4:return(x=h.getReducedResult(F))?[3,6]:[4,this.read()];case 5:return R=B.sent(),F=h.reduceResponse(F,R),[3,4];case 6:return de("apdu","<= "+x.toString("hex")),[2,x]}})})}).catch(function(c){throw c&&c.message&&c.message.includes("write")?(a._emitDisconnect(c),new xt(c.message)):c})];case 1:return s=u.sent(),[2,s]}})})},n.device=e,n.deviceModel=typeof e.productId=="number"?pe(e.productId):void 0,e.addEventListener("inputreport",n.onInputReport),n}return t.request=function(){return j(this,void 0,void 0,function(){var e,n;return X(this,function(i){switch(i.label){case 0:return[4,jt()];case 1:return e=Ni.apply(void 0,[i.sent(),1]),n=e[0],[2,t.open(n)]}})})},t.openConnected=function(){return j(this,void 0,void 0,function(){var e;return X(this,function(n){switch(n.label){case 0:return[4,Ge()];case 1:return e=n.sent(),e.length===0?[2,null]:[2,t.open(e[0])]}})})},t.open=function(e){return j(this,void 0,void 0,function(){var n,i;return X(this,function(s){switch(s.label){case 0:return[4,e.open()];case 1:return s.sent(),n=new t(e),i=function(a){e===a.device&&(ve().removeEventListener("disconnect",i),n._emitDisconnect(new _t))},ve().addEventListener("disconnect",i),[2,n]}})})},t.prototype.close=function(){return j(this,void 0,void 0,function(){return X(this,function(e){switch(e.label){case 0:return[4,this.exchangeBusyPromise];case 1:return e.sent(),this.device.removeEventListener("inputreport",this.onInputReport),[4,this.device.close()];case 2:return e.sent(),[2]}})})},t.prototype.setScrambleKey=function(){},t.isSupported=Oi,t.list=Ge,t.listen=function(e){var n=!1;Ai().then(function(s){if(!s)e.error(new Pe("Access denied to use Ledger device"));else if(!n){var a=typeof s.productId=="number"?pe(s.productId):void 0;e.next({type:"add",descriptor:s,deviceModel:a}),e.complete()}},function(s){e.error(new Pe(s.message))});function i(){n=!0}return{unsubscribe:i}},t}(Dt),Ye=globalThis&&globalThis.__awaiter||function(r,t,e,n){function i(s){return s instanceof e?s:new e(function(a){a(s)})}return new(e||(e=Promise))(function(s,a){function u(l){try{o(n.next(l))}catch(h){a(h)}}function c(l){try{o(n.throw(l))}catch(h){a(h)}}function o(l){l.done?s(l.value):i(l.value).then(u,c)}o((n=n.apply(r,t||[])).next())})},We=globalThis&&globalThis.__generator||function(r,t){var e={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(o){return function(l){return c([o,l])}}function c(o){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,i&&(s=o[0]&2?i.return:o[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,o[1])).done)return s;switch(i=0,s&&(o=[o[0]&2,s.value]),o[0]){case 0:case 1:s=o;break;case 4:return e.label++,{value:o[1],done:!1};case 5:e.label++,i=o[1],o=[0];continue;case 7:o=e.ops.pop(),e.trys.pop();continue;default:if(s=e.trys,!(s=s.length>0&&s[s.length-1])&&(o[0]===6||o[0]===2)){e=0;continue}if(o[0]===3&&(!s||o[1]>s[0]&&o[1]<s[3])){e.label=o[1];break}if(o[0]===6&&e.label<s[1]){e.label=s[1],s=o;break}if(s&&e.label<s[2]){e.label=s[2],e.ops.push(o);break}s[2]&&e.ops.pop(),e.trys.pop();continue}o=t.call(r,e)}catch(l){o=[6,l],i=0}finally{n=s=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},xi=[{vendorId:Te}];function Xt(){return Ye(this,void 0,void 0,function(){var r;return We(this,function(t){switch(t.label){case 0:return[4,navigator.usb.requestDevice({filters:xi})];case 1:return r=t.sent(),[2,r]}})})}function Me(){return Ye(this,void 0,void 0,function(){var r;return We(this,function(t){switch(t.label){case 0:return[4,navigator.usb.getDevices()];case 1:return r=t.sent(),[2,r.filter(function(e){return e.vendorId===Te})]}})})}function Li(){return Ye(this,void 0,void 0,function(){var r;return We(this,function(t){switch(t.label){case 0:return[4,Me()];case 1:return r=t.sent(),r.length>0?[2,r[0]]:[2,Xt()]}})})}var Di=function(){return Promise.resolve(!!navigator&&!!navigator.usb&&typeof navigator.usb.getDevices=="function")},Ci=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(n[s]=i[s])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),H=globalThis&&globalThis.__awaiter||function(r,t,e,n){function i(s){return s instanceof e?s:new e(function(a){a(s)})}return new(e||(e=Promise))(function(s,a){function u(l){try{o(n.next(l))}catch(h){a(h)}}function c(l){try{o(n.throw(l))}catch(h){a(h)}}function o(l){l.done?s(l.value):i(l.value).then(u,c)}o((n=n.apply(r,t||[])).next())})},Y=globalThis&&globalThis.__generator||function(r,t){var e={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(o){return function(l){return c([o,l])}}function c(o){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,i&&(s=o[0]&2?i.return:o[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,o[1])).done)return s;switch(i=0,s&&(o=[o[0]&2,s.value]),o[0]){case 0:case 1:s=o;break;case 4:return e.label++,{value:o[1],done:!1};case 5:e.label++,i=o[1],o=[0];continue;case 7:o=e.ops.pop(),e.trys.pop();continue;default:if(s=e.trys,!(s=s.length>0&&s[s.length-1])&&(o[0]===6||o[0]===2)){e=0;continue}if(o[0]===3&&(!s||o[1]>s[0]&&o[1]<s[3])){e.label=o[1];break}if(o[0]===6&&e.label<s[1]){e.label=s[1],s=o;break}if(s&&e.label<s[2]){e.label=s[2],e.ops.push(o);break}s[2]&&e.ops.pop(),e.trys.pop();continue}o=t.call(r,e)}catch(l){o=[6,l],i=0}finally{n=s=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},Pi=1,Ot=3,Ui=function(r){Ci(t,r);function t(e,n){var i=r.call(this)||this;return i.channel=Math.floor(Math.random()*65535),i.packetSize=64,i._disconnectEmitted=!1,i._emitDisconnect=function(s){i._disconnectEmitted||(i._disconnectEmitted=!0,i.emit("disconnect",s))},i.device=e,i.interfaceNumber=n,i.deviceModel=pe(e.productId),i}return t.request=function(){return H(this,void 0,void 0,function(){var e;return Y(this,function(n){switch(n.label){case 0:return[4,Xt()];case 1:return e=n.sent(),[2,t.open(e)]}})})},t.openConnected=function(){return H(this,void 0,void 0,function(){var e;return Y(this,function(n){switch(n.label){case 0:return[4,Me()];case 1:return e=n.sent(),e.length===0?[2,null]:[2,t.open(e[0])]}})})},t.open=function(e){return H(this,void 0,void 0,function(){var n,i,s,a,u;return Y(this,function(c){switch(c.label){case 0:return[4,e.open()];case 1:return c.sent(),e.configuration!==null?[3,3]:[4,e.selectConfiguration(Pi)];case 2:c.sent(),c.label=3;case 3:return[4,At(e)];case 4:if(c.sent(),n=e.configurations[0].interfaces.find(function(o){var l=o.alternates;return l.some(function(h){return h.interfaceClass===255})}),!n)throw new Qe("No WebUSB interface found for your Ledger device. Please upgrade firmware or contact techsupport.");i=n.interfaceNumber,c.label=5;case 5:return c.trys.push([5,7,,9]),[4,e.claimInterface(i)];case 6:return c.sent(),[3,9];case 7:return s=c.sent(),[4,e.close()];case 8:throw c.sent(),new Qe(s.message);case 9:return a=new t(e,i),u=function(o){e===o.device&&(navigator.usb.removeEventListener("disconnect",u),a._emitDisconnect(new _t))},navigator.usb.addEventListener("disconnect",u),[2,a]}})})},t.prototype.close=function(){return H(this,void 0,void 0,function(){return Y(this,function(e){switch(e.label){case 0:return[4,this.exchangeBusyPromise];case 1:return e.sent(),[4,this.device.releaseInterface(this.interfaceNumber)];case 2:return e.sent(),[4,At(this.device)];case 3:return e.sent(),[4,this.device.close()];case 4:return e.sent(),[2]}})})},t.prototype.exchange=function(e){return H(this,void 0,void 0,function(){var n,i=this;return Y(this,function(s){switch(s.label){case 0:return[4,this.exchangeAtomicImpl(function(){return H(i,void 0,void 0,function(){var a,u,c,o,l,h,I,v,x,F;return Y(this,function(R){switch(R.label){case 0:a=this,u=a.channel,c=a.packetSize,de("apdu","=> "+e.toString("hex")),o=Ct(u,c),l=o.makeBlocks(e),h=0,R.label=1;case 1:return h<l.length?[4,this.device.transferOut(Ot,l[h])]:[3,4];case 2:R.sent(),R.label=3;case 3:return h++,[3,1];case 4:return(I=o.getReducedResult(v))?[3,6]:[4,this.device.transferIn(Ot,c)];case 5:return x=R.sent(),F=Buffer.from(x.data.buffer),v=o.reduceResponse(v,F),[3,4];case 6:return de("apdu","<= "+I.toString("hex")),[2,I]}})})}).catch(function(a){throw a&&a.message&&a.message.includes("disconnected")?(i._emitDisconnect(a),new xt(a.message)):a})];case 1:return n=s.sent(),[2,n]}})})},t.prototype.setScrambleKey=function(){},t.isSupported=Di,t.list=Me,t.listen=function(e){var n=!1;Li().then(function(s){if(!n){var a=pe(s.productId);e.next({type:"add",descriptor:s,deviceModel:a}),e.complete()}},function(s){window.DOMException&&s instanceof window.DOMException&&s.code===18?e.error(new dr(s.message)):e.error(new Pe(s.message))});function i(){n=!0}return{unsubscribe:i}},t}(Dt);function At(r){return H(this,void 0,void 0,function(){var t;return Y(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,r.reset()];case 1:return e.sent(),[3,3];case 2:return t=e.sent(),console.warn(t),[3,3];case 3:return[2]}})})}const Fi=async()=>{try{return await Ui.create()}catch(r){return console.log(r),await _i.create()}},Bi=async(r,t)=>{const{create_toolkit:e}=await tr(()=>import("./taquito.4a51c829.js"),["assets/taquito.4a51c829.js","assets/taquito.es6.dfb0aade.js","assets/taquito-http-utils.es6.491b203a.js","assets/main.fcc73858.js","assets/index.dec37447.css","assets/taquito-utils.es6.9e1a8ea2.js","assets/index.558d09ea.js"]),{tezos:n,forger:i}=await e(t.rpc),s=new ur(r,t.derivationPath,void 0,t.derivationType);n.setSignerProvider(s);const a=await n.signer.publicKeyHash(),u=a?await n.rpc.getManagerKey(a):void 0;return{account:a,tezos:n,forger:i,managerKey:u==null?void 0:u.toString()}},{request_ledger_setup:Gi}=ar();class kt extends or{constructor(e,n,i,s,a){super(e,i,s,a);Ke(this,"transport");this.transport=n}get AccountType(){return rr.Ledger}get Icon(){return new nr("/assets/svg/ledger-wallet-icon.svg",sr.raw)}get IsAccountSwitchSupported(){return!1}static async create(e,n,i){var l;const s=ir[n];if(!s)throw new Error("Invalid network specification!");const{account:a,tezos:u,forger:c,managerKey:o}=await Bi(e,{...i,rpc:(l=i==null?void 0:i.rpc)!=null?l:s.rpc});return new kt(a!=null?a:"",e,u,c,{networkId:n,managerKey:o})}static async create_transport(){return Fi()}static async create_from_cache(){}logout(){this.transport.close()}async switch_wallet(){const e=await Gi({networkId:this.NetworkId,rpc:this.Tezos.rpc.getRpcUrl()});if(!e)throw new Error("Aborted.");return e}async vote(e){const n=await this.forge_ballot_op(e),i=async()=>{const s=this.Tezos.wallet.context,a=await this.Tezos.signer.sign(n,new Uint8Array([3])),u=await this.Tezos.rpc.injectOperation(a.sbytes);return s.operationFactory.createOperation(u)};return new Ze(i,"Vote",{account:this.Account,ballot:e})}async propose(e){const n=await this.forge_proposals_op(e),i=async()=>{const s=this.Tezos.wallet.context,a=await this.Tezos.signer.sign(n,new Uint8Array([3])),u=await this.Tezos.rpc.injectOperation(a.sbytes);return s.operationFactory.createOperation(u)};return new Ze(i,"Propose",{account:this.Account,proposals:e})}}export{kt as LedgerSession};
