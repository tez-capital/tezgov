function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/taquito-DQFB5Rhl.js","assets/taquito.es6-CZA_0qd1.js","assets/main-BG0ee8p3.js","assets/main-CJpwEAG2.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{R as er,_ as tr,E as rr,G as nr,H as sr,O as Z,U as ir,J as or}from"./main-BG0ee8p3.js";import{S as ar}from"./SessionBase-CLBIlJ9v.js";import{E as cr}from"./WalletConnectCommunicationClient-CwWhMaOS.js";import{L as lr}from"./LedgerDialog-sRsCWvpx.js";import"./taquito.es6-CZA_0qd1.js";const re=r=>{class e extends Error{constructor(n,s,i){if(super(n||r,i),Object.setPrototypeOf(this,e.prototype),this.name=r,s)for(const a in s)this[a]=s[a];if(i&&ur(i)&&"cause"in i&&!("cause"in this)){const a=i.cause;this.cause=a,"stack"in a&&(this.stack=this.stack+`
CAUSE: `+a.stack)}}}return e};function ur(r){return typeof r=="object"}const xt=re("DisconnectedDevice"),Lt=re("DisconnectedDeviceDuringOperation"),Ue=re("TransportOpenUserCancelled"),Ze=re("TransportInterfaceNotAvailable"),hr=re("TransportRaceCondition"),fr=re("TransportWebUSBGestureRequired");var Je;(function(r){r.Unknown="Unknown",r.LocationServicesDisabled="LocationServicesDisabled",r.LocationServicesUnauthorized="LocationServicesUnauthorized",r.BluetoothScanStartFailed="BluetoothScanStartFailed"})(Je||(Je={}));class V extends Error{constructor(e,t){const n="TransportError";super(e||n),this.name=n,this.message=e,this.stack=new Error(e).stack,this.id=t}}const ee={ACCESS_CONDITION_NOT_FULFILLED:38916,ALGORITHM_NOT_SUPPORTED:38020,CLA_NOT_SUPPORTED:28160,CODE_BLOCKED:38976,CODE_NOT_INITIALIZED:38914,COMMAND_INCOMPATIBLE_FILE_STRUCTURE:27009,CONDITIONS_OF_USE_NOT_SATISFIED:27013,CONTRADICTION_INVALIDATION:38928,CONTRADICTION_SECRET_CODE_STATUS:38920,CUSTOM_IMAGE_BOOTLOADER:26159,CUSTOM_IMAGE_EMPTY:26158,FILE_ALREADY_EXISTS:27273,FILE_NOT_FOUND:37892,GP_AUTH_FAILED:25344,HALTED:28586,INCONSISTENT_FILE:37896,INCORRECT_DATA:27264,INCORRECT_LENGTH:26368,INCORRECT_P1_P2:27392,INS_NOT_SUPPORTED:27904,DEVICE_NOT_ONBOARDED:27911,DEVICE_NOT_ONBOARDED_2:26129,INVALID_KCV:38021,INVALID_OFFSET:37890,LICENSING:28482,LOCKED_DEVICE:21781,MAX_VALUE_REACHED:38992,MEMORY_PROBLEM:37440,MISSING_CRITICAL_PARAMETER:26624,NO_EF_SELECTED:37888,NOT_ENOUGH_MEMORY_SPACE:27268,OK:36864,PIN_REMAINING_ATTEMPTS:25536,REFERENCED_DATA_NOT_FOUND:27272,SECURITY_STATUS_NOT_SATISFIED:27010,TECHNICAL_PROBLEM:28416,UNKNOWN_APDU:27906,USER_REFUSED_ON_DEVICE:21761,NOT_ENOUGH_SPACE:20738};function dr(r){switch(r){case 26368:return"Incorrect length";case 26624:return"Missing critical parameter";case 27010:return"Security not satisfied (dongle locked or have invalid access rights)";case 27013:return"Condition of use not satisfied (denied by the user?)";case 27264:return"Invalid data received";case 27392:return"Invalid parameter received";case 21781:return"Locked device"}if(28416<=r&&r<=28671)return"Internal error, please report"}class le extends Error{constructor(e,{canBeMappedToChildError:t=!0}={}){const n=Object.keys(ee).find(u=>ee[u]===e)||"UNKNOWN_ERROR",s=dr(e)||n,i=e.toString(16),a=`Ledger device: ${s} (0x${i})`;if(super(a),this.name="TransportStatusError",this.statusCode=e,this.statusText=n,Object.setPrototypeOf(this,le.prototype),t&&e===ee.LOCKED_DEVICE)return new Be(a)}}class Be extends le{constructor(e){super(ee.LOCKED_DEVICE,{canBeMappedToChildError:!1}),e&&(this.message=e),this.name="LockedDeviceError",Object.setPrototypeOf(this,Be.prototype)}}let _t=0;const j=[],me=(r,e,t)=>{const n={type:r,id:String(++_t),date:new Date};e&&(n.message=e),t&&(n.data=t),Dt(n)},pr=({type:r,message:e,data:t,context:n})=>{const s={type:r,id:String(++_t),date:new Date};e&&(s.message=e),t&&(s.data=t),n&&(s.context=n),Dt(s)};class ae{constructor(e,t){this.type=e,this.context=t}trace(e,t){pr({type:this.type,message:e,data:t,context:this.context})}getContext(){return this.context}setContext(e){this.context=e}updateContext(e){this.context=Object.assign(Object.assign({},this.context),e)}getType(){return this.type}setType(e){this.type=e}withType(e){return new ae(e,this.context)}withContext(e){return new ae(this.type,e)}withUpdatedContext(e){return new ae(this.type,Object.assign(Object.assign({},this.context),e))}}const Er=r=>(j.push(r),()=>{const e=j.indexOf(r);e!==-1&&(j[e]=j[j.length-1],j.pop())});function Dt(r){for(let e=0;e<j.length;e++)try{j[e](r)}catch(t){console.error(t)}}typeof window<"u"&&(window.__ledgerLogsListen=Er);var he=function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function u(l){try{c(n.next(l))}catch(h){a(h)}}function o(l){try{c(n.throw(l))}catch(h){a(h)}}function c(l){l.done?i(l.value):s(l.value).then(u,o)}c((n=n.apply(r,e||[])).next())})};const mr="transport";class $e{constructor({context:e,logType:t}={}){this.exchangeTimeout=3e4,this.unresponsiveTimeout=15e3,this.deviceModel=null,this._events=new cr,this.send=(n,s,i,a,u=Buffer.alloc(0),o=[ee.OK],{abortTimeoutMs:c}={})=>he(this,void 0,void 0,function*(){const l=this.tracer.withUpdatedContext({function:"send"});if(u.length>=256)throw l.trace("data.length exceeded 256 bytes limit",{dataLength:u.length}),new V("data.length exceed 256 bytes limit. Got: "+u.length,"DataLengthTooBig");l.trace("Starting an exchange",{abortTimeoutMs:c});const h=yield this.exchange(Buffer.concat([Buffer.from([n,s,i,a]),Buffer.from([u.length]),u]),{abortTimeoutMs:c});l.trace("Received response from exchange");const S=h.readUInt16BE(h.length-2);if(!o.some(E=>E===S))throw new le(S);return h}),this._appAPIlock=null,this.tracer=new ae(t??mr,e)}exchange(e,{abortTimeoutMs:t}={}){throw new Error("exchange not implemented")}exchangeBulk(e,t){let n=!1;const s=()=>{n=!0};return he(this,void 0,void 0,function*(){if(!n)for(const a of e){const u=yield this.exchange(a);if(n)return;const o=u.readUInt16BE(u.length-2);if(o!==ee.OK)throw new le(o);t.next(u)}}).then(()=>!n&&t.complete(),a=>!n&&t.error(a)),{unsubscribe:s}}setScrambleKey(e){}close(){return Promise.resolve()}on(e,t){this._events.on(e,t)}off(e,t){this._events.removeListener(e,t)}emit(e,...t){this._events.emit(e,...t)}setDebugMode(){console.warn("setDebugMode is deprecated. use @ledgerhq/logs instead. No logs are emitted in this anymore.")}setExchangeTimeout(e){this.exchangeTimeout=e}setExchangeUnresponsiveTimeout(e){this.unresponsiveTimeout=e}static create(e=3e3,t){return new Promise((n,s)=>{let i=!1;const a=this.listen({next:o=>{i=!0,a&&a.unsubscribe(),u&&clearTimeout(u),this.open(o.descriptor,e).then(n,s)},error:o=>{u&&clearTimeout(u),s(o)},complete:()=>{u&&clearTimeout(u),i||s(new V(this.ErrorMessage_NoDeviceFound,"NoDeviceFound"))}}),u=t?setTimeout(()=>{a.unsubscribe(),s(new V(this.ErrorMessage_ListenTimeout,"ListenTimeout"))},t):null})}exchangeAtomicImpl(e){return he(this,void 0,void 0,function*(){const t=this.tracer.withUpdatedContext({function:"exchangeAtomicImpl",unresponsiveTimeout:this.unresponsiveTimeout});if(this.exchangeBusyPromise)throw t.trace("Atomic exchange is already busy"),new hr("An action was already pending on the Ledger device. Please deny or reconnect.");let n;const s=new Promise(u=>{n=u});this.exchangeBusyPromise=s;let i=!1;const a=setTimeout(()=>{t.trace('Timeout reached, emitting Transport event "unresponsive"',{unresponsiveTimeout:this.unresponsiveTimeout}),i=!0,this.emit("unresponsive")},this.unresponsiveTimeout);try{const u=yield e();return i&&(t.trace("Device was unresponsive, emitting responsive"),this.emit("responsive")),u}finally{t.trace("Finalize, clearing busy guard"),clearTimeout(a),n&&n(),this.exchangeBusyPromise=null}})}decorateAppAPIMethods(e,t,n){for(const s of t)e[s]=this.decorateAppAPIMethod(s,e[s],e,n)}decorateAppAPIMethod(e,t,n,s){return(...i)=>he(this,void 0,void 0,function*(){const{_appAPIlock:a}=this;if(a)return Promise.reject(new V("Ledger Device is busy (lock "+a+")","TransportLocked"));try{return this._appAPIlock=e,this.setScrambleKey(s),yield t.apply(n,i)}finally{this._appAPIlock=null}})}setTraceContext(e){this.tracer=this.tracer.withContext(e)}updateTraceContext(e){this.tracer.updateContext(e)}getTraceContext(){return this.tracer.getContext()}}$e.ErrorMessage_ListenTimeout="No Ledger device found (timeout)";$e.ErrorMessage_NoDeviceFound="No Ledger device found";const Qe=5;function vr(r){const e=Buffer.alloc(2);return e.writeUInt16BE(r,0),e}const gr={data:Buffer.alloc(0),dataLength:0,sequence:0},Ct=(r,e)=>({makeBlocks(t){let n=Buffer.concat([vr(t.length),t]);const s=e-5,i=Math.ceil(n.length/s);n=Buffer.concat([n,Buffer.alloc(i*s-n.length+1).fill(0)]);const a=[];for(let u=0;u<i;u++){const o=Buffer.alloc(5);o.writeUInt16BE(r,0),o.writeUInt8(Qe,2),o.writeUInt16BE(u,3);const c=n.slice(u*s,(u+1)*s);a.push(Buffer.concat([o,c]))}return a},reduceResponse(t,n){let{data:s,dataLength:i,sequence:a}=t||gr;if(n.readUInt16BE(0)!==r)throw new V("Invalid channel","InvalidChannel");if(n.readUInt8(2)!==Qe)throw new V("Invalid tag","InvalidTag");if(n.readUInt16BE(3)!==a)throw new V("Invalid sequence","InvalidSequence");t||(i=n.readUInt16BE(5)),a++;const u=n.slice(t?5:7);return s=Buffer.concat([s,u]),s.length>i&&(s=s.slice(0,i)),{data:s,dataLength:i,sequence:a}},getReducedResult(t){if(t&&t.dataLength===t.data.length)return t.data}});var Ge={exports:{}};const $r="2.0.0",bt=256,Ir=Number.MAX_SAFE_INTEGER||9007199254740991,yr=16,Rr=bt-6,Sr=["major","premajor","minor","preminor","patch","prepatch","prerelease"];var Ie={MAX_LENGTH:bt,MAX_SAFE_COMPONENT_LENGTH:yr,MAX_SAFE_BUILD_LENGTH:Rr,MAX_SAFE_INTEGER:Ir,RELEASE_TYPES:Sr,SEMVER_SPEC_VERSION:$r,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},Ne={};const wr=typeof process=="object"&&Ne&&Ne.NODE_DEBUG&&/\bsemver\b/i.test(Ne.NODE_DEBUG)?(...r)=>console.error("SEMVER",...r):()=>{};var ye=wr;(function(r,e){const{MAX_SAFE_COMPONENT_LENGTH:t,MAX_SAFE_BUILD_LENGTH:n,MAX_LENGTH:s}=Ie,i=ye;e=r.exports={};const a=e.re=[],u=e.safeRe=[],o=e.src=[],c=e.t={};let l=0;const h="[a-zA-Z0-9-]",S=[["\\s",1],["\\d",s],[h,n]],E=M=>{for(const[D,H]of S)M=M.split(`${D}*`).join(`${D}{0,${H}}`).split(`${D}+`).join(`${D}{1,${H}}`);return M},g=(M,D,H)=>{const A=E(D),q=l++;i(M,q,D),c[M]=q,o[q]=D,a[q]=new RegExp(D,H?"g":void 0),u[q]=new RegExp(A,H?"g":void 0)};g("NUMERICIDENTIFIER","0|[1-9]\\d*"),g("NUMERICIDENTIFIERLOOSE","\\d+"),g("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${h}*`),g("MAINVERSION",`(${o[c.NUMERICIDENTIFIER]})\\.(${o[c.NUMERICIDENTIFIER]})\\.(${o[c.NUMERICIDENTIFIER]})`),g("MAINVERSIONLOOSE",`(${o[c.NUMERICIDENTIFIERLOOSE]})\\.(${o[c.NUMERICIDENTIFIERLOOSE]})\\.(${o[c.NUMERICIDENTIFIERLOOSE]})`),g("PRERELEASEIDENTIFIER",`(?:${o[c.NUMERICIDENTIFIER]}|${o[c.NONNUMERICIDENTIFIER]})`),g("PRERELEASEIDENTIFIERLOOSE",`(?:${o[c.NUMERICIDENTIFIERLOOSE]}|${o[c.NONNUMERICIDENTIFIER]})`),g("PRERELEASE",`(?:-(${o[c.PRERELEASEIDENTIFIER]}(?:\\.${o[c.PRERELEASEIDENTIFIER]})*))`),g("PRERELEASELOOSE",`(?:-?(${o[c.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${o[c.PRERELEASEIDENTIFIERLOOSE]})*))`),g("BUILDIDENTIFIER",`${h}+`),g("BUILD",`(?:\\+(${o[c.BUILDIDENTIFIER]}(?:\\.${o[c.BUILDIDENTIFIER]})*))`),g("FULLPLAIN",`v?${o[c.MAINVERSION]}${o[c.PRERELEASE]}?${o[c.BUILD]}?`),g("FULL",`^${o[c.FULLPLAIN]}$`),g("LOOSEPLAIN",`[v=\\s]*${o[c.MAINVERSIONLOOSE]}${o[c.PRERELEASELOOSE]}?${o[c.BUILD]}?`),g("LOOSE",`^${o[c.LOOSEPLAIN]}$`),g("GTLT","((?:<|>)?=?)"),g("XRANGEIDENTIFIERLOOSE",`${o[c.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),g("XRANGEIDENTIFIER",`${o[c.NUMERICIDENTIFIER]}|x|X|\\*`),g("XRANGEPLAIN",`[v=\\s]*(${o[c.XRANGEIDENTIFIER]})(?:\\.(${o[c.XRANGEIDENTIFIER]})(?:\\.(${o[c.XRANGEIDENTIFIER]})(?:${o[c.PRERELEASE]})?${o[c.BUILD]}?)?)?`),g("XRANGEPLAINLOOSE",`[v=\\s]*(${o[c.XRANGEIDENTIFIERLOOSE]})(?:\\.(${o[c.XRANGEIDENTIFIERLOOSE]})(?:\\.(${o[c.XRANGEIDENTIFIERLOOSE]})(?:${o[c.PRERELEASELOOSE]})?${o[c.BUILD]}?)?)?`),g("XRANGE",`^${o[c.GTLT]}\\s*${o[c.XRANGEPLAIN]}$`),g("XRANGELOOSE",`^${o[c.GTLT]}\\s*${o[c.XRANGEPLAINLOOSE]}$`),g("COERCE",`(^|[^\\d])(\\d{1,${t}})(?:\\.(\\d{1,${t}}))?(?:\\.(\\d{1,${t}}))?(?:$|[^\\d])`),g("COERCERTL",o[c.COERCE],!0),g("LONETILDE","(?:~>?)"),g("TILDETRIM",`(\\s*)${o[c.LONETILDE]}\\s+`,!0),e.tildeTrimReplace="$1~",g("TILDE",`^${o[c.LONETILDE]}${o[c.XRANGEPLAIN]}$`),g("TILDELOOSE",`^${o[c.LONETILDE]}${o[c.XRANGEPLAINLOOSE]}$`),g("LONECARET","(?:\\^)"),g("CARETTRIM",`(\\s*)${o[c.LONECARET]}\\s+`,!0),e.caretTrimReplace="$1^",g("CARET",`^${o[c.LONECARET]}${o[c.XRANGEPLAIN]}$`),g("CARETLOOSE",`^${o[c.LONECARET]}${o[c.XRANGEPLAINLOOSE]}$`),g("COMPARATORLOOSE",`^${o[c.GTLT]}\\s*(${o[c.LOOSEPLAIN]})$|^$`),g("COMPARATOR",`^${o[c.GTLT]}\\s*(${o[c.FULLPLAIN]})$|^$`),g("COMPARATORTRIM",`(\\s*)${o[c.GTLT]}\\s*(${o[c.LOOSEPLAIN]}|${o[c.XRANGEPLAIN]})`,!0),e.comparatorTrimReplace="$1$2$3",g("HYPHENRANGE",`^\\s*(${o[c.XRANGEPLAIN]})\\s+-\\s+(${o[c.XRANGEPLAIN]})\\s*$`),g("HYPHENRANGELOOSE",`^\\s*(${o[c.XRANGEPLAINLOOSE]})\\s+-\\s+(${o[c.XRANGEPLAINLOOSE]})\\s*$`),g("STAR","(<|>)?=?\\s*\\*"),g("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),g("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")})(Ge,Ge.exports);var ue=Ge.exports;const Tr=Object.freeze({loose:!0}),Or=Object.freeze({}),Nr=r=>r?typeof r!="object"?Tr:r:Or;var Me=Nr;const et=/^[0-9]+$/,Pt=(r,e)=>{const t=et.test(r),n=et.test(e);return t&&n&&(r=+r,e=+e),r===e?0:t&&!n?-1:n&&!t?1:r<e?-1:1},Ar=(r,e)=>Pt(e,r);var Ut={compareIdentifiers:Pt,rcompareIdentifiers:Ar};const fe=ye,{MAX_LENGTH:tt,MAX_SAFE_INTEGER:de}=Ie,{safeRe:rt,t:nt}=ue,xr=Me,{compareIdentifiers:J}=Ut;let Lr=class U{constructor(e,t){if(t=xr(t),e instanceof U){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>tt)throw new TypeError(`version is longer than ${tt} characters`);fe("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const n=e.trim().match(t.loose?rt[nt.LOOSE]:rt[nt.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>de||this.major<0)throw new TypeError("Invalid major version");if(this.minor>de||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>de||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(s=>{if(/^[0-9]+$/.test(s)){const i=+s;if(i>=0&&i<de)return i}return s}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(fe("SemVer.compare",this.version,this.options,e),!(e instanceof U)){if(typeof e=="string"&&e===this.version)return 0;e=new U(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof U||(e=new U(e,this.options)),J(this.major,e.major)||J(this.minor,e.minor)||J(this.patch,e.patch)}comparePre(e){if(e instanceof U||(e=new U(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const n=this.prerelease[t],s=e.prerelease[t];if(fe("prerelease compare",t,n,s),n===void 0&&s===void 0)return 0;if(s===void 0)return 1;if(n===void 0)return-1;if(n===s)continue;return J(n,s)}while(++t)}compareBuild(e){e instanceof U||(e=new U(e,this.options));let t=0;do{const n=this.build[t],s=e.build[t];if(fe("prerelease compare",t,n,s),n===void 0&&s===void 0)return 0;if(s===void 0)return 1;if(n===void 0)return-1;if(n===s)continue;return J(n,s)}while(++t)}inc(e,t,n){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,n),this.inc("pre",t,n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",t,n),this.inc("pre",t,n);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const s=Number(n)?1:0;if(!t&&n===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[s];else{let i=this.prerelease.length;for(;--i>=0;)typeof this.prerelease[i]=="number"&&(this.prerelease[i]++,i=-2);if(i===-1){if(t===this.prerelease.join(".")&&n===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(s)}}if(t){let i=[t,s];n===!1&&(i=[t]),J(this.prerelease[0],t)===0?isNaN(this.prerelease[1])&&(this.prerelease=i):this.prerelease=i}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};var L=Lr;const st=L,_r=(r,e,t=!1)=>{if(r instanceof st)return r;try{return new st(r,e)}catch(n){if(!t)return null;throw n}};var ne=_r;const Dr=ne,Cr=(r,e)=>{const t=Dr(r,e);return t?t.version:null};var br=Cr;const Pr=ne,Ur=(r,e)=>{const t=Pr(r.trim().replace(/^[=v]+/,""),e);return t?t.version:null};var Gr=Ur;const it=L,Fr=(r,e,t,n,s)=>{typeof t=="string"&&(s=n,n=t,t=void 0);try{return new it(r instanceof it?r.version:r,t).inc(e,n,s).version}catch{return null}};var Br=Fr;const ot=ne,Mr=(r,e)=>{const t=ot(r,null,!0),n=ot(e,null,!0),s=t.compare(n);if(s===0)return null;const i=s>0,a=i?t:n,u=i?n:t,o=!!a.prerelease.length;if(!!u.prerelease.length&&!o)return!u.patch&&!u.minor?"major":a.patch?"patch":a.minor?"minor":"major";const l=o?"pre":"";return t.major!==n.major?l+"major":t.minor!==n.minor?l+"minor":t.patch!==n.patch?l+"patch":"prerelease"};var jr=Mr;const Vr=L,Xr=(r,e)=>new Vr(r,e).major;var zr=Xr;const Hr=L,qr=(r,e)=>new Hr(r,e).minor;var kr=qr;const Kr=L,Yr=(r,e)=>new Kr(r,e).patch;var Wr=Yr;const Zr=ne,Jr=(r,e)=>{const t=Zr(r,e);return t&&t.prerelease.length?t.prerelease:null};var Qr=Jr;const at=L,en=(r,e,t)=>new at(r,t).compare(new at(e,t));var b=en;const tn=b,rn=(r,e,t)=>tn(e,r,t);var nn=rn;const sn=b,on=(r,e)=>sn(r,e,!0);var an=on;const ct=L,cn=(r,e,t)=>{const n=new ct(r,t),s=new ct(e,t);return n.compare(s)||n.compareBuild(s)};var je=cn;const ln=je,un=(r,e)=>r.sort((t,n)=>ln(t,n,e));var hn=un;const fn=je,dn=(r,e)=>r.sort((t,n)=>fn(n,t,e));var pn=dn;const En=b,mn=(r,e,t)=>En(r,e,t)>0;var Re=mn;const vn=b,gn=(r,e,t)=>vn(r,e,t)<0;var Ve=gn;const $n=b,In=(r,e,t)=>$n(r,e,t)===0;var Gt=In;const yn=b,Rn=(r,e,t)=>yn(r,e,t)!==0;var Ft=Rn;const Sn=b,wn=(r,e,t)=>Sn(r,e,t)>=0;var Xe=wn;const Tn=b,On=(r,e,t)=>Tn(r,e,t)<=0;var ze=On;const Nn=Gt,An=Ft,xn=Re,Ln=Xe,_n=Ve,Dn=ze,Cn=(r,e,t,n)=>{switch(e){case"===":return typeof r=="object"&&(r=r.version),typeof t=="object"&&(t=t.version),r===t;case"!==":return typeof r=="object"&&(r=r.version),typeof t=="object"&&(t=t.version),r!==t;case"":case"=":case"==":return Nn(r,t,n);case"!=":return An(r,t,n);case">":return xn(r,t,n);case">=":return Ln(r,t,n);case"<":return _n(r,t,n);case"<=":return Dn(r,t,n);default:throw new TypeError(`Invalid operator: ${e}`)}};var Bt=Cn;const bn=L,Pn=ne,{safeRe:pe,t:Ee}=ue,Un=(r,e)=>{if(r instanceof bn)return r;if(typeof r=="number"&&(r=String(r)),typeof r!="string")return null;e=e||{};let t=null;if(!e.rtl)t=r.match(pe[Ee.COERCE]);else{let n;for(;(n=pe[Ee.COERCERTL].exec(r))&&(!t||t.index+t[0].length!==r.length);)(!t||n.index+n[0].length!==t.index+t[0].length)&&(t=n),pe[Ee.COERCERTL].lastIndex=n.index+n[1].length+n[2].length;pe[Ee.COERCERTL].lastIndex=-1}return t===null?null:Pn(`${t[2]}.${t[3]||"0"}.${t[4]||"0"}`,e)};var Gn=Un,Ae,lt;function Fn(){return lt||(lt=1,Ae=function(r){r.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}),Ae}var Bn=R;R.Node=W;R.create=R;function R(r){var e=this;if(e instanceof R||(e=new R),e.tail=null,e.head=null,e.length=0,r&&typeof r.forEach=="function")r.forEach(function(s){e.push(s)});else if(arguments.length>0)for(var t=0,n=arguments.length;t<n;t++)e.push(arguments[t]);return e}R.prototype.removeNode=function(r){if(r.list!==this)throw new Error("removing node which does not belong to this list");var e=r.next,t=r.prev;return e&&(e.prev=t),t&&(t.next=e),r===this.head&&(this.head=e),r===this.tail&&(this.tail=t),r.list.length--,r.next=null,r.prev=null,r.list=null,e};R.prototype.unshiftNode=function(r){if(r!==this.head){r.list&&r.list.removeNode(r);var e=this.head;r.list=this,r.next=e,e&&(e.prev=r),this.head=r,this.tail||(this.tail=r),this.length++}};R.prototype.pushNode=function(r){if(r!==this.tail){r.list&&r.list.removeNode(r);var e=this.tail;r.list=this,r.prev=e,e&&(e.next=r),this.tail=r,this.head||(this.head=r),this.length++}};R.prototype.push=function(){for(var r=0,e=arguments.length;r<e;r++)jn(this,arguments[r]);return this.length};R.prototype.unshift=function(){for(var r=0,e=arguments.length;r<e;r++)Vn(this,arguments[r]);return this.length};R.prototype.pop=function(){if(this.tail){var r=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,r}};R.prototype.shift=function(){if(this.head){var r=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,r}};R.prototype.forEach=function(r,e){e=e||this;for(var t=this.head,n=0;t!==null;n++)r.call(e,t.value,n,this),t=t.next};R.prototype.forEachReverse=function(r,e){e=e||this;for(var t=this.tail,n=this.length-1;t!==null;n--)r.call(e,t.value,n,this),t=t.prev};R.prototype.get=function(r){for(var e=0,t=this.head;t!==null&&e<r;e++)t=t.next;if(e===r&&t!==null)return t.value};R.prototype.getReverse=function(r){for(var e=0,t=this.tail;t!==null&&e<r;e++)t=t.prev;if(e===r&&t!==null)return t.value};R.prototype.map=function(r,e){e=e||this;for(var t=new R,n=this.head;n!==null;)t.push(r.call(e,n.value,this)),n=n.next;return t};R.prototype.mapReverse=function(r,e){e=e||this;for(var t=new R,n=this.tail;n!==null;)t.push(r.call(e,n.value,this)),n=n.prev;return t};R.prototype.reduce=function(r,e){var t,n=this.head;if(arguments.length>1)t=e;else if(this.head)n=this.head.next,t=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var s=0;n!==null;s++)t=r(t,n.value,s),n=n.next;return t};R.prototype.reduceReverse=function(r,e){var t,n=this.tail;if(arguments.length>1)t=e;else if(this.tail)n=this.tail.prev,t=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var s=this.length-1;n!==null;s--)t=r(t,n.value,s),n=n.prev;return t};R.prototype.toArray=function(){for(var r=new Array(this.length),e=0,t=this.head;t!==null;e++)r[e]=t.value,t=t.next;return r};R.prototype.toArrayReverse=function(){for(var r=new Array(this.length),e=0,t=this.tail;t!==null;e++)r[e]=t.value,t=t.prev;return r};R.prototype.slice=function(r,e){e=e||this.length,e<0&&(e+=this.length),r=r||0,r<0&&(r+=this.length);var t=new R;if(e<r||e<0)return t;r<0&&(r=0),e>this.length&&(e=this.length);for(var n=0,s=this.head;s!==null&&n<r;n++)s=s.next;for(;s!==null&&n<e;n++,s=s.next)t.push(s.value);return t};R.prototype.sliceReverse=function(r,e){e=e||this.length,e<0&&(e+=this.length),r=r||0,r<0&&(r+=this.length);var t=new R;if(e<r||e<0)return t;r<0&&(r=0),e>this.length&&(e=this.length);for(var n=this.length,s=this.tail;s!==null&&n>e;n--)s=s.prev;for(;s!==null&&n>r;n--,s=s.prev)t.push(s.value);return t};R.prototype.splice=function(r,e,...t){r>this.length&&(r=this.length-1),r<0&&(r=this.length+r);for(var n=0,s=this.head;s!==null&&n<r;n++)s=s.next;for(var i=[],n=0;s&&n<e;n++)i.push(s.value),s=this.removeNode(s);s===null&&(s=this.tail),s!==this.head&&s!==this.tail&&(s=s.prev);for(var n=0;n<t.length;n++)s=Mn(this,s,t[n]);return i};R.prototype.reverse=function(){for(var r=this.head,e=this.tail,t=r;t!==null;t=t.prev){var n=t.prev;t.prev=t.next,t.next=n}return this.head=e,this.tail=r,this};function Mn(r,e,t){var n=e===r.head?new W(t,null,e,r):new W(t,e,e.next,r);return n.next===null&&(r.tail=n),n.prev===null&&(r.head=n),r.length++,n}function jn(r,e){r.tail=new W(e,r.tail,null,r),r.head||(r.head=r.tail),r.length++}function Vn(r,e){r.head=new W(e,null,r.head,r),r.tail||(r.tail=r.head),r.length++}function W(r,e,t,n){if(!(this instanceof W))return new W(r,e,t,n);this.list=n,this.value=r,e?(e.next=this,this.prev=e):this.prev=null,t?(t.prev=this,this.next=t):this.next=null}try{Fn()(R)}catch{}const Xn=Bn,K=Symbol("max"),F=Symbol("length"),Q=Symbol("lengthCalculator"),ce=Symbol("allowStale"),Y=Symbol("maxAge"),G=Symbol("dispose"),ut=Symbol("noDisposeOnSet"),N=Symbol("lruList"),C=Symbol("cache"),Mt=Symbol("updateAgeOnGet"),xe=()=>1;class zn{constructor(e){if(typeof e=="number"&&(e={max:e}),e||(e={}),e.max&&(typeof e.max!="number"||e.max<0))throw new TypeError("max must be a non-negative number");this[K]=e.max||1/0;const t=e.length||xe;if(this[Q]=typeof t!="function"?xe:t,this[ce]=e.stale||!1,e.maxAge&&typeof e.maxAge!="number")throw new TypeError("maxAge must be a number");this[Y]=e.maxAge||0,this[G]=e.dispose,this[ut]=e.noDisposeOnSet||!1,this[Mt]=e.updateAgeOnGet||!1,this.reset()}set max(e){if(typeof e!="number"||e<0)throw new TypeError("max must be a non-negative number");this[K]=e||1/0,ie(this)}get max(){return this[K]}set allowStale(e){this[ce]=!!e}get allowStale(){return this[ce]}set maxAge(e){if(typeof e!="number")throw new TypeError("maxAge must be a non-negative number");this[Y]=e,ie(this)}get maxAge(){return this[Y]}set lengthCalculator(e){typeof e!="function"&&(e=xe),e!==this[Q]&&(this[Q]=e,this[F]=0,this[N].forEach(t=>{t.length=this[Q](t.value,t.key),this[F]+=t.length})),ie(this)}get lengthCalculator(){return this[Q]}get length(){return this[F]}get itemCount(){return this[N].length}rforEach(e,t){t=t||this;for(let n=this[N].tail;n!==null;){const s=n.prev;ht(this,e,n,t),n=s}}forEach(e,t){t=t||this;for(let n=this[N].head;n!==null;){const s=n.next;ht(this,e,n,t),n=s}}keys(){return this[N].toArray().map(e=>e.key)}values(){return this[N].toArray().map(e=>e.value)}reset(){this[G]&&this[N]&&this[N].length&&this[N].forEach(e=>this[G](e.key,e.value)),this[C]=new Map,this[N]=new Xn,this[F]=0}dump(){return this[N].map(e=>ve(this,e)?!1:{k:e.key,v:e.value,e:e.now+(e.maxAge||0)}).toArray().filter(e=>e)}dumpLru(){return this[N]}set(e,t,n){if(n=n||this[Y],n&&typeof n!="number")throw new TypeError("maxAge must be a number");const s=n?Date.now():0,i=this[Q](t,e);if(this[C].has(e)){if(i>this[K])return te(this,this[C].get(e)),!1;const o=this[C].get(e).value;return this[G]&&(this[ut]||this[G](e,o.value)),o.now=s,o.maxAge=n,o.value=t,this[F]+=i-o.length,o.length=i,this.get(e),ie(this),!0}const a=new Hn(e,t,i,s,n);return a.length>this[K]?(this[G]&&this[G](e,t),!1):(this[F]+=a.length,this[N].unshift(a),this[C].set(e,this[N].head),ie(this),!0)}has(e){if(!this[C].has(e))return!1;const t=this[C].get(e).value;return!ve(this,t)}get(e){return Le(this,e,!0)}peek(e){return Le(this,e,!1)}pop(){const e=this[N].tail;return e?(te(this,e),e.value):null}del(e){te(this,this[C].get(e))}load(e){this.reset();const t=Date.now();for(let n=e.length-1;n>=0;n--){const s=e[n],i=s.e||0;if(i===0)this.set(s.k,s.v);else{const a=i-t;a>0&&this.set(s.k,s.v,a)}}}prune(){this[C].forEach((e,t)=>Le(this,t,!1))}}const Le=(r,e,t)=>{const n=r[C].get(e);if(n){const s=n.value;if(ve(r,s)){if(te(r,n),!r[ce])return}else t&&(r[Mt]&&(n.value.now=Date.now()),r[N].unshiftNode(n));return s.value}},ve=(r,e)=>{if(!e||!e.maxAge&&!r[Y])return!1;const t=Date.now()-e.now;return e.maxAge?t>e.maxAge:r[Y]&&t>r[Y]},ie=r=>{if(r[F]>r[K])for(let e=r[N].tail;r[F]>r[K]&&e!==null;){const t=e.prev;te(r,e),e=t}},te=(r,e)=>{if(e){const t=e.value;r[G]&&r[G](t.key,t.value),r[F]-=t.length,r[C].delete(t.key),r[N].removeNode(e)}};class Hn{constructor(e,t,n,s,i){this.key=e,this.value=t,this.length=n,this.now=s,this.maxAge=i||0}}const ht=(r,e,t,n)=>{let s=t.value;ve(r,s)&&(te(r,t),r[ce]||(s=void 0)),s&&e.call(n,s.value,s.key,r)};var qn=zn,_e,ft;function P(){if(ft)return _e;ft=1;class r{constructor(f,$){if($=n($),f instanceof r)return f.loose===!!$.loose&&f.includePrerelease===!!$.includePrerelease?f:new r(f.raw,$);if(f instanceof s)return this.raw=f.value,this.set=[[f]],this.format(),this;if(this.options=$,this.loose=!!$.loose,this.includePrerelease=!!$.includePrerelease,this.raw=f.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map(m=>this.parseRange(m.trim())).filter(m=>m.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const m=this.set[0];if(this.set=this.set.filter(v=>!g(v[0])),this.set.length===0)this.set=[m];else if(this.set.length>1){for(const v of this.set)if(v.length===1&&M(v[0])){this.set=[v];break}}}this.format()}format(){return this.range=this.set.map(f=>f.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(f){const m=((this.options.includePrerelease&&S)|(this.options.loose&&E))+":"+f,v=t.get(m);if(v)return v;const p=this.options.loose,I=p?u[o.HYPHENRANGELOOSE]:u[o.HYPHENRANGE];f=f.replace(I,Jt(this.options.includePrerelease)),i("hyphen replace",f),f=f.replace(u[o.COMPARATORTRIM],c),i("comparator trim",f),f=f.replace(u[o.TILDETRIM],l),i("tilde trim",f),f=f.replace(u[o.CARETTRIM],h),i("caret trim",f);let w=f.split(" ").map(O=>H(O,this.options)).join(" ").split(/\s+/).map(O=>Zt(O,this.options));p&&(w=w.filter(O=>(i("loose invalid filter",O,this.options),!!O.match(u[o.COMPARATORLOOSE])))),i("range list",w);const y=new Map,T=w.map(O=>new s(O,this.options));for(const O of T){if(g(O))return[O];y.set(O.value,O)}y.size>1&&y.has("")&&y.delete("");const _=[...y.values()];return t.set(m,_),_}intersects(f,$){if(!(f instanceof r))throw new TypeError("a Range is required");return this.set.some(m=>D(m,$)&&f.set.some(v=>D(v,$)&&m.every(p=>v.every(I=>p.intersects(I,$)))))}test(f){if(!f)return!1;if(typeof f=="string")try{f=new a(f,this.options)}catch{return!1}for(let $=0;$<this.set.length;$++)if(Qt(this.set[$],f,this.options))return!0;return!1}}_e=r;const e=qn,t=new e({max:1e3}),n=Me,s=Se(),i=ye,a=L,{safeRe:u,t:o,comparatorTrimReplace:c,tildeTrimReplace:l,caretTrimReplace:h}=ue,{FLAG_INCLUDE_PRERELEASE:S,FLAG_LOOSE:E}=Ie,g=d=>d.value==="<0.0.0-0",M=d=>d.value==="",D=(d,f)=>{let $=!0;const m=d.slice();let v=m.pop();for(;$&&m.length;)$=m.every(p=>v.intersects(p,f)),v=m.pop();return $},H=(d,f)=>(i("comp",d,f),d=qt(d,f),i("caret",d),d=q(d,f),i("tildes",d),d=Kt(d,f),i("xrange",d),d=Wt(d,f),i("stars",d),d),A=d=>!d||d.toLowerCase()==="x"||d==="*",q=(d,f)=>d.trim().split(/\s+/).map($=>Ht($,f)).join(" "),Ht=(d,f)=>{const $=f.loose?u[o.TILDELOOSE]:u[o.TILDE];return d.replace($,(m,v,p,I,w)=>{i("tilde",d,m,v,p,I,w);let y;return A(v)?y="":A(p)?y=`>=${v}.0.0 <${+v+1}.0.0-0`:A(I)?y=`>=${v}.${p}.0 <${v}.${+p+1}.0-0`:w?(i("replaceTilde pr",w),y=`>=${v}.${p}.${I}-${w} <${v}.${+p+1}.0-0`):y=`>=${v}.${p}.${I} <${v}.${+p+1}.0-0`,i("tilde return",y),y})},qt=(d,f)=>d.trim().split(/\s+/).map($=>kt($,f)).join(" "),kt=(d,f)=>{i("caret",d,f);const $=f.loose?u[o.CARETLOOSE]:u[o.CARET],m=f.includePrerelease?"-0":"";return d.replace($,(v,p,I,w,y)=>{i("caret",d,v,p,I,w,y);let T;return A(p)?T="":A(I)?T=`>=${p}.0.0${m} <${+p+1}.0.0-0`:A(w)?p==="0"?T=`>=${p}.${I}.0${m} <${p}.${+I+1}.0-0`:T=`>=${p}.${I}.0${m} <${+p+1}.0.0-0`:y?(i("replaceCaret pr",y),p==="0"?I==="0"?T=`>=${p}.${I}.${w}-${y} <${p}.${I}.${+w+1}-0`:T=`>=${p}.${I}.${w}-${y} <${p}.${+I+1}.0-0`:T=`>=${p}.${I}.${w}-${y} <${+p+1}.0.0-0`):(i("no pr"),p==="0"?I==="0"?T=`>=${p}.${I}.${w}${m} <${p}.${I}.${+w+1}-0`:T=`>=${p}.${I}.${w}${m} <${p}.${+I+1}.0-0`:T=`>=${p}.${I}.${w} <${+p+1}.0.0-0`),i("caret return",T),T})},Kt=(d,f)=>(i("replaceXRanges",d,f),d.split(/\s+/).map($=>Yt($,f)).join(" ")),Yt=(d,f)=>{d=d.trim();const $=f.loose?u[o.XRANGELOOSE]:u[o.XRANGE];return d.replace($,(m,v,p,I,w,y)=>{i("xRange",d,m,v,p,I,w,y);const T=A(p),_=T||A(I),O=_||A(w),se=O;return v==="="&&se&&(v=""),y=f.includePrerelease?"-0":"",T?v===">"||v==="<"?m="<0.0.0-0":m="*":v&&se?(_&&(I=0),w=0,v===">"?(v=">=",_?(p=+p+1,I=0,w=0):(I=+I+1,w=0)):v==="<="&&(v="<",_?p=+p+1:I=+I+1),v==="<"&&(y="-0"),m=`${v+p}.${I}.${w}${y}`):_?m=`>=${p}.0.0${y} <${+p+1}.0.0-0`:O&&(m=`>=${p}.${I}.0${y} <${p}.${+I+1}.0-0`),i("xRange return",m),m})},Wt=(d,f)=>(i("replaceStars",d,f),d.trim().replace(u[o.STAR],"")),Zt=(d,f)=>(i("replaceGTE0",d,f),d.trim().replace(u[f.includePrerelease?o.GTE0PRE:o.GTE0],"")),Jt=d=>(f,$,m,v,p,I,w,y,T,_,O,se,Li)=>(A(m)?$="":A(v)?$=`>=${m}.0.0${d?"-0":""}`:A(p)?$=`>=${m}.${v}.0${d?"-0":""}`:I?$=`>=${$}`:$=`>=${$}${d?"-0":""}`,A(T)?y="":A(_)?y=`<${+T+1}.0.0-0`:A(O)?y=`<${T}.${+_+1}.0-0`:se?y=`<=${T}.${_}.${O}-${se}`:d?y=`<${T}.${_}.${+O+1}-0`:y=`<=${y}`,`${$} ${y}`.trim()),Qt=(d,f,$)=>{for(let m=0;m<d.length;m++)if(!d[m].test(f))return!1;if(f.prerelease.length&&!$.includePrerelease){for(let m=0;m<d.length;m++)if(i(d[m].semver),d[m].semver!==s.ANY&&d[m].semver.prerelease.length>0){const v=d[m].semver;if(v.major===f.major&&v.minor===f.minor&&v.patch===f.patch)return!0}return!1}return!0};return _e}var De,dt;function Se(){if(dt)return De;dt=1;const r=Symbol("SemVer ANY");class e{static get ANY(){return r}constructor(l,h){if(h=t(h),l instanceof e){if(l.loose===!!h.loose)return l;l=l.value}l=l.trim().split(/\s+/).join(" "),a("comparator",l,h),this.options=h,this.loose=!!h.loose,this.parse(l),this.semver===r?this.value="":this.value=this.operator+this.semver.version,a("comp",this)}parse(l){const h=this.options.loose?n[s.COMPARATORLOOSE]:n[s.COMPARATOR],S=l.match(h);if(!S)throw new TypeError(`Invalid comparator: ${l}`);this.operator=S[1]!==void 0?S[1]:"",this.operator==="="&&(this.operator=""),S[2]?this.semver=new u(S[2],this.options.loose):this.semver=r}toString(){return this.value}test(l){if(a("Comparator.test",l,this.options.loose),this.semver===r||l===r)return!0;if(typeof l=="string")try{l=new u(l,this.options)}catch{return!1}return i(l,this.operator,this.semver,this.options)}intersects(l,h){if(!(l instanceof e))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new o(l.value,h).test(this.value):l.operator===""?l.value===""?!0:new o(this.value,h).test(l.semver):(h=t(h),h.includePrerelease&&(this.value==="<0.0.0-0"||l.value==="<0.0.0-0")||!h.includePrerelease&&(this.value.startsWith("<0.0.0")||l.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&l.operator.startsWith(">")||this.operator.startsWith("<")&&l.operator.startsWith("<")||this.semver.version===l.semver.version&&this.operator.includes("=")&&l.operator.includes("=")||i(this.semver,"<",l.semver,h)&&this.operator.startsWith(">")&&l.operator.startsWith("<")||i(this.semver,">",l.semver,h)&&this.operator.startsWith("<")&&l.operator.startsWith(">")))}}De=e;const t=Me,{safeRe:n,t:s}=ue,i=Bt,a=ye,u=L,o=P();return De}const kn=P(),Kn=(r,e,t)=>{try{e=new kn(e,t)}catch{return!1}return e.test(r)};var we=Kn;const Yn=P(),Wn=(r,e)=>new Yn(r,e).set.map(t=>t.map(n=>n.value).join(" ").trim().split(" "));var Zn=Wn;const Jn=L,Qn=P(),es=(r,e,t)=>{let n=null,s=null,i=null;try{i=new Qn(e,t)}catch{return null}return r.forEach(a=>{i.test(a)&&(!n||s.compare(a)===-1)&&(n=a,s=new Jn(n,t))}),n};var ts=es;const rs=L,ns=P(),ss=(r,e,t)=>{let n=null,s=null,i=null;try{i=new ns(e,t)}catch{return null}return r.forEach(a=>{i.test(a)&&(!n||s.compare(a)===1)&&(n=a,s=new rs(n,t))}),n};var is=ss;const Ce=L,os=P(),pt=Re,as=(r,e)=>{r=new os(r,e);let t=new Ce("0.0.0");if(r.test(t)||(t=new Ce("0.0.0-0"),r.test(t)))return t;t=null;for(let n=0;n<r.set.length;++n){const s=r.set[n];let i=null;s.forEach(a=>{const u=new Ce(a.semver.version);switch(a.operator){case">":u.prerelease.length===0?u.patch++:u.prerelease.push(0),u.raw=u.format();case"":case">=":(!i||pt(u,i))&&(i=u);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${a.operator}`)}}),i&&(!t||pt(t,i))&&(t=i)}return t&&r.test(t)?t:null};var cs=as;const ls=P(),us=(r,e)=>{try{return new ls(r,e).range||"*"}catch{return null}};var hs=us;const fs=L,jt=Se(),{ANY:ds}=jt,ps=P(),Es=we,Et=Re,mt=Ve,ms=ze,vs=Xe,gs=(r,e,t,n)=>{r=new fs(r,n),e=new ps(e,n);let s,i,a,u,o;switch(t){case">":s=Et,i=ms,a=mt,u=">",o=">=";break;case"<":s=mt,i=vs,a=Et,u="<",o="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(Es(r,e,n))return!1;for(let c=0;c<e.set.length;++c){const l=e.set[c];let h=null,S=null;if(l.forEach(E=>{E.semver===ds&&(E=new jt(">=0.0.0")),h=h||E,S=S||E,s(E.semver,h.semver,n)?h=E:a(E.semver,S.semver,n)&&(S=E)}),h.operator===u||h.operator===o||(!S.operator||S.operator===u)&&i(r,S.semver))return!1;if(S.operator===o&&a(r,S.semver))return!1}return!0};var He=gs;const $s=He,Is=(r,e,t)=>$s(r,e,">",t);var ys=Is;const Rs=He,Ss=(r,e,t)=>Rs(r,e,"<",t);var ws=Ss;const vt=P(),Ts=(r,e,t)=>(r=new vt(r,t),e=new vt(e,t),r.intersects(e,t));var Os=Ts;const Ns=we,As=b;var xs=(r,e,t)=>{const n=[];let s=null,i=null;const a=r.sort((l,h)=>As(l,h,t));for(const l of a)Ns(l,e,t)?(i=l,s||(s=l)):(i&&n.push([s,i]),i=null,s=null);s&&n.push([s,null]);const u=[];for(const[l,h]of n)l===h?u.push(l):!h&&l===a[0]?u.push("*"):h?l===a[0]?u.push(`<=${h}`):u.push(`${l} - ${h}`):u.push(`>=${l}`);const o=u.join(" || "),c=typeof e.raw=="string"?e.raw:String(e);return o.length<c.length?o:e};const gt=P(),qe=Se(),{ANY:be}=qe,oe=we,ke=b,Ls=(r,e,t={})=>{if(r===e)return!0;r=new gt(r,t),e=new gt(e,t);let n=!1;e:for(const s of r.set){for(const i of e.set){const a=Ds(s,i,t);if(n=n||a!==null,a)continue e}if(n)return!1}return!0},_s=[new qe(">=0.0.0-0")],$t=[new qe(">=0.0.0")],Ds=(r,e,t)=>{if(r===e)return!0;if(r.length===1&&r[0].semver===be){if(e.length===1&&e[0].semver===be)return!0;t.includePrerelease?r=_s:r=$t}if(e.length===1&&e[0].semver===be){if(t.includePrerelease)return!0;e=$t}const n=new Set;let s,i;for(const E of r)E.operator===">"||E.operator===">="?s=It(s,E,t):E.operator==="<"||E.operator==="<="?i=yt(i,E,t):n.add(E.semver);if(n.size>1)return null;let a;if(s&&i){if(a=ke(s.semver,i.semver,t),a>0)return null;if(a===0&&(s.operator!==">="||i.operator!=="<="))return null}for(const E of n){if(s&&!oe(E,String(s),t)||i&&!oe(E,String(i),t))return null;for(const g of e)if(!oe(E,String(g),t))return!1;return!0}let u,o,c,l,h=i&&!t.includePrerelease&&i.semver.prerelease.length?i.semver:!1,S=s&&!t.includePrerelease&&s.semver.prerelease.length?s.semver:!1;h&&h.prerelease.length===1&&i.operator==="<"&&h.prerelease[0]===0&&(h=!1);for(const E of e){if(l=l||E.operator===">"||E.operator===">=",c=c||E.operator==="<"||E.operator==="<=",s){if(S&&E.semver.prerelease&&E.semver.prerelease.length&&E.semver.major===S.major&&E.semver.minor===S.minor&&E.semver.patch===S.patch&&(S=!1),E.operator===">"||E.operator===">="){if(u=It(s,E,t),u===E&&u!==s)return!1}else if(s.operator===">="&&!oe(s.semver,String(E),t))return!1}if(i){if(h&&E.semver.prerelease&&E.semver.prerelease.length&&E.semver.major===h.major&&E.semver.minor===h.minor&&E.semver.patch===h.patch&&(h=!1),E.operator==="<"||E.operator==="<="){if(o=yt(i,E,t),o===E&&o!==i)return!1}else if(i.operator==="<="&&!oe(i.semver,String(E),t))return!1}if(!E.operator&&(i||s)&&a!==0)return!1}return!(s&&c&&!i&&a!==0||i&&l&&!s&&a!==0||S||h)},It=(r,e,t)=>{if(!r)return e;const n=ke(r.semver,e.semver,t);return n>0?r:n<0||e.operator===">"&&r.operator===">="?e:r},yt=(r,e,t)=>{if(!r)return e;const n=ke(r.semver,e.semver,t);return n<0?r:n>0||e.operator==="<"&&r.operator==="<="?e:r};var Cs=Ls;const Pe=ue,Rt=Ie,bs=L,St=Ut,Ps=ne,Us=br,Gs=Gr,Fs=Br,Bs=jr,Ms=zr,js=kr,Vs=Wr,Xs=Qr,zs=b,Hs=nn,qs=an,ks=je,Ks=hn,Ys=pn,Ws=Re,Zs=Ve,Js=Gt,Qs=Ft,ei=Xe,ti=ze,ri=Bt,ni=Gn,si=Se(),ii=P(),oi=we,ai=Zn,ci=ts,li=is,ui=cs,hi=hs,fi=He,di=ys,pi=ws,Ei=Os,mi=xs,vi=Cs;var gi={parse:Ps,valid:Us,clean:Gs,inc:Fs,diff:Bs,major:Ms,minor:js,patch:Vs,prerelease:Xs,compare:zs,rcompare:Hs,compareLoose:qs,compareBuild:ks,sort:Ks,rsort:Ys,gt:Ws,lt:Zs,eq:Js,neq:Qs,gte:ei,lte:ti,cmp:ri,coerce:ni,Comparator:si,Range:ii,satisfies:oi,toComparators:ai,maxSatisfying:ci,minSatisfying:li,minVersion:ui,validRange:hi,outside:fi,gtr:di,ltr:pi,intersects:Ei,simplifyRange:mi,subset:vi,SemVer:bs,re:Pe.re,src:Pe.src,tokens:Pe.t,SEMVER_SPEC_VERSION:Rt.SEMVER_SPEC_VERSION,RELEASE_TYPES:Rt.RELEASE_TYPES,compareIdentifiers:St.compareIdentifiers,rcompareIdentifiers:St.rcompareIdentifiers};const wt=er(gi);var x;(function(r){r.blue="blue",r.nanoS="nanoS",r.nanoSP="nanoSP",r.nanoX="nanoX",r.stax="stax"})(x||(x={}));const Fe={[x.blue]:{id:x.blue,productName:"Ledger Blue",productIdMM:0,legacyUsbProductId:0,usbOnly:!0,memorySize:480*1024,masks:[822083584,822149120],getBlockSize:r=>4*1024},[x.nanoS]:{id:x.nanoS,productName:"Ledger Nano S",productIdMM:16,legacyUsbProductId:1,usbOnly:!0,memorySize:320*1024,masks:[823132160],getBlockSize:r=>{var e;return wt.lt((e=wt.coerce(r))!==null&&e!==void 0?e:"","2.0.0")?4*1024:2*1024}},[x.nanoSP]:{id:x.nanoSP,productName:"Ledger Nano S Plus",productIdMM:80,legacyUsbProductId:5,usbOnly:!0,memorySize:1533*1024,masks:[856686592],getBlockSize:r=>32},[x.nanoX]:{id:x.nanoX,productName:"Ledger Nano X",productIdMM:64,legacyUsbProductId:4,usbOnly:!1,memorySize:2*1024*1024,masks:[855638016],getBlockSize:r=>4*1024,bluetoothSpec:[{serviceUuid:"13d63400-2c97-0004-0000-4c6564676572",notifyUuid:"13d63400-2c97-0004-0001-4c6564676572",writeUuid:"13d63400-2c97-0004-0002-4c6564676572",writeCmdUuid:"13d63400-2c97-0004-0003-4c6564676572"}]},[x.stax]:{id:x.stax,productName:"Ledger Stax",productIdMM:96,legacyUsbProductId:6,usbOnly:!1,memorySize:1533*1024,masks:[857735168],getBlockSize:r=>32,bluetoothSpec:[{serviceUuid:"13d63400-2c97-6004-0000-4c6564676572",notifyUuid:"13d63400-2c97-6004-0001-4c6564676572",writeUuid:"13d63400-2c97-6004-0002-4c6564676572",writeCmdUuid:"13d63400-2c97-6004-0003-4c6564676572"}]}};x.blue,x.nanoS,x.nanoSP,x.nanoX,x.stax;const Tt=Object.values(Fe),Te=11415,Oe=r=>{const e=Tt.find(s=>s.legacyUsbProductId===r);if(e)return e;const t=r>>8;return Tt.find(s=>s.productIdMM===t)},$i=[],Ot={};for(const r in Fe){const e=Fe[r],{bluetoothSpec:t}=e;if(t)for(let n=0;n<t.length;n++){const s=t[n];$i.push(s.serviceUuid),Ot[s.serviceUuid]=Ot[s.serviceUuid.replace(/-/g,"")]=Object.assign({deviceModel:e},s)}}var B=function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function u(l){try{c(n.next(l))}catch(h){a(h)}}function o(l){try{c(n.throw(l))}catch(h){a(h)}}function c(l){l.done?i(l.value):s(l.value).then(u,o)}c((n=n.apply(r,e||[])).next())})};const Ii=[{vendorId:Te}],yi=()=>Promise.resolve(!!(window.navigator&&window.navigator.hid)),ge=()=>{const{hid:r}=navigator;if(!r)throw new V("navigator.hid is not supported","HIDNotSupported");return r};function Vt(){return B(this,void 0,void 0,function*(){const r=yield ge().requestDevice({filters:Ii});return Array.isArray(r)?r:[r]})}function Ke(){return B(this,void 0,void 0,function*(){return(yield ge().getDevices()).filter(e=>e.vendorId===Te)})}function Ri(){return B(this,void 0,void 0,function*(){const r=yield Ke();return r.length>0?r[0]:(yield Vt())[0]})}class X extends $e{constructor(e){super(),this.channel=Math.floor(Math.random()*65535),this.packetSize=64,this.inputs=[],this.read=()=>this.inputs.length?Promise.resolve(this.inputs.shift()):new Promise(t=>{this.inputCallback=t}),this.onInputReport=t=>{const n=Buffer.from(t.data.buffer);this.inputCallback?(this.inputCallback(n),this.inputCallback=null):this.inputs.push(n)},this._disconnectEmitted=!1,this._emitDisconnect=t=>{this._disconnectEmitted||(this._disconnectEmitted=!0,this.emit("disconnect",t))},this.exchange=t=>B(this,void 0,void 0,function*(){return yield this.exchangeAtomicImpl(()=>B(this,void 0,void 0,function*(){const{channel:s,packetSize:i}=this;me("apdu","=> "+t.toString("hex"));const a=Ct(s,i),u=a.makeBlocks(t);for(let l=0;l<u.length;l++)yield this.device.sendReport(0,u[l]);let o,c;for(;!(o=a.getReducedResult(c));){const l=yield this.read();c=a.reduceResponse(c,l)}return me("apdu","<= "+o.toString("hex")),o})).catch(s=>{throw s&&s.message&&s.message.includes("write")?(this._emitDisconnect(s),new Lt(s.message)):s})}),this.device=e,this.deviceModel=typeof e.productId=="number"?Oe(e.productId):void 0,e.addEventListener("inputreport",this.onInputReport)}static request(){return B(this,void 0,void 0,function*(){const[e]=yield Vt();return X.open(e)})}static openConnected(){return B(this,void 0,void 0,function*(){const e=yield Ke();return e.length===0?null:X.open(e[0])})}static open(e){return B(this,void 0,void 0,function*(){yield e.open();const t=new X(e),n=s=>{e===s.device&&(ge().removeEventListener("disconnect",n),t._emitDisconnect(new xt))};return ge().addEventListener("disconnect",n),t})}close(){return B(this,void 0,void 0,function*(){yield this.exchangeBusyPromise,this.device.removeEventListener("inputreport",this.onInputReport),yield this.device.close()})}setScrambleKey(){}}X.isSupported=yi;X.list=Ke;X.listen=r=>{let e=!1;Ri().then(n=>{if(!n)r.error(new Ue("Access denied to use Ledger device"));else if(!e){const s=typeof n.productId=="number"?Oe(n.productId):void 0;r.next({type:"add",descriptor:n,deviceModel:s}),r.complete()}},n=>{r.error(new Ue(n.message))});function t(){e=!0}return{unsubscribe:t}};var Ye=function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function u(l){try{c(n.next(l))}catch(h){a(h)}}function o(l){try{c(n.throw(l))}catch(h){a(h)}}function c(l){l.done?i(l.value):s(l.value).then(u,o)}c((n=n.apply(r,e||[])).next())})};const Si=[{vendorId:Te}];function Xt(){return Ye(this,void 0,void 0,function*(){return yield navigator.usb.requestDevice({filters:Si})})}function We(){return Ye(this,void 0,void 0,function*(){return(yield navigator.usb.getDevices()).filter(e=>e.vendorId===Te)})}function wi(){return Ye(this,void 0,void 0,function*(){const r=yield We();return r.length>0?r[0]:Xt()})}const Ti=()=>Promise.resolve(!!navigator&&!!navigator.usb&&typeof navigator.usb.getDevices=="function");var k=function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function u(l){try{c(n.next(l))}catch(h){a(h)}}function o(l){try{c(n.throw(l))}catch(h){a(h)}}function c(l){l.done?i(l.value):s(l.value).then(u,o)}c((n=n.apply(r,e||[])).next())})};const Oi=1,Nt=3;class z extends $e{constructor(e,t){super(),this.channel=Math.floor(Math.random()*65535),this.packetSize=64,this._disconnectEmitted=!1,this._emitDisconnect=n=>{this._disconnectEmitted||(this._disconnectEmitted=!0,this.emit("disconnect",n))},this.device=e,this.interfaceNumber=t,this.deviceModel=Oe(e.productId)}static request(){return k(this,void 0,void 0,function*(){const e=yield Xt();return z.open(e)})}static openConnected(){return k(this,void 0,void 0,function*(){const e=yield We();return e.length===0?null:z.open(e[0])})}static open(e){return k(this,void 0,void 0,function*(){yield e.open(),e.configuration===null&&(yield e.selectConfiguration(Oi)),yield At(e);const t=e.configurations[0].interfaces.find(({alternates:a})=>a.some(u=>u.interfaceClass===255));if(!t)throw new Ze("No WebUSB interface found for your Ledger device. Please upgrade firmware or contact techsupport.");const n=t.interfaceNumber;try{yield e.claimInterface(n)}catch(a){throw yield e.close(),new Ze(a.message)}const s=new z(e,n),i=a=>{e===a.device&&(navigator.usb.removeEventListener("disconnect",i),s._emitDisconnect(new xt))};return navigator.usb.addEventListener("disconnect",i),s})}close(){return k(this,void 0,void 0,function*(){yield this.exchangeBusyPromise,yield this.device.releaseInterface(this.interfaceNumber),yield At(this.device),yield this.device.close()})}exchange(e){return k(this,void 0,void 0,function*(){return yield this.exchangeAtomicImpl(()=>k(this,void 0,void 0,function*(){const{channel:n,packetSize:s}=this;me("apdu","=> "+e.toString("hex"));const i=Ct(n,s),a=i.makeBlocks(e);for(let c=0;c<a.length;c++)yield this.device.transferOut(Nt,a[c]);let u,o;for(;!(u=i.getReducedResult(o));){const c=yield this.device.transferIn(Nt,s),l=Buffer.from(c.data.buffer);o=i.reduceResponse(o,l)}return me("apdu","<= "+u.toString("hex")),u})).catch(n=>{throw n&&n.message&&n.message.includes("disconnected")?(this._emitDisconnect(n),new Lt(n.message)):n})})}setScrambleKey(){}}z.isSupported=Ti;z.list=We;z.listen=r=>{let e=!1;wi().then(n=>{if(!e){const s=Oe(n.productId);r.next({type:"add",descriptor:n,deviceModel:s}),r.complete()}},n=>{window.DOMException&&n instanceof window.DOMException&&n.code===18?r.error(new fr(n.message)):r.error(new Ue(n.message))});function t(){e=!0}return{unsubscribe:t}};function At(r){return k(this,void 0,void 0,function*(){try{yield r.reset()}catch(e){console.warn(e)}})}const Ni=async()=>{try{return await z.create()}catch(r){return navigator.hid||alert("Error: "+r),console.log(r),await X.create()}},Ai=async(r,e)=>{const{create_toolkit:t}=await tr(()=>import("./taquito-DQFB5Rhl.js"),__vite__mapDeps([0,1,2,3])),{tezos:n,forger:s}=await t(e.rpc),i=new lr(r,e.derivationPath,void 0,e.derivationType);n.setSignerProvider(i);const a=await n.signer.publicKeyHash(),u=a?await n.rpc.getManagerKey(a):void 0;return{account:a,tezos:n,forger:s,managerKey:u==null?void 0:u.toString()}},{request_ledger_setup:xi}=ir();class zt extends ar{constructor(e,t,n,s,i){super(e,n,s,i),this.transport=t}get AccountType(){return rr.Ledger}get Icon(){return new nr("/assets/svg/ledger-wallet-icon.svg",sr.raw)}get IsAccountSwitchSupported(){return!1}static async create(e,t,n){const s=or[t];if(!s)throw new Error("Invalid network specification!");const{account:i,tezos:a,forger:u,managerKey:o}=await Ai(e,{...n,rpc:(n==null?void 0:n.rpc)??s.rpc});return new zt(i??"",e,a,u,{networkId:t,managerKey:o})}static async create_transport(){return Ni()}static async create_from_cache(){}logout(){this.transport.close()}async switch_wallet(){const e=await xi({networkId:this.NetworkId,rpc:this.Tezos.rpc.getRpcUrl()});if(!e)throw new Error("Aborted.");return e}async vote(e){const t=await this.forge_ballot_op(e),n=async()=>{const s=this.Tezos.wallet.context,i=await this.Tezos.signer.sign(t,new Uint8Array([3])),a=await this.Tezos.rpc.injectOperation(i.sbytes);return s.operationFactory.createOperation(a)};return new Z(n,"Vote",{account:this.Account,ballot:e})}async propose(e){const t=await this.forge_proposals_op(e),n=async()=>{const s=this.Tezos.wallet.context,i=await this.Tezos.signer.sign(t,new Uint8Array([3])),a=await this.Tezos.rpc.injectOperation(i.sbytes);return s.operationFactory.createOperation(a)};return new Z(n,"Propose",{account:this.Account,proposals:e})}async set_deposits_limit(e){const t=await this.forge_set_deposit_op(e),n=async()=>{const s=this.Tezos.wallet.context,i=await this.Tezos.signer.sign(t,new Uint8Array([3])),a=await this.Tezos.rpc.injectOperation(i.sbytes);return s.operationFactory.createOperation(a)};return new Z(n,"Set deposit limit",{account:this.Account,limit:e.toString()})}async update_consensus_key(e){const t=await this.forge_update_consensus_key_op(e),n=async()=>{const s=this.Tezos.wallet.context,i=await this.Tezos.signer.sign(t,new Uint8Array([3])),a=await this.Tezos.rpc.injectOperation(i.sbytes);return s.operationFactory.createOperation(a)};return new Z(n,"Update consensus key",{account:this.Account,"Consensus Key":e})}async restore_consensus_key(){const e=await this.Tezos.signer.publicKey(),t=await this.forge_update_consensus_key_op(e),n=async()=>{const s=this.Tezos.wallet.context,i=await this.Tezos.signer.sign(t,new Uint8Array([3])),a=await this.Tezos.rpc.injectOperation(i.sbytes);return s.operationFactory.createOperation(a)};return new Z(n,"Restore consensus key",{account:this.Account,"Consensus Key":e})}async finalize_unstake(){const e=await this.forge_finalize_unstake(),t=async()=>{const n=this.Tezos.wallet.context,s=await this.Tezos.signer.sign(e,new Uint8Array([3])),i=await this.Tezos.rpc.injectOperation(s.sbytes);return n.operationFactory.createOperation(i)};return new Z(t,"Finalize Unstake",{account:this.Account})}}export{zt as LedgerSession};
