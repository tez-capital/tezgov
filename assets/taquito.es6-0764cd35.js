import{aa as Ga,_ as Ka,af as Q,V as x,ar as tt,as as xe,a2 as R,ae as Cl,ag as us,ah as Ml,ai as so,aj as oo,ak as Dl,al as $l,P as C,Z as Fa,p as Ts,am as ao,M as Ns,an as Bl,ao as qa,U as kl,at as jl,b as Hl,N as Ls,au as za,av as Ce,aw as We,ax as Vl,ay as xs,az as Ul,aA as Ya,aB as Wa,aC as Ja,aD as Gl}from"./main-31999e94.js";import{_ as V}from"./DAppClient-0df61cf3.js";var ls={},Kl={get exports(){return ls},set exports(e){ls=e}},Nn={},Fl={get exports(){return Nn},set exports(e){Nn=e}},Xa=function(t,r){return function(){for(var i=new Array(arguments.length),s=0;s<i.length;s++)i[s]=arguments[s];return t.apply(r,i)}},ql=Xa,nr=Object.prototype.toString;function Cs(e){return Array.isArray(e)}function hs(e){return typeof e>"u"}function zl(e){return e!==null&&!hs(e)&&e.constructor!==null&&!hs(e.constructor)&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)}function Za(e){return nr.call(e)==="[object ArrayBuffer]"}function Yl(e){return nr.call(e)==="[object FormData]"}function Wl(e){var t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&Za(e.buffer),t}function Jl(e){return typeof e=="string"}function Xl(e){return typeof e=="number"}function Qa(e){return e!==null&&typeof e=="object"}function wn(e){if(nr.call(e)!=="[object Object]")return!1;var t=Object.getPrototypeOf(e);return t===null||t===Object.prototype}function Zl(e){return nr.call(e)==="[object Date]"}function Ql(e){return nr.call(e)==="[object File]"}function th(e){return nr.call(e)==="[object Blob]"}function tc(e){return nr.call(e)==="[object Function]"}function eh(e){return Qa(e)&&tc(e.pipe)}function rh(e){return nr.call(e)==="[object URLSearchParams]"}function nh(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function ih(){return typeof navigator<"u"&&(navigator.product==="ReactNative"||navigator.product==="NativeScript"||navigator.product==="NS")?!1:typeof window<"u"&&typeof document<"u"}function Ms(e,t){if(!(e===null||typeof e>"u"))if(typeof e!="object"&&(e=[e]),Cs(e))for(var r=0,n=e.length;r<n;r++)t.call(null,e[r],r,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.call(null,e[i],i,e)}function ps(){var e={};function t(i,s){wn(e[s])&&wn(i)?e[s]=ps(e[s],i):wn(i)?e[s]=ps({},i):Cs(i)?e[s]=i.slice():e[s]=i}for(var r=0,n=arguments.length;r<n;r++)Ms(arguments[r],t);return e}function sh(e,t,r){return Ms(t,function(i,s){r&&typeof i=="function"?e[s]=ql(i,r):e[s]=i}),e}function oh(e){return e.charCodeAt(0)===65279&&(e=e.slice(1)),e}var Pt={isArray:Cs,isArrayBuffer:Za,isBuffer:zl,isFormData:Yl,isArrayBufferView:Wl,isString:Jl,isNumber:Xl,isObject:Qa,isPlainObject:wn,isUndefined:hs,isDate:Zl,isFile:Ql,isBlob:th,isFunction:tc,isStream:eh,isURLSearchParams:rh,isStandardBrowserEnv:ih,forEach:Ms,merge:ps,extend:sh,trim:nh,stripBOM:oh},fr=Pt;function co(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var ec=function(t,r,n){if(!r)return t;var i;if(n)i=n(r);else if(fr.isURLSearchParams(r))i=r.toString();else{var s=[];fr.forEach(r,function(c,d){c===null||typeof c>"u"||(fr.isArray(c)?d=d+"[]":c=[c],fr.forEach(c,function(l){fr.isDate(l)?l=l.toISOString():fr.isObject(l)&&(l=JSON.stringify(l)),s.push(co(d)+"="+co(l))}))}),i=s.join("&")}if(i){var o=t.indexOf("#");o!==-1&&(t=t.slice(0,o)),t+=(t.indexOf("?")===-1?"?":"&")+i}return t},ah=Pt;function si(){this.handlers=[]}si.prototype.use=function(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1};si.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)};si.prototype.forEach=function(t){ah.forEach(this.handlers,function(n){n!==null&&t(n)})};var ch=si,uh=Pt,lh=function(t,r){uh.forEach(t,function(i,s){s!==r&&s.toUpperCase()===r.toUpperCase()&&(t[r]=i,delete t[s])})},rc=function(t,r,n,i,s){return t.config=r,n&&(t.code=n),t.request=i,t.response=s,t.isAxiosError=!0,t.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}},t},nc={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},hh=rc,ic=function(t,r,n,i,s){var o=new Error(t);return hh(o,r,n,i,s)},ph=ic,dh=function(t,r,n){var i=n.config.validateStatus;!n.status||!i||i(n.status)?t(n):r(ph("Request failed with status code "+n.status,n.config,null,n.request,n))},Si,uo;function fh(){if(uo)return Si;uo=1;var e=Pt;return Si=e.isStandardBrowserEnv()?function(){return{write:function(n,i,s,o,a,c){var d=[];d.push(n+"="+encodeURIComponent(i)),e.isNumber(s)&&d.push("expires="+new Date(s).toGMTString()),e.isString(o)&&d.push("path="+o),e.isString(a)&&d.push("domain="+a),c===!0&&d.push("secure"),document.cookie=d.join("; ")},read:function(n){var i=document.cookie.match(new RegExp("(^|;\\s*)("+n+")=([^;]*)"));return i?decodeURIComponent(i[3]):null},remove:function(n){this.write(n,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}(),Si}var gh=function(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)},mh=function(t,r){return r?t.replace(/\/+$/,"")+"/"+r.replace(/^\/+/,""):t},yh=gh,Eh=mh,bh=function(t,r){return t&&!yh(r)?Eh(t,r):r},Ti,lo;function vh(){if(lo)return Ti;lo=1;var e=Pt,t=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];return Ti=function(n){var i={},s,o,a;return n&&e.forEach(n.split(`
`),function(d){if(a=d.indexOf(":"),s=e.trim(d.substr(0,a)).toLowerCase(),o=e.trim(d.substr(a+1)),s){if(i[s]&&t.indexOf(s)>=0)return;s==="set-cookie"?i[s]=(i[s]?i[s]:[]).concat([o]):i[s]=i[s]?i[s]+", "+o:o}}),i},Ti}var Ni,ho;function _h(){if(ho)return Ni;ho=1;var e=Pt;return Ni=e.isStandardBrowserEnv()?function(){var r=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a"),i;function s(o){var a=o;return r&&(n.setAttribute("href",a),a=n.href),n.setAttribute("href",a),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:n.pathname.charAt(0)==="/"?n.pathname:"/"+n.pathname}}return i=s(window.location.href),function(a){var c=e.isString(a)?s(a):a;return c.protocol===i.protocol&&c.host===i.host}}():function(){return function(){return!0}}(),Ni}var Li,po;function oi(){if(po)return Li;po=1;function e(t){this.message=t}return e.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},e.prototype.__CANCEL__=!0,Li=e,Li}var xi,fo;function go(){if(fo)return xi;fo=1;var e=Pt,t=dh,r=fh(),n=ec,i=bh,s=vh(),o=_h(),a=ic,c=nc,d=oi();return xi=function(l){return new Promise(function(_,N){var K=l.data,P=l.headers,w=l.responseType,v;function Kt(){l.cancelToken&&l.cancelToken.unsubscribe(v),l.signal&&l.signal.removeEventListener("abort",v)}e.isFormData(K)&&delete P["Content-Type"];var E=new XMLHttpRequest;if(l.auth){var H=l.auth.username||"",ye=l.auth.password?unescape(encodeURIComponent(l.auth.password)):"";P.Authorization="Basic "+btoa(H+":"+ye)}var mt=i(l.baseURL,l.url);E.open(l.method.toUpperCase(),n(mt,l.params,l.paramsSerializer),!0),E.timeout=l.timeout;function Ft(){if(E){var f="getAllResponseHeaders"in E?s(E.getAllResponseHeaders()):null,O=!w||w==="text"||w==="json"?E.responseText:E.response,I={data:O,status:E.status,statusText:E.statusText,headers:f,config:l,request:E};t(function(D){_(D),Kt()},function(D){N(D),Kt()},I),E=null}}if("onloadend"in E?E.onloadend=Ft:E.onreadystatechange=function(){!E||E.readyState!==4||E.status===0&&!(E.responseURL&&E.responseURL.indexOf("file:")===0)||setTimeout(Ft)},E.onabort=function(){E&&(N(a("Request aborted",l,"ECONNABORTED",E)),E=null)},E.onerror=function(){N(a("Network Error",l,null,E)),E=null},E.ontimeout=function(){var O=l.timeout?"timeout of "+l.timeout+"ms exceeded":"timeout exceeded",I=l.transitional||c;l.timeoutErrorMessage&&(O=l.timeoutErrorMessage),N(a(O,l,I.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",E)),E=null},e.isStandardBrowserEnv()){var $e=(l.withCredentials||o(mt))&&l.xsrfCookieName?r.read(l.xsrfCookieName):void 0;$e&&(P[l.xsrfHeaderName]=$e)}"setRequestHeader"in E&&e.forEach(P,function(O,I){typeof K>"u"&&I.toLowerCase()==="content-type"?delete P[I]:E.setRequestHeader(I,O)}),e.isUndefined(l.withCredentials)||(E.withCredentials=!!l.withCredentials),w&&w!=="json"&&(E.responseType=l.responseType),typeof l.onDownloadProgress=="function"&&E.addEventListener("progress",l.onDownloadProgress),typeof l.onUploadProgress=="function"&&E.upload&&E.upload.addEventListener("progress",l.onUploadProgress),(l.cancelToken||l.signal)&&(v=function(f){E&&(N(!f||f&&f.type?new d("canceled"):f),E.abort(),E=null)},l.cancelToken&&l.cancelToken.subscribe(v),l.signal&&(l.signal.aborted?v():l.signal.addEventListener("abort",v))),K||(K=null),E.send(K)})},xi}var ft=Pt,mo=lh,wh=rc,Ah=nc,Rh={"Content-Type":"application/x-www-form-urlencoded"};function yo(e,t){!ft.isUndefined(e)&&ft.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}function Oh(){var e;return(typeof XMLHttpRequest<"u"||typeof process<"u"&&Object.prototype.toString.call(process)==="[object process]")&&(e=go()),e}function Ph(e,t,r){if(ft.isString(e))try{return(t||JSON.parse)(e),ft.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}var ai={transitional:Ah,adapter:Oh(),transformRequest:[function(t,r){return mo(r,"Accept"),mo(r,"Content-Type"),ft.isFormData(t)||ft.isArrayBuffer(t)||ft.isBuffer(t)||ft.isStream(t)||ft.isFile(t)||ft.isBlob(t)?t:ft.isArrayBufferView(t)?t.buffer:ft.isURLSearchParams(t)?(yo(r,"application/x-www-form-urlencoded;charset=utf-8"),t.toString()):ft.isObject(t)||r&&r["Content-Type"]==="application/json"?(yo(r,"application/json"),Ph(t)):t}],transformResponse:[function(t){var r=this.transitional||ai.transitional,n=r&&r.silentJSONParsing,i=r&&r.forcedJSONParsing,s=!n&&this.responseType==="json";if(s||i&&ft.isString(t)&&t.length)try{return JSON.parse(t)}catch(o){if(s)throw o.name==="SyntaxError"?wh(o,this,"E_JSON_PARSE"):o}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};ft.forEach(["delete","get","head"],function(t){ai.headers[t]={}});ft.forEach(["post","put","patch"],function(t){ai.headers[t]=ft.merge(Rh)});var Ds=ai,Ih=Pt,Sh=Ds,Th=function(t,r,n){var i=this||Sh;return Ih.forEach(n,function(o){t=o.call(i,t,r)}),t},Ci,Eo;function sc(){return Eo||(Eo=1,Ci=function(t){return!!(t&&t.__CANCEL__)}),Ci}var bo=Pt,Mi=Th,Nh=sc(),Lh=Ds,xh=oi();function Di(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new xh("canceled")}var Ch=function(t){Di(t),t.headers=t.headers||{},t.data=Mi.call(t,t.data,t.headers,t.transformRequest),t.headers=bo.merge(t.headers.common||{},t.headers[t.method]||{},t.headers),bo.forEach(["delete","get","head","post","put","patch","common"],function(i){delete t.headers[i]});var r=t.adapter||Lh.adapter;return r(t).then(function(i){return Di(t),i.data=Mi.call(t,i.data,i.headers,t.transformResponse),i},function(i){return Nh(i)||(Di(t),i&&i.response&&(i.response.data=Mi.call(t,i.response.data,i.response.headers,t.transformResponse))),Promise.reject(i)})},Tt=Pt,oc=function(t,r){r=r||{};var n={};function i(p,l){return Tt.isPlainObject(p)&&Tt.isPlainObject(l)?Tt.merge(p,l):Tt.isPlainObject(l)?Tt.merge({},l):Tt.isArray(l)?l.slice():l}function s(p){if(Tt.isUndefined(r[p])){if(!Tt.isUndefined(t[p]))return i(void 0,t[p])}else return i(t[p],r[p])}function o(p){if(!Tt.isUndefined(r[p]))return i(void 0,r[p])}function a(p){if(Tt.isUndefined(r[p])){if(!Tt.isUndefined(t[p]))return i(void 0,t[p])}else return i(void 0,r[p])}function c(p){if(p in r)return i(t[p],r[p]);if(p in t)return i(void 0,t[p])}var d={url:o,method:o,data:o,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:c};return Tt.forEach(Object.keys(t).concat(Object.keys(r)),function(l){var y=d[l]||s,_=y(l);Tt.isUndefined(_)&&y!==c||(n[l]=_)}),n},$i,vo;function ac(){return vo||(vo=1,$i={version:"0.26.1"}),$i}var Mh=ac().version,$s={};["object","boolean","number","function","string","symbol"].forEach(function(e,t){$s[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});var _o={};$s.transitional=function(t,r,n){function i(s,o){return"[Axios v"+Mh+"] Transitional option '"+s+"'"+o+(n?". "+n:"")}return function(s,o,a){if(t===!1)throw new Error(i(o," has been removed"+(r?" in "+r:"")));return r&&!_o[o]&&(_o[o]=!0,console.warn(i(o," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(s,o,a):!0}};function Dh(e,t,r){if(typeof e!="object")throw new TypeError("options must be an object");for(var n=Object.keys(e),i=n.length;i-- >0;){var s=n[i],o=t[s];if(o){var a=e[s],c=a===void 0||o(a,s,e);if(c!==!0)throw new TypeError("option "+s+" must be "+c);continue}if(r!==!0)throw Error("Unknown option "+s)}}var $h={assertOptions:Dh,validators:$s},cc=Pt,Bh=ec,wo=ch,Ao=Ch,ci=oc,uc=$h,gr=uc.validators;function Kr(e){this.defaults=e,this.interceptors={request:new wo,response:new wo}}Kr.prototype.request=function(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=ci(this.defaults,r),r.method?r.method=r.method.toLowerCase():this.defaults.method?r.method=this.defaults.method.toLowerCase():r.method="get";var n=r.transitional;n!==void 0&&uc.assertOptions(n,{silentJSONParsing:gr.transitional(gr.boolean),forcedJSONParsing:gr.transitional(gr.boolean),clarifyTimeoutError:gr.transitional(gr.boolean)},!1);var i=[],s=!0;this.interceptors.request.forEach(function(_){typeof _.runWhen=="function"&&_.runWhen(r)===!1||(s=s&&_.synchronous,i.unshift(_.fulfilled,_.rejected))});var o=[];this.interceptors.response.forEach(function(_){o.push(_.fulfilled,_.rejected)});var a;if(!s){var c=[Ao,void 0];for(Array.prototype.unshift.apply(c,i),c=c.concat(o),a=Promise.resolve(r);c.length;)a=a.then(c.shift(),c.shift());return a}for(var d=r;i.length;){var p=i.shift(),l=i.shift();try{d=p(d)}catch(y){l(y);break}}try{a=Ao(d)}catch(y){return Promise.reject(y)}for(;o.length;)a=a.then(o.shift(),o.shift());return a};Kr.prototype.getUri=function(t){return t=ci(this.defaults,t),Bh(t.url,t.params,t.paramsSerializer).replace(/^\?/,"")};cc.forEach(["delete","get","head","options"],function(t){Kr.prototype[t]=function(r,n){return this.request(ci(n||{},{method:t,url:r,data:(n||{}).data}))}});cc.forEach(["post","put","patch"],function(t){Kr.prototype[t]=function(r,n,i){return this.request(ci(i||{},{method:t,url:r,data:n}))}});var kh=Kr,Bi,Ro;function jh(){if(Ro)return Bi;Ro=1;var e=oi();function t(r){if(typeof r!="function")throw new TypeError("executor must be a function.");var n;this.promise=new Promise(function(o){n=o});var i=this;this.promise.then(function(s){if(i._listeners){var o,a=i._listeners.length;for(o=0;o<a;o++)i._listeners[o](s);i._listeners=null}}),this.promise.then=function(s){var o,a=new Promise(function(c){i.subscribe(c),o=c}).then(s);return a.cancel=function(){i.unsubscribe(o)},a},r(function(o){i.reason||(i.reason=new e(o),n(i.reason))})}return t.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},t.prototype.subscribe=function(n){if(this.reason){n(this.reason);return}this._listeners?this._listeners.push(n):this._listeners=[n]},t.prototype.unsubscribe=function(n){if(this._listeners){var i=this._listeners.indexOf(n);i!==-1&&this._listeners.splice(i,1)}},t.source=function(){var n,i=new t(function(o){n=o});return{token:i,cancel:n}},Bi=t,Bi}var ki,Oo;function Hh(){return Oo||(Oo=1,ki=function(t){return function(n){return t.apply(null,n)}}),ki}var ji,Po;function Vh(){if(Po)return ji;Po=1;var e=Pt;return ji=function(r){return e.isObject(r)&&r.isAxiosError===!0},ji}var Io=Pt,Uh=Xa,An=kh,Gh=oc,Kh=Ds;function lc(e){var t=new An(e),r=Uh(An.prototype.request,t);return Io.extend(r,An.prototype,t),Io.extend(r,t),r.create=function(i){return lc(Gh(e,i))},r}var ge=lc(Kh);ge.Axios=An;ge.Cancel=oi();ge.CancelToken=jh();ge.isCancel=sc();ge.VERSION=ac().version;ge.all=function(t){return Promise.all(t)};ge.spread=Hh();ge.isAxiosError=Vh();Fl.exports=ge;Nn.default=ge;(function(e){e.exports=Nn})(Kl);const So=Ga(ls);function Fh(e,t,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(p){try{d(n.next(p))}catch(l){o(l)}}function c(p){try{d(n.throw(p))}catch(l){o(l)}}function d(p){p.done?s(p.value):i(p.value).then(a,c)}d((n=n.apply(e,t||[])).next())})}var ds;(function(e){e[e.CONTINUE=100]="CONTINUE",e[e.SWITCHING_PROTOCOLS=101]="SWITCHING_PROTOCOLS",e[e.PROCESSING=102]="PROCESSING",e[e.OK=200]="OK",e[e.CREATED=201]="CREATED",e[e.ACCEPTED=202]="ACCEPTED",e[e.NON_AUTHORITATIVE_INFORMATION=203]="NON_AUTHORITATIVE_INFORMATION",e[e.NO_CONTENT=204]="NO_CONTENT",e[e.RESET_CONTENT=205]="RESET_CONTENT",e[e.PARTIAL_CONTENT=206]="PARTIAL_CONTENT",e[e.MULTI_STATUS=207]="MULTI_STATUS",e[e.ALREADY_REPORTED=208]="ALREADY_REPORTED",e[e.IM_USED=226]="IM_USED",e[e.MULTIPLE_CHOICES=300]="MULTIPLE_CHOICES",e[e.MOVED_PERMANENTLY=301]="MOVED_PERMANENTLY",e[e.FOUND=302]="FOUND",e[e.SEE_OTHER=303]="SEE_OTHER",e[e.NOT_MODIFIED=304]="NOT_MODIFIED",e[e.USE_PROXY=305]="USE_PROXY",e[e.SWITCH_PROXY=306]="SWITCH_PROXY",e[e.TEMPORARY_REDIRECT=307]="TEMPORARY_REDIRECT",e[e.PERMANENT_REDIRECT=308]="PERMANENT_REDIRECT",e[e.BAD_REQUEST=400]="BAD_REQUEST",e[e.UNAUTHORIZED=401]="UNAUTHORIZED",e[e.PAYMENT_REQUIRED=402]="PAYMENT_REQUIRED",e[e.FORBIDDEN=403]="FORBIDDEN",e[e.NOT_FOUND=404]="NOT_FOUND",e[e.METHOD_NOT_ALLOWED=405]="METHOD_NOT_ALLOWED",e[e.NOT_ACCEPTABLE=406]="NOT_ACCEPTABLE",e[e.PROXY_AUTHENTICATION_REQUIRED=407]="PROXY_AUTHENTICATION_REQUIRED",e[e.REQUEST_TIMEOUT=408]="REQUEST_TIMEOUT",e[e.CONFLICT=409]="CONFLICT",e[e.GONE=410]="GONE",e[e.LENGTH_REQUIRED=411]="LENGTH_REQUIRED",e[e.PRECONDITION_FAILED=412]="PRECONDITION_FAILED",e[e.PAYLOAD_TOO_LARGE=413]="PAYLOAD_TOO_LARGE",e[e.URI_TOO_LONG=414]="URI_TOO_LONG",e[e.UNSUPPORTED_MEDIA_TYPE=415]="UNSUPPORTED_MEDIA_TYPE",e[e.RANGE_NOT_SATISFIABLE=416]="RANGE_NOT_SATISFIABLE",e[e.EXPECTATION_FAILED=417]="EXPECTATION_FAILED",e[e.I_AM_A_TEAPOT=418]="I_AM_A_TEAPOT",e[e.MISDIRECTED_REQUEST=421]="MISDIRECTED_REQUEST",e[e.UNPROCESSABLE_ENTITY=422]="UNPROCESSABLE_ENTITY",e[e.LOCKED=423]="LOCKED",e[e.FAILED_DEPENDENCY=424]="FAILED_DEPENDENCY",e[e.UPGRADE_REQUIRED=426]="UPGRADE_REQUIRED",e[e.PRECONDITION_REQUIRED=428]="PRECONDITION_REQUIRED",e[e.TOO_MANY_REQUESTS=429]="TOO_MANY_REQUESTS",e[e.REQUEST_HEADER_FIELDS_TOO_LARGE=431]="REQUEST_HEADER_FIELDS_TOO_LARGE",e[e.UNAVAILABLE_FOR_LEGAL_REASONS=451]="UNAVAILABLE_FOR_LEGAL_REASONS",e[e.INTERNAL_SERVER_ERROR=500]="INTERNAL_SERVER_ERROR",e[e.NOT_IMPLEMENTED=501]="NOT_IMPLEMENTED",e[e.BAD_GATEWAY=502]="BAD_GATEWAY",e[e.SERVICE_UNAVAILABLE=503]="SERVICE_UNAVAILABLE",e[e.GATEWAY_TIMEOUT=504]="GATEWAY_TIMEOUT",e[e.HTTP_VERSION_NOT_SUPPORTED=505]="HTTP_VERSION_NOT_SUPPORTED",e[e.VARIANT_ALSO_NEGOTIATES=506]="VARIANT_ALSO_NEGOTIATES",e[e.INSUFFICIENT_STORAGE=507]="INSUFFICIENT_STORAGE",e[e.LOOP_DETECTED=508]="LOOP_DETECTED",e[e.NOT_EXTENDED=510]="NOT_EXTENDED",e[e.NETWORK_AUTHENTICATION_REQUIRED=511]="NETWORK_AUTHENTICATION_REQUIRED"})(ds||(ds={}));const hc=typeof process<"u"&&process.versions!=null&&process.versions.node!=null,To=hc?void 0:Ka(()=>import("./index-de15d168.js"),["assets/index-de15d168.js","assets/main-31999e94.js","assets/index-bf468514.css","assets/DAppClient-0df61cf3.js"]).then(e=>e.default).catch(()=>{});var Ln;(function(e){e.TEXT="text",e.JSON="json"})(Ln||(Ln={}));let pc=class extends Error{constructor(t,r,n,i,s){super(t),this.message=t,this.status=r,this.statusText=n,this.body=i,this.url=s,this.name="HttpResponse"}};class qh extends Error{constructor(t){super(t),this.message=t,this.name="HttpRequestFailed"}}class zh{constructor(t=3e4){this.timeout=t}serialize(t){if(!t)return"";const r=[];for(const i in t)if(t.hasOwnProperty(i)&&typeof t[i]<"u"){const s=typeof t[i].toJSON=="function"?t[i].toJSON():t[i];if(s===null){r.push(encodeURIComponent(i));continue}if(Array.isArray(s)){s.forEach(o=>{r.push(encodeURIComponent(i)+"="+encodeURIComponent(o))});continue}r.push(encodeURIComponent(i)+"="+encodeURIComponent(s))}const n=r.join("&");return n?`?${n}`:""}createRequest({url:t,method:r,timeout:n=this.timeout,query:i,headers:s={},json:o=!0},a){return Fh(this,void 0,void 0,function*(){let c,d;s["Content-Type"]||(s["Content-Type"]="application/json"),o?c=Ln.JSON:(c=Ln.TEXT,d=[p=>p]);try{const p=To&&(yield To);return(yield So.request({url:t+this.serialize(i),method:r??"GET",headers:s,responseType:c,transformResponse:d,timeout:n,data:a,adapter:p})).data}catch(p){if(So.isAxiosError(p)&&p.response||!hc&&p.response){let l;throw typeof p.response.data=="object"?l=JSON.stringify(p.response.data):l=p.response.data,new pc(`Http error response: (${p.response.status}) ${l}`,p.response.status,p.response.statusText,l,t+this.serialize(i))}else throw new qh(`${r} ${t+this.serialize(i)} ${String(p)}`)}})}}function gn(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function L(e,t,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(p){try{d(n.next(p))}catch(l){o(l)}}function c(p){try{d(n.throw(p))}catch(l){o(l)}}function d(p){p.done?s(p.value):i(p.value).then(a,c)}d((n=n.apply(e,t||[])).next())})}const Yh="main",M={block:"head"};var No;(function(e){e.GET_BAKING_RIGHTS="getBakingRights",e.GET_BALLOTS="getBallots",e.GET_BALLOT_LIST="getBallotList",e.GET_BIG_MAP_KEY="getBigMapKey",e.GET_BIG_MAP_EXPR="getBigMapExpr",e.GET_BLOCK_HASH="getBlockHash",e.GET_BLOCK="getBlock",e.GET_BLOCK_HEADER="getBlockHeader",e.GET_BLOCK_METADATA="getBlockMetadata",e.GET_BALANCE="getBalance",e.GET_CHAIN_ID="getChainId",e.GET_CONSTANTS="getConstants",e.GET_CONTRACT="getContract",e.GET_CURRENT_PERIOD="getCurrentPeriod",e.GET_CURRENT_PROPOSAL="getCurrentProposal",e.GET_CURRENT_QUORUM="getCurrentQuorum",e.GET_DELEGATE="getDelegate",e.GET_DELEGATES="getDelegates",e.GET_VOTING_INFO="getVotingInfo",e.GET_ENDORSING_RIGHTS="getEndorsingRights",e.GET_ENTRYPOINTS="getEntrypoints",e.GET_LIVE_BLOCKS="getLiveBlocks",e.GET_MANAGER_KEY="getManagerKey",e.GET_NORMALIZED_SCRIPT="getNormalizedScript",e.GET_PROPOSALS="getProposals",e.GET_PROTOCOLS="getProtocols",e.GET_SAPLING_DIFF_BY_CONTRACT="getSaplingDiffByContract",e.GET_SAPLING_DIFF_BY_ID="getSaplingDiffById",e.GET_SCRIPT="getScript",e.GET_STORAGE="getStorage",e.GET_SUCCESSOR_PERIOD="getSuccessorPeriod",e.GET_TX_ROLLUP_INBOX="getTxRollupInbox",e.GET_TX_ROLLUP_STATE="getTxRollupState",e.GET_VOTES_LISTINGS="getVotesListings",e.PACK_DATA="packData",e.GET_STORAGE_USED_SPACE="getStorageUsedSpace",e.GET_STORAGE_PAID_SPACE="getStoragePaidSpace",e.GET_TICKET_BALANCE="getTicketBalance",e.GET_ALL_TICKET_BALANCES="getAllTicketBalances"})(No||(No={}));function Br(e,t){const r=Array.isArray(e);typeof t>"u"&&(t=Object.keys(e));const n=r?[]:{};return t.forEach(i=>{const s=e[i];let o;if(!(typeof s>"u")){if(Array.isArray(s)){o=Br(s),n[i]=o;return}o=new R(s),n[i]=o}}),n}var Lo;(function(e){e.TOO_LARGE="too large"})(Lo||(Lo={}));var xo;(function(e){e.BAKING_REWARDS="baking rewards",e.REWARDS="rewards",e.FEES="fees",e.DEPOSITS="deposits",e.LEGACY_REWARDS="legacy_rewards",e.LEGACY_FEES="legacy_fees",e.LEGACY_DEPOSITS="legacy_deposits",e.BLOCK_FEES="block fees",e.NONCE_REVELATION_REWARDS="nonce revelation rewards",e.DOUBLE_SIGNING_EVIDENCE_REWARDS="double signing evidence rewards",e.ENDORSING_REWARDS="endorsing rewards",e.BAKING_BONUSES="baking bonuses",e.STORAGE_FEES="storage fees",e.PUNISHMENTS="punishments",e.LOST_ENDORSING_REWARDS="lost endorsing rewards",e.SUBSIDY="subsidy",e.BURNED="burned",e.COMMITMENT="commitment",e.BOOTSTRAP="bootstrap",e.INVOICE="invoice",e.MINTED="minted",e.TX_ROLLUP_REJECTION_REWARDS="tx_rollup_rejection_rewards",e.TX_ROLLUP_REJECTION_PUNISHMENTS="tx_rollup_rejection_punishments",e.BONDS="bonds"})(xo||(xo={}));var b;(function(e){e.ORIGINATION="origination",e.DELEGATION="delegation",e.REVEAL="reveal",e.TRANSACTION="transaction",e.ACTIVATION="activate_account",e.ENDORSEMENT="endorsement",e.PREENDORSEMENT="preendorsement",e.SET_DEPOSITS_LIMIT="set_deposits_limit",e.DOUBLE_PREENDORSEMENT_EVIDENCE="double_preendorsement_evidence",e.ENDORSEMENT_WITH_SLOT="endorsement_with_slot",e.SEED_NONCE_REVELATION="seed_nonce_revelation",e.DOUBLE_ENDORSEMENT_EVIDENCE="double_endorsement_evidence",e.DOUBLE_BAKING_EVIDENCE="double_baking_evidence",e.PROPOSALS="proposals",e.BALLOT="ballot",e.FAILING_NOOP="failing_noop",e.REGISTER_GLOBAL_CONSTANT="register_global_constant",e.TX_ROLLUP_ORIGINATION="tx_rollup_origination",e.TX_ROLLUP_SUBMIT_BATCH="tx_rollup_submit_batch",e.TX_ROLLUP_COMMIT="tx_rollup_commit",e.TX_ROLLUP_RETURN_BOND="tx_rollup_return_bond",e.TX_ROLLUP_FINALIZE_COMMITMENT="tx_rollup_finalize_commitment",e.TX_ROLLUP_REMOVE_COMMITMENT="tx_rollup_remove_commitment",e.TX_ROLLUP_REJECTION="tx_rollup_rejection",e.TX_ROLLUP_DISPATCH_TICKETS="tx_rollup_dispatch_tickets",e.TRANSFER_TICKET="transfer_ticket",e.INCREASE_PAID_STORAGE="increase_paid_storage",e.UPDATE_CONSENSUS_KEY="update_consensus_key",e.DRAIN_DELEGATE="drain_delegate",e.VDF_REVELATION="vdf_revelation",e.EVENT="event",e.TICKET_UPDATES="ticket_updates",e.SMART_ROLLUP_ORIGINATE="smart_rollup_originate",e.SMART_ROLLUP_ADD_MESSAGES="smart_rollup_add_messages",e.SMART_ROLLUP_EXECUTE_OUTBOX_MESSAGE="smart_rollup_execute_outbox_message"})(b||(b={}));class Rn{constructor(t,r=Yh,n=new zh){this.url=t,this.chain=r,this.httpBackend=n}createURL(t){return`${this.url.replace(/\/+$/g,"")}${t}`}validateAddress(t){if(Q(t)!==x.VALID)throw new tt(t)}validateContract(t){if(xe(t)!==x.VALID)throw new tt(t)}getBlockHash({block:t}=M){return L(this,void 0,void 0,function*(){return yield this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${t}/hash`),method:"GET"})})}getLiveBlocks({block:t}=M){return L(this,void 0,void 0,function*(){return yield this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${t}/live_blocks`),method:"GET"})})}getBalance(t,{block:r}=M){return L(this,void 0,void 0,function*(){this.validateAddress(t);const n=yield this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${r}/context/contracts/${t}/balance`),method:"GET"});return new R(n)})}getStorage(t,{block:r}=M){return L(this,void 0,void 0,function*(){return this.validateContract(t),this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${r}/context/contracts/${t}/storage`),method:"GET"})})}getScript(t,{block:r}=M){return L(this,void 0,void 0,function*(){return this.validateContract(t),this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${r}/context/contracts/${t}/script`),method:"GET"})})}getNormalizedScript(t,r={unparsing_mode:"Readable"},{block:n}=M){return L(this,void 0,void 0,function*(){return this.validateContract(t),this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${n}/context/contracts/${t}/script/normalized`),method:"POST"},r)})}getContract(t,{block:r}=M){return L(this,void 0,void 0,function*(){this.validateAddress(t);const n=yield this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${r}/context/contracts/${t}`),method:"GET"});return Object.assign(Object.assign({},n),{balance:new R(n.balance)})})}getManagerKey(t,{block:r}=M){return L(this,void 0,void 0,function*(){return this.validateAddress(t),this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${r}/context/contracts/${t}/manager_key`),method:"GET"})})}getDelegate(t,{block:r}=M){return L(this,void 0,void 0,function*(){this.validateAddress(t);let n;try{n=yield this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${r}/context/contracts/${t}/delegate`),method:"GET"})}catch(i){if(i instanceof pc&&i.status===ds.NOT_FOUND)n=null;else throw i}return n})}getBigMapKey(t,r,{block:n}=M){return L(this,void 0,void 0,function*(){return this.validateAddress(t),this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${n}/context/contracts/${t}/big_map_get`),method:"POST"},r)})}getBigMapExpr(t,r,{block:n}=M){return L(this,void 0,void 0,function*(){return this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${n}/context/big_maps/${t}/${r}`),method:"GET"})})}getDelegates(t,{block:r}=M){return L(this,void 0,void 0,function*(){this.validateAddress(t);const n=yield this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${r}/context/delegates/${t}`),method:"GET"}),i=Br(n,["balance","full_balance","current_frozen_deposits","frozen_deposits","frozen_balance","frozen_deposits_limit","staking_balance","delegated_balance","voting_power"]);return Object.assign(Object.assign(Object.assign({},n),i),{frozen_balance_by_cycle:n.frozen_balance_by_cycle?n.frozen_balance_by_cycle.map(s=>{var{deposit:o,deposits:a,fees:c,rewards:d}=s,p=gn(s,["deposit","deposits","fees","rewards"]);const l=Br({deposit:o,deposits:a,fees:c,rewards:d},["deposit","deposits","fees","rewards"]);return Object.assign(Object.assign({},p),{deposit:l.deposit,deposits:l.deposits,fees:l.fees,rewards:l.rewards})}):void 0})})}getVotingInfo(t,{block:r}=M){return L(this,void 0,void 0,function*(){return this.validateAddress(t),yield this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${r}/context/delegates/${t}/voting_info`),method:"GET"})})}getConstants({block:t}=M){return L(this,void 0,void 0,function*(){const r=yield this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${t}/context/constants`),method:"GET"}),n=Br(r,["time_between_blocks","hard_gas_limit_per_operation","hard_gas_limit_per_block","proof_of_work_threshold","tokens_per_roll","seed_nonce_revelation_tip","block_security_deposit","endorsement_security_deposit","block_reward","endorsement_reward","cost_per_byte","hard_storage_limit_per_operation","test_chain_duration","baking_reward_per_endorsement","delay_per_missing_endorsement","minimal_block_delay","liquidity_baking_subsidy","cache_layout","baking_reward_fixed_portion","baking_reward_bonus_per_slot","endorsing_reward_per_slot","double_baking_punishment","delay_increment_per_round","tx_rollup_commitment_bond","vdf_difficulty","sc_rollup_stake_amount","minimal_stake"]);return Object.assign(Object.assign({},r),n)})}getBlock({block:t}=M){return L(this,void 0,void 0,function*(){return yield this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${t}`),method:"GET"})})}getBlockHeader({block:t}=M){return L(this,void 0,void 0,function*(){return yield this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${t}/header`),method:"GET"})})}getBlockMetadata({block:t}=M){return L(this,void 0,void 0,function*(){return yield this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${t}/metadata`),method:"GET"})})}getBakingRights(t={},{block:r}=M){return L(this,void 0,void 0,function*(){return yield this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${r}/helpers/baking_rights`),method:"GET",query:t})})}getEndorsingRights(t={},{block:r}=M){return L(this,void 0,void 0,function*(){return yield this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${r}/helpers/endorsing_rights`),method:"GET",query:t})})}getBallotList({block:t}=M){return L(this,void 0,void 0,function*(){return yield this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${t}/votes/ballot_list`),method:"GET"})})}getBallots({block:t}=M){return L(this,void 0,void 0,function*(){const r=yield this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${t}/votes/ballots`),method:"GET"});return Br(r,["yay","nay","pass"])})}getCurrentProposal({block:t}=M){return L(this,void 0,void 0,function*(){return yield this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${t}/votes/current_proposal`),method:"GET"})})}getCurrentQuorum({block:t}=M){return L(this,void 0,void 0,function*(){return yield this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${t}/votes/current_quorum`),method:"GET"})})}getVotesListings({block:t}=M){return L(this,void 0,void 0,function*(){const r=yield this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${t}/votes/listings`),method:"GET"});return r.map(n=>(n.voting_power&&(n.voting_power=new R(n.voting_power)),n)),r})}getProposals({block:t}=M){return L(this,void 0,void 0,function*(){const r=yield this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${t}/votes/proposals`),method:"GET"});return r.map(n=>n[1]=new R(n[1])),r})}forgeOperations(t,{block:r}=M){return L(this,void 0,void 0,function*(){return this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${r}/helpers/forge/operations`),method:"POST"},t)})}injectOperation(t){return L(this,void 0,void 0,function*(){return this.httpBackend.createRequest({url:this.createURL("/injection/operation"),method:"POST"},t)})}preapplyOperations(t,{block:r}=M){return L(this,void 0,void 0,function*(){return yield this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${r}/helpers/preapply/operations`),method:"POST"},t)})}getEntrypoints(t,{block:r}=M){return L(this,void 0,void 0,function*(){return this.validateContract(t),yield this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${r}/context/contracts/${t}/entrypoints`),method:"GET"})})}runOperation(t,{block:r}=M){return L(this,void 0,void 0,function*(){return yield this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${r}/helpers/scripts/run_operation`),method:"POST"},t)})}runCode(t,{block:r}=M){return L(this,void 0,void 0,function*(){return yield this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${r}/helpers/scripts/run_code`),method:"POST"},t)})}runScriptView(t,{block:r}=M){var{unparsing_mode:n="Readable"}=t,i=gn(t,["unparsing_mode"]);return L(this,void 0,void 0,function*(){return this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${r}/helpers/scripts/run_script_view`),method:"POST"},Object.assign({unparsing_mode:n},i))})}runView(t,{block:r}=M){var{unparsing_mode:n="Readable"}=t,i=gn(t,["unparsing_mode"]);return L(this,void 0,void 0,function*(){return this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${r}/helpers/scripts/run_view`),method:"POST"},Object.assign({unparsing_mode:n},i))})}getChainId(){return L(this,void 0,void 0,function*(){return this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/chain_id`),method:"GET"})})}packData(t,{block:r}=M){return L(this,void 0,void 0,function*(){const n=yield this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${r}/helpers/scripts/pack_data`),method:"POST"},t),{gas:i}=n,s=gn(n,["gas"]);let o=i;const a=new R(i||"");return a.isNaN()||(o=a),Object.assign({gas:o},s)})}getRpcUrl(){return this.url}getCurrentPeriod({block:t}=M){return L(this,void 0,void 0,function*(){return yield this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${t}/votes/current_period`),method:"GET"})})}getSuccessorPeriod({block:t}=M){return L(this,void 0,void 0,function*(){return yield this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${t}/votes/successor_period`),method:"GET"})})}getSaplingDiffById(t,{block:r}=M){return L(this,void 0,void 0,function*(){return this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${r}/context/sapling/${t}/get_diff`),method:"GET"})})}getSaplingDiffByContract(t,{block:r}=M){return L(this,void 0,void 0,function*(){return this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${r}/context/contracts/${t}/single_sapling_get_diff`),method:"GET"})})}getProtocols({block:t}=M){return L(this,void 0,void 0,function*(){return this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${t}/protocols`),method:"GET"})})}getTxRollupState(t,{block:r}=M){return L(this,void 0,void 0,function*(){return this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${r}/context/tx_rollup/${t}/state`),method:"GET"})})}getTxRollupInbox(t,r,{block:n}=M){return L(this,void 0,void 0,function*(){return this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${n}/context/tx_rollup/${t}/inbox/${r}`),method:"GET"})})}getStorageUsedSpace(t,{block:r}=M){return L(this,void 0,void 0,function*(){return this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${r}/context/contracts/${t}/storage/used_space`),method:"GET"})})}getStoragePaidSpace(t,{block:r}=M){return L(this,void 0,void 0,function*(){return this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${r}/context/contracts/${t}/storage/paid_space`),method:"GET"})})}getTicketBalance(t,r,{block:n}=M){return L(this,void 0,void 0,function*(){return this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${n}/context/contracts/${t}/ticket_balance`),method:"POST"},r)})}getAllTicketBalances(t,{block:r}=M){return L(this,void 0,void 0,function*(){return this.httpBackend.createRequest({url:this.createURL(`/chains/${this.chain}/blocks/${r}/context/contracts/${t}/all_ticket_balances`),method:"GET"})})}}var fs={},Wh={get exports(){return fs},set exports(e){fs=e}},xn={},Jh={get exports(){return xn},set exports(e){xn=e}},dc=function(t,r){return function(){for(var i=new Array(arguments.length),s=0;s<i.length;s++)i[s]=arguments[s];return t.apply(r,i)}},Xh=dc,ir=Object.prototype.toString;function Bs(e){return Array.isArray(e)}function gs(e){return typeof e>"u"}function Zh(e){return e!==null&&!gs(e)&&e.constructor!==null&&!gs(e.constructor)&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)}function fc(e){return ir.call(e)==="[object ArrayBuffer]"}function Qh(e){return ir.call(e)==="[object FormData]"}function tp(e){var t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&fc(e.buffer),t}function ep(e){return typeof e=="string"}function rp(e){return typeof e=="number"}function gc(e){return e!==null&&typeof e=="object"}function On(e){if(ir.call(e)!=="[object Object]")return!1;var t=Object.getPrototypeOf(e);return t===null||t===Object.prototype}function np(e){return ir.call(e)==="[object Date]"}function ip(e){return ir.call(e)==="[object File]"}function sp(e){return ir.call(e)==="[object Blob]"}function mc(e){return ir.call(e)==="[object Function]"}function op(e){return gc(e)&&mc(e.pipe)}function ap(e){return ir.call(e)==="[object URLSearchParams]"}function cp(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function up(){return typeof navigator<"u"&&(navigator.product==="ReactNative"||navigator.product==="NativeScript"||navigator.product==="NS")?!1:typeof window<"u"&&typeof document<"u"}function ks(e,t){if(!(e===null||typeof e>"u"))if(typeof e!="object"&&(e=[e]),Bs(e))for(var r=0,n=e.length;r<n;r++)t.call(null,e[r],r,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.call(null,e[i],i,e)}function ms(){var e={};function t(i,s){On(e[s])&&On(i)?e[s]=ms(e[s],i):On(i)?e[s]=ms({},i):Bs(i)?e[s]=i.slice():e[s]=i}for(var r=0,n=arguments.length;r<n;r++)ks(arguments[r],t);return e}function lp(e,t,r){return ks(t,function(i,s){r&&typeof i=="function"?e[s]=Xh(i,r):e[s]=i}),e}function hp(e){return e.charCodeAt(0)===65279&&(e=e.slice(1)),e}var It={isArray:Bs,isArrayBuffer:fc,isBuffer:Zh,isFormData:Qh,isArrayBufferView:tp,isString:ep,isNumber:rp,isObject:gc,isPlainObject:On,isUndefined:gs,isDate:np,isFile:ip,isBlob:sp,isFunction:mc,isStream:op,isURLSearchParams:ap,isStandardBrowserEnv:up,forEach:ks,merge:ms,extend:lp,trim:cp,stripBOM:hp},mr=It;function Co(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var yc=function(t,r,n){if(!r)return t;var i;if(n)i=n(r);else if(mr.isURLSearchParams(r))i=r.toString();else{var s=[];mr.forEach(r,function(c,d){c===null||typeof c>"u"||(mr.isArray(c)?d=d+"[]":c=[c],mr.forEach(c,function(l){mr.isDate(l)?l=l.toISOString():mr.isObject(l)&&(l=JSON.stringify(l)),s.push(Co(d)+"="+Co(l))}))}),i=s.join("&")}if(i){var o=t.indexOf("#");o!==-1&&(t=t.slice(0,o)),t+=(t.indexOf("?")===-1?"?":"&")+i}return t},pp=It;function ui(){this.handlers=[]}ui.prototype.use=function(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1};ui.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)};ui.prototype.forEach=function(t){pp.forEach(this.handlers,function(n){n!==null&&t(n)})};var dp=ui,fp=It,gp=function(t,r){fp.forEach(t,function(i,s){s!==r&&s.toUpperCase()===r.toUpperCase()&&(t[r]=i,delete t[s])})},Ec=function(t,r,n,i,s){return t.config=r,n&&(t.code=n),t.request=i,t.response=s,t.isAxiosError=!0,t.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}},t},bc={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},mp=Ec,vc=function(t,r,n,i,s){var o=new Error(t);return mp(o,r,n,i,s)},yp=vc,Ep=function(t,r,n){var i=n.config.validateStatus;!n.status||!i||i(n.status)?t(n):r(yp("Request failed with status code "+n.status,n.config,null,n.request,n))},Hi,Mo;function bp(){if(Mo)return Hi;Mo=1;var e=It;return Hi=e.isStandardBrowserEnv()?function(){return{write:function(n,i,s,o,a,c){var d=[];d.push(n+"="+encodeURIComponent(i)),e.isNumber(s)&&d.push("expires="+new Date(s).toGMTString()),e.isString(o)&&d.push("path="+o),e.isString(a)&&d.push("domain="+a),c===!0&&d.push("secure"),document.cookie=d.join("; ")},read:function(n){var i=document.cookie.match(new RegExp("(^|;\\s*)("+n+")=([^;]*)"));return i?decodeURIComponent(i[3]):null},remove:function(n){this.write(n,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}(),Hi}var vp=function(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)},_p=function(t,r){return r?t.replace(/\/+$/,"")+"/"+r.replace(/^\/+/,""):t},wp=vp,Ap=_p,Rp=function(t,r){return t&&!wp(r)?Ap(t,r):r},Vi,Do;function Op(){if(Do)return Vi;Do=1;var e=It,t=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];return Vi=function(n){var i={},s,o,a;return n&&e.forEach(n.split(`
`),function(d){if(a=d.indexOf(":"),s=e.trim(d.substr(0,a)).toLowerCase(),o=e.trim(d.substr(a+1)),s){if(i[s]&&t.indexOf(s)>=0)return;s==="set-cookie"?i[s]=(i[s]?i[s]:[]).concat([o]):i[s]=i[s]?i[s]+", "+o:o}}),i},Vi}var Ui,$o;function Pp(){if($o)return Ui;$o=1;var e=It;return Ui=e.isStandardBrowserEnv()?function(){var r=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a"),i;function s(o){var a=o;return r&&(n.setAttribute("href",a),a=n.href),n.setAttribute("href",a),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:n.pathname.charAt(0)==="/"?n.pathname:"/"+n.pathname}}return i=s(window.location.href),function(a){var c=e.isString(a)?s(a):a;return c.protocol===i.protocol&&c.host===i.host}}():function(){return function(){return!0}}(),Ui}var Gi,Bo;function li(){if(Bo)return Gi;Bo=1;function e(t){this.message=t}return e.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},e.prototype.__CANCEL__=!0,Gi=e,Gi}var Ki,ko;function jo(){if(ko)return Ki;ko=1;var e=It,t=Ep,r=bp(),n=yc,i=Rp,s=Op(),o=Pp(),a=vc,c=bc,d=li();return Ki=function(l){return new Promise(function(_,N){var K=l.data,P=l.headers,w=l.responseType,v;function Kt(){l.cancelToken&&l.cancelToken.unsubscribe(v),l.signal&&l.signal.removeEventListener("abort",v)}e.isFormData(K)&&delete P["Content-Type"];var E=new XMLHttpRequest;if(l.auth){var H=l.auth.username||"",ye=l.auth.password?unescape(encodeURIComponent(l.auth.password)):"";P.Authorization="Basic "+btoa(H+":"+ye)}var mt=i(l.baseURL,l.url);E.open(l.method.toUpperCase(),n(mt,l.params,l.paramsSerializer),!0),E.timeout=l.timeout;function Ft(){if(E){var f="getAllResponseHeaders"in E?s(E.getAllResponseHeaders()):null,O=!w||w==="text"||w==="json"?E.responseText:E.response,I={data:O,status:E.status,statusText:E.statusText,headers:f,config:l,request:E};t(function(D){_(D),Kt()},function(D){N(D),Kt()},I),E=null}}if("onloadend"in E?E.onloadend=Ft:E.onreadystatechange=function(){!E||E.readyState!==4||E.status===0&&!(E.responseURL&&E.responseURL.indexOf("file:")===0)||setTimeout(Ft)},E.onabort=function(){E&&(N(a("Request aborted",l,"ECONNABORTED",E)),E=null)},E.onerror=function(){N(a("Network Error",l,null,E)),E=null},E.ontimeout=function(){var O=l.timeout?"timeout of "+l.timeout+"ms exceeded":"timeout exceeded",I=l.transitional||c;l.timeoutErrorMessage&&(O=l.timeoutErrorMessage),N(a(O,l,I.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",E)),E=null},e.isStandardBrowserEnv()){var $e=(l.withCredentials||o(mt))&&l.xsrfCookieName?r.read(l.xsrfCookieName):void 0;$e&&(P[l.xsrfHeaderName]=$e)}"setRequestHeader"in E&&e.forEach(P,function(O,I){typeof K>"u"&&I.toLowerCase()==="content-type"?delete P[I]:E.setRequestHeader(I,O)}),e.isUndefined(l.withCredentials)||(E.withCredentials=!!l.withCredentials),w&&w!=="json"&&(E.responseType=l.responseType),typeof l.onDownloadProgress=="function"&&E.addEventListener("progress",l.onDownloadProgress),typeof l.onUploadProgress=="function"&&E.upload&&E.upload.addEventListener("progress",l.onUploadProgress),(l.cancelToken||l.signal)&&(v=function(f){E&&(N(!f||f&&f.type?new d("canceled"):f),E.abort(),E=null)},l.cancelToken&&l.cancelToken.subscribe(v),l.signal&&(l.signal.aborted?v():l.signal.addEventListener("abort",v))),K||(K=null),E.send(K)})},Ki}var gt=It,Ho=gp,Ip=Ec,Sp=bc,Tp={"Content-Type":"application/x-www-form-urlencoded"};function Vo(e,t){!gt.isUndefined(e)&&gt.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}function Np(){var e;return(typeof XMLHttpRequest<"u"||typeof process<"u"&&Object.prototype.toString.call(process)==="[object process]")&&(e=jo()),e}function Lp(e,t,r){if(gt.isString(e))try{return(t||JSON.parse)(e),gt.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}var hi={transitional:Sp,adapter:Np(),transformRequest:[function(t,r){return Ho(r,"Accept"),Ho(r,"Content-Type"),gt.isFormData(t)||gt.isArrayBuffer(t)||gt.isBuffer(t)||gt.isStream(t)||gt.isFile(t)||gt.isBlob(t)?t:gt.isArrayBufferView(t)?t.buffer:gt.isURLSearchParams(t)?(Vo(r,"application/x-www-form-urlencoded;charset=utf-8"),t.toString()):gt.isObject(t)||r&&r["Content-Type"]==="application/json"?(Vo(r,"application/json"),Lp(t)):t}],transformResponse:[function(t){var r=this.transitional||hi.transitional,n=r&&r.silentJSONParsing,i=r&&r.forcedJSONParsing,s=!n&&this.responseType==="json";if(s||i&&gt.isString(t)&&t.length)try{return JSON.parse(t)}catch(o){if(s)throw o.name==="SyntaxError"?Ip(o,this,"E_JSON_PARSE"):o}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};gt.forEach(["delete","get","head"],function(t){hi.headers[t]={}});gt.forEach(["post","put","patch"],function(t){hi.headers[t]=gt.merge(Tp)});var js=hi,xp=It,Cp=js,Mp=function(t,r,n){var i=this||Cp;return xp.forEach(n,function(o){t=o.call(i,t,r)}),t},Fi,Uo;function _c(){return Uo||(Uo=1,Fi=function(t){return!!(t&&t.__CANCEL__)}),Fi}var Go=It,qi=Mp,Dp=_c(),$p=js,Bp=li();function zi(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Bp("canceled")}var kp=function(t){zi(t),t.headers=t.headers||{},t.data=qi.call(t,t.data,t.headers,t.transformRequest),t.headers=Go.merge(t.headers.common||{},t.headers[t.method]||{},t.headers),Go.forEach(["delete","get","head","post","put","patch","common"],function(i){delete t.headers[i]});var r=t.adapter||$p.adapter;return r(t).then(function(i){return zi(t),i.data=qi.call(t,i.data,i.headers,t.transformResponse),i},function(i){return Dp(i)||(zi(t),i&&i.response&&(i.response.data=qi.call(t,i.response.data,i.response.headers,t.transformResponse))),Promise.reject(i)})},Nt=It,wc=function(t,r){r=r||{};var n={};function i(p,l){return Nt.isPlainObject(p)&&Nt.isPlainObject(l)?Nt.merge(p,l):Nt.isPlainObject(l)?Nt.merge({},l):Nt.isArray(l)?l.slice():l}function s(p){if(Nt.isUndefined(r[p])){if(!Nt.isUndefined(t[p]))return i(void 0,t[p])}else return i(t[p],r[p])}function o(p){if(!Nt.isUndefined(r[p]))return i(void 0,r[p])}function a(p){if(Nt.isUndefined(r[p])){if(!Nt.isUndefined(t[p]))return i(void 0,t[p])}else return i(void 0,r[p])}function c(p){if(p in r)return i(t[p],r[p]);if(p in t)return i(void 0,t[p])}var d={url:o,method:o,data:o,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:c};return Nt.forEach(Object.keys(t).concat(Object.keys(r)),function(l){var y=d[l]||s,_=y(l);Nt.isUndefined(_)&&y!==c||(n[l]=_)}),n},Yi,Ko;function Ac(){return Ko||(Ko=1,Yi={version:"0.26.1"}),Yi}var jp=Ac().version,Hs={};["object","boolean","number","function","string","symbol"].forEach(function(e,t){Hs[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});var Fo={};Hs.transitional=function(t,r,n){function i(s,o){return"[Axios v"+jp+"] Transitional option '"+s+"'"+o+(n?". "+n:"")}return function(s,o,a){if(t===!1)throw new Error(i(o," has been removed"+(r?" in "+r:"")));return r&&!Fo[o]&&(Fo[o]=!0,console.warn(i(o," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(s,o,a):!0}};function Hp(e,t,r){if(typeof e!="object")throw new TypeError("options must be an object");for(var n=Object.keys(e),i=n.length;i-- >0;){var s=n[i],o=t[s];if(o){var a=e[s],c=a===void 0||o(a,s,e);if(c!==!0)throw new TypeError("option "+s+" must be "+c);continue}if(r!==!0)throw Error("Unknown option "+s)}}var Vp={assertOptions:Hp,validators:Hs},Rc=It,Up=yc,qo=dp,zo=kp,pi=wc,Oc=Vp,yr=Oc.validators;function Fr(e){this.defaults=e,this.interceptors={request:new qo,response:new qo}}Fr.prototype.request=function(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=pi(this.defaults,r),r.method?r.method=r.method.toLowerCase():this.defaults.method?r.method=this.defaults.method.toLowerCase():r.method="get";var n=r.transitional;n!==void 0&&Oc.assertOptions(n,{silentJSONParsing:yr.transitional(yr.boolean),forcedJSONParsing:yr.transitional(yr.boolean),clarifyTimeoutError:yr.transitional(yr.boolean)},!1);var i=[],s=!0;this.interceptors.request.forEach(function(_){typeof _.runWhen=="function"&&_.runWhen(r)===!1||(s=s&&_.synchronous,i.unshift(_.fulfilled,_.rejected))});var o=[];this.interceptors.response.forEach(function(_){o.push(_.fulfilled,_.rejected)});var a;if(!s){var c=[zo,void 0];for(Array.prototype.unshift.apply(c,i),c=c.concat(o),a=Promise.resolve(r);c.length;)a=a.then(c.shift(),c.shift());return a}for(var d=r;i.length;){var p=i.shift(),l=i.shift();try{d=p(d)}catch(y){l(y);break}}try{a=zo(d)}catch(y){return Promise.reject(y)}for(;o.length;)a=a.then(o.shift(),o.shift());return a};Fr.prototype.getUri=function(t){return t=pi(this.defaults,t),Up(t.url,t.params,t.paramsSerializer).replace(/^\?/,"")};Rc.forEach(["delete","get","head","options"],function(t){Fr.prototype[t]=function(r,n){return this.request(pi(n||{},{method:t,url:r,data:(n||{}).data}))}});Rc.forEach(["post","put","patch"],function(t){Fr.prototype[t]=function(r,n,i){return this.request(pi(i||{},{method:t,url:r,data:n}))}});var Gp=Fr,Wi,Yo;function Kp(){if(Yo)return Wi;Yo=1;var e=li();function t(r){if(typeof r!="function")throw new TypeError("executor must be a function.");var n;this.promise=new Promise(function(o){n=o});var i=this;this.promise.then(function(s){if(i._listeners){var o,a=i._listeners.length;for(o=0;o<a;o++)i._listeners[o](s);i._listeners=null}}),this.promise.then=function(s){var o,a=new Promise(function(c){i.subscribe(c),o=c}).then(s);return a.cancel=function(){i.unsubscribe(o)},a},r(function(o){i.reason||(i.reason=new e(o),n(i.reason))})}return t.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},t.prototype.subscribe=function(n){if(this.reason){n(this.reason);return}this._listeners?this._listeners.push(n):this._listeners=[n]},t.prototype.unsubscribe=function(n){if(this._listeners){var i=this._listeners.indexOf(n);i!==-1&&this._listeners.splice(i,1)}},t.source=function(){var n,i=new t(function(o){n=o});return{token:i,cancel:n}},Wi=t,Wi}var Ji,Wo;function Fp(){return Wo||(Wo=1,Ji=function(t){return function(n){return t.apply(null,n)}}),Ji}var Xi,Jo;function qp(){if(Jo)return Xi;Jo=1;var e=It;return Xi=function(r){return e.isObject(r)&&r.isAxiosError===!0},Xi}var Xo=It,zp=dc,Pn=Gp,Yp=wc,Wp=js;function Pc(e){var t=new Pn(e),r=zp(Pn.prototype.request,t);return Xo.extend(r,Pn.prototype,t),Xo.extend(r,t),r.create=function(i){return Pc(Yp(e,i))},r}var me=Pc(Wp);me.Axios=Pn;me.Cancel=li();me.CancelToken=Kp();me.isCancel=_c();me.VERSION=Ac().version;me.all=function(t){return Promise.all(t)};me.spread=Fp();me.isAxiosError=qp();Jh.exports=me;xn.default=me;(function(e){e.exports=xn})(Wh);const y0=Ga(fs);var Cn;(function(e){e[e.CONTINUE=100]="CONTINUE",e[e.SWITCHING_PROTOCOLS=101]="SWITCHING_PROTOCOLS",e[e.PROCESSING=102]="PROCESSING",e[e.OK=200]="OK",e[e.CREATED=201]="CREATED",e[e.ACCEPTED=202]="ACCEPTED",e[e.NON_AUTHORITATIVE_INFORMATION=203]="NON_AUTHORITATIVE_INFORMATION",e[e.NO_CONTENT=204]="NO_CONTENT",e[e.RESET_CONTENT=205]="RESET_CONTENT",e[e.PARTIAL_CONTENT=206]="PARTIAL_CONTENT",e[e.MULTI_STATUS=207]="MULTI_STATUS",e[e.ALREADY_REPORTED=208]="ALREADY_REPORTED",e[e.IM_USED=226]="IM_USED",e[e.MULTIPLE_CHOICES=300]="MULTIPLE_CHOICES",e[e.MOVED_PERMANENTLY=301]="MOVED_PERMANENTLY",e[e.FOUND=302]="FOUND",e[e.SEE_OTHER=303]="SEE_OTHER",e[e.NOT_MODIFIED=304]="NOT_MODIFIED",e[e.USE_PROXY=305]="USE_PROXY",e[e.SWITCH_PROXY=306]="SWITCH_PROXY",e[e.TEMPORARY_REDIRECT=307]="TEMPORARY_REDIRECT",e[e.PERMANENT_REDIRECT=308]="PERMANENT_REDIRECT",e[e.BAD_REQUEST=400]="BAD_REQUEST",e[e.UNAUTHORIZED=401]="UNAUTHORIZED",e[e.PAYMENT_REQUIRED=402]="PAYMENT_REQUIRED",e[e.FORBIDDEN=403]="FORBIDDEN",e[e.NOT_FOUND=404]="NOT_FOUND",e[e.METHOD_NOT_ALLOWED=405]="METHOD_NOT_ALLOWED",e[e.NOT_ACCEPTABLE=406]="NOT_ACCEPTABLE",e[e.PROXY_AUTHENTICATION_REQUIRED=407]="PROXY_AUTHENTICATION_REQUIRED",e[e.REQUEST_TIMEOUT=408]="REQUEST_TIMEOUT",e[e.CONFLICT=409]="CONFLICT",e[e.GONE=410]="GONE",e[e.LENGTH_REQUIRED=411]="LENGTH_REQUIRED",e[e.PRECONDITION_FAILED=412]="PRECONDITION_FAILED",e[e.PAYLOAD_TOO_LARGE=413]="PAYLOAD_TOO_LARGE",e[e.URI_TOO_LONG=414]="URI_TOO_LONG",e[e.UNSUPPORTED_MEDIA_TYPE=415]="UNSUPPORTED_MEDIA_TYPE",e[e.RANGE_NOT_SATISFIABLE=416]="RANGE_NOT_SATISFIABLE",e[e.EXPECTATION_FAILED=417]="EXPECTATION_FAILED",e[e.I_AM_A_TEAPOT=418]="I_AM_A_TEAPOT",e[e.MISDIRECTED_REQUEST=421]="MISDIRECTED_REQUEST",e[e.UNPROCESSABLE_ENTITY=422]="UNPROCESSABLE_ENTITY",e[e.LOCKED=423]="LOCKED",e[e.FAILED_DEPENDENCY=424]="FAILED_DEPENDENCY",e[e.UPGRADE_REQUIRED=426]="UPGRADE_REQUIRED",e[e.PRECONDITION_REQUIRED=428]="PRECONDITION_REQUIRED",e[e.TOO_MANY_REQUESTS=429]="TOO_MANY_REQUESTS",e[e.REQUEST_HEADER_FIELDS_TOO_LARGE=431]="REQUEST_HEADER_FIELDS_TOO_LARGE",e[e.UNAVAILABLE_FOR_LEGAL_REASONS=451]="UNAVAILABLE_FOR_LEGAL_REASONS",e[e.INTERNAL_SERVER_ERROR=500]="INTERNAL_SERVER_ERROR",e[e.NOT_IMPLEMENTED=501]="NOT_IMPLEMENTED",e[e.BAD_GATEWAY=502]="BAD_GATEWAY",e[e.SERVICE_UNAVAILABLE=503]="SERVICE_UNAVAILABLE",e[e.GATEWAY_TIMEOUT=504]="GATEWAY_TIMEOUT",e[e.HTTP_VERSION_NOT_SUPPORTED=505]="HTTP_VERSION_NOT_SUPPORTED",e[e.VARIANT_ALSO_NEGOTIATES=506]="VARIANT_ALSO_NEGOTIATES",e[e.INSUFFICIENT_STORAGE=507]="INSUFFICIENT_STORAGE",e[e.LOOP_DETECTED=508]="LOOP_DETECTED",e[e.NOT_EXTENDED=510]="NOT_EXTENDED",e[e.NETWORK_AUTHENTICATION_REQUIRED=511]="NETWORK_AUTHENTICATION_REQUIRED"})(Cn||(Cn={}));const Jp=typeof process<"u"&&process.versions!=null&&process.versions.node!=null;Jp||Ka(()=>import("./index-3f946520.js"),["assets/index-3f946520.js","assets/main-31999e94.js","assets/index-bf468514.css","assets/DAppClient-0df61cf3.js"]).then(e=>e.default).catch(()=>{});var Zo;(function(e){e.TEXT="text",e.JSON="json"})(Zo||(Zo={}));class di extends Error{constructor(t,r,n,i,s){super(t),this.message=t,this.status=r,this.statusText=n,this.body=i,this.url=s,this.name="HttpResponse"}}function Mn(e){return typeof e=="function"}var Qo=!1,ce={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){if(e){var t=new Error;""+t.stack}Qo=e},get useDeprecatedSynchronousErrorHandling(){return Qo}};function br(e){setTimeout(function(){throw e},0)}var Dn={closed:!0,next:function(e){},error:function(e){if(ce.useDeprecatedSynchronousErrorHandling)throw e;br(e)},complete:function(){}},Vs=function(){return Array.isArray||function(e){return e&&typeof e.length=="number"}}();function Ic(e){return e!==null&&typeof e=="object"}var Xp=function(){function e(t){return Error.call(this),this.message=t?t.length+` errors occurred during unsubscription:
`+t.map(function(r,n){return n+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=t,this}return e.prototype=Object.create(Error.prototype),e}(),In=Xp,jt=function(){function e(t){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._ctorUnsubscribe=!0,this._unsubscribe=t)}return e.prototype.unsubscribe=function(){var t;if(!this.closed){var r=this,n=r._parentOrParents,i=r._ctorUnsubscribe,s=r._unsubscribe,o=r._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,n instanceof e)n.remove(this);else if(n!==null)for(var a=0;a<n.length;++a){var c=n[a];c.remove(this)}if(Mn(s)){i&&(this._unsubscribe=void 0);try{s.call(this)}catch(l){t=l instanceof In?ta(l.errors):[l]}}if(Vs(o))for(var a=-1,d=o.length;++a<d;){var p=o[a];if(Ic(p))try{p.unsubscribe()}catch(y){t=t||[],y instanceof In?t=t.concat(ta(y.errors)):t.push(y)}}if(t)throw new In(t)}},e.prototype.add=function(t){var r=t;if(!t)return e.EMPTY;switch(typeof t){case"function":r=new e(t);case"object":if(r===this||r.closed||typeof r.unsubscribe!="function")return r;if(this.closed)return r.unsubscribe(),r;if(!(r instanceof e)){var n=r;r=new e,r._subscriptions=[n]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}var i=r._parentOrParents;if(i===null)r._parentOrParents=this;else if(i instanceof e){if(i===this)return r;r._parentOrParents=[i,this]}else if(i.indexOf(this)===-1)i.push(this);else return r;var s=this._subscriptions;return s===null?this._subscriptions=[r]:s.push(r),r},e.prototype.remove=function(t){var r=this._subscriptions;if(r){var n=r.indexOf(t);n!==-1&&r.splice(n,1)}},e.EMPTY=function(t){return t.closed=!0,t}(new e),e}();function ta(e){return e.reduce(function(t,r){return t.concat(r instanceof In?r.errors:r)},[])}var $n=function(){return typeof Symbol=="function"?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),st=function(e){V(t,e);function t(r,n,i){var s=e.call(this)||this;switch(s.syncErrorValue=null,s.syncErrorThrown=!1,s.syncErrorThrowable=!1,s.isStopped=!1,arguments.length){case 0:s.destination=Dn;break;case 1:if(!r){s.destination=Dn;break}if(typeof r=="object"){r instanceof t?(s.syncErrorThrowable=r.syncErrorThrowable,s.destination=r,r.add(s)):(s.syncErrorThrowable=!0,s.destination=new ea(s,r));break}default:s.syncErrorThrowable=!0,s.destination=new ea(s,r,n,i);break}return s}return t.prototype[$n]=function(){return this},t.create=function(r,n,i){var s=new t(r,n,i);return s.syncErrorThrowable=!1,s},t.prototype.next=function(r){this.isStopped||this._next(r)},t.prototype.error=function(r){this.isStopped||(this.isStopped=!0,this._error(r))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this))},t.prototype._next=function(r){this.destination.next(r)},t.prototype._error=function(r){this.destination.error(r),this.unsubscribe()},t.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},t.prototype._unsubscribeAndRecycle=function(){var r=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=r,this},t}(jt),ea=function(e){V(t,e);function t(r,n,i,s){var o=e.call(this)||this;o._parentSubscriber=r;var a,c=o;return Mn(n)?a=n:n&&(a=n.next,i=n.error,s=n.complete,n!==Dn&&(c=Object.create(n),Mn(c.unsubscribe)&&o.add(c.unsubscribe.bind(c)),c.unsubscribe=o.unsubscribe.bind(o))),o._context=c,o._next=a,o._error=i,o._complete=s,o}return t.prototype.next=function(r){if(!this.isStopped&&this._next){var n=this._parentSubscriber;!ce.useDeprecatedSynchronousErrorHandling||!n.syncErrorThrowable?this.__tryOrUnsub(this._next,r):this.__tryOrSetError(n,this._next,r)&&this.unsubscribe()}},t.prototype.error=function(r){if(!this.isStopped){var n=this._parentSubscriber,i=ce.useDeprecatedSynchronousErrorHandling;if(this._error)!i||!n.syncErrorThrowable?(this.__tryOrUnsub(this._error,r),this.unsubscribe()):(this.__tryOrSetError(n,this._error,r),this.unsubscribe());else if(n.syncErrorThrowable)i?(n.syncErrorValue=r,n.syncErrorThrown=!0):br(r),this.unsubscribe();else{if(this.unsubscribe(),i)throw r;br(r)}}},t.prototype.complete=function(){var r=this;if(!this.isStopped){var n=this._parentSubscriber;if(this._complete){var i=function(){return r._complete.call(r._context)};!ce.useDeprecatedSynchronousErrorHandling||!n.syncErrorThrowable?(this.__tryOrUnsub(i),this.unsubscribe()):(this.__tryOrSetError(n,i),this.unsubscribe())}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(r,n){try{r.call(this._context,n)}catch(i){if(this.unsubscribe(),ce.useDeprecatedSynchronousErrorHandling)throw i;br(i)}},t.prototype.__tryOrSetError=function(r,n,i){if(!ce.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{n.call(this._context,i)}catch(s){return ce.useDeprecatedSynchronousErrorHandling?(r.syncErrorValue=s,r.syncErrorThrown=!0,!0):(br(s),!0)}return!1},t.prototype._unsubscribe=function(){var r=this._parentSubscriber;this._context=null,this._parentSubscriber=null,r.unsubscribe()},t}(st);function Zp(e){for(;e;){var t=e,r=t.closed,n=t.destination,i=t.isStopped;if(r||i)return!1;n&&n instanceof st?e=n:e=null}return!0}function Qp(e,t,r){if(e){if(e instanceof st)return e;if(e[$n])return e[$n]()}return!e&&!t&&!r?new st(Dn):new st(e,t,r)}var qr=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function Us(e){return e}function td(e){return e.length===0?Us:e.length===1?e[0]:function(r){return e.reduce(function(n,i){return i(n)},r)}}var nt=function(){function e(t){this._isScalar=!1,t&&(this._subscribe=t)}return e.prototype.lift=function(t){var r=new e;return r.source=this,r.operator=t,r},e.prototype.subscribe=function(t,r,n){var i=this.operator,s=Qp(t,r,n);if(i?s.add(i.call(s,this.source)):s.add(this.source||ce.useDeprecatedSynchronousErrorHandling&&!s.syncErrorThrowable?this._subscribe(s):this._trySubscribe(s)),ce.useDeprecatedSynchronousErrorHandling&&s.syncErrorThrowable&&(s.syncErrorThrowable=!1,s.syncErrorThrown))throw s.syncErrorValue;return s},e.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(r){ce.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=r),Zp(t)?t.error(r):console.warn(r)}},e.prototype.forEach=function(t,r){var n=this;return r=ra(r),new r(function(i,s){var o;o=n.subscribe(function(a){try{t(a)}catch(c){s(c),o&&o.unsubscribe()}},s,i)})},e.prototype._subscribe=function(t){var r=this.source;return r&&r.subscribe(t)},e.prototype[qr]=function(){return this},e.prototype.pipe=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return t.length===0?this:td(t)(this)},e.prototype.toPromise=function(t){var r=this;return t=ra(t),new t(function(n,i){var s;r.subscribe(function(o){return s=o},function(o){return i(o)},function(){return n(s)})})},e.create=function(t){return new e(t)},e}();function ra(e){if(e||(e=Promise),!e)throw new Error("no Promise impl found");return e}var ed=function(){function e(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return e.prototype=Object.create(Error.prototype),e}(),sr=ed,Sc=function(e){V(t,e);function t(r,n){var i=e.call(this)||this;return i.subject=r,i.subscriber=n,i.closed=!1,i}return t.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var r=this.subject,n=r.observers;if(this.subject=null,!(!n||n.length===0||r.isStopped||r.closed)){var i=n.indexOf(this.subscriber);i!==-1&&n.splice(i,1)}}},t}(jt),Tc=function(e){V(t,e);function t(r){var n=e.call(this,r)||this;return n.destination=r,n}return t}(st),Pr=function(e){V(t,e);function t(){var r=e.call(this)||this;return r.observers=[],r.closed=!1,r.isStopped=!1,r.hasError=!1,r.thrownError=null,r}return t.prototype[$n]=function(){return new Tc(this)},t.prototype.lift=function(r){var n=new na(this,this);return n.operator=r,n},t.prototype.next=function(r){if(this.closed)throw new sr;if(!this.isStopped)for(var n=this.observers,i=n.length,s=n.slice(),o=0;o<i;o++)s[o].next(r)},t.prototype.error=function(r){if(this.closed)throw new sr;this.hasError=!0,this.thrownError=r,this.isStopped=!0;for(var n=this.observers,i=n.length,s=n.slice(),o=0;o<i;o++)s[o].error(r);this.observers.length=0},t.prototype.complete=function(){if(this.closed)throw new sr;this.isStopped=!0;for(var r=this.observers,n=r.length,i=r.slice(),s=0;s<n;s++)i[s].complete();this.observers.length=0},t.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},t.prototype._trySubscribe=function(r){if(this.closed)throw new sr;return e.prototype._trySubscribe.call(this,r)},t.prototype._subscribe=function(r){if(this.closed)throw new sr;return this.hasError?(r.error(this.thrownError),jt.EMPTY):this.isStopped?(r.complete(),jt.EMPTY):(this.observers.push(r),new Sc(this,r))},t.prototype.asObservable=function(){var r=new nt;return r.source=this,r},t.create=function(r,n){return new na(r,n)},t}(nt),na=function(e){V(t,e);function t(r,n){var i=e.call(this)||this;return i.destination=r,i.source=n,i}return t.prototype.next=function(r){var n=this.destination;n&&n.next&&n.next(r)},t.prototype.error=function(r){var n=this.destination;n&&n.error&&this.destination.error(r)},t.prototype.complete=function(){var r=this.destination;r&&r.complete&&this.destination.complete()},t.prototype._subscribe=function(r){var n=this.source;return n?this.source.subscribe(r):jt.EMPTY},t}(Pr);function jr(){return function(t){return t.lift(new rd(t))}}var rd=function(){function e(t){this.connectable=t}return e.prototype.call=function(t,r){var n=this.connectable;n._refCount++;var i=new nd(t,n),s=r.subscribe(i);return i.closed||(i.connection=n.connect()),s},e}(),nd=function(e){V(t,e);function t(r,n){var i=e.call(this,r)||this;return i.connectable=n,i}return t.prototype._unsubscribe=function(){var r=this.connectable;if(!r){this.connection=null;return}this.connectable=null;var n=r._refCount;if(n<=0){this.connection=null;return}if(r._refCount=n-1,n>1){this.connection=null;return}var i=this.connection,s=r._connection;this.connection=null,s&&(!i||s===i)&&s.unsubscribe()},t}(st),id=function(e){V(t,e);function t(r,n){var i=e.call(this)||this;return i.source=r,i.subjectFactory=n,i._refCount=0,i._isComplete=!1,i}return t.prototype._subscribe=function(r){return this.getSubject().subscribe(r)},t.prototype.getSubject=function(){var r=this._subject;return(!r||r.isStopped)&&(this._subject=this.subjectFactory()),this._subject},t.prototype.connect=function(){var r=this._connection;return r||(this._isComplete=!1,r=this._connection=new jt,r.add(this.source.subscribe(new od(this.getSubject(),this))),r.closed&&(this._connection=null,r=jt.EMPTY)),r},t.prototype.refCount=function(){return jr()(this)},t}(nt),sd=function(){var e=id.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:e._subscribe},_isComplete:{value:e._isComplete,writable:!0},getSubject:{value:e.getSubject},connect:{value:e.connect},refCount:{value:e.refCount}}}(),od=function(e){V(t,e);function t(r,n){var i=e.call(this,r)||this;return i.connectable=n,i}return t.prototype._error=function(r){this._unsubscribe(),e.prototype._error.call(this,r)},t.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),e.prototype._complete.call(this)},t.prototype._unsubscribe=function(){var r=this.connectable;if(r){this.connectable=null;var n=r._connection;r._refCount=0,r._subject=null,r._connection=null,n&&n.unsubscribe()}},t}(Tc),fi=function(e){V(t,e);function t(r){var n=e.call(this)||this;return n._value=r,n}return Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),t.prototype._subscribe=function(r){var n=e.prototype._subscribe.call(this,r);return n&&!n.closed&&r.next(this._value),n},t.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new sr;return this._value},t.prototype.next=function(r){e.prototype.next.call(this,this._value=r)},t}(Pr),ad=function(e){V(t,e);function t(r,n){return e.call(this)||this}return t.prototype.schedule=function(r,n){return this},t}(jt),Nc=function(e){V(t,e);function t(r,n){var i=e.call(this,r,n)||this;return i.scheduler=r,i.work=n,i.pending=!1,i}return t.prototype.schedule=function(r,n){if(n===void 0&&(n=0),this.closed)return this;this.state=r;var i=this.id,s=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(s,i,n)),this.pending=!0,this.delay=n,this.id=this.id||this.requestAsyncId(s,this.id,n),this},t.prototype.requestAsyncId=function(r,n,i){return i===void 0&&(i=0),setInterval(r.flush.bind(r,this),i)},t.prototype.recycleAsyncId=function(r,n,i){if(i===void 0&&(i=0),i!==null&&this.delay===i&&this.pending===!1)return n;clearInterval(n)},t.prototype.execute=function(r,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var i=this._execute(r,n);if(i)return i;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(r,n){var i=!1,s=void 0;try{this.work(r)}catch(o){i=!0,s=!!o&&o||new Error(o)}if(i)return this.unsubscribe(),s},t.prototype._unsubscribe=function(){var r=this.id,n=this.scheduler,i=n.actions,s=i.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,s!==-1&&i.splice(s,1),r!=null&&(this.id=this.recycleAsyncId(n,r,null)),this.delay=null},t}(ad),cd=function(e){V(t,e);function t(r,n){var i=e.call(this,r,n)||this;return i.scheduler=r,i.work=n,i}return t.prototype.schedule=function(r,n){return n===void 0&&(n=0),n>0?e.prototype.schedule.call(this,r,n):(this.delay=n,this.state=r,this.scheduler.flush(this),this)},t.prototype.execute=function(r,n){return n>0||this.closed?e.prototype.execute.call(this,r,n):this._execute(r,n)},t.prototype.requestAsyncId=function(r,n,i){return i===void 0&&(i=0),i!==null&&i>0||i===null&&this.delay>0?e.prototype.requestAsyncId.call(this,r,n,i):r.flush(this)},t}(Nc),ia=function(){function e(t,r){r===void 0&&(r=e.now),this.SchedulerAction=t,this.now=r}return e.prototype.schedule=function(t,r,n){return r===void 0&&(r=0),new this.SchedulerAction(this,t).schedule(n,r)},e.now=function(){return Date.now()},e}(),Lc=function(e){V(t,e);function t(r,n){n===void 0&&(n=ia.now);var i=e.call(this,r,function(){return t.delegate&&t.delegate!==i?t.delegate.now():n()})||this;return i.actions=[],i.active=!1,i.scheduled=void 0,i}return t.prototype.schedule=function(r,n,i){return n===void 0&&(n=0),t.delegate&&t.delegate!==this?t.delegate.schedule(r,n,i):e.prototype.schedule.call(this,r,n,i)},t.prototype.flush=function(r){var n=this.actions;if(this.active){n.push(r);return}var i;this.active=!0;do if(i=r.execute(r.state,r.delay))break;while(r=n.shift());if(this.active=!1,i){for(;r=n.shift();)r.unsubscribe();throw i}},t}(ia),ud=function(e){V(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(Lc),ld=new ud(cd),hd=ld,xc=new nt(function(e){return e.complete()});function Gs(e){return e?pd(e):xc}function pd(e){return new nt(function(t){return e.schedule(function(){return t.complete()})})}function Hr(e){return e&&typeof e.schedule=="function"}var Cc=function(e){return function(t){for(var r=0,n=e.length;r<n&&!t.closed;r++)t.next(e[r]);t.complete()}};function Ks(e,t){return new nt(function(r){var n=new jt,i=0;return n.add(t.schedule(function(){if(i===e.length){r.complete();return}r.next(e[i++]),r.closed||n.add(this.schedule())})),n})}function Mc(e,t){return t?Ks(e,t):new nt(Cc(e))}function Cr(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=e[e.length-1];return Hr(r)?(e.pop(),Ks(e,r)):Mc(e)}function Fs(e,t){return t?new nt(function(r){return t.schedule(dd,0,{error:e,subscriber:r})}):new nt(function(r){return r.error(e)})}function dd(e){var t=e.error,r=e.subscriber;r.error(t)}var Zi=function(){function e(t,r,n){this.kind=t,this.value=r,this.error=n,this.hasValue=t==="N"}return e.prototype.observe=function(t){switch(this.kind){case"N":return t.next&&t.next(this.value);case"E":return t.error&&t.error(this.error);case"C":return t.complete&&t.complete()}},e.prototype.do=function(t,r,n){var i=this.kind;switch(i){case"N":return t&&t(this.value);case"E":return r&&r(this.error);case"C":return n&&n()}},e.prototype.accept=function(t,r,n){return t&&typeof t.next=="function"?this.observe(t):this.do(t,r,n)},e.prototype.toObservable=function(){var t=this.kind;switch(t){case"N":return Cr(this.value);case"E":return Fs(this.error);case"C":return Gs()}throw new Error("unexpected notification kind value")},e.createNext=function(t){return typeof t<"u"?new e("N",t):e.undefinedValueNotification},e.createError=function(t){return new e("E",void 0,t)},e.createComplete=function(){return e.completeNotification},e.completeNotification=new e("C"),e.undefinedValueNotification=new e("N",void 0),e}(),fd=function(e){V(t,e);function t(r,n,i){i===void 0&&(i=0);var s=e.call(this,r)||this;return s.scheduler=n,s.delay=i,s}return t.dispatch=function(r){var n=r.notification,i=r.destination;n.observe(i),this.unsubscribe()},t.prototype.scheduleMessage=function(r){var n=this.destination;n.add(this.scheduler.schedule(t.dispatch,this.delay,new gd(r,this.destination)))},t.prototype._next=function(r){this.scheduleMessage(Zi.createNext(r))},t.prototype._error=function(r){this.scheduleMessage(Zi.createError(r)),this.unsubscribe()},t.prototype._complete=function(){this.scheduleMessage(Zi.createComplete()),this.unsubscribe()},t}(st),gd=function(){function e(t,r){this.notification=t,this.destination=r}return e}(),Vr=function(e){V(t,e);function t(r,n,i){r===void 0&&(r=Number.POSITIVE_INFINITY),n===void 0&&(n=Number.POSITIVE_INFINITY);var s=e.call(this)||this;return s.scheduler=i,s._events=[],s._infiniteTimeWindow=!1,s._bufferSize=r<1?1:r,s._windowTime=n<1?1:n,n===Number.POSITIVE_INFINITY?(s._infiniteTimeWindow=!0,s.next=s.nextInfiniteTimeWindow):s.next=s.nextTimeWindow,s}return t.prototype.nextInfiniteTimeWindow=function(r){if(!this.isStopped){var n=this._events;n.push(r),n.length>this._bufferSize&&n.shift()}e.prototype.next.call(this,r)},t.prototype.nextTimeWindow=function(r){this.isStopped||(this._events.push(new md(this._getNow(),r)),this._trimBufferThenGetEvents()),e.prototype.next.call(this,r)},t.prototype._subscribe=function(r){var n=this._infiniteTimeWindow,i=n?this._events:this._trimBufferThenGetEvents(),s=this.scheduler,o=i.length,a;if(this.closed)throw new sr;if(this.isStopped||this.hasError?a=jt.EMPTY:(this.observers.push(r),a=new Sc(this,r)),s&&r.add(r=new fd(r,s)),n)for(var c=0;c<o&&!r.closed;c++)r.next(i[c]);else for(var c=0;c<o&&!r.closed;c++)r.next(i[c].value);return this.hasError?r.error(this.thrownError):this.isStopped&&r.complete(),a},t.prototype._getNow=function(){return(this.scheduler||hd).now()},t.prototype._trimBufferThenGetEvents=function(){for(var r=this._getNow(),n=this._bufferSize,i=this._windowTime,s=this._events,o=s.length,a=0;a<o&&!(r-s[a].time<i);)a++;return o>n&&(a=Math.max(a,o-n)),a>0&&s.splice(0,a),s},t}(Pr),md=function(){function e(t,r){this.time=t,this.value=r}return e}(),yd=new Lc(Nc),Dc=yd;function Ee(){}var Ed=function(){function e(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return e.prototype=Object.create(Error.prototype),e}(),bd=Ed,vd=function(){function e(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return e.prototype=Object.create(Error.prototype),e}(),$c=vd;function lr(e,t){return function(n){if(typeof e!="function")throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new _d(e,t))}}var _d=function(){function e(t,r){this.project=t,this.thisArg=r}return e.prototype.call=function(t,r){return r.subscribe(new wd(t,this.project,this.thisArg))},e}(),wd=function(e){V(t,e);function t(r,n,i){var s=e.call(this,r)||this;return s.project=n,s.count=0,s.thisArg=i||s,s}return t.prototype._next=function(r){var n;try{n=this.project.call(this.thisArg,r,this.count++)}catch(i){this.destination.error(i);return}this.destination.next(n)},t}(st),Ad=function(e){V(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.notifyNext=function(r,n,i,s,o){this.destination.next(n)},t.prototype.notifyError=function(r,n){this.destination.error(r)},t.prototype.notifyComplete=function(r){this.destination.complete()},t}(st),Rd=function(e){V(t,e);function t(r,n,i){var s=e.call(this)||this;return s.parent=r,s.outerValue=n,s.outerIndex=i,s.index=0,s}return t.prototype._next=function(r){this.parent.notifyNext(this.outerValue,r,this.outerIndex,this.index++,this)},t.prototype._error=function(r){this.parent.notifyError(r,this),this.unsubscribe()},t.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},t}(st),Od=function(e){return function(t){return e.then(function(r){t.closed||(t.next(r),t.complete())},function(r){return t.error(r)}).then(null,br),t}};function Pd(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var gi=Pd(),Id=function(e){return function(t){var r=e[gi]();do{var n=void 0;try{n=r.next()}catch(i){return t.error(i),t}if(n.done){t.complete();break}if(t.next(n.value),t.closed)break}while(!0);return typeof r.return=="function"&&t.add(function(){r.return&&r.return()}),t}},Sd=function(e){return function(t){var r=e[qr]();if(typeof r.subscribe!="function")throw new TypeError("Provided object does not correctly implement Symbol.observable");return r.subscribe(t)}},Bc=function(e){return e&&typeof e.length=="number"&&typeof e!="function"};function kc(e){return!!e&&typeof e.subscribe!="function"&&typeof e.then=="function"}var qs=function(e){if(e&&typeof e[qr]=="function")return Sd(e);if(Bc(e))return Cc(e);if(kc(e))return Od(e);if(e&&typeof e[gi]=="function")return Id(e);var t=Ic(e)?"an invalid object":"'"+e+"'",r="You provided "+t+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.";throw new TypeError(r)};function Td(e,t,r,n,i){if(i===void 0&&(i=new Rd(e,r,n)),!i.closed)return t instanceof nt?t.subscribe(i):qs(t)(i)}var sa={};function oa(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=void 0,n=void 0;return Hr(e[e.length-1])&&(n=e.pop()),typeof e[e.length-1]=="function"&&(r=e.pop()),e.length===1&&Vs(e[0])&&(e=e[0]),Mc(e,n).lift(new Nd(r))}var Nd=function(){function e(t){this.resultSelector=t}return e.prototype.call=function(t,r){return r.subscribe(new Ld(t,this.resultSelector))},e}(),Ld=function(e){V(t,e);function t(r,n){var i=e.call(this,r)||this;return i.resultSelector=n,i.active=0,i.values=[],i.observables=[],i}return t.prototype._next=function(r){this.values.push(sa),this.observables.push(r)},t.prototype._complete=function(){var r=this.observables,n=r.length;if(n===0)this.destination.complete();else{this.active=n,this.toRespond=n;for(var i=0;i<n;i++){var s=r[i];this.add(Td(this,s,void 0,i))}}},t.prototype.notifyComplete=function(r){(this.active-=1)===0&&this.destination.complete()},t.prototype.notifyNext=function(r,n,i){var s=this.values,o=s[i],a=this.toRespond?o===sa?--this.toRespond:this.toRespond:0;s[i]=n,a===0&&(this.resultSelector?this._tryResultSelector(s):this.destination.next(s.slice()))},t.prototype._tryResultSelector=function(r){var n;try{n=this.resultSelector.apply(this,r)}catch(i){this.destination.error(i);return}this.destination.next(n)},t}(Ad);function xd(e,t){return new nt(function(r){var n=new jt;return n.add(t.schedule(function(){var i=e[qr]();n.add(i.subscribe({next:function(s){n.add(t.schedule(function(){return r.next(s)}))},error:function(s){n.add(t.schedule(function(){return r.error(s)}))},complete:function(){n.add(t.schedule(function(){return r.complete()}))}}))})),n})}function Cd(e,t){return new nt(function(r){var n=new jt;return n.add(t.schedule(function(){return e.then(function(i){n.add(t.schedule(function(){r.next(i),n.add(t.schedule(function(){return r.complete()}))}))},function(i){n.add(t.schedule(function(){return r.error(i)}))})})),n})}function Md(e,t){if(!e)throw new Error("Iterable cannot be null");return new nt(function(r){var n=new jt,i;return n.add(function(){i&&typeof i.return=="function"&&i.return()}),n.add(t.schedule(function(){i=e[gi](),n.add(t.schedule(function(){if(!r.closed){var s,o;try{var a=i.next();s=a.value,o=a.done}catch(c){r.error(c);return}o?r.complete():(r.next(s),this.schedule())}}))})),n})}function Dd(e){return e&&typeof e[qr]=="function"}function $d(e){return e&&typeof e[gi]=="function"}function Bd(e,t){if(e!=null){if(Dd(e))return xd(e,t);if(kc(e))return Cd(e,t);if(Bc(e))return Ks(e,t);if($d(e)||typeof e=="string")return Md(e,t)}throw new TypeError((e!==null&&typeof e||e)+" is not observable")}function pr(e,t){return t?Bd(e,t):e instanceof nt?e:new nt(qs(e))}var zr=function(e){V(t,e);function t(r){var n=e.call(this)||this;return n.parent=r,n}return t.prototype._next=function(r){this.parent.notifyNext(r)},t.prototype._error=function(r){this.parent.notifyError(r),this.unsubscribe()},t.prototype._complete=function(){this.parent.notifyComplete(),this.unsubscribe()},t}(st),Yr=function(e){V(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.notifyNext=function(r){this.destination.next(r)},t.prototype.notifyError=function(r){this.destination.error(r)},t.prototype.notifyComplete=function(){this.destination.complete()},t}(st);function Wr(e,t){if(!t.closed){if(e instanceof nt)return e.subscribe(t);var r;try{r=qs(e)(t)}catch(n){t.error(n)}return r}}function mi(e,t,r){return r===void 0&&(r=Number.POSITIVE_INFINITY),typeof t=="function"?function(n){return n.pipe(mi(function(i,s){return pr(e(i,s)).pipe(lr(function(o,a){return t(i,o,s,a)}))},r))}:(typeof t=="number"&&(r=t),function(n){return n.lift(new kd(e,r))})}var kd=function(){function e(t,r){r===void 0&&(r=Number.POSITIVE_INFINITY),this.project=t,this.concurrent=r}return e.prototype.call=function(t,r){return r.subscribe(new jd(t,this.project,this.concurrent))},e}(),jd=function(e){V(t,e);function t(r,n,i){i===void 0&&(i=Number.POSITIVE_INFINITY);var s=e.call(this,r)||this;return s.project=n,s.concurrent=i,s.hasCompleted=!1,s.buffer=[],s.active=0,s.index=0,s}return t.prototype._next=function(r){this.active<this.concurrent?this._tryNext(r):this.buffer.push(r)},t.prototype._tryNext=function(r){var n,i=this.index++;try{n=this.project(r,i)}catch(s){this.destination.error(s);return}this.active++,this._innerSub(n)},t.prototype._innerSub=function(r){var n=new zr(this),i=this.destination;i.add(n);var s=Wr(r,n);s!==n&&i.add(s)},t.prototype._complete=function(){this.hasCompleted=!0,this.active===0&&this.buffer.length===0&&this.destination.complete(),this.unsubscribe()},t.prototype.notifyNext=function(r){this.destination.next(r)},t.prototype.notifyComplete=function(){var r=this.buffer;this.active--,r.length>0?this._next(r.shift()):this.active===0&&this.hasCompleted&&this.destination.complete()},t}(Yr);function Hd(e){return e===void 0&&(e=Number.POSITIVE_INFINITY),mi(Us,e)}function Vd(){return Hd(1)}function Bn(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Vd()(Cr.apply(void 0,e))}function jc(e){return new nt(function(t){var r;try{r=e()}catch(i){t.error(i);return}var n=r?pr(r):Gs();return n.subscribe(t)})}function aa(e){return!Vs(e)&&e-parseFloat(e)+1>=0}var Ud=new nt(Ee);function kn(e,t){return function(n){return n.lift(new Gd(e,t))}}var Gd=function(){function e(t,r){this.predicate=t,this.thisArg=r}return e.prototype.call=function(t,r){return r.subscribe(new Kd(t,this.predicate,this.thisArg))},e}(),Kd=function(e){V(t,e);function t(r,n,i){var s=e.call(this,r)||this;return s.predicate=n,s.thisArg=i,s.count=0,s}return t.prototype._next=function(r){var n;try{n=this.predicate.call(this.thisArg,r,this.count++)}catch(i){this.destination.error(i);return}n&&this.destination.next(r)},t}(st);function zs(e,t,r){return e===void 0&&(e=0),new nt(function(n){t===void 0&&(t=e,e=0);var i=0,s=e;if(r)return r.schedule(Fd,0,{index:i,count:t,start:e,subscriber:n});do{if(i++>=t){n.complete();break}if(n.next(s++),n.closed)break}while(!0)})}function Fd(e){var t=e.start,r=e.index,n=e.count,i=e.subscriber;if(r>=n){i.complete();return}i.next(t),!i.closed&&(e.index=r+1,e.start=t+1,this.schedule(e))}function ca(e,t,r){e===void 0&&(e=0);var n=-1;return aa(t)?n=Number(t)<1&&1||Number(t):Hr(t)&&(r=t),Hr(r)||(r=Dc),new nt(function(i){var s=aa(e)?e:+e-r.now();return r.schedule(qd,s,{index:0,period:n,subscriber:i})})}function qd(e){var t=e.index,r=e.period,n=e.subscriber;if(n.next(t),!n.closed){if(r===-1)return n.complete();e.index=t+1,this.schedule(e,r)}}function Ys(e){return function(r){var n=new zd(e),i=r.lift(n);return n.caught=i}}var zd=function(){function e(t){this.selector=t}return e.prototype.call=function(t,r){return r.subscribe(new Yd(t,this.selector,this.caught))},e}(),Yd=function(e){V(t,e);function t(r,n,i){var s=e.call(this,r)||this;return s.selector=n,s.caught=i,s}return t.prototype.error=function(r){if(!this.isStopped){var n=void 0;try{n=this.selector(r,this.caught)}catch(o){e.prototype.error.call(this,o);return}this._unsubscribeAndRecycle();var i=new zr(this);this.add(i);var s=Wr(n,i);s!==i&&this.add(s)}},t}(Yr);function Jr(e,t){return mi(e,t,1)}function Wd(e){return e===void 0&&(e=null),function(t){return t.lift(new Jd(e))}}var Jd=function(){function e(t){this.defaultValue=t}return e.prototype.call=function(t,r){return r.subscribe(new Xd(t,this.defaultValue))},e}(),Xd=function(e){V(t,e);function t(r,n){var i=e.call(this,r)||this;return i.defaultValue=n,i.isEmpty=!0,i}return t.prototype._next=function(r){this.isEmpty=!1,this.destination.next(r)},t.prototype._complete=function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()},t}(st);function Zd(e){return e instanceof Date&&!isNaN(+e)}function Hc(e,t){return function(r){return r.lift(new Qd(e,t))}}var Qd=function(){function e(t,r){this.compare=t,this.keySelector=r}return e.prototype.call=function(t,r){return r.subscribe(new tf(t,this.compare,this.keySelector))},e}(),tf=function(e){V(t,e);function t(r,n,i){var s=e.call(this,r)||this;return s.keySelector=i,s.hasKey=!1,typeof n=="function"&&(s.compare=n),s}return t.prototype.compare=function(r,n){return r===n},t.prototype._next=function(r){var n;try{var i=this.keySelector;n=i?i(r):r}catch(a){return this.destination.error(a)}var s=!1;if(this.hasKey)try{var o=this.compare;s=o(this.key,n)}catch(a){return this.destination.error(a)}else this.hasKey=!0;s||(this.key=n,this.destination.next(r))},t}(st);function ef(e,t){return Hc(function(r,n){return t?t(r[e],n[e]):r[e]===n[e]})}function rf(e){return e===void 0&&(e=of),function(t){return t.lift(new nf(e))}}var nf=function(){function e(t){this.errorFactory=t}return e.prototype.call=function(t,r){return r.subscribe(new sf(t,this.errorFactory))},e}(),sf=function(e){V(t,e);function t(r,n){var i=e.call(this,r)||this;return i.errorFactory=n,i.hasValue=!1,i}return t.prototype._next=function(r){this.hasValue=!0,this.destination.next(r)},t.prototype._complete=function(){if(this.hasValue)return this.destination.complete();var r=void 0;try{r=this.errorFactory()}catch(n){r=n}this.destination.error(r)},t}(st);function of(){return new $c}function af(e){return function(t){return e===0?Gs():t.lift(new cf(e))}}var cf=function(){function e(t){if(this.total=t,this.total<0)throw new bd}return e.prototype.call=function(t,r){return r.subscribe(new uf(t,this.total))},e}(),uf=function(e){V(t,e);function t(r,n){var i=e.call(this,r)||this;return i.total=n,i.count=0,i}return t.prototype._next=function(r){var n=this.total,i=++this.count;i<=n&&(this.destination.next(r),i===n&&(this.destination.complete(),this.unsubscribe()))},t}(st);function Vc(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(r){return Bn(r,Cr.apply(void 0,e))}}function Se(e,t){var r=arguments.length>=2;return function(n){return n.pipe(e?kn(function(i,s){return e(i,s,n)}):Us,af(1),r?Wd(t):rf(function(){return new $c}))}}function ys(e,t){return function(n){var i;if(typeof e=="function"?i=e:i=function(){return e},typeof t=="function")return n.lift(new lf(i,t));var s=Object.create(n,sd);return s.source=n,s.subjectFactory=i,s}}var lf=function(){function e(t,r){this.subjectFactory=t,this.selector=r}return e.prototype.call=function(t,r){var n=this.selector,i=this.subjectFactory(),s=n(i).subscribe(t);return s.add(r.subscribe(i)),s},e}();function ua(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=e.length;if(r===0)throw new Error("list of properties cannot be empty.");return function(n){return lr(hf(e,r))(n)}}function hf(e,t){var r=function(n){for(var i=n,s=0;s<t;s++){var o=i!=null?i[e[s]]:void 0;if(o!==void 0)i=o;else return}return i};return r}function pf(e){return e?ys(function(){return new Pr},e):ys(new Pr)}function Es(e,t,r,n){r&&typeof r!="function"&&(n=r);var i=typeof r=="function"?r:void 0,s=new Vr(e,t,n);return function(o){return ys(function(){return s},i)(o)}}function Uc(e){return e===void 0&&(e=-1),function(t){return t.lift(new df(e,t))}}var df=function(){function e(t,r){this.count=t,this.source=r}return e.prototype.call=function(t,r){return r.subscribe(new ff(t,this.count,this.source))},e}(),ff=function(e){V(t,e);function t(r,n,i){var s=e.call(this,r)||this;return s.count=n,s.source=i,s}return t.prototype.error=function(r){if(!this.isStopped){var n=this,i=n.source,s=n.count;if(s===0)return e.prototype.error.call(this,r);s>-1&&(this.count=s-1),i.subscribe(this._unsubscribeAndRecycle())}},t}(st);function la(e,t,r){var n;return e&&typeof e=="object"?n=e:n={bufferSize:e,windowTime:t,refCount:!1,scheduler:r},function(i){return i.lift(gf(n))}}function gf(e){var t=e.bufferSize,r=t===void 0?Number.POSITIVE_INFINITY:t,n=e.windowTime,i=n===void 0?Number.POSITIVE_INFINITY:n,s=e.refCount,o=e.scheduler,a,c=0,d,p=!1,l=!1;return function(_){c++;var N;!a||p?(p=!1,a=new Vr(r,i,o),N=a.subscribe(this),d=_.subscribe({next:function(K){a.next(K)},error:function(K){p=!0,a.error(K)},complete:function(){l=!0,d=void 0,a.complete()}}),l&&(d=void 0)):N=a.subscribe(this),this.add(function(){c--,N.unsubscribe(),N=void 0,d&&!l&&s&&c===0&&(d.unsubscribe(),d=void 0,a=void 0)})}}function mf(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=e[e.length-1];return Hr(r)?(e.pop(),function(n){return Bn(e,n,r)}):function(n){return Bn(e,n)}}function he(e,t){return typeof t=="function"?function(r){return r.pipe(he(function(n,i){return pr(e(n,i)).pipe(lr(function(s,o){return t(n,s,i,o)}))}))}:function(r){return r.lift(new yf(e))}}var yf=function(){function e(t){this.project=t}return e.prototype.call=function(t,r){return r.subscribe(new Ef(t,this.project))},e}(),Ef=function(e){V(t,e);function t(r,n){var i=e.call(this,r)||this;return i.project=n,i.index=0,i}return t.prototype._next=function(r){var n,i=this.index++;try{n=this.project(r,i)}catch(s){this.destination.error(s);return}this._innerSub(n)},t.prototype._innerSub=function(r){var n=this.innerSubscription;n&&n.unsubscribe();var i=new zr(this),s=this.destination;s.add(i),this.innerSubscription=Wr(r,i),this.innerSubscription!==i&&s.add(this.innerSubscription)},t.prototype._complete=function(){var r=this.innerSubscription;(!r||r.closed)&&e.prototype._complete.call(this),this.unsubscribe()},t.prototype._unsubscribe=function(){this.innerSubscription=void 0},t.prototype.notifyComplete=function(){this.innerSubscription=void 0,this.isStopped&&e.prototype._complete.call(this)},t.prototype.notifyNext=function(r){this.destination.next(r)},t}(Yr);function bf(e){return function(t){return t.lift(new vf(e))}}var vf=function(){function e(t){this.notifier=t}return e.prototype.call=function(t,r){var n=new _f(t),i=Wr(this.notifier,new zr(n));return i&&!n.seenValue?(n.add(i),r.subscribe(n)):n},e}(),_f=function(e){V(t,e);function t(r){var n=e.call(this,r)||this;return n.seenValue=!1,n}return t.prototype.notifyNext=function(){this.seenValue=!0,this.complete()},t.prototype.notifyComplete=function(){},t}(Yr);function wf(e,t){return t===void 0&&(t=!1),function(r){return r.lift(new Af(e,t))}}var Af=function(){function e(t,r){this.predicate=t,this.inclusive=r}return e.prototype.call=function(t,r){return r.subscribe(new Rf(t,this.predicate,this.inclusive))},e}(),Rf=function(e){V(t,e);function t(r,n,i){var s=e.call(this,r)||this;return s.predicate=n,s.inclusive=i,s.index=0,s}return t.prototype._next=function(r){var n=this.destination,i;try{i=this.predicate(r,this.index++)}catch(s){n.error(s);return}this.nextOrComplete(r,i)},t.prototype.nextOrComplete=function(r,n){var i=this.destination;n?i.next(r):(this.inclusive&&i.next(r),i.complete())},t}(st);function jn(e,t,r){return function(i){return i.lift(new Of(e,t,r))}}var Of=function(){function e(t,r,n){this.nextOrObserver=t,this.error=r,this.complete=n}return e.prototype.call=function(t,r){return r.subscribe(new Pf(t,this.nextOrObserver,this.error,this.complete))},e}(),Pf=function(e){V(t,e);function t(r,n,i,s){var o=e.call(this,r)||this;return o._tapNext=Ee,o._tapError=Ee,o._tapComplete=Ee,o._tapError=i||Ee,o._tapComplete=s||Ee,Mn(n)?(o._context=o,o._tapNext=n):n&&(o._context=n,o._tapNext=n.next||Ee,o._tapError=n.error||Ee,o._tapComplete=n.complete||Ee),o}return t.prototype._next=function(r){try{this._tapNext.call(this._context,r)}catch(n){this.destination.error(n);return}this.destination.next(r)},t.prototype._error=function(r){try{this._tapError.call(this._context,r)}catch(n){this.destination.error(n);return}this.destination.error(r)},t.prototype._complete=function(){try{this._tapComplete.call(this._context)}catch(r){this.destination.error(r);return}return this.destination.complete()},t}(st);function Gc(e,t,r){return r===void 0&&(r=Dc),function(n){var i=Zd(e),s=i?+e-r.now():Math.abs(e);return n.lift(new If(s,i,t,r))}}var If=function(){function e(t,r,n,i){this.waitFor=t,this.absoluteTimeout=r,this.withObservable=n,this.scheduler=i}return e.prototype.call=function(t,r){return r.subscribe(new Sf(t,this.absoluteTimeout,this.waitFor,this.withObservable,this.scheduler))},e}(),Sf=function(e){V(t,e);function t(r,n,i,s,o){var a=e.call(this,r)||this;return a.absoluteTimeout=n,a.waitFor=i,a.withObservable=s,a.scheduler=o,a.scheduleTimeout(),a}return t.dispatchTimeout=function(r){var n=r.withObservable;r._unsubscribeAndRecycle(),r.add(Wr(n,new zr(r)))},t.prototype.scheduleTimeout=function(){var r=this.action;r?this.action=r.schedule(this,this.waitFor):this.add(this.action=this.scheduler.schedule(t.dispatchTimeout,this.waitFor,this))},t.prototype._next=function(r){this.absoluteTimeout||this.scheduleTimeout(),e.prototype._next.call(this,r)},t.prototype._unsubscribe=function(){this.action=void 0,this.scheduler=null,this.withObservable=null},t}(Yr),Tf=function(e,t){t||(t={}),typeof t=="function"&&(t={cmp:t});var r=typeof t.cycles=="boolean"?t.cycles:!1,n=t.cmp&&function(s){return function(o){return function(a,c){var d={key:a,value:o[a]},p={key:c,value:o[c]};return s(d,p)}}}(t.cmp),i=[];return function s(o){if(o&&o.toJSON&&typeof o.toJSON=="function"&&(o=o.toJSON()),o!==void 0){if(typeof o=="number")return isFinite(o)?""+o:"null";if(typeof o!="object")return JSON.stringify(o);var a,c;if(Array.isArray(o)){for(c="[",a=0;a<o.length;a++)a&&(c+=","),c+=s(o[a])||"null";return c+"]"}if(o===null)return"null";if(i.indexOf(o)!==-1){if(r)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var d=i.push(o)-1,p=Object.keys(o).sort(n&&n(o));for(c="",a=0;a<p.length;a++){var l=p[a],y=s(o[l]);y&&(c&&(c+=","),c+=JSON.stringify(l)+":"+y)}return i.splice(d,1),"{"+c+"}"}}(e)},Kc;class Nf extends Error{constructor(t){super(`The map type '${t}' is invalid`),this.mapType=t,this.name="InvalidMapTypeError"}}const Fc=Symbol.for("taquito-michelson-map-type-symbol"),Lf=e=>"args"in e&&Array.isArray(e.args)&&e.args.length===2;class ha extends Error{constructor(t,r,n){super(`${n} not compliant with underlying michelson type`),this.value=t,this.type=r,this.name="MapTypecheckError"}}class Ct{constructor(t){this.valueMap=new Map,this.keyMap=new Map,this[Kc]=!0,t&&this.setType(t)}static isMichelsonMap(t){return t&&t[Fc]===!0}setType(t){if(!Lf(t))throw new Nf(t.toString());this.keySchema=new Mt(t.args[0]),this.valueSchema=new Mt(t.args[1])}removeType(){this.keySchema=void 0,this.valueSchema=void 0}static fromLiteral(t,r){const n=new Ct(r);return Object.keys(t).forEach(i=>{n.set(i,t[i])}),n}typecheckKey(t){return this.keySchema?this.keySchema.Typecheck(t):!0}typecheckValue(t){return this.valueSchema?this.valueSchema.Typecheck(t):!0}assertTypecheckValue(t){if(!this.typecheckValue(t))throw new ha(t,this.valueSchema,"value")}assertTypecheckKey(t){if(!this.typecheckKey(t))throw new ha(t,this.keySchema,"key")}serializeDeterministically(t){return Tf(t)}*keys(){for(const[t]of this.entries())yield t}*values(){for(const[,t]of this.entries())yield t}*entries(){for(const t of this.valueMap.keys())yield[this.keyMap.get(t),this.valueMap.get(t)]}get(t){this.assertTypecheckKey(t);const r=this.serializeDeterministically(t);return this.valueMap.get(r)}set(t,r){this.assertTypecheckKey(t),this.assertTypecheckValue(r);const n=this.serializeDeterministically(t);this.keyMap.set(n,t),this.valueMap.set(n,r)}delete(t){this.assertTypecheckKey(t),this.keyMap.delete(this.serializeDeterministically(t)),this.valueMap.delete(this.serializeDeterministically(t))}has(t){this.assertTypecheckKey(t);const r=this.serializeDeterministically(t);return this.keyMap.has(r)&&this.valueMap.has(r)}clear(){this.keyMap.clear(),this.valueMap.clear()}get size(){return this.keyMap.size}forEach(t){for(const[r,n]of this.entries())t(n,r,this)}}Kc=Fc;class Z extends Error{constructor(t,r,n){super(),this.value=t,this.token=r,this.name="ValidationError";const i=this.token.annot(),s=i?`[${i}] `:"";this.message=`${s}${n}`}}class at{constructor(t,r,n){this.val=t,this.idx=r,this.fac=n,this.createToken=this.fac}typeWithoutAnnotations(){const t=n=>{if(typeof n=="object"){if(Array.isArray(n))return n.map(o=>t(o));const i=n;return i.args?{prim:i.prim,args:i.args.map(s=>t(s))}:{prim:i.prim}}return n};return(n=>n.args?{prim:n.prim,args:n.args.map(i=>t(i))}:{prim:n.prim})(this.val)}annot(){return(Array.isArray(this.val.annots)&&this.val.annots.length>0?this.val.annots[0]:String(this.idx)).replace(/(%|:)(_Liq_entry_)?/,"")}hasAnnotations(){return Array.isArray(this.val.annots)&&this.val.annots.length}get tokenVal(){return this.val}ExtractSignature(){return[[this.ExtractSchema()]]}}class it extends at{compare(t,r){return t===r?0:t<r?-1:1}}class pa extends Z{constructor(t,r,n){super(t,r,n),this.value=t,this.token=r,this.name="BigMapValidationError"}}class xt extends at{constructor(t,r,n){super(t,r,n),this.val=t,this.idx=r,this.fac=n}get ValueSchema(){return this.createToken(this.val.args[1],0)}get KeySchema(){return this.createToken(this.val.args[0],0)}ExtractSchema(){return{big_map:{key:this.KeySchema.ExtractSchema(),value:this.ValueSchema.ExtractSchema()}}}generateSchema(){return{__michelsonType:xt.prim,schema:{key:this.KeySchema.generateSchema(),value:this.ValueSchema.generateSchema()}}}isValid(t){return Ct.isMichelsonMap(t)?null:new pa(t,this,"Value must be a MichelsonMap")}objLitToMichelsonMap(t){return t instanceof Ct?t:typeof t=="object"?Object.keys(t).length===0?new Ct:Ct.fromLiteral(t):t}Encode(t){const r=this.objLitToMichelsonMap(t.pop()),n=this.isValid(r);if(n)throw n;return Array.from(r.keys()).sort((i,s)=>this.KeySchema.compare(i,s)).map(i=>({prim:"Elt",args:[this.KeySchema.EncodeObject(i),this.ValueSchema.EncodeObject(r.get(i))]}))}EncodeObject(t,r){const n=this.objLitToMichelsonMap(t),i=this.isValid(n);if(i)throw i;return r&&r[xt.prim]?r[xt.prim](n,this.val):Array.from(n.keys()).sort((s,o)=>this.KeySchema.compare(s,o)).map(s=>({prim:"Elt",args:[this.KeySchema.EncodeObject(s),this.ValueSchema.EncodeObject(n.get(s))]}))}Execute(t,r){if(r&&r[xt.prim])return r[xt.prim](t,this.val);if(Array.isArray(t)){const n=new Ct(this.val);return t.forEach(i=>{n.set(this.KeySchema.ToKey(i.args[0]),this.ValueSchema.Execute(i.args[1]))}),n}else{if("int"in t)return t.int;throw new pa(t,this,`Big map is expecting either an array (Athens) or an object with an int property (Babylon). Got ${JSON.stringify(t)}`)}}findAndReturnTokens(t,r){return xt.prim===t&&r.push(this),this.KeySchema.findAndReturnTokens(t,r),this.ValueSchema.findAndReturnTokens(t,r),r}}xt.prim="big_map";class xf extends Error{constructor(t){super(t),this.message=t,this.name="OrTokenDecodingError"}}class F extends it{constructor(t,r,n){super(t,r,n),this.val=t,this.idx=r,this.fac=n}Encode(t){const r=t[t.length-1],n=this.createToken(this.val.args[0],this.idx);let i=1;n instanceof F&&(i=Object.keys(n.ExtractSchema()).length);const s=this.createToken(this.val.args[1],this.idx+i);if(String(n.annot())===String(r)&&!(n instanceof F))return t.pop(),{prim:"Left",args:[n.Encode(t)]};if(String(s.annot())===String(r)&&!(s instanceof F))return t.pop(),{prim:"Right",args:[s.Encode(t)]};if(n instanceof F){const o=n.Encode(t);if(o)return{prim:"Left",args:[o]}}if(s instanceof F){const o=s.Encode(t);if(o)return{prim:"Right",args:[o]}}return null}ExtractSignature(){const t=this.createToken(this.val.args[0],this.idx);let r=1;t instanceof F&&(r=Object.keys(t.ExtractSchema()).length);const n=this.createToken(this.val.args[1],this.idx+r),i=[];if(t instanceof F)i.push(...t.ExtractSignature());else for(const s of t.ExtractSignature())i.push([t.annot(),...s]);if(n instanceof F)i.push(...n.ExtractSignature());else for(const s of n.ExtractSignature())i.push([n.annot(),...s]);return i}EncodeObject(t,r){const n=Object.keys(t)[0],i=this.createToken(this.val.args[0],this.idx);let s=1;i instanceof F&&(s=Object.keys(i.ExtractSchema()).length);const o=this.createToken(this.val.args[1],this.idx+s);if(String(i.annot())===String(n)&&!(i instanceof F))return{prim:"Left",args:[i.EncodeObject(t[n],r)]};if(String(o.annot())===String(n)&&!(o instanceof F))return{prim:"Right",args:[o.EncodeObject(t[n],r)]};if(i instanceof F){const a=i.EncodeObject(t,r);if(a)return{prim:"Left",args:[a]}}if(o instanceof F){const a=o.EncodeObject(t,r);if(a)return{prim:"Right",args:[a]}}return null}Execute(t,r){const n=this.createToken(this.val.args[0],this.idx);let i=1;n instanceof F&&(i=Object.keys(n.ExtractSchema()).length);const s=this.createToken(this.val.args[1],this.idx+i);if(t.prim==="Right")return s instanceof F?s.Execute(t.args[0],r):{[s.annot()]:s.Execute(t.args[0],r)};if(t.prim==="Left")return n instanceof F?n.Execute(t.args[0],r):{[n.annot()]:n.Execute(t.args[0],r)};throw new xf(`Was expecting Left or Right prim but got: ${t.prim}`)}traversal(t,r,n){const i=this.createToken(this.val.args[0],this.idx);let s=1,o;i instanceof F&&!i.hasAnnotations()?(o=t(i),s=Object.keys(i.ExtractSchema()).length):o={[i.annot()]:t(i)};const a=this.createToken(this.val.args[1],this.idx+s);let c;return a instanceof F&&!a.hasAnnotations()?c=r(a):c={[a.annot()]:r(a)},n(o,c)}ExtractSchema(){return this.traversal(t=>t.ExtractSchema(),t=>t.ExtractSchema(),(t,r)=>Object.assign(Object.assign({},t),r))}generateSchema(){return{__michelsonType:F.prim,schema:this.traversal(t=>t instanceof F&&!t.hasAnnotations()?t.generateSchema().schema:t.generateSchema(),t=>t instanceof F&&!t.hasAnnotations()?t.generateSchema().schema:t.generateSchema(),(t,r)=>Object.assign(Object.assign({},t),r))}}findToken(t){const r=this.createToken(this.val.args[0],this.idx);let n=1;r instanceof F&&(n=Object.keys(r.ExtractSchema()).length);const i=this.createToken(this.val.args[1],this.idx+n);if(String(r.annot())===String(t)&&!(r instanceof F)&&r instanceof it)return r;if(String(i.annot())===String(t)&&!(i instanceof F)&&i instanceof it)return i;if(r instanceof F){const s=r.findToken(t);if(s)return s}if(i instanceof F){const s=i.findToken(t);if(s)return s}return null}compare(t,r){const n=Object.keys(t)[0],i=Object.keys(r)[0];if(n===i){const s=this.findToken(n);if(s instanceof it)return s.compare(t[n],r[n])}else{const s=JSON.stringify(this.EncodeObject(t)),o=JSON.stringify(this.EncodeObject(r));return s<o?-1:1}}ToKey(t){return this.Execute(t)}ToBigMapKey(t){return{key:this.EncodeObject(t),type:this.typeWithoutAnnotations()}}findAndReturnTokens(t,r){return F.prim===t&&r.push(this),this.traversal(n=>n.findAndReturnTokens(t,r),n=>n.findAndReturnTokens(t,r),(n,i)=>Object.assign(Object.assign({},n),i)),r}}F.prim="or";class Cf extends Error{constructor(t){super(t),this.message=t,this.name="TokenArgumentValidationError"}}class Mf extends Error{constructor(t,r){super(`Tokens ${t} and ${r} are not comparable`),this.val1=t,this.val2=r,this.name="TokenComparisonError"}}function bs(e,t=ot.prim){if(Array.isArray(e))return bs({prim:t,args:e},t);if(e.args===void 0)throw new Cf("Encountered an invalid PairToken with no arguments, a pair must have two or more arguments");return e.args.length>2?[e.args[0],{prim:t,args:e.args.slice(1)}]:[e.args[0],e.args[1]]}class ot extends it{constructor(t,r,n){super(Array.isArray(t)?{prim:ot.prim,args:t}:t.prim?t:{prim:ot.prim,args:t},r,n)}args(){return bs(this.val)}tokens(){let t=0;return this.args().map(r=>{const n=this.createToken(r,this.idx+t);return n instanceof ot?t+=Object.keys(n.ExtractSchema()).length:t++,n})}Encode(t){return{prim:"Pair",args:this.tokens().map(r=>r.Encode(t))}}ExtractSignature(){const t=this.args(),r=this.createToken(t[0],this.idx);let n=1;r instanceof F&&(n=Object.keys(r.ExtractSchema()).length);const i=this.createToken(t[1],this.idx+n),s=[];for(const o of r.ExtractSignature())for(const a of i.ExtractSignature())s.push([...o,...a]);return s}ToBigMapKey(t){return{key:this.EncodeObject(t),type:this.typeWithoutAnnotations()}}ToKey(t){return this.Execute(t)}EncodeObject(t,r){const[n,i]=this.tokens();let s;n instanceof ot&&!n.hasAnnotations()?s=t:s=t[n.annot()];let o;return i instanceof ot&&!i.hasAnnotations()?o=t:o=t[i.annot()],{prim:"Pair",args:[n.EncodeObject(s,r),i.EncodeObject(o,r)]}}traversal(t,r){const n=this.args(),i=this.createToken(n[0],this.idx);let s=1,o;i instanceof ot&&(s=Object.keys(i.ExtractSchema()).length),i instanceof ot&&!i.hasAnnotations()?o=t(i):o={[i.annot()]:t(i)};const a=this.createToken(n[1],this.idx+s);let c;return a instanceof ot&&!a.hasAnnotations()?c=r(a):c={[a.annot()]:r(a)},Object.assign(Object.assign({},o),c)}Execute(t,r){const n=bs(t,"Pair");return this.traversal(i=>i.Execute(n[0],r),i=>i.Execute(n[1],r))}ExtractSchema(){return this.traversal(t=>t.ExtractSchema(),t=>t.ExtractSchema())}generateSchema(){return{__michelsonType:ot.prim,schema:this.traversal(t=>t instanceof ot&&!t.hasAnnotations()?t.generateSchema().schema:t.generateSchema(),t=>t instanceof ot&&!t.hasAnnotations()?t.generateSchema().schema:t.generateSchema())}}compare(t,r){const[n,i]=this.tokens(),s=(o,a)=>o instanceof ot&&!o.hasAnnotations()?a:a[o.annot()];if(n instanceof it&&i instanceof it){const o=n.compare(s(n,t),s(n,r));return o===0?i.compare(s(i,t),s(i,r)):o}throw new Mf(t,r)}findAndReturnTokens(t,r){return ot.prim===t&&r.push(this),this.tokens().map(n=>n.findAndReturnTokens(t,r)),r}}ot.prim="pair";class da extends Z{constructor(t,r,n){super(t,r,n),this.value=t,this.token=r,this.name="NatValidationError"}}class Wt extends it{constructor(t,r,n){super(t,r,n),this.val=t,this.idx=r,this.fac=n}Execute(t){return new R(t[Object.keys(t)[0]])}Encode(t){const r=t.pop(),n=this.isValid(r);if(n)throw n;return{int:new R(r).toFixed()}}isValid(t){const r=new R(t);return r.isNaN()?new da(t,this,`Value is not a number: ${t}`):r.isNegative()?new da(t,this,`Value cannot be negative: ${t}`):null}EncodeObject(t,r){const n=this.isValid(t);if(n)throw n;return r&&r[Wt.prim]?r[Wt.prim](t):{int:new R(t).toFixed()}}ExtractSchema(){return Wt.prim}generateSchema(){return{__michelsonType:Wt.prim,schema:Wt.prim}}ToBigMapKey(t){return{key:{int:String(t)},type:{prim:Wt.prim}}}ToKey({int:t}){return new R(t)}compare(t,r){const n=Number(t),i=Number(r);return n===i?0:n<i?-1:1}findAndReturnTokens(t,r){return Wt.prim===t&&r.push(this),r}}Wt.prim="nat";class Jt extends it{constructor(t,r,n){super(t,r,n),this.val=t,this.idx=r,this.fac=n}Execute(t){return t[Object.keys(t)[0]]}ExtractSchema(){return Jt.prim}generateSchema(){return{__michelsonType:Jt.prim,schema:Jt.prim}}Encode(t){return{string:t.pop()}}EncodeObject(t,r){return r&&r[Jt.prim]?r[Jt.prim](t):{string:t}}ToKey({string:t}){return t}ToBigMapKey(t){return{key:{string:t},type:{prim:Jt.prim}}}findAndReturnTokens(t,r){return Jt.prim===t&&r.push(this),r}}Jt.prim="string";class Qi extends Z{constructor(t,r,n){super(t,r,n),this.value=t,this.token=r,this.name="AddressValidationError"}}class be extends it{constructor(t,r,n){super(t,r,n),this.val=t,this.idx=r,this.fac=n}ToBigMapKey(t){return{key:{bytes:Cl(t)},type:{prim:"bytes"}}}isValid(t){return Q(t)!==x.VALID?new Qi(t,this,`Address is not valid: ${t}`):null}Encode(t){const r=t.pop(),n=this.isValid(r);if(n)throw n;return{string:r}}EncodeObject(t,r){const n=this.isValid(t);if(n)throw n;return r&&r[be.prim]?r[be.prim](t):{string:t}}Execute(t){if(t.string)return t.string;if(!t.bytes)throw new Qi(t,this,`cannot be missing both string and bytes: ${t}`);return us(t.bytes)}ExtractSchema(){return be.prim}generateSchema(){return{__michelsonType:be.prim,schema:be.prim}}ToKey({bytes:t,string:r}){if(r)return r;if(!t)throw new Qi({bytes:t,string:r},this,`cannot be missing both string and bytes ${{string:r,bytes:t}}`);return us(t)}compare(t,r){const n=o=>o.startsWith("tz"),i=n(t),s=n(r);return i&&!s?-1:s&&!i?1:super.compare(t,r)}findAndReturnTokens(t,r){return be.prim===t&&r.push(this),r}}be.prim="address";class Df extends Z{constructor(t,r,n){super(t,r,n),this.value=t,this.token=r,this.name="MapValidationError"}}class qe extends at{constructor(t,r,n){super(t,r,n),this.val=t,this.idx=r,this.fac=n}get ValueSchema(){return this.createToken(this.val.args[1],0)}get KeySchema(){return this.createToken(this.val.args[0],0)}isValid(t){return Ct.isMichelsonMap(t)?null:new Df(t,this,"Value must be a MichelsonMap")}Execute(t,r){const n=new Ct(this.val);return t.forEach(i=>{n.set(this.KeySchema.ToKey(i.args[0]),this.ValueSchema.Execute(i.args[1],r))}),n}objLitToMichelsonMap(t){return t instanceof Ct?t:typeof t=="object"?Object.keys(t).length===0?new Ct:Ct.fromLiteral(t):t}Encode(t){const r=this.objLitToMichelsonMap(t.pop()),n=this.isValid(r);if(n)throw n;return Array.from(r.keys()).sort((i,s)=>this.KeySchema.compare(i,s)).map(i=>({prim:"Elt",args:[this.KeySchema.EncodeObject(i),this.ValueSchema.EncodeObject(r.get(i))]}))}EncodeObject(t,r){const n=this.objLitToMichelsonMap(t),i=this.isValid(n);if(i)throw i;return r&&r[qe.prim]?r[qe.prim](n):Array.from(n.keys()).sort((s,o)=>this.KeySchema.compare(s,o)).map(s=>({prim:"Elt",args:[this.KeySchema.EncodeObject(s),this.ValueSchema.EncodeObject(n.get(s))]}))}ExtractSchema(){return{map:{key:this.KeySchema.ExtractSchema(),value:this.ValueSchema.ExtractSchema()}}}generateSchema(){return{__michelsonType:qe.prim,schema:{key:this.KeySchema.generateSchema(),value:this.ValueSchema.generateSchema()}}}findAndReturnTokens(t,r){return qe.prim===t&&r.push(this),this.KeySchema.findAndReturnTokens(t,r),this.ValueSchema.findAndReturnTokens(t,r),r}}qe.prim="map";class Xt extends it{constructor(t,r,n){super(t,r,n),this.val=t,this.idx=r,this.fac=n}Execute(t){return String(t.prim).toLowerCase()==="true"}Encode(t){return{prim:t.pop()?"True":"False"}}EncodeObject(t,r){return r&&r[Xt.prim]?r[Xt.prim](t):{prim:t?"True":"False"}}ExtractSchema(){return Xt.prim}generateSchema(){return{__michelsonType:Xt.prim,schema:Xt.prim}}ToBigMapKey(t){return{key:this.EncodeObject(t),type:{prim:Xt.prim}}}ToKey(t){return this.EncodeObject(t)}compare(t,r){return t&&r||!t&&!r?0:t?1:-1}findAndReturnTokens(t,r){return Xt.prim===t&&r.push(this),r}}Xt.prim="bool";class mn extends Z{constructor(t,r,n){super(t,r,n),this.value=t,this.token=r,this.name="TxRollupL2AddressValidationError"}}class ve extends it{constructor(t,r,n){super(t,r,n),this.val=t,this.idx=r,this.fac=n}ToBigMapKey(t){return{key:{bytes:Ml(t)},type:{prim:"bytes"}}}isValid(t){if(Q(t)!==x.VALID)throw new mn(t,this,`tx_rollup_l2_address is not valid: ${t}`);return null}Encode(t){const r=t.pop();if(!r)throw new mn(r,this,`arg missing to encode: this -> "${r}"`);return this.isValid(r),{string:r}}EncodeObject(t,r){return this.isValid(t),r&&r[ve.prim]?r[ve.prim](t):{string:t}}Execute(t){if(t.string)return t.string;if(!t.bytes)throw new mn(t,this,`value cannot be missing string and byte value. must have one ${JSON.stringify(t)}`);return so(t.bytes)}ExtractSchema(){return ve.prim}generateSchema(){return{__michelsonType:ve.prim,schema:ve.prim}}ToKey({bytes:t,string:r}){if(r)return r;if(!t)throw new mn(t,this,`value cannot be missing string and byte value. must have one: bytes = ${t}`);return so(t)}findAndReturnTokens(t,r){return ve.prim===t&&r.push(this),r}}ve.prim="tx_rollup_l2_address";class fa extends Z{constructor(t,r,n){super(t,r,n),this.value=t,this.token=r,this.name="ContractValidationError"}}class Ot extends at{constructor(t,r,n){super(t,r,n),this.val=t,this.idx=r,this.fac=n}isValid(t){return Q(t)!==x.VALID?new fa(t,this,"Contract address is not valid"):null}Execute(t){if(t.string)return t.string;if(!t.bytes)throw new fa(t,this,"must contain bytes or string");return us(t.bytes)}Encode(t){const r=t.pop(),n=this.isValid(r);if(n)throw n;return{string:r}}EncodeObject(t,r){const n=this.isValid(t);if(n)throw n;return r&&r[Ot.prim]?r[Ot.prim](t):{string:t}}ExtractSchema(){return Ot.prim}generateSchema(){const t=this.createToken(this.val.args[0],0);return{__michelsonType:Ot.prim,schema:{parameter:this.val.args[0]?t.generateSchema():{}}}}findAndReturnTokens(t,r){return Ot.prim===t&&r.push(this),r}}Ot.prim="contract";class $f extends Z{constructor(t,r,n){super(t,r,n),this.value=t,this.token=r,this.name="ListValidationError"}}class He extends at{constructor(t,r,n){super(t,r,n),this.val=t,this.idx=r,this.fac=n}get valueSchema(){return this.createToken(this.val.args[0],this.idx)}isValid(t){return Array.isArray(t)?null:new $f(t,this,"Value must be an array")}Encode(t){const r=t.pop(),n=this.isValid(r);if(n)throw n;const i=this.createToken(this.val.args[0],0);return r.reduce((s,o)=>[...s,i.EncodeObject(o)],[])}Execute(t,r){const n=this.createToken(this.val.args[0],0),i=this.isValid(t);if(i)throw i;return t.reduce((s,o)=>[...s,n.Execute(o,r)],[])}EncodeObject(t,r){const n=this.createToken(this.val.args[0],0),i=this.isValid(t);if(i)throw i;return r&&r[He.prim]?r[He.prim](t):t.reduce((s,o)=>[...s,n.EncodeObject(o)],[])}ExtractSchema(){return{[He.prim]:this.valueSchema.ExtractSchema()}}generateSchema(){return{__michelsonType:He.prim,schema:this.valueSchema.generateSchema()}}findAndReturnTokens(t,r){return He.prim===t&&r.push(this),this.createToken(this.val.args[0],this.idx).findAndReturnTokens(t,r),r}}He.prim="list";class Bf extends Z{constructor(t,r,n){super(t,r,n),this.value=t,this.token=r,this.name="MutezValidationError"}}class Zt extends it{constructor(t,r,n){super(t,r,n),this.val=t,this.idx=r,this.fac=n}Execute(t){return new R(t[Object.keys(t)[0]])}ExtractSchema(){return Zt.prim}generateSchema(){return{__michelsonType:Zt.prim,schema:Zt.prim}}isValid(t){return new R(t).isNaN()?new Bf(t,this,`Value is not a number: ${t}`):null}Encode(t){const r=t.pop(),n=this.isValid(r);if(n)throw n;return{int:String(r).toString()}}EncodeObject(t,r){const n=this.isValid(t);if(n)throw n;return r&&r[Zt.prim]?r[Zt.prim](t):{int:String(t).toString()}}ToBigMapKey(t){return{key:{int:String(t)},type:{prim:Zt.prim}}}ToKey({int:t}){return t}compare(t,r){const n=Number(t),i=Number(r);return n===i?0:n<i?-1:1}findAndReturnTokens(t,r){return Zt.prim===t&&r.push(this),r}}Zt.prim="mutez";class kf extends Z{constructor(t,r,n){super(t,r,n),this.value=t,this.token=r,this.name="BytesValidationError"}}class Qt extends it{constructor(t,r,n){super(t,r,n),this.val=t,this.idx=r,this.fac=n}ToBigMapKey(t){return{key:{bytes:t},type:{prim:Qt.prim}}}isValid(t){return typeof t=="string"&&/^[0-9a-fA-F]*$/.test(t)&&t.length%2===0?null:new kf(t,this,`Invalid bytes: ${t}`)}convertUint8ArrayToHexString(t){return t.constructor===Uint8Array?Buffer.from(t).toString("hex"):t}Encode(t){let r=t.pop();r=oo(this.convertUint8ArrayToHexString(r));const n=this.isValid(r);if(n)throw n;return{bytes:String(r).toString()}}EncodeObject(t,r){t=this.convertUint8ArrayToHexString(t),typeof t=="string"&&(t=oo(t));const n=this.isValid(t);if(n)throw n;return r&&r[Qt.prim]?r[Qt.prim](t):{bytes:String(t).toString()}}Execute(t){return t.bytes}ExtractSchema(){return Qt.prim}generateSchema(){return{__michelsonType:Qt.prim,schema:Qt.prim}}ToKey({bytes:t,string:r}){return r||t}findAndReturnTokens(t,r){return Qt.prim===t&&r.push(this),r}}Qt.prim="bytes";class Ir extends it{constructor(t,r,n){super(t,r,n),this.val=t,this.idx=r,this.fac=n}subToken(){return this.createToken(this.val.args[0],this.idx)}schema(){return this.createToken(this.val.args[0],0)}annot(){return Array.isArray(this.val.annots)?super.annot():this.createToken(this.val.args[0],this.idx).annot()}Encode(t){const r=t;return r==null?{prim:"None"}:Array.isArray(r)&&(r[r.length-1]===void 0||r[r.length-1]===null)?(r.pop(),{prim:"None"}):{prim:"Some",args:[this.schema().Encode(t)]}}EncodeObject(t,r){const n=t;return n==null?{prim:"None"}:{prim:"Some",args:[this.schema().EncodeObject(n,r)]}}Execute(t,r){return t.prim==="None"?null:this.schema().Execute(t.args[0],r)}ExtractSchema(){return this.schema().ExtractSchema()}generateSchema(){return{__michelsonType:Ir.prim,schema:this.schema().generateSchema()}}ExtractSignature(){return[...this.schema().ExtractSignature(),[]]}get KeySchema(){return this.schema()}compare(t,r){if(t){if(!r)return 1}else return-1;return this.KeySchema.compare(t,r)}ToKey(t){return this.Execute(t)}ToBigMapKey(t){return{key:this.EncodeObject(t),type:this.typeWithoutAnnotations()}}findAndReturnTokens(t,r){return Ir.prim===t&&r.push(this),this.subToken().findAndReturnTokens(t,r),r}}Ir.prim="option";class te extends it{constructor(t,r,n){super(t,r,n),this.val=t,this.idx=r,this.fac=n}Execute(t){if(t.string&&/^\d+$/.test(t.string))return new Date(Number(t.string)*1e3).toISOString();if(t.string)return new Date(t.string).toISOString();if(t.int)return new Date(Number(t.int)*1e3).toISOString()}Encode(t){const r=t.pop();return typeof r=="number"?{int:String(r)}:{string:r}}EncodeObject(t,r){return r&&r[te.prim]?r[te.prim](t):typeof t=="number"?{int:String(t)}:{string:t}}ExtractSchema(){return te.prim}generateSchema(){return{__michelsonType:te.prim,schema:te.prim}}ToKey({string:t}){return t}ToBigMapKey(t){return{key:{string:t},type:{prim:te.prim}}}findAndReturnTokens(t,r){return te.prim===t&&r.push(this),r}}te.prim="timestamp";class jf extends Z{constructor(t,r,n){super(t,r,n),this.value=t,this.token=r,this.name="IntValidationError"}}class Et extends it{constructor(t,r,n){super(t,r,n),this.val=t,this.idx=r,this.fac=n}Execute(t){return new R(t[Object.keys(t)[0]])}ExtractSchema(){return Et.prim}generateSchema(){return{__michelsonType:Et.prim,schema:Et.prim}}isValid(t){return new R(t).isNaN()?new jf(t,this,`Value is not a number: ${t}`):null}Encode(t){const r=t.pop(),n=this.isValid(r);if(n)throw n;return{int:new R(r).toFixed()}}EncodeObject(t,r){const n=this.isValid(t);if(n)throw n;return r&&r[Et.prim]?r[Et.prim](t):{int:new R(t).toFixed()}}ToBigMapKey(t){return{key:{int:String(t)},type:{prim:Et.prim}}}ToKey({int:t}){return t}compare(t,r){const n=Number(t),i=Number(r);return n===i?0:n<i?-1:1}findAndReturnTokens(t,r){return Et.prim===t&&r.push(this),r}}Et.prim="int";class ee extends it{constructor(t,r,n){super(t,r,n),this.val=t,this.idx=r,this.fac=n}Encode(t){return t.pop(),{prim:"Unit"}}EncodeObject(t,r){return r&&r[ee.prim]?r[ee.prim](t):{prim:"Unit"}}Execute(t){return wa}ExtractSchema(){return ee.prim}generateSchema(){return{__michelsonType:ee.prim,schema:ee.prim}}compare(t,r){return 0}ToKey(t){return wa}ToBigMapKey(t){return{key:{prim:"Unit"},type:{prim:ee.prim}}}findAndReturnTokens(t,r){return ee.prim===t&&r.push(this),r}}ee.prim="unit";const Hf=4;class Vf extends Z{constructor(t,r,n){super(t,r,n),this.value=t,this.token=r,this.name="KeyValidationError"}}class re extends it{constructor(t,r,n){super(t,r,n),this.val=t,this.idx=r,this.fac=n}Execute(t){return t.string?t.string:Dl(t.bytes)}isValid(t){return $l(t)!==x.VALID?new Vf(t,this,"Key is not valid"):null}Encode(t){const r=t.pop(),n=this.isValid(r);if(n)throw n;return{string:r}}EncodeObject(t,r){const n=this.isValid(t);if(n)throw n;return r&&r[re.prim]?r[re.prim](t):{string:t}}ExtractSchema(){return re.prim}generateSchema(){return{__michelsonType:re.prim,schema:re.prim}}ToKey(t){return this.Execute(t)}ToBigMapKey(t){return{key:{string:t},type:{prim:re.prim}}}compare(t,r){const n=this.getPrefix(t),i=this.getPrefix(r);if(n===C.EDPK&&i!==C.EDPK)return-1;if(n===C.SPPK&&i!==C.SPPK)return i===C.EDPK?1:-1;if(n===C.P2PK){if(i!==C.P2PK)return 1;const s=this.getP256PublicKeyComparableBytes(t),o=this.getP256PublicKeyComparableBytes(r);return Buffer.compare(s,o)}return super.compare(t,r)}getPrefix(t){return t.substring(0,Hf)}getP256PublicKeyComparableBytes(t){return Fa(t,Ts[C.P2PK]).slice(1)}findAndReturnTokens(t,r){return re.prim===t&&r.push(this),r}}re.prim="key";class Uf extends Z{constructor(t,r,n){super(t,r,n),this.value=t,this.token=r,this.name="KeyHashValidationError"}}class ne extends it{constructor(t,r,n){super(t,r,n),this.val=t,this.idx=r,this.fac=n}Execute(t){return t.string?t.string:ao(t.bytes)}isValid(t){return Ns(t)!==x.VALID?new Uf(t,this,`KeyHash is not valid: ${t}`):null}Encode(t){const r=t.pop(),n=this.isValid(r);if(n)throw n;return{string:r}}EncodeObject(t,r){const n=this.isValid(t);if(n)throw n;return r&&r[ne.prim]?r[ne.prim](t):{string:t}}ExtractSchema(){return ne.prim}generateSchema(){return{__michelsonType:ne.prim,schema:ne.prim}}ToKey({string:t,bytes:r}){return t||ao(r)}ToBigMapKey(t){return{key:{string:t},type:{prim:ne.prim}}}findAndReturnTokens(t,r){return ne.prim===t&&r.push(this),r}}ne.prim="key_hash";class Gf extends Z{constructor(t,r,n){super(t,r,n),this.value=t,this.token=r,this.name="SignatureValidationError"}}class ie extends it{constructor(t,r,n){super(t,r,n),this.val=t,this.idx=r,this.fac=n}Execute(t){return t.string?t.string:t.bytes}isValid(t){return Bl(t)!==x.VALID?new Gf(t,this,"Signature is not valid"):null}Encode(t){const r=t.pop(),n=this.isValid(r);if(n)throw n;return{string:r}}EncodeObject(t,r){const n=this.isValid(t);if(n)throw n;return r&&r[ie.prim]?r[ie.prim](t):{string:t}}ExtractSchema(){return ie.prim}generateSchema(){return{__michelsonType:ie.prim,schema:ie.prim}}ToKey(t){return this.Execute(t)}ToBigMapKey(t){return{key:{string:t},type:{prim:ie.prim}}}findAndReturnTokens(t,r){return ie.prim===t&&r.push(this),r}}ie.prim="signature";class Ve extends at{constructor(t,r,n){super(t,r,n),this.val=t,this.idx=r,this.fac=n}get paramSchema(){return this.createToken(this.val.args[0],this.idx)}get returnSchema(){return this.createToken(this.val.args[1],this.idx+1)}Execute(t){return t.string?t.string:t}Encode(t){return t.pop()}EncodeObject(t,r){return r&&r[Ve.prim]?r[Ve.prim](t):t}ExtractSchema(){return{[Ve.prim]:{parameters:this.paramSchema.ExtractSchema(),returns:this.returnSchema.ExtractSchema()}}}generateSchema(){return{__michelsonType:Ve.prim,schema:{parameters:this.paramSchema.generateSchema(),returns:this.returnSchema.generateSchema()}}}findAndReturnTokens(t,r){return Ve.prim===t&&r.push(this),this.createToken(this.val.args[0],this.idx).findAndReturnTokens(t,r),this.createToken(this.val.args[1],this.idx).findAndReturnTokens(t,r),r}}Ve.prim="lambda";class _e extends at{constructor(t,r,n){super(t,r,n),this.val=t,this.idx=r,this.fac=n}Execute(t){return t.string}Encode(...t){return{string:t.pop()}}EncodeObject(t,r){return r&&r[_e.prim]?r[_e.prim](t):{string:t}}ExtractSchema(){return _e.prim}generateSchema(){return{__michelsonType:_e.prim,schema:_e.prim}}findAndReturnTokens(t,r){return _e.prim===t&&r.push(this),r}}_e.prim="operation";class Kf extends Z{constructor(t,r,n){super(t,r,n),this.value=t,this.token=r,this.name="SetValidationError"}}class Ue extends at{constructor(t,r,n){super(t,r,n),this.val=t,this.idx=r,this.fac=n}get KeySchema(){return this.createToken(this.val.args[0],0)}isValid(t){return Array.isArray(t)?null:new Kf(t,this,"Value must be an array")}Encode(t){const r=t.pop(),n=this.isValid(r);if(n)throw n;return r.sort((i,s)=>this.KeySchema.compare(i,s)).reduce((i,s)=>[...i,this.KeySchema.EncodeObject(s)],[])}Execute(t,r){return t.reduce((n,i)=>[...n,this.KeySchema.Execute(i,r)],[])}EncodeObject(t,r){const n=this.isValid(t);if(n)throw n;return r&&r[Ue.prim]?r[Ue.prim](t):t.sort((i,s)=>this.KeySchema.compare(i,s)).reduce((i,s)=>[...i,this.KeySchema.EncodeObject(s)],[])}ExtractSchema(){return Ue.prim}generateSchema(){return{__michelsonType:Ue.prim,schema:this.KeySchema.generateSchema()}}findAndReturnTokens(t,r){return Ue.prim===t&&r.push(this),this.KeySchema.findAndReturnTokens(t,r),r}}Ue.prim="set";class Ff extends Z{constructor(t,r,n){super(t,r,n),this.value=t,this.token=r,this.name="ChainIDValidationError"}}class se extends it{constructor(t,r,n){super(t,r,n),this.val=t,this.idx=r,this.fac=n}isValid(t){return qa(t)!==x.VALID?new Ff(t,this,"ChainID is not valid"):null}Execute(t){return t[Object.keys(t)[0]]}ExtractSchema(){return se.prim}generateSchema(){return{__michelsonType:se.prim,schema:se.prim}}Encode(t){const r=t.pop(),n=this.isValid(r);if(n)throw n;return{string:r}}EncodeObject(t,r){const n=this.isValid(t);if(n)throw n;return r&&r[se.prim]?r[se.prim](t):{string:t}}ToKey({string:t}){return t}ToBigMapKey(t){return{key:{string:t},type:{prim:se.prim}}}findAndReturnTokens(t,r){return se.prim===t&&r.push(this),r}}se.prim="chain_id";class ga extends Error{constructor(){super("Tickets cannot be sent to the blockchain; they are created on-chain"),this.name="TicketEncodeError"}}const qf={prim:"contract"},zf={prim:"int"};class ue extends at{constructor(t,r,n){super(t,r,n),this.val=t,this.idx=r,this.fac=n}get valueToken(){return this.createToken(this.val.args[0],this.idx)}Encode(t){throw new ga}EncodeObject(t,r){if(r&&r[ue.prim])return r[ue.prim](t,this.val);throw new ga}Execute(t,r){if(r&&r[ue.prim])return r[ue.prim](t,this.val);const n=this.createToken(qf,this.idx),i=this.valueToken,s=this.createToken(zf,this.idx);return t.args[2]===void 0&&t.args[1].args!==void 0?{ticketer:n.Execute(t.args[0],r),value:i.Execute(t.args[1].args[0],r),amount:s.Execute(t.args[1].args[1],r)}:{ticketer:n.Execute(t.args[0],r),value:i.Execute(t.args[1],r),amount:s.Execute(t.args[2],r)}}ExtractSchema(){return{ticketer:Ot.prim,value:this.valueToken.ExtractSchema(),amount:Et.prim}}generateSchema(){return{__michelsonType:ue.prim,schema:{value:this.valueToken.generateSchema(),ticketer:{__michelsonType:Ot.prim,schema:Ot.prim},amount:{__michelsonType:Et.prim,schema:Et.prim}}}}findAndReturnTokens(t,r){return ue.prim===t&&r.push(this),this.valueToken.findAndReturnTokens(t,r),r}}ue.prim="ticket";class ma extends Error{constructor(){super("Ticket_deprecated cannot be sent to the blockchain; they are created on-chain"),this.name="TicketDeprecatedEncodeError"}}const Yf={prim:"contract"},Wf={prim:"int"};class le extends at{constructor(t,r,n){super(t,r,n),this.val=t,this.idx=r,this.fac=n}get valueToken(){return this.createToken(this.val.args[0],this.idx)}Encode(t){throw new ma}EncodeObject(t,r){if(r&&r[le.prim])return r[le.prim](t,this.val);throw new ma}Execute(t,r){if(r&&r[le.prim])return r[le.prim](t,this.val);const n=this.createToken(Yf,this.idx),i=this.valueToken,s=this.createToken(Wf,this.idx);return t.args[2]===void 0&&t.args[1].args!==void 0?{ticketer:n.Execute(t.args[0],r),value:i.Execute(t.args[1].args[0],r),amount:s.Execute(t.args[1].args[1],r)}:{ticketer:n.Execute(t.args[0],r),value:i.Execute(t.args[1],r),amount:s.Execute(t.args[2],r)}}ExtractSchema(){return{ticketer:Ot.prim,value:this.valueToken.ExtractSchema(),amount:Et.prim}}generateSchema(){return{__michelsonType:le.prim,schema:{value:this.valueToken.generateSchema(),ticketer:{__michelsonType:Ot.prim,schema:Ot.prim},amount:{__michelsonType:Et.prim,schema:Et.prim}}}}findAndReturnTokens(t,r){return le.prim===t&&r.push(this),this.valueToken.findAndReturnTokens(t,r),r}}le.prim="ticket_deprecated";class ts extends Z{constructor(t,r,n){super(t,r,n),this.value=t,this.token=r,this.name="NeverTokenError"}}class we extends at{constructor(t,r,n){super(t,r,n),this.val=t,this.idx=r,this.fac=n}Encode(t){const r=t.pop();throw new ts(r,this,"Assigning a value to the type never is forbidden.")}EncodeObject(t,r){if(r&&r[we.prim])return r[we.prim](t);throw new ts(t,this,"Assigning a value to the type never is forbidden.")}Execute(t){throw new ts(t,this,"There is no literal value for the type never.")}ExtractSchema(){return we.prim}generateSchema(){return{__michelsonType:we.prim,schema:we.prim}}findAndReturnTokens(t,r){return we.prim===t&&r.push(this),r}}we.prim="never";class es extends Z{constructor(t,r,n){super(t,r,n),this.value=t,this.token=r,this.name="SaplingStateValidationError"}}class oe extends at{constructor(t,r,n){super(t,r,n),this.val=t,this.idx=r,this.fac=n}isValid(t){return typeof t=="object"&&Object.keys(t).length===0}Execute(t,r){if(r&&r[oe.prim])return r[oe.prim](t,this.val);if("int"in t)return t.int;throw new es(t,this,`Sapling state is expecting an object with an int property. Got ${JSON.stringify(t)}`)}Encode(t){const r=t.pop();if(this.isValid(r))return[];throw new es(r,this,`Invalid sapling_state. Received: ${r} while expecting: {}`)}EncodeObject(t,r){if(r&&r[oe.prim])return r[oe.prim](t);if(this.isValid(t))return[];throw new es(t,this,`Invalid sapling_state. Received: ${t} while expecting: {}`)}ExtractSchema(){return{[oe.prim]:{"memo-size":Number(this.val.args[0].int)}}}generateSchema(){return{__michelsonType:oe.prim,schema:{memoSize:this.val.args[0].int}}}findAndReturnTokens(t,r){return oe.prim===t&&r.push(this),r}}oe.prim="sapling_state";class ya extends Z{constructor(t,r,n){super(t,r,n),this.value=t,this.token=r,this.name="SaplingTransactionValidationError"}}class Ge extends at{constructor(t,r,n){super(t,r,n),this.val=t,this.idx=r,this.fac=n}Execute(t){throw new ya(t,this,"There is no literal value for the sapling_transaction type.")}validateBytes(t){const r=/^(0x|0X)?([0-9a-fA-F]*$)/.exec(t);if(r&&r[2].length%2===0)return r[2];throw new ya(t,this,`Invalid bytes: ${t}`)}convertUint8ArrayToHexString(t){return t.constructor===Uint8Array?Buffer.from(t).toString("hex"):t}Encode(t){let r=t.pop();return r=this.validateBytes(this.convertUint8ArrayToHexString(r)),{bytes:String(r).toString()}}EncodeObject(t,r){return t=this.validateBytes(this.convertUint8ArrayToHexString(t)),r&&r[Ge.prim]?r[Ge.prim](t):{bytes:String(t).toString()}}ExtractSchema(){return{[Ge.prim]:{"memo-size":Number(this.val.args[0].int)}}}generateSchema(){return{__michelsonType:Ge.prim,schema:{memoSize:this.val.args[0].int}}}findAndReturnTokens(t,r){return Ge.prim===t&&r.push(this),r}}Ge.prim="sapling_transaction";class Ea extends Z{constructor(t,r,n){super(t,r,n),this.value=t,this.token=r,this.name="SaplingTransactionDeprecatedValidationError"}}class Ke extends at{constructor(t,r,n){super(t,r,n),this.val=t,this.idx=r,this.fac=n}Execute(t){throw new Ea(t,this,"There is no literal value for the sapling_transaction_deprecated type.")}validateBytes(t){const r=/^(0x|0X)?([0-9a-fA-F]*$)/.exec(t);if(r&&r[2].length%2===0)return r[2];throw new Ea(t,this,`Invalid bytes: ${t}`)}convertUint8ArrayToHexString(t){return t.constructor===Uint8Array?Buffer.from(t).toString("hex"):t}Encode(t){let r=t.pop();return r=this.validateBytes(this.convertUint8ArrayToHexString(r)),{bytes:String(r).toString()}}EncodeObject(t,r){return t=this.validateBytes(this.convertUint8ArrayToHexString(t)),r&&r[Ke.prim]?r[Ke.prim](t):{bytes:String(t).toString()}}ExtractSchema(){return{[Ke.prim]:{"memo-size":Number(this.val.args[0].int)}}}generateSchema(){return{__michelsonType:Ke.prim,schema:{memoSize:this.val.args[0].int}}}findAndReturnTokens(t,r){return Ke.prim===t&&r.push(this),r}}Ke.prim="sapling_transaction_deprecated";class Jf extends Z{constructor(t,r,n){super(t,r,n),this.value=t,this.token=r,this.name="Bls12381frValidationError"}}class Ae extends at{constructor(t,r,n){super(t,r,n),this.val=t,this.idx=r,this.fac=n}isValid(t){return/^[0-9a-fA-F]*$/.test(t)&&t.length%2===0?null:new Jf(t,this,`Invalid bytes: ${t}`)}convertUint8ArrayToHexString(t){return t.constructor===Uint8Array?Buffer.from(t).toString("hex"):t}Encode(t){let r=t.pop();if(typeof r=="number")return{int:r.toString()};{r=this.convertUint8ArrayToHexString(r);const n=this.isValid(r);if(n)throw n;return{bytes:r}}}EncodeObject(t,r){if(r&&r[Ae.prim])return r[Ae.prim](t);if(typeof t=="number")return{int:t.toString()};{t=this.convertUint8ArrayToHexString(t);const n=this.isValid(t);if(n)throw n;return{bytes:t}}}Execute(t){return t.bytes}ExtractSchema(){return Ae.prim}generateSchema(){return{__michelsonType:Ae.prim,schema:Ae.prim}}findAndReturnTokens(t,r){return Ae.prim===t&&r.push(this),r}}Ae.prim="bls12_381_fr";class Xf extends Z{constructor(t,r,n){super(t,r,n),this.value=t,this.token=r,this.name="Bls12381g1ValidationError"}}class Re extends at{constructor(t,r,n){super(t,r,n),this.val=t,this.idx=r,this.fac=n}isValid(t){return/^[0-9a-fA-F]*$/.test(t)&&t.length%2===0?null:new Xf(t,this,`Invalid bytes: ${t}`)}convertUint8ArrayToHexString(t){return t.constructor===Uint8Array?Buffer.from(t).toString("hex"):t}Encode(t){let r=t.pop();r=this.convertUint8ArrayToHexString(r);const n=this.isValid(r);if(n)throw n;return{bytes:r}}EncodeObject(t,r){t=this.convertUint8ArrayToHexString(t);const n=this.isValid(t);if(n)throw n;return r&&r[Re.prim]?r[Re.prim](t):{bytes:t}}Execute(t){return t.bytes}ExtractSchema(){return Re.prim}generateSchema(){return{__michelsonType:Re.prim,schema:Re.prim}}findAndReturnTokens(t,r){return Re.prim===t&&r.push(this),r}}Re.prim="bls12_381_g1";class Zf extends Z{constructor(t,r,n){super(t,r,n),this.value=t,this.token=r,this.name="Bls12381g2ValidationError"}}class Oe extends at{constructor(t,r,n){super(t,r,n),this.val=t,this.idx=r,this.fac=n}isValid(t){return/^[0-9a-fA-F]*$/.test(t)&&t.length%2===0?null:new Zf(t,this,`Invalid bytes: ${t}`)}convertUint8ArrayToHexString(t){return t.constructor===Uint8Array?Buffer.from(t).toString("hex"):t}Encode(t){let r=t.pop();r=this.convertUint8ArrayToHexString(r);const n=this.isValid(r);if(n)throw n;return{bytes:r}}EncodeObject(t,r){t=this.convertUint8ArrayToHexString(t);const n=this.isValid(t);if(n)throw n;return r&&r[Oe.prim]?r[Oe.prim](t):{bytes:t}}Execute(t){return t.bytes}ExtractSchema(){return Oe.prim}generateSchema(){return{__michelsonType:Oe.prim,schema:Oe.prim}}findAndReturnTokens(t,r){return Oe.prim===t&&r.push(this),r}}Oe.prim="bls12_381_g2";class Qf extends Z{constructor(t,r,n){super(t,r,n),this.value=t,this.token=r,this.name="ChestValidationError"}}class Pe extends at{constructor(t,r,n){super(t,r,n),this.val=t,this.idx=r,this.fac=n}isValid(t){return/^[0-9a-fA-F]*$/.test(t)&&t.length%2===0?null:new Qf(t,this,`Invalid bytes: ${t}`)}convertUint8ArrayToHexString(t){return t.constructor===Uint8Array?Buffer.from(t).toString("hex"):t}Encode(t){let r=t.pop();r=this.convertUint8ArrayToHexString(r);const n=this.isValid(r);if(n)throw n;return{bytes:r}}EncodeObject(t,r){t=this.convertUint8ArrayToHexString(t);const n=this.isValid(t);if(n)throw n;return r&&r[Pe.prim]?r[Pe.prim](t):{bytes:t}}Execute(t){return t.bytes}ExtractSchema(){return Pe.prim}generateSchema(){return{__michelsonType:Pe.prim,schema:Pe.prim}}findAndReturnTokens(t,r){return Pe.prim===t&&r.push(this),r}}Pe.prim="chest";class tg extends Z{constructor(t,r,n){super(t,r,n),this.value=t,this.token=r,this.name="ChestKeyValidationError"}}class Ie extends at{constructor(t,r,n){super(t,r,n),this.val=t,this.idx=r,this.fac=n}isValid(t){return/^[0-9a-fA-F]*$/.test(t)&&t.length%2===0?null:new tg(t,this,`Invalid bytes: ${t}`)}convertUint8ArrayToHexString(t){return t.constructor===Uint8Array?Buffer.from(t).toString("hex"):t}Encode(t){let r=t.pop();r=this.convertUint8ArrayToHexString(r);const n=this.isValid(r);if(n)throw n;return{bytes:r}}EncodeObject(t,r){t=this.convertUint8ArrayToHexString(t);const n=this.isValid(t);if(n)throw n;return r&&r[Ie.prim]?r[Ie.prim](t):{bytes:t}}Execute(t){return t.bytes}ExtractSchema(){return Ie.prim}generateSchema(){return{__michelsonType:Ie.prim,schema:Ie.prim}}findAndReturnTokens(t,r){return Ie.prim===t&&r.push(this),r}}Ie.prim="chest_key";class ba extends Z{constructor(t,r,n){super(t,r,n),this.value=t,this.token=r,this.name="GlobalConstantEncodingError"}}class eg extends Z{constructor(t,r,n){super(t,r,n),this.value=t,this.token=r,this.name="GlobalConstantDecodingError"}}class ae extends at{constructor(t,r,n){super(t,r,n),this.val=t,this.idx=r,this.fac=n}Execute(t,r){if(r&&r[ae.prim])return r[ae.prim](t,this.val);throw new eg(t,this,`Unable to decode a value represented by a globalThis constants. Please provide an expanded script to the Michelson-Encoder or semantics for the decoding. The following globalThis constant hash was encountered: ${this.val.args[0].string}.`)}Encode(t){throw new ba(t,this,`Unable to encode a script containing globalThis constants. Please provide an expanded script to the Michelson-Encoder. The following globalThis constant hash was encountered: ${this.val.args[0].string}.`)}EncodeObject(t,r){if(r&&r[ae.prim])return r[ae.prim](t);throw new ba(t,this,`Unable to encode a script containing globalThis constants. Please provide an expanded script to the Michelson-Encoder. The following globalThis constant hash was encountered: ${this.val.args[0].string}.`)}ExtractSchema(){return ae.prim}generateSchema(){return{__michelsonType:ae.prim,schema:{hash:this.val.args[0].string}}}findAndReturnTokens(t,r){return ae.prim===t&&r.push(this),r}}ae.prim="constant";const rg=[ot,Wt,Jt,xt,be,ve,qe,Xt,F,Ot,He,Zt,Qt,Ir,te,Et,ee,re,ne,ie,Ve,_e,Ue,se,ue,le,we,oe,Ge,Ke,Ae,Re,Oe,Pe,Ie,ae];class ng extends Error{constructor(t,r){super(t),this.message=t,this.data=r,this.name="Invalid token error"}}function hr(e,t){if(Array.isArray(e))return new ot(e,t,hr);const r=rg.find(n=>n.prim===e.prim);if(!r)throw new ng("Malformed data expected a value with a valid prim property",e);return new r(e,t,hr)}class ig extends Error{constructor(t,r){super(`Unable to encode the parameter of the view: ${t}.`),this.smartContractViewName=t,this.originalError=r,this.name="ViewEncodingError"}}class va extends Error{constructor(t){super(t),this.message=t,this.name="InvalidScriptError"}}class qc extends Error{constructor(t){super("Invalid RPC response passed as argument(s)"),this.script=t,this.name="InvalidRpcResponseError"}}class _a extends Error{constructor(t,r,n){super(`
      ${t}. Error encountered when trying to encode arguments: 

      [${r}]
    `),this.message=t,this.args=r,this.originalError=n,this.name="ParameterEncodingError"}}class yn extends Error{constructor(t){super(t),this.message=t,this.name="InvalidBigMapSchema"}}class sg extends Error{constructor(t){super(t),this.message=t,this.name="InvalidBigMapDiff"}}class og extends Error{constructor(t,r){super(`Unable to encode ${t}. ${r}`),this.obj=t,this.details=r,this.name="BigMapEncodingError"}}class ag extends Error{constructor(t,r){super(`Unable to encode ${t}. ${r}`),this.obj=t,this.details=r,this.name="StorageEncodingError"}}class cg extends Error{constructor(t){super(t),this.message=t,this.name="MissingArgumentError"}}var zc;const Yc=Symbol.for("taquito-schema-type-symbol");function Ur(e,t=ot.prim){var r,n;if(Array.isArray(e))return Ur({prim:t,args:e},t);const i=e;return i.prim===t&&i.args&&i.args.length>2?Object.assign(Object.assign({},i),{args:[(r=i.args)===null||r===void 0?void 0:r[0],{prim:t,args:(n=i.args)===null||n===void 0?void 0:n.slice(1)}]}):i}function Wc(e,t){const r=Ur(e),n=Ur(t);return r.prim===n.prim&&(r.args===void 0&&n.args===void 0||r.args!==void 0&&n.args!==void 0&&r.args.length===n.args.length&&r.args.every((i,s)=>{var o,a;return Wc(i,(a=(o=n.args)===null||o===void 0?void 0:o[s])!==null&&a!==void 0?a:{})}))&&(r.annots===void 0&&n.annots===void 0||r.annots!==void 0&&n.annots!==void 0&&r.annots.length===n.annots.length&&r.annots.every((i,s)=>{var o;return i===((o=n.annots)===null||o===void 0?void 0:o[s])}))}class Mt{constructor(t){if(this.val=t,this[zc]=!0,this.root=hr(t,0),this.root instanceof xt)this.bigMap=this.root;else if(this.isExpressionExtended(t)&&t.prim==="pair"){const r=t.args[0];this.isExpressionExtended(r)&&r.prim==="big_map"&&(this.bigMap=new xt(r,0,hr))}}static isSchema(t){return t&&t[Yc]===!0}static fromRPCResponse(t){const r=t&&t.script&&Array.isArray(t.script.code)&&t.script.code.find(n=>{if(Array.isArray(n))this.fromRPCResponse({script:{code:n,storage:t.script.storage}});else{const i=n;return i.prim?i.prim==="storage":!1}});if(!r||!Array.isArray(r.args))throw new qc(t.script);return new Mt(r.args[0])}isExpressionExtended(t){return"prim"in t&&Array.isArray(t.args)}removeTopLevelAnnotation(t){return(this.root instanceof ot||this.root instanceof F)&&this.root.hasAnnotations()&&typeof t=="object"&&Object.keys(t).length===1?t[Object.keys(t)[0]]:t}Execute(t,r){const n=this.root.Execute(t,r);return this.removeTopLevelAnnotation(n)}Typecheck(t){if(this.root instanceof xt&&Number.isInteger(Number(t))||this.root instanceof ue&&t.ticketer&&t.value&&t.amount||this.root instanceof le&&t.ticketer&&t.value&&t.amount||this.root instanceof qe&&this.root.ValueSchema instanceof xt)return!0;try{return this.root.EncodeObject(t),!0}catch{return!1}}ExecuteOnBigMapDiff(t,r){if(!this.bigMap)throw new yn("Big map schema is undefined");if(!Array.isArray(t))throw new sg("Big map diff must be an array");const n=t.map(({key:i,value:s})=>({args:[i,s]}));return this.bigMap.Execute(n,r)}ExecuteOnBigMapValue(t,r){if(!this.bigMap)throw new yn("No big map schema");return this.bigMap.ValueSchema.Execute(t,r)}EncodeBigMapKey(t){if(!this.bigMap)throw new yn("Big map schema is undefined");try{return this.bigMap.KeySchema.ToBigMapKey(t)}catch(r){throw new og("big map key",r)}}Encode(t,r){try{return this.root.EncodeObject(t,r)}catch(n){throw n instanceof Z?n:new ag("storage object",n)}}ExtractSchema(){return this.removeTopLevelAnnotation(this.root.ExtractSchema())}generateSchema(){return this.removeTopLevelAnnotation(this.root.generateSchema())}ComputeState(t,r){if(!this.bigMap)throw new yn("Big map schema is undefined");const n=t.reduce((i,s)=>Object.assign(Object.assign({},i),this.ExecuteOnBigMapDiff(s.contents[0].metadata.operation_result.big_map_diff)),{});return Object.assign(Object.assign({},this.Execute(r)),{[this.bigMap.annot()]:n})}FindFirstInTopLevelPair(t,r){return this.findValue(this.root.val,t,r)}findValue(t,r,n){if(Wc(n,t))return r;if(Array.isArray(t)||t.prim==="pair"){const i=Ur(t),s=Ur(r,"Pair");if(i.args===void 0||s.args===void 0)throw new cg("Tokens have no arguments");if(i.args[0])return this.findValue(i.args[0],s.args[0],n)||this.findValue(i.args[1],s.args[1],n)}}findToken(t){const r=[];return this.root.findAndReturnTokens(t,r)}}zc=Yc;class vr{constructor(t){this.root=hr(t,0)}static fromRPCResponse(t){const r=t&&t.script&&Array.isArray(t.script.code)&&t.script.code.find(n=>n.prim==="parameter");if(!r||!Array.isArray(r.args))throw new qc(t.script);return new vr(r.args[0])}get isMultipleEntryPoint(){return this.root instanceof F||this.root instanceof Ir&&this.root.subToken()instanceof F}get hasAnnotation(){return this.isMultipleEntryPoint?Object.keys(this.ExtractSchema())[0]!=="0":!0}Execute(t,r){return this.root.Execute(t,r)}Encode(...t){try{return this.root.Encode(t.reverse())}catch(r){throw r instanceof Z?r:new _a("Unable to encode parameter",t.toString(),r)}}EncodeObject(t,r){try{return this.root.EncodeObject(t,r)}catch(n){throw n instanceof Z?n:new _a("Unable to encode parameter object",t,n)}}ExtractSchema(){return this.root.ExtractSchema()}generateSchema(){return this.root.generateSchema()}ExtractSignatures(){return this.root.ExtractSignature()}}class Ws{constructor(t){if(t.length!==4||!("string"in t[0]))throw new va(`Invalid on-chain view: ${JSON.stringify(t)}`);this.viewName=t[0].string,this.viewArgsType=t[1],this.viewReturnType=t[2],this.instructions=t[3],this.rootArgsType=hr(this.viewArgsType,0),this.rootReturnType=hr(this.viewReturnType,0)}static fromRPCResponse(t){const r=[],n=t&&t.script&&Array.isArray(t.script.code)&&t.script.code.filter(i=>i.prim==="view");return n&&n.forEach(i=>{if(!i.args||i.args.length!==4)throw new va(`Invalid on-chain view found in the script: ${JSON.stringify(i)}`);r.push(new Ws(i.args))}),r}encodeViewArgs(t){try{return this.rootArgsType.EncodeObject(t)}catch(r){throw new ig(this.viewName,r)}}decodeViewResult(t,r){return this.rootReturnType.Execute(t,r)}extractArgsSchema(){return this.rootArgsType.ExtractSchema()}extractResultSchema(){return this.rootReturnType.ExtractSchema()}}const wa=Symbol(),_t=Symbol("source_reference");class or extends Error{constructor(t,r,n){super(n),this.src=t,this.idx=r,Object.setPrototypeOf(this,or.prototype)}}var At;(function(e){e[e.Comment=0]="Comment",e[e.Number=1]="Number",e[e.String=2]="String",e[e.Bytes=3]="Bytes",e[e.Ident=4]="Ident"})(At||(At={}));const ug=new RegExp("\\s"),lg=new RegExp("[:@%_A-Za-z]"),hg=new RegExp("[@%_\\.A-Za-z0-9]"),Aa=new RegExp("[0-9]"),pg=new RegExp("[0-9a-fA-F]");function*rs(e,t=!1){let r=0;for(;r<e.length;){for(;r<e.length&&ug.test(e[r]);)r++;if(r===e.length)return;const n=e[r],i=r;if(lg.test(n)){for(r++;r<e.length&&hg.test(e[r]);)r++;yield{t:At.Ident,v:e.slice(i,r),first:i,last:r}}else if(e.length-r>1&&e.substr(r,2)==="0x"){for(r+=2;r<e.length&&pg.test(e[r]);)r++;if(r-i&1)throw new or(e,r,"Bytes literal length is expected to be power of two");yield{t:At.Bytes,v:e.slice(i,r),first:i,last:r}}else if(Aa.test(n)||n==="-"){n==="-"&&r++;const s=r;for(;r<e.length&&Aa.test(e[r]);)r++;if(s===r)throw new or(e,r,"Number literal is too short");yield{t:At.Number,v:e.slice(i,r),first:i,last:r}}else if(n==='"'){r++;let s=!1;for(;r<e.length&&(s||e[r]!=='"');r++)!s&&e[r]==="\\"?s=!0:s=!1;if(r===e.length)throw new or(e,r,"Unterminated string literal");r++,yield{t:At.String,v:e.slice(i,r),first:i,last:r}}else if(n==="#"){for(r++;r<e.length&&e[r]!==`
`;)r++;t&&(yield{t:At.Comment,v:e.slice(i,r),first:i,last:r})}else if(e.length-r>1&&e.substr(r,2)==="/*"){for(r+=2;r<e.length&&!(e.length-r>1&&e.substr(r,2)==="*/");)r++;if(r===e.length)throw new or(e,r,"Unterminated C style comment");r+=2,t&&(yield{t:At.Comment,v:e.slice(i,r),first:i,last:r})}else if(n==="("||n===")"||n==="{"||n==="}"||n===";")r++,yield{t:n,v:n,first:i,last:r};else throw new or(e,r,`Invalid character at offset ${r}: \`${n}'`)}}const En=Symbol("ref_contract");var Me;(function(e){e.Ps9mPmXa="Ps9mPmXaRzmzk35gbAYNCAw6UXdE2qoABTHbN2oEEc1qM7CwT9P",e.PtCJ7pwo="PtCJ7pwoxe8JasnHY8YonnLYjcVHmhiARPJvqcC6VfHT5s8k8sY",e.PsYLVpVv="PsYLVpVvgbLhAhoqAkMFUo6gudkJ9weNXhUYCiLDzcUpFpkk8Wt",e.PsddFKi3="PsddFKi32cMJ2qPjf43Qv5GDWLDPZb3T3bF6fLKiF5HtvHNU7aP",e.Pt24m4xi="Pt24m4xiPbLDhVgVfABUjirbmda3yohdN82Sp9FeuAXJ4eV9otd",e.PsBABY5H="PsBABY5HQTSkA4297zNHfsZNKtxULfL18y95qb3m53QJiXGmrbU",e.PsBabyM1="PsBabyM1eUXZseaJdmXFApDSBqj8YBfwELoxZHHW77EMcAbbwAS",e.PsCARTHA="PsCARTHAGazKbHtnKfLzQg3kms52kSRpgnDY982a9oYsSXRLQEb",e.PsDELPH1="PsDELPH1Kxsxt8f9eWbxQeRxkjfbxoqM52jvs5Y5fBxWWh4ifpo",e.PtEdoTez="PtEdoTezd3RHSC31mpxxo1npxFjoWWcFgQtxapi51Z8TLu6v6Uq",e.PtEdo2Zk="PtEdo2ZkT9oKpimTah6x2embF25oss54njMuPzkJTEi5RqfdZFA",e.PsFLoren="PsFLorenaUUuikDWvMDr6fGBRG8kt3e3D3fHoXK1j1BFRxeSH4i",e.PsFLorena="PsFLorenaUUuikDWvMDr6fGBRG8kt3e3D3fHoXK1j1BFRxeSH4i",e.PtGRANAD="PtGRANADsDU8R9daYKAgWnQYAJ64omN1o3KMGVCykShA97vQbvV",e.PtGRANADs="PtGRANADsDU8R9daYKAgWnQYAJ64omN1o3KMGVCykShA97vQbvV",e.PtHangzH="PtHangzHogokSuiMHemCuowEavgYTP8J5qQ9fQS793MHYFpCY3r",e.PtHangz2="PtHangz2aRngywmSRGGvrcTyMbbdpWdpFKuS4uMWxg2RaH9i1qx",e.PsiThaCa="PsiThaCaT47Zboaw71QWScM8sXeMM7bbQFncK9FLqYc6EKdpjVP",e.Psithaca2="Psithaca2MLRFYargivpo7YvUr7wUDqyxrdhC5CQq78mRvimz6A",e.PtJakarta="PtJakartaiDz69SfDDLXJSiuZqTSeSKRDbKVZC8MNzJnvRjvnGw",e.PtJakart2="PtJakart2xVj7pYXJBXrqHgd82rdkLey5ZeeGwDgPp9rhQUbSqY",e.PtKathman="PtKathmankSpLLDALzWw7CGD2j2MtyveTwboEYokqUCP4a1LxMg",e.PtLimaPtL="PtLimaPtLMwfNinJi9rCfDPWea8dFgTZ1MeJ9f1m2SRic6ayiwW",e.PtMumbaii="PtMumbaiiFFEGbew1rRjzSPyzRbA51Tm3RVZL5suHPxSZYDhCEc",e.PtMumbai2="PtMumbai2TmsJHNGRkD8v8YDbtao7BLUC3wjASn1inAKLFCjaH1",e.ProtoALpha="ProtoALphaALphaALphaALphaALphaALphaALphaALphaDdp3zK"})(Me||(Me={}));const Jc=Me.Psithaca2,Ra={Ps9mPmXaRzmzk35gbAYNCAw6UXdE2qoABTHbN2oEEc1qM7CwT9P:0,PtCJ7pwoxe8JasnHY8YonnLYjcVHmhiARPJvqcC6VfHT5s8k8sY:1,PsYLVpVvgbLhAhoqAkMFUo6gudkJ9weNXhUYCiLDzcUpFpkk8Wt:2,PsddFKi32cMJ2qPjf43Qv5GDWLDPZb3T3bF6fLKiF5HtvHNU7aP:3,Pt24m4xiPbLDhVgVfABUjirbmda3yohdN82Sp9FeuAXJ4eV9otd:4,PsBABY5HQTSkA4297zNHfsZNKtxULfL18y95qb3m53QJiXGmrbU:5,PsBabyM1eUXZseaJdmXFApDSBqj8YBfwELoxZHHW77EMcAbbwAS:5,PsCARTHAGazKbHtnKfLzQg3kms52kSRpgnDY982a9oYsSXRLQEb:6,PsDELPH1Kxsxt8f9eWbxQeRxkjfbxoqM52jvs5Y5fBxWWh4ifpo:7,PtEdoTezd3RHSC31mpxxo1npxFjoWWcFgQtxapi51Z8TLu6v6Uq:8,PtEdo2ZkT9oKpimTah6x2embF25oss54njMuPzkJTEi5RqfdZFA:8,PsFLorenaUUuikDWvMDr6fGBRG8kt3e3D3fHoXK1j1BFRxeSH4i:9,PtGRANADsDU8R9daYKAgWnQYAJ64omN1o3KMGVCykShA97vQbvV:10,PtHangzHogokSuiMHemCuowEavgYTP8J5qQ9fQS793MHYFpCY3r:11,PtHangz2aRngywmSRGGvrcTyMbbdpWdpFKuS4uMWxg2RaH9i1qx:11,PsiThaCaT47Zboaw71QWScM8sXeMM7bbQFncK9FLqYc6EKdpjVP:12,Psithaca2MLRFYargivpo7YvUr7wUDqyxrdhC5CQq78mRvimz6A:12,PtJakartaiDz69SfDDLXJSiuZqTSeSKRDbKVZC8MNzJnvRjvnGw:13,PtJakart2xVj7pYXJBXrqHgd82rdkLey5ZeeGwDgPp9rhQUbSqY:13,PtKathmankSpLLDALzWw7CGD2j2MtyveTwboEYokqUCP4a1LxMg:14,PtLimaPtLMwfNinJi9rCfDPWea8dFgTZ1MeJ9f1m2SRic6ayiwW:15,PtMumbaiiFFEGbew1rRjzSPyzRbA51Tm3RVZL5suHPxSZYDhCEc:16,PtMumbai2TmsJHNGRkD8v8YDbtao7BLUC3wjASn1inAKLFCjaH1:16,ProtoALphaALphaALphaALphaALphaALphaALphaALphaDdp3zK:17};function _r(e,t){return Ra[e]<Ra[t]}class Dt extends Error{constructor(t,r){super(r),this.prim=t,Object.setPrototypeOf(this,Dt.prototype)}}function et(e,t){var r,n;if(t===0&&e.args===void 0||((r=e.args)===null||r===void 0?void 0:r.length)===t)return!0;throw new Dt(e,`macro ${e.prim} expects ${t} arguments, was given ${(n=e.args)===null||n===void 0?void 0:n.length}`)}function $r(e){if(e.annots===void 0)return!0;throw new Dt(e,`unexpected annotation on macro ${e.prim}: ${e.annots}`)}function Oa(e,t){if("int"in t)return!0;throw new Dt(e,`macro ${e.prim} expects int argument`)}function kr(e,t,r,n){let i=0,s=0;const o=[null,null];let a;if(i===t.length)throw new Dt(e,`unexpected end: ${e.prim}`);let c=t[i++];switch(c){case"P":{const{r:p,n:l,an:y}=kr(e,t.slice(i),r.slice(s),n);a=p,i+=l,s+=y;break}case"A":s!==r.length&&(o[0]=r[s++]);break;default:throw new Dt(e,`${e.prim}: unexpected character: ${c}`)}let d;if(i===t.length)throw new Dt(e,`unexpected end: ${e.prim}`);switch(c=t[i++],c){case"P":{const{r:p,n:l,an:y}=kr(e,t.slice(i),r.slice(s),n);d=p.map(([_,N])=>[_+1,N]),i+=l,s+=y;break}case"I":s!==r.length&&(o[1]=r[s++]);break;default:throw new Dt(e,`${e.prim}: unexpected character: ${c}`)}return{r:n(a,d,[0,o]),n:i,an:s}}function Hn(e,t,r,n){const i=t[0];switch(i){case"A":return t.length>1?[{prim:"DUP"},{prim:"DIP",args:[[{prim:"CAR",annots:["@%%"]},Hn(e,t.slice(1),[],n)]]},{prim:"CDR",annots:["@%%"]},{prim:"SWAP"},{prim:"PAIR",annots:["%@","%@",...r]}]:n.a;case"D":return t.length>1?[{prim:"DUP"},{prim:"DIP",args:[[{prim:"CDR",annots:["@%%"]},Hn(e,t.slice(1),[],n)]]},{prim:"CAR",annots:["@%%"]},{prim:"PAIR",annots:["%@","%@",...r]}]:n.d;default:throw new Dt(e,`${e.prim}: unexpected character: ${i}`)}}function dg(e,t){let r=e.length;for(;r>0&&e[r-1]===t;)r--;return e.slice(0,r)}function ns(e){const t=[],r=[];if(e!==void 0)for(const n of e)(n.length!==0&&n[0]==="%"?t:r).push(n);return{fields:t,rest:r}}function ct({prim:e,annots:t,args:r}){return Object.assign(Object.assign({prim:e},t&&{annots:t}),r&&{args:r})}const fg=/^P[PAI]{3,}R$/,gg=/^UNP[PAI]{2,}R$/,mg=/^C[AD]{2,}R$/,yg=/^SET_C[AD]+R$/,Eg=/^MAP_C[AD]+R$/,bg=/^DI{2,}P$/,vg=/^DU+P$/;function _g(e,t){const r=(t==null?void 0:t.protocol)||Jc;function n(i){return i!==void 0?[{prim:"RENAME",annots:i}]:[]}switch(e.prim){case"CMPEQ":case"CMPNEQ":case"CMPLT":case"CMPGT":case"CMPLE":case"CMPGE":if(et(e,0))return[{prim:"COMPARE"},ct({prim:e.prim.slice(3),annots:e.annots})];break;case"IFEQ":case"IFNEQ":case"IFLT":case"IFGT":case"IFLE":case"IFGE":if(et(e,2))return[{prim:e.prim.slice(2)},ct({prim:"IF",annots:e.annots,args:e.args})];break;case"IFCMPEQ":case"IFCMPNEQ":case"IFCMPLT":case"IFCMPGT":case"IFCMPLE":case"IFCMPGE":if(et(e,2))return[{prim:"COMPARE"},{prim:e.prim.slice(5)},ct({prim:"IF",annots:e.annots,args:e.args})];break;case"FAIL":if(et(e,0)&&$r(e))return[{prim:"UNIT"},{prim:"FAILWITH"}];break;case"ASSERT":if(et(e,0)&&$r(e))return[{prim:"IF",args:[[],[[{prim:"UNIT"},{prim:"FAILWITH"}]]]}];break;case"ASSERT_EQ":case"ASSERT_NEQ":case"ASSERT_LT":case"ASSERT_GT":case"ASSERT_LE":case"ASSERT_GE":if(et(e,0)&&$r(e))return[{prim:e.prim.slice(7)},{prim:"IF",args:[[],[[{prim:"UNIT"},{prim:"FAILWITH"}]]]}];break;case"ASSERT_CMPEQ":case"ASSERT_CMPNEQ":case"ASSERT_CMPLT":case"ASSERT_CMPGT":case"ASSERT_CMPLE":case"ASSERT_CMPGE":if(et(e,0)&&$r(e))return[[{prim:"COMPARE"},{prim:e.prim.slice(10)}],{prim:"IF",args:[[],[[{prim:"UNIT"},{prim:"FAILWITH"}]]]}];break;case"ASSERT_NONE":if(et(e,0)&&$r(e))return[{prim:"IF_NONE",args:[[],[[{prim:"UNIT"},{prim:"FAILWITH"}]]]}];break;case"ASSERT_SOME":if(et(e,0))return[{prim:"IF_NONE",args:[[[{prim:"UNIT"},{prim:"FAILWITH"}]],n(e.annots)]}];break;case"ASSERT_LEFT":if(et(e,0))return[{prim:"IF_LEFT",args:[n(e.annots),[[{prim:"UNIT"},{prim:"FAILWITH"}]]]}];break;case"ASSERT_RIGHT":if(et(e,0))return[{prim:"IF_LEFT",args:[[[{prim:"UNIT"},{prim:"FAILWITH"}]],n(e.annots)]}];break;case"IF_SOME":if(et(e,2))return[ct({prim:"IF_NONE",annots:e.annots,args:[e.args[1],e.args[0]]})];break;case"IF_RIGHT":if(et(e,2))return[ct({prim:"IF_LEFT",annots:e.annots,args:[e.args[1],e.args[0]]})];break;case"CAR":case"CDR":if(e.args!==void 0){if(et(e,1)&&Oa(e,e.args[0])){const i=parseInt(e.args[0].int,10);return ct({prim:"GET",args:[{int:e.prim==="CAR"?String(i*2+1):String(i*2)}],annots:e.annots})}}else return e}if(fg.test(e.prim)&&et(e,0)){const{fields:i,rest:s}=ns(e.annots),{r:o}=kr(e,e.prim.slice(1),i,(a,c,d)=>[...a||[],...c||[],d]);return o.map(([a,c],d)=>{const p=[...dg(c,null).map(y=>y===null?"%":y),...a===0&&d===o.length-1?s:[]],l=ct({prim:"PAIR",annots:p.length!==0?p:void 0});return a===0?l:{prim:"DIP",args:a===1?[[l]]:[{int:String(a)},[l]]}})}if(gg.test(e.prim))if(_r(r,Me.PtEdo2Zk)&&et(e,0)){const{r:i}=kr(e,e.prim.slice(3),e.annots||[],(s,o,a)=>[a,...o||[],...s||[]]);return i.map(([s,o])=>{const a=[{prim:"DUP"},ct({prim:"CAR",annots:o[0]!==null?[o[0]]:void 0}),{prim:"DIP",args:[[ct({prim:"CDR",annots:o[1]!==null?[o[1]]:void 0})]]}];return s===0?a:{prim:"DIP",args:s===1?[[a]]:[{int:String(s)},[a]]}})}else{if(e.prim==="UNPAIR")return e;if(et(e,0)){const{r:i}=kr(e,e.prim.slice(3),[],(s,o,a)=>[a,...o||[],...s||[]]);return i.map(([s])=>{const o=ct({prim:"UNPAIR"});return s===0?o:{prim:"DIP",args:s===1?[[o]]:[{int:String(s)},[o]]}})}}if(mg.test(e.prim)&&et(e,0)){const i=[...e.prim.slice(1,e.prim.length-1)];return i.map((s,o)=>{const a=o===i.length-1?e.annots:void 0;switch(s){case"A":return ct({prim:"CAR",annots:a});case"D":return ct({prim:"CDR",annots:a});default:throw new Dt(e,`unexpected character: ${s}`)}})}if(yg.test(e.prim)&&et(e,0)){const{fields:i,rest:s}=ns(e.annots);if(i.length>1)throw new Dt(e,`unexpected annotation on macro ${e.prim}: ${i}`);const o=i.length!==0?{a:[{prim:"DUP"},{prim:"CAR",annots:i},{prim:"DROP"},{prim:"CDR",annots:["@%%"]},{prim:"SWAP"},{prim:"PAIR",annots:[i[0],"%@"]}],d:[{prim:"DUP"},{prim:"CDR",annots:i},{prim:"DROP"},{prim:"CAR",annots:["@%%"]},{prim:"PAIR",annots:["%@",i[0]]}]}:{a:[{prim:"CDR",annots:["@%%"]},{prim:"SWAP"},{prim:"PAIR",annots:["%","%@"]}],d:[{prim:"CAR",annots:["@%%"]},{prim:"PAIR",annots:["%@","%"]}]};return Hn(e,e.prim.slice(5,e.prim.length-1),s,o)}if(Eg.test(e.prim)&&et(e,1)){const{fields:i}=ns(e.annots);if(i.length>1)throw new Dt(e,`unexpected annotation on macro ${e.prim}: ${i}`);const s={a:[{prim:"DUP"},{prim:"CDR",annots:["@%%"]},{prim:"DIP",args:[[ct({prim:"CAR",annots:i.length!==0?["@"+i[0].slice(1)]:void 0}),e.args[0]]]},{prim:"SWAP"},{prim:"PAIR",annots:[i.length!==0?i[0]:"%","%@"]}],d:[{prim:"DUP"},ct({prim:"CDR",annots:i.length!==0?["@"+i[0].slice(1)]:void 0}),e.args[0],{prim:"SWAP"},{prim:"CAR",annots:["@%%"]},{prim:"PAIR",annots:["%@",i.length!==0?i[0]:"%"]}]};return Hn(e,e.prim.slice(5,e.prim.length-1),[],s)}if(bg.test(e.prim)&&et(e,1)){let i=0;for(;e.prim[1+i]==="I";)i++;return ct({prim:"DIP",args:[{int:String(i)},e.args[0]]})}if(vg.test(e.prim)){let i=0;for(;e.prim[1+i]==="U";)i++;if(_r(r,Me.PtEdo2Zk)){if(i===1){if(e.args===void 0)return e;et(e,1)&&Oa(e,e.args[0])&&(i=parseInt(e.args[0].int,10))}else et(e,0);return i===1?[ct({prim:"DUP",annots:e.annots})]:i===2?[{prim:"DIP",args:[[ct({prim:"DUP",annots:e.annots})]]},{prim:"SWAP"}]:[{prim:"DIP",args:[{int:String(i-1)},[ct({prim:"DUP",annots:e.annots})]]},{prim:"DIG",args:[{int:String(i)}]}]}else{if(i===1)return e;if(et(e,0))return ct({prim:"DUP",args:[{int:String(i)}],annots:e.annots})}}return e}function wg(e,t){return e.args!==void 0&&e.args.length===1&&"string"in e.args[0]&&e.args[0].string in t?t[e.args[0].string]:e}class Ar extends Error{constructor(t,r){super(r),this.token=t,Object.setPrototypeOf(this,Ar.prototype)}}class zt extends Error{constructor(t,r){super(r),this.node=t,Object.setPrototypeOf(this,zt.prototype)}}const is=new Ar(null,"Unexpected EOF");function Pa(e){return e.t===At.Ident&&(e.v[0]==="@"||e.v[0]==="%"||e.v[0]===":")}const Ag=new RegExp("^-?[0-9]+$"),Rg=new RegExp("^([0-9a-fA-F]{2})*$");class ur{constructor(t){this.opt=t}expand(t){var r,n,i;if(((r=this.opt)===null||r===void 0?void 0:r.expandGlobalConstant)!==void 0&&t.prim==="constant"){const s=wg(t,this.opt.expandGlobalConstant);return s!==t&&(s[_t]=Object.assign(Object.assign({},t[_t]||{first:0,last:0}),{globalConstant:t})),s}if(((n=this.opt)===null||n===void 0?void 0:n.expandMacros)===void 0||!((i=this.opt)===null||i===void 0)&&i.expandMacros){const s=_g(t,this.opt);return s!==t&&(s[_t]=Object.assign(Object.assign({},t[_t]||{first:0,last:0}),{macro:t})),s}else return t}parseListExpr(t,r){var n;const i={first:r.first,last:r.last},s=r.t==="(";let o;if(s){if(o=t.next(),o.done)throw is;i.last=o.value.last}else o={value:r};if(o.value.t!==At.Ident)throw new Ar(o.value,`not an identifier: ${o.value.v}`);const a={prim:o.value.v,[_t]:i};for(;;){const c=t.next();if(c.done){if(s)throw is;break}else if(c.value.t===")"){if(!s)throw new Ar(c.value,"unexpected closing bracket");i.last=c.value.last;break}else if(Pa(c.value))a.annots=a.annots||[],a.annots.push(c.value.v),i.last=c.value.last;else{a.args=a.args||[];const d=this.parseExpr(t,c.value);i.last=((n=d[_t])===null||n===void 0?void 0:n.last)||i.last,a.args.push(d)}}return this.expand(a)}parseArgs(t,r){var n;const i={first:r.first,last:r.last},s={prim:r.v,[_t]:i};for(;;){const o=t.next();if(o.done||o.value.t==="}"||o.value.t===";")return[s,o];if(Pa(o.value))i.last=o.value.last,s.annots=s.annots||[],s.annots.push(o.value.v);else{const a=this.parseExpr(t,o.value);i.last=((n=a[_t])===null||n===void 0?void 0:n.last)||i.last,s.args=s.args||[],s.args.push(a)}}}parseSequenceExpr(t,r){var n,i;const s={first:r.first,last:r.last},o=[];o[_t]=s;const a=r.t==="{";let c=r.t==="{"?null:{value:r};for(;;){if(c===null&&(c=t.next(),c.done||(s.last=c.value.last)),c.done){if(a)throw is;return o}if(c.value.t==="}"){if(a)return o;throw new Ar(c.value,"unexpected closing bracket")}else if(c.value.t===At.Ident){const[d,p]=this.parseArgs(t,c.value);s.last=((n=d[_t])===null||n===void 0?void 0:n.last)||s.last,o.push(this.expand(d)),c=p}else{const d=this.parseExpr(t,c.value);s.last=((i=d[_t])===null||i===void 0?void 0:i.last)||s.last,o.push(d),c=null}c===null&&(c=t.next(),c.done||(s.last=c.value.last)),!c.done&&c.value.t===";"&&(c=null)}}parseExpr(t,r){switch(r.t){case At.Ident:return this.expand({prim:r.v,[_t]:{first:r.first,last:r.last}});case At.Number:return{int:r.v,[_t]:{first:r.first,last:r.last}};case At.String:return{string:JSON.parse(r.v),[_t]:{first:r.first,last:r.last}};case At.Bytes:return{bytes:r.v.slice(2),[_t]:{first:r.first,last:r.last}};case"{":return this.parseSequenceExpr(t,r);default:return this.parseListExpr(t,r)}}parseSequence(t){if(typeof t!="string")throw new TypeError(`string type was expected, got ${typeof t} instead`);const r=rs(t),n=r.next();return n.done?null:this.parseSequenceExpr(r,n.value)}parseList(t){if(typeof t!="string")throw new TypeError(`string type was expected, got ${typeof t} instead`);const r=rs(t),n=r.next();return n.done?null:this.parseListExpr(r,n.value)}parseMichelineExpression(t){if(typeof t!="string")throw new TypeError(`string type was expected, got ${typeof t} instead`);const r=rs(t),n=r.next();return n.done?null:this.parseExpr(r,n.value)}parseScript(t){return this.parseSequence(t)}parseData(t){return this.parseList(t)}parseJSON(t){if(typeof t!="object")throw new TypeError(`object type was expected, got ${typeof t} instead`);if(Array.isArray(t)){const r=[];for(const n of t){if(n===null||typeof n!="object")throw new zt(n,`unexpected sequence element: ${n}`);r.push(this.parseJSON(n))}return r}else if("prim"in t){const r=t;if(typeof r.prim=="string"&&(r.annots===void 0||Array.isArray(r.annots))&&(r.args===void 0||Array.isArray(r.args))){const n={prim:r.prim};if(r.annots!==void 0){for(const i of r.annots)if(typeof i!="string")throw new zt(i,`string expected: ${i}`);n.annots=r.annots}if(r.args!==void 0){n.args=[];for(const i of r.args){if(i===null||typeof i!="object")throw new zt(i,`unexpected argument: ${i}`);n.args.push(this.parseJSON(i))}}return this.expand(n)}throw new zt(t,`malformed prim expression: ${t}`)}else if("string"in t){if(typeof t.string=="string")return{string:t.string};throw new zt(t,`malformed string literal: ${t}`)}else if("int"in t){if(typeof t.int=="string"&&Ag.test(t.int))return{int:t.int};throw new zt(t,`malformed int literal: ${t}`)}else if("bytes"in t){if(typeof t.bytes=="string"&&Rg.test(t.bytes))return{bytes:t.bytes};throw new zt(t,`malformed bytes literal: ${t}`)}else throw new zt(t,`unexpected object: ${t}`)}}const Og=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225],Pg=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998];class vs extends Error{constructor(t){super(t),this.message=t,this.name="Base58DecodingError"}}class Ig extends Error{constructor(t){super(t),this.message=t,this.name="InvalidMessageError"}}function Ia(e){const t=(e.length+9)%64,r=t===0?0:64-t;if(e.length>268435455)throw new Ig(`SHA-256 -- message length is too big: ${e.length}`);const n=e.length<<3,i=[...e,128,...new Array(r).fill(0),0,0,0,0,n>>24&255,n>>16&255,n>>8&255,n&255];function s(p,l){return p>>>l|p<<32-l}const o=[...Og],a=new Array(64),c=new Array(8);for(let p=0;p<i.length;p+=64){let l=p,y=0;for(;y<16;)a[y]=i[l]<<24|i[l+1]<<16|i[l+2]<<8|i[l+3],l+=4,y++;for(;y<64;){const _=s(a[y-15],7)^s(a[y-15],18)^a[y-15]>>>3,N=s(a[y-2],17)^s(a[y-2],19)^a[y-2]>>>10;a[y]=(N|0)+a[y-7]+_+a[y-16]|0,y++}for(let _=0;_<8;_++)c[_]=o[_];for(let _=0;_<64;_++){const N=s(c[0],2)^s(c[0],13)^s(c[0],22),K=s(c[4],6)^s(c[4],11)^s(c[4],25),P=c[7]+K+(c[4]&c[5]^~c[4]&c[6])+Pg[_]+a[_]|0,w=N+(c[0]&c[1]^c[0]&c[2]^c[1]&c[2])|0;c[7]=c[6],c[6]=c[5],c[5]=c[4],c[4]=c[3]+P|0,c[3]=c[2],c[2]=c[1],c[1]=c[0],c[0]=P+w|0}for(let _=0;_<8;_++)o[_]=o[_]+c[_]|0}const d=[];for(const p of o)d.push(p>>24&255),d.push(p>>16&255),d.push(p>>8&255),d.push(p&255);return d}const ss=[0,1,2,3,4,5,6,7,8,-1,-1,-1,-1,-1,-1,-1,9,10,11,12,13,14,15,16,-1,17,18,19,20,21,-1,22,23,24,25,26,27,28,29,30,31,32,-1,-1,-1,-1,-1,-1,33,34,35,36,37,38,39,40,41,42,43,-1,44,45,46,47,48,49,50,51,52,53,54,55,56,57];function Sa(e,t){const r=e.charCodeAt(t)-49;if(r>=ss.length||ss[r]===-1)throw new vs(`Unexpected character at position ${t}: ${e[t]}`);return ss[r]}function Sg(e){const t=[];let r=0;for(;r<e.length&&Sa(e,r)===0;)r++;let n=r;for(;r<e.length;){let i=Sa(e,r++),s=0;for(;i!==0||s<t.length;){const o=(t[s]||0)*58+i;t[s++]=o%256,i=Math.floor(o/256)}}for(;n-- >0;)t.push(0);return t.reverse()}function Xc(e){const t=Sg(e);if(t.length<4)throw new vs(`Data is too short ${t.length}`);const r=t.slice(0,t.length-4),n=t.slice(t.length-4),i=Ia(Ia(r));if(n[0]!==i[0]||n[1]!==i[1]||n[2]!==i[2]||n[3]!==i[3])throw new vs("Invalid checksum");return r}class Tg extends Error{constructor(t){super(t),this.message=t,this.name="InvalidContractError"}}class Ng extends Error{constructor(t){super(t),this.message=t,this.name="InvalidTypeExpressionError"}}class Lg extends Error{constructor(t){super(t),this.message=t,this.name="InvalidDataExpressionError"}}class xg extends Error{constructor(t){super(`Contract has no entrypoint named: '${t}'`),this.entrypoint=t,this.name="InvalidEntrypointError"}}class Cg extends Error{constructor(t){super(t),this.message=t,this.name="LongIntegerError"}}class Mg extends Error{constructor(t){super(`Unable to parse hex byte: ${t}`),this.hexByte=t,this.name="HexParseError"}}class $t extends Error{constructor(t,r){super(r),this.val=t,Object.setPrototypeOf(this,$t.prototype)}}class T extends $t{constructor(t,r,n){super(t,n),r!==void 0&&(this.data=r),Object.setPrototypeOf(this,T.prototype)}}class Zc{constructor(t){if(this.neg=!1,this.buf=[],t!==void 0)if(typeof t=="string")for(let r=0;r<t.length;r++){const n=t.charCodeAt(r);if(r===0&&n===45)this.neg=!0;else{if(n<48||n>57)throw new Cg(`unexpected character in integer constant: ${t[r]}`);this.append(n-48)}}else t<0?(this.neg=!0,this.append(-t)):this.append(t)}append(t){let r=0;for(;t!==0||r<this.buf.length;){const n=(this.buf[r]||0)*10+t;this.buf[r++]=n%256,t=Math.floor(n/256)}}cmp(t){if(this.neg!==t.neg)return(t.neg?1:0)-(this.neg?1:0);{let r=0;if(this.buf.length!==t.buf.length)r=this.buf.length<t.buf.length?-1:1;else if(this.buf.length!==0){let n=t.buf.length-1;for(;n>=0&&this.buf[n]===t.buf[n];)n--;r=n<0?0:this.buf[n]<t.buf[n]?-1:1}return this.neg?r===0?0:-r:r}}get sign(){return this.buf.length===0?0:this.neg?-1:1}}function Rr(e){const t=[];for(let r=0;r<e.length;r+=2){const n=parseInt(e.slice(r,r+2),16);if(Number.isNaN(n))return null;t.push(n)}return t}function _s(e){try{return new Zc(e),!0}catch{return!1}}function Qc(e){try{return new Zc(e).sign>=0}catch{return!1}}const Dg=/^(@%|@%%|%@|[@:%]([_0-9a-zA-Z][_0-9a-zA-Z.%@]*)?)$/;function Sr(e,t){if(Array.isArray(e))return{};let r,n,i;if(e.annots!==void 0){for(const s of e.annots)if(s.length!==0){if(!Dg.test(s)||!(t!=null&&t.specialVar)&&(s==="@%"||s==="@%%")||!(t!=null&&t.specialFields)&&s==="%@")throw new $t(e,`${e.prim}: unexpected annotation: ${s}`);switch(s[0]){case"%":(t!=null&&t.emptyFields||s.length>1)&&(r=r||[],r.push(s));break;case":":s.length>1&&(n=n||[],n.push(s));break;case"@":(t!=null&&t.emptyVar||s.length>1)&&(i=i||[],i.push(s));break}}}return{f:r,t:n,v:i}}const $g={BlockHash:[32,[1,52]],OperationHash:[32,[5,116]],OperationListHash:[32,[133,233]],OperationListListHash:[32,[29,159,109]],ProtocolHash:[32,[2,170]],ContextHash:[32,[79,199]],ED25519PublicKeyHash:[20,[6,161,159]],SECP256K1PublicKeyHash:[20,[6,161,161]],P256PublicKeyHash:[20,[6,161,164]],ContractHash:[20,[2,90,121]],CryptoboxPublicKeyHash:[16,[153,103]],ED25519Seed:[32,[13,15,58,7]],ED25519PublicKey:[32,[13,15,37,217]],SECP256K1SecretKey:[32,[17,162,224,201]],P256SecretKey:[32,[16,81,238,189]],ED25519EncryptedSeed:[56,[7,90,60,179,41]],SECP256K1EncryptedSecretKey:[56,[9,237,241,174,150]],P256EncryptedSecretKey:[56,[9,48,57,115,171]],SECP256K1PublicKey:[33,[3,254,226,86]],P256PublicKey:[33,[3,178,139,127]],SECP256K1Scalar:[33,[38,248,136]],SECP256K1Element:[33,[5,92,0]],ED25519SecretKey:[64,[43,246,78,7]],ED25519Signature:[64,[9,245,205,134,18]],SECP256K1Signature:[64,[13,115,101,19,63]],P256Signature:[64,[54,240,44,52]],GenericSignature:[64,[4,130,43]],ChainID:[4,[87,82,0]],RollupAddress:[20,[1,128,120,31]],TxRollupL2Address:[20,[6,161,166]]};function Te(e,...t){const r=Xc(e);for(const n of t){const[i,s]=$g[n];if(r.length===i+s.length){let o=0;for(;o<s.length&&r[o]===s[o];)o++;if(o===s.length)return[n,r.slice(s.length)]}}return null}function Lt(e,t){const r=t,n=Array.isArray(r)?r:r.args;return n.length===2?e==="pair"?{prim:"pair",args:n}:{prim:"Pair",args:n}:Object.assign(Object.assign({},Array.isArray(r)?{prim:e}:r),{args:[n[0],{prim:e,args:n.slice(1)}]})}function Ne(e){return Array.isArray(e)||e.prim==="pair"}function tu(e){return Array.isArray(e)||"prim"in e&&e.prim==="Pair"}const Bg=/^[0-9]{4}-(0[1-9]|1[0-2])-(0[1-9]|[12][0-9]|3[01])[T ]([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]|60)(\.[0-9]+)?(Z|[+-]([01][0-9]|2[0-3]):([0-5][0-9]))$/;function eu(e){if("string"in e){if(Qc(e.string))return new Date(parseInt(e.string,10));if(Bg.test(e.string)){const t=new Date(e.string);if(!Number.isNaN(t.valueOf))return t}}else if(_s(e.int))return new Date(parseInt(e.int,10));return null}function kg(e){const t=[];for(let r=0;r<e.length;r+=2){const n=e.slice(r,r+2),i=parseInt(n,16);if(Number.isNaN(i))throw new Mg(n);t.push(i)}return t}function Er(e){return e.map(t=>(t>>4&15).toString(16)+(t&15).toString(16)).join("")}const jg=31,ru={ABS:!0,ADD:!0,ADDRESS:!0,AMOUNT:!0,AND:!0,APPLY:!0,BALANCE:!0,BLAKE2B:!0,CAR:!0,CDR:!0,CHAIN_ID:!0,CHECK_SIGNATURE:!0,COMPARE:!0,CONCAT:!0,CONS:!0,EDIV:!0,EQ:!0,EXEC:!0,FAILWITH:!0,GE:!0,GET_AND_UPDATE:!0,GT:!0,HASH_KEY:!0,IMPLICIT_ACCOUNT:!0,INT:!0,ISNAT:!0,JOIN_TICKETS:!0,KECCAK:!0,LE:!0,LEVEL:!0,LSL:!0,LSR:!0,LT:!0,MEM:!0,MUL:!0,NEG:!0,NEQ:!0,NEVER:!0,NOT:!0,NOW:!0,OR:!0,PACK:!0,PAIRING_CHECK:!0,READ_TICKET:!0,SAPLING_VERIFY_UPDATE:!0,SELF:!0,SELF_ADDRESS:!0,SENDER:!0,SET_DELEGATE:!0,SHA256:!0,SHA3:!0,SHA512:!0,SIZE:!0,SLICE:!0,SOME:!0,SOURCE:!0,SPLIT_TICKET:!0,SUB:!0,SWAP:!0,TICKET:!0,TICKET_DEPRECATED:!0,TOTAL_VOTING_POWER:!0,TRANSFER_TOKENS:!0,UNIT:!0,VOTING_POWER:!0,XOR:!0,RENAME:!0,OPEN_CHEST:!0,SUB_MUTEZ:!0,MIN_BLOCK_TIME:!0,BYTES:!0,NAT:!0},nu=Object.assign({},ru,{CONTRACT:!0,CREATE_CONTRACT:!0,DIG:!0,DIP:!0,DROP:!0,DUG:!0,DUP:!0,EMIT:!0,EMPTY_BIG_MAP:!0,EMPTY_MAP:!0,EMPTY_SET:!0,GET:!0,IF:!0,IF_CONS:!0,IF_LEFT:!0,IF_NONE:!0,ITER:!0,LAMBDA:!0,LAMBDA_REC:!0,LEFT:!0,LOOP:!0,LOOP_LEFT:!0,MAP:!0,NIL:!0,NONE:!0,PAIR:!0,PUSH:!0,RIGHT:!0,SAPLING_EMPTY_STATE:!0,UNPACK:!0,UNPAIR:!0,UPDATE:!0,CAST:!0,VIEW:!0}),iu={unit:!0,never:!0,bool:!0,int:!0,nat:!0,string:!0,chain_id:!0,bytes:!0,mutez:!0,key_hash:!0,key:!0,signature:!0,timestamp:!0,address:!0,tx_rollup_l2_address:!0},Mr=Object.assign({},iu,{or:!0,pair:!0,set:!0,big_map:!0,contract:!0,lambda:!0,list:!0,map:!0,operation:!0,option:!0,bls12_381_g1:!0,bls12_381_g2:!0,bls12_381_fr:!0,sapling_transaction:!0,sapling_transaction_deprecated:!0,sapling_state:!0,ticket:!0,chest_key:!0,chest:!0});class J extends $t{constructor(t,r){super(t,r),this.val=t,Object.setPrototypeOf(this,J.prototype)}}function fe(e){return"prim"in e}function Hg(e){return Array.isArray(e)||"prim"in e}function su(e){if(fe(e))return!0;throw new J(e,"prim expression expected")}function Fe(e){if(Array.isArray(e))return!0;throw new J(e,"sequence expression expected")}function yt(e){if(Hg(e))return!0;throw new J(e,"prim or sequence expression expected")}function os(e){if(e.int[0]==="-")throw new J(e,"natural number expected")}function Sn(e){if("int"in e)return!0;throw new J(e,"int literal expected")}function ou(e){if("string"in e)return!0;throw new J(e,"string literal expected")}function q(e,t){var r;if(t===0&&e.args===void 0||((r=e.args)===null||r===void 0?void 0:r.length)===t)return!0;throw new J(e,`${t} arguments expected`)}function Vt(e){var t,r;if(Array.isArray(e)){for(const n of e){if(!Array.isArray(n)&&!fe(n))throw new J(e,"sequence or prim expected");Vt(n)}return!0}if(su(e)){if(Object.prototype.hasOwnProperty.call(ru,e.prim))return q(e,0),!0;switch(e.prim){case"DROP":case"PAIR":case"UNPAIR":case"DUP":case"UPDATE":case"GET":e.args!==void 0&&q(e,1)&&Sn(e.args[0])&&os(e.args[0]);break;case"DIG":case"DUG":case"SAPLING_EMPTY_STATE":q(e,1)&&Sn(e.args[0])&&os(e.args[0]);break;case"NONE":case"LEFT":case"RIGHT":case"NIL":case"CAST":q(e,1)&&Le(e.args[0]);break;case"UNPACK":q(e,1)&&Js(e.args[0]);break;case"CONTRACT":q(e,1)&&yi(e.args[0]);break;case"IF_NONE":case"IF_LEFT":case"IF_CONS":case"IF":q(e,2)&&(Fe(e.args[0])&&Vt(e.args[0]),Fe(e.args[1])&&Vt(e.args[1]));break;case"MAP":case"ITER":case"LOOP":case"LOOP_LEFT":q(e,1)&&Vt(e.args[0]);break;case"CREATE_CONTRACT":q(e,1)&&cu(e.args[0]);break;case"DIP":if(((t=e.args)===null||t===void 0?void 0:t.length)===2)Sn(e.args[0])&&os(e.args[0]),Fe(e.args[1])&&Vt(e.args[1]);else if(((r=e.args)===null||r===void 0?void 0:r.length)===1)Fe(e.args[0])&&Vt(e.args[0]);else throw new J(e,"1 or 2 arguments expected");break;case"PUSH":q(e,2)&&(Tr(e.args[0]),ar(e.args[1]));break;case"EMPTY_SET":q(e,1)&&De(e.args[0]);break;case"EMPTY_MAP":q(e,2)&&(De(e.args[0]),Le(e.args[1]));break;case"EMPTY_BIG_MAP":q(e,2)&&(De(e.args[0]),Ei(e.args[1]));break;case"LAMBDA_REC":case"LAMBDA":q(e,3)&&(Le(e.args[0]),Le(e.args[1]),Fe(e.args[2])&&Vt(e.args[2]));break;case"VIEW":q(e,2)&&(ou(e.args[0])&&au(e.args[0]),Le(e.args[1])&&Tr(e.args[1]));break;case"EMIT":e.args&&e.args.length>0?q(e,1):q(e,0);break;default:throw new J(e,"instruction expected")}}return!0}function De(e){if(yt(e)){if(Array.isArray(e)||e.prim==="pair"||e.prim==="or"||e.prim==="option")dr(e,t=>De(t));else if(!Object.prototype.hasOwnProperty.call(iu,e.prim))throw new J(e,`${e.prim}: type is not comparable`)}return!0}function Js(e){if(yt(e)&&fe(e)){if(!Object.prototype.hasOwnProperty.call(Mr,e.prim)||e.prim==="big_map"||e.prim==="operation"||e.prim==="sapling_state"||e.prim==="ticket")throw new J(e,`${e.prim}: type can't be used inside PACK/UNPACK instructions`);dr(e,t=>Js(t))}return!0}function Tr(e){if(yt(e)&&fe(e)){if(!Object.prototype.hasOwnProperty.call(Mr,e.prim)||e.prim==="big_map"||e.prim==="operation"||e.prim==="sapling_state"||e.prim==="ticket"||e.prim==="contract")throw new J(e,`${e.prim}: type can't be pushed`);dr(e,t=>Tr(t))}return!0}function Xs(e){if(yt(e)&&fe(e)){if(!Object.prototype.hasOwnProperty.call(Mr,e.prim)||e.prim==="operation"||e.prim==="contract")throw new J(e,`${e.prim}: type can't be used as part of a storage`);dr(e,t=>Xs(t))}return!0}function yi(e){if(yt(e)&&fe(e)){if(!Object.prototype.hasOwnProperty.call(Mr,e.prim)||e.prim==="operation")throw new J(e,`${e.prim}: type can't be used as part of a parameter`);dr(e,t=>yi(t))}return!0}function Ei(e){if(yt(e)&&fe(e)){if(!Object.prototype.hasOwnProperty.call(Mr,e.prim)||e.prim==="big_map"||e.prim==="operation"||e.prim==="sapling_state")throw new J(e,`${e.prim}: type can't be used inside a big_map`);dr(e,t=>Ei(t))}return!0}const Vg=new RegExp("^[a-zA-Z0-9_.%@]*$");function au(e){if(e.string.length>jg)throw new J(e,`view name too long: ${e.string}`);if(!Vg.test(e.string))throw new J(e,`invalid character(s) in view name: ${e.string}`)}function Le(e){if(yt(e)&&fe(e)){if(!Object.prototype.hasOwnProperty.call(Mr,e.prim))throw new J(e,"type expected");dr(e,t=>Le(t))}return!0}function dr(e,t){if(Array.isArray(e)||e.prim==="pair"){const r=Array.isArray(e)?e:e.args;if(r===void 0||r.length<2)throw new J(e,"at least 2 arguments expected");return r.forEach(n=>{yt(n)&&t(n)}),!0}switch(e.prim){case"option":case"list":q(e,1)&&yt(e.args[0])&&t(e.args[0]);break;case"contract":q(e,1)&&yi(e.args[0]);break;case"or":q(e,2)&&yt(e.args[0])&&yt(e.args[1])&&(t(e.args[0]),t(e.args[1]));break;case"lambda":q(e,2)&&(Le(e.args[0]),Le(e.args[1]));break;case"set":q(e,1)&&De(e.args[0]);break;case"map":q(e,2)&&yt(e.args[0])&&yt(e.args[1])&&(De(e.args[0]),t(e.args[1]));break;case"big_map":q(e,2)&&yt(e.args[0])&&yt(e.args[1])&&(De(e.args[0]),Ei(e.args[1]),t(e.args[1]));break;case"ticket":q(e,1)&&yt(e.args[0])&&De(e.args[0]);break;case"sapling_state":case"sapling_transaction":q(e,1)&&Sn(e.args[0]);break;default:q(e,0)}return!0}function ar(e){if("int"in e||"string"in e||"bytes"in e)return!0;if(Array.isArray(e)){let t=0;for(const r of e)fe(r)&&r.prim==="Elt"?(q(r,2)&&(ar(r.args[0]),ar(r.args[1])),t++):ar(r);if(t!==0&&t!==e.length)throw new J(e,"data entries and map elements can't be intermixed");return!0}if(fe(e))switch(e.prim){case"Unit":case"True":case"False":case"None":q(e,0);break;case"Pair":if(e.args===void 0||e.args.length<2)throw new J(e,"at least 2 arguments expected");for(const t of e.args)ar(t);break;case"Left":case"Right":case"Some":q(e,1)&&ar(e.args[0]);break;case"Lambda_rec":e.args&&Vt(e.args);break;default:if(Object.prototype.hasOwnProperty.call(nu,e.prim))Vt(e);else throw new J(e,"data entry or instruction expected")}else throw new J(e,"data entry expected");return!0}function cu(e){if(Fe(e)){const t={},r={};for(const n of e)if(su(n)){if(n.prim!=="view"){if(n.prim in t)throw new J(e,`duplicate contract section: ${n.prim}`);t[n.prim]=!0}switch(n.prim){case"code":q(n,1)&&Fe(n.args[0])&&Vt(n.args[0]);break;case"parameter":if(q(n,1)&&yi(n.args[0]),n.annots)throw new J(n,"Annotation must be part of the parameter type");break;case"storage":q(n,1)&&Xs(n.args[0]);break;case"view":if(q(n,4)){if(ou(n.args[0])){const i=n.args[0];if(i.string in r)throw new J(e,`duplicate view name: ${i.string}`);r[i.string]=!0,au(i)}Tr(n.args[1]),Tr(n.args[2]),Fe(n.args[3])&&Vt(n.args[3])}break;default:throw new J(e,`unexpected contract section: ${n.prim}`)}}}return!0}function uu(e){return Object.prototype.hasOwnProperty.call(nu,e.prim)}function ws(e){if(!Array.isArray(e))return!1;for(const t of e)if("prim"in t){if(uu(t))throw new $t(e,`Instruction outside of a lambda: ${JSON.stringify(e)}`);if(t.prim==="Elt")throw new $t(e,`Elt item outside of a map literal: ${JSON.stringify(e)}`)}return!0}function Ug(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}const Gg=["parameter","storage","code","False","Elt","Left","None","Pair","Right","Some","True","Unit","PACK","UNPACK","BLAKE2B","SHA256","SHA512","ABS","ADD","AMOUNT","AND","BALANCE","CAR","CDR","CHECK_SIGNATURE","COMPARE","CONCAT","CONS","CREATE_ACCOUNT","CREATE_CONTRACT","IMPLICIT_ACCOUNT","DIP","DROP","DUP","EDIV","EMPTY_MAP","EMPTY_SET","EQ","EXEC","FAILWITH","GE","GET","GT","HASH_KEY","IF","IF_CONS","IF_LEFT","IF_NONE","INT","LAMBDA","LE","LEFT","LOOP","LSL","LSR","LT","MAP","MEM","MUL","NEG","NEQ","NIL","NONE","NOT","NOW","OR","PAIR","PUSH","RIGHT","SIZE","SOME","SOURCE","SENDER","SELF","STEPS_TO_QUOTA","SUB","SWAP","TRANSFER_TOKENS","SET_DELEGATE","UNIT","UPDATE","XOR","ITER","LOOP_LEFT","ADDRESS","CONTRACT","ISNAT","CAST","RENAME","bool","contract","int","key","key_hash","lambda","list","map","big_map","nat","option","or","pair","set","signature","string","bytes","mutez","timestamp","unit","operation","address","SLICE","DIG","DUG","EMPTY_BIG_MAP","APPLY","chain_id","CHAIN_ID","LEVEL","SELF_ADDRESS","never","NEVER","UNPAIR","VOTING_POWER","TOTAL_VOTING_POWER","KECCAK","SHA3","PAIRING_CHECK","bls12_381_g1","bls12_381_g2","bls12_381_fr","sapling_state","sapling_transaction_deprecated","SAPLING_EMPTY_STATE","SAPLING_VERIFY_UPDATE","ticket","TICKET_DEPRECATED","READ_TICKET","SPLIT_TICKET","JOIN_TICKETS","GET_AND_UPDATE","chest","chest_key","OPEN_CHEST","VIEW","view","constant","SUB_MUTEZ","tx_rollup_l2_address","MIN_BLOCK_TIME","sapling_transaction","EMIT","Lambda_rec","LAMBDA_REC","TICKET","BYTES","NAT"],Kg=Object.assign({},...Gg.map((e,t)=>({[e]:t})));var ke;(function(e){e[e.Int=0]="Int",e[e.String=1]="String",e[e.Sequence=2]="Sequence",e[e.Prim0=3]="Prim0",e[e.Prim0Annot=4]="Prim0Annot",e[e.Prim1=5]="Prim1",e[e.Prim1Annot=6]="Prim1Annot",e[e.Prim2=7]="Prim2",e[e.Prim2Annot=8]="Prim2Annot",e[e.Prim=9]="Prim",e[e.Bytes=10]="Bytes"})(ke||(ke={}));class Or{constructor(){this.buffer=[]}get length(){return this.buffer.length}writeBytes(t){this.buffer.push(...t.map(r=>r&255))}writeUint8(t){const r=t|0;this.buffer.push(r&255)}writeUint16(t){const r=t|0;this.buffer.push(r>>8&255),this.buffer.push(r&255)}writeUint32(t){const r=t|0;this.buffer.push(r>>24&255),this.buffer.push(r>>16&255),this.buffer.push(r>>8&255),this.buffer.push(r&255)}writeInt8(t){this.writeUint8(t)}writeInt16(t){this.writeUint16(t)}writeInt32(t){this.writeUint32(t)}}const Be=new Error("bounds out of range");class Nr{constructor(t,r=0,n=t.length){this.buffer=t,this.idx=r,this.cap=n}get length(){return this.cap-this.idx}readBytes(t){if(this.cap-this.idx<t)throw Be;const r=this.buffer.slice(this.idx,this.idx+t);return this.idx+=t,r}reader(t){if(this.cap-this.idx<t)throw Be;const r=new Nr(this.buffer,this.idx,this.idx+t);return this.idx+=t,r}copy(){return new Nr(this.buffer,this.idx,this.cap)}readUint8(){if(this.cap-this.idx<1)throw Be;return this.buffer[this.idx++]>>>0}readUint16(){if(this.cap-this.idx<2)throw Be;const t=this.buffer[this.idx++],r=this.buffer[this.idx++];return(t<<8|r)>>>0}readUint32(){if(this.cap-this.idx<4)throw Be;const t=this.buffer[this.idx++],r=this.buffer[this.idx++],n=this.buffer[this.idx++],i=this.buffer[this.idx++];return(t<<24|r<<16|n<<8|i)>>>0}readInt8(){if(this.cap-this.idx<1)throw Be;return this.buffer[this.idx++]<<24>>24}readInt16(){if(this.cap-this.idx<2)throw Be;const t=this.buffer[this.idx++],r=this.buffer[this.idx++];return(t<<8|r)<<16>>16}readInt32(){if(this.cap-this.idx<4)throw Be;const t=this.buffer[this.idx++],r=this.buffer[this.idx++],n=this.buffer[this.idx++],i=this.buffer[this.idx++];return t<<24|r<<16|n<<8|i}}var Lr;(function(e){e[e.Implicit=0]="Implicit",e[e.Originated=1]="Originated"})(Lr||(Lr={}));var ze;(function(e){e[e.ED25519=0]="ED25519",e[e.SECP256K1=1]="SECP256K1",e[e.P256=2]="P256"})(ze||(ze={}));function lu(e){let t;const r=e.readUint8();switch(r){case ze.ED25519:t="ED25519PublicKeyHash";break;case ze.SECP256K1:t="SECP256K1PublicKeyHash";break;case ze.P256:t="P256PublicKeyHash";break;default:throw new Error(`unknown public key hash tag: ${r}`)}return{type:t,hash:e.readBytes(20)}}function Fg(e){let t;const r=e.readUint8();switch(r){case Lr.Implicit:t=lu(e);break;case Lr.Originated:t={type:"ContractHash",hash:e.readBytes(20)},e.readBytes(1);break;default:throw new Error(`unknown address tag: ${r}`)}if(e.length!==0){const n=new TextDecoder;t.entryPoint=n.decode(new Uint8Array(e.readBytes(e.length)))}return t}function hu(e,t){let r;switch(e.type){case"ED25519PublicKeyHash":r=ze.ED25519;break;case"SECP256K1PublicKeyHash":r=ze.SECP256K1;break;case"P256PublicKeyHash":r=ze.P256;break;default:throw new Error(`unexpected address type: ${e.type}`)}t.writeUint8(r),t.writeBytes(Array.from(e.hash))}function qg(e,t){if(e.type==="ContractHash"?(t.writeUint8(Lr.Originated),t.writeBytes(Array.from(e.hash)),t.writeUint8(0)):(t.writeUint8(Lr.Implicit),hu(e,t)),e.entryPoint!==void 0&&e.entryPoint!==""&&e.entryPoint!=="default"){const n=new TextEncoder().encode(e.entryPoint);t.writeBytes(Array.from(n))}}var Ye;(function(e){e[e.ED25519=0]="ED25519",e[e.SECP256K1=1]="SECP256K1",e[e.P256=2]="P256"})(Ye||(Ye={}));function zg(e){let t,r;const n=e.readUint8();switch(n){case Ye.ED25519:r="ED25519PublicKey",t=32;break;case Ye.SECP256K1:r="SECP256K1PublicKey",t=33;break;case Ye.P256:r="P256PublicKey",t=33;break;default:throw new Error(`unknown public key tag: ${n}`)}return{type:r,publicKey:e.readBytes(t)}}function Yg(e,t){let r;switch(e.type){case"ED25519PublicKey":r=Ye.ED25519;break;case"SECP256K1PublicKey":r=Ye.SECP256K1;break;case"P256PublicKey":r=Ye.P256;break;default:throw new Error(`unexpected public key type: ${e.type}`)}t.writeUint8(r),t.writeBytes(Array.from(e.publicKey))}function Tn(e,t,r){var n,i;const[s,o]=r(e);if(Array.isArray(s)){const d=new Or;for(const p of s){const l=o.next();if(l.done)throw new Error("REPORT ME: iterator is done");Tn(p,d,l.value)}t.writeUint8(ke.Sequence),t.writeUint32(d.length),t.writeBytes(d.buffer);return}if("string"in s){const p=new TextEncoder().encode(s.string);t.writeUint8(ke.String),t.writeUint32(p.length),t.writeBytes(Array.from(p));return}if("int"in s){t.writeUint8(ke.Int);let d=BigInt(s.int);const p=d<0;p&&(d=-d);let l=0;do{const y=BigInt(l===0?6:7);let _=d&(BigInt(1)<<y)-BigInt(1);d>>=y,d&&(_|=BigInt(128)),l===0&&p&&(_|=BigInt(64)),t.writeUint8(Number(_)),l++}while(d);return}if("bytes"in s){const d=kg(s.bytes);t.writeUint8(ke.Bytes),t.writeUint32(d.length),t.writeBytes(d);return}const a=Kg[s.prim];if(a===void 0)throw new TypeError(`Can't encode primary: ${s.prim}`);const c=(((n=s.args)===null||n===void 0?void 0:n.length)||0)<3?ke.Prim0+(((i=s.args)===null||i===void 0?void 0:i.length)||0)*2+(s.annots===void 0||s.annots.length===0?0:1):ke.Prim;if(t.writeUint8(c),t.writeUint8(a),s.args!==void 0)if(s.args.length<3)for(const d of s.args){const p=o.next();if(p.done)throw new Error("REPORT ME: iterator is done");Tn(d,t,p.value)}else{const d=new Or;for(const p of s.args){const l=o.next();if(l.done)throw new Error("REPORT ME: iterator is done");Tn(p,d,l.value)}t.writeUint32(d.length),t.writeBytes(d.buffer)}if(s.annots!==void 0&&s.annots.length!==0){const p=new TextEncoder().encode(s.annots.join(" "));t.writeUint32(p.length),t.writeBytes(Array.from(p))}else s.args!==void 0&&s.args.length>=3&&t.writeUint32(0)}const Wg=e=>"prim"in e&&(e.prim==="Left"||e.prim==="Right"),Jg=e=>"prim"in e&&(e.prim==="Some"||e.prim==="None"),cr=e=>{if(Ne(e))return t=>{if(!tu(t))throw new T(e,t,`pair expected: ${JSON.stringify(t)}`);ws(t);const r=Lt("pair",e);return[Lt("Pair",t),function*(){for(const i of r.args)yield cr(i)}()]};switch(e.prim){case"or":return t=>{if(!Wg(t))throw new T(e,t,`or expected: ${JSON.stringify(t)}`);return[t,function*(){yield cr(e.args[t.prim==="Left"?0:1])}()]};case"option":return t=>{if(!Jg(t))throw new T(e,t,`option expected: ${JSON.stringify(t)}`);return[t,function*(){t.prim==="Some"&&(yield cr(e.args[0]))}()]};case"list":case"set":return t=>{if(!Array.isArray(t))throw new T(e,t,`${e.prim} expected: ${JSON.stringify(t)}`);return[t,function*(){for(const r of t)yield cr(e.args[0])}()]};case"map":return t=>{if(!Array.isArray(t))throw new T(e,t,`map expected: ${JSON.stringify(t)}`);return[t,function*(){for(const r of t)yield n=>{if(!("prim"in n)||n.prim!=="Elt")throw new T(e,n,`map element expected: ${JSON.stringify(n)}`);return[n,function*(){for(const i of e.args)yield cr(i)}()]}}()]};case"chain_id":return t=>{if(!("bytes"in t)&&!("string"in t))throw new T(e,t,`chain id expected: ${JSON.stringify(t)}`);let r;if("string"in t){const n=Te(t.string,"ChainID");if(n===null)throw new T(e,t,`chain id base58 expected: ${t.string}`);r={bytes:Er(n[1])}}else r=t;return[r,[][Symbol.iterator]()]};case"signature":return t=>{if(!("bytes"in t)&&!("string"in t))throw new T(e,t,`signature expected: ${JSON.stringify(t)}`);let r;if("string"in t){const n=Te(t.string,"ED25519Signature","SECP256K1Signature","P256Signature","GenericSignature");if(n===null)throw new T(e,t,`signature base58 expected: ${t.string}`);r={bytes:Er(n[1])}}else r=t;return[r,[][Symbol.iterator]()]};case"key_hash":return t=>{if(!("bytes"in t)&&!("string"in t))throw new T(e,t,`key hash expected: ${JSON.stringify(t)}`);let r;if("string"in t){const n=Te(t.string,"ED25519PublicKeyHash","SECP256K1PublicKeyHash","P256PublicKeyHash");if(n===null)throw new T(e,t,`key hash base58 expected: ${t.string}`);const i=new Or;hu({type:n[0],hash:n[1]},i),r={bytes:Er(i.buffer)}}else r=t;return[r,[][Symbol.iterator]()]};case"key":return t=>{if(!("bytes"in t)&&!("string"in t))throw new T(e,t,`public key expected: ${JSON.stringify(t)}`);let r;if("string"in t){const n=Te(t.string,"ED25519PublicKey","SECP256K1PublicKey","P256PublicKey");if(n===null)throw new T(e,t,`public key base58 expected: ${t.string}`);const i=new Or;Yg({type:n[0],publicKey:n[1]},i),r={bytes:Er(i.buffer)}}else r=t;return[r,[][Symbol.iterator]()]};case"address":return t=>{if(!("bytes"in t)&&!("string"in t))throw new T(e,t,`address expected: ${JSON.stringify(t)}`);let r;if("string"in t){const n=t.string.split("%"),i=Te(n[0],"ED25519PublicKeyHash","SECP256K1PublicKeyHash","P256PublicKeyHash","ContractHash");if(i===null)throw new T(e,t,`address base58 expected: ${t.string}`);const s=new Or;qg({type:i[0],hash:i[1],entryPoint:n.length>1?n[1]:void 0},s),r={bytes:Er(s.buffer)}}else r=t;return[r,[][Symbol.iterator]()]};case"timestamp":return t=>{if(!("string"in t)&&!("int"in t))throw new T(e,t,`timestamp expected: ${JSON.stringify(t)}`);let r;if("string"in t){const n=eu(t);if(n===null)throw new T(e,t,`can't parse date: ${t.string}`);r={int:String(Math.floor(n.getTime()/1e3))}}else r=t;return[r,[][Symbol.iterator]()]};default:return Vn}},Xg=e=>"prim"in e&&e.prim==="PUSH",Vn=e=>Xg(e)?(Vt(e),[e,function*(){yield Vn,yield cr(e.args[0])}()]):[e,function*(){for(;;)yield Vn}()];function Zg(e,t){const r=new Or;return r.writeUint8(5),Tn(e,r,t!==void 0?cr(t):Vn),r.buffer}function Qg(e,t){return{bytes:Er(Zg(e,t))}}function tm(e){const t=Rr(e.bytes);if(t===null)throw new Error(`can't parse bytes: "${e.bytes}"`);const r=new Nr(new Uint8Array(t));return Fg(r)}function em(e){const t=Rr(e.bytes);if(t===null)throw new Error(`can't parse bytes: "${e.bytes}"`);const r=new Nr(new Uint8Array(t));return lu(r)}function rm(e){const t=Rr(e.bytes);if(t===null)throw new Error(`can't parse bytes: "${e.bytes}"`);const r=new Nr(new Uint8Array(t));return zg(r)}class $ extends $t{constructor(t,r,n){super(t,n),this.stackState=r,Object.setPrototypeOf(this,$.prototype)}}function X(e){return Array.isArray(e)?"pair":e.prim}function Un(e){return"prim"in e?e.args:e}function Gt(e,t,r=!1){if(X(e)!==X(t))throw new T(e,void 0,`types mismatch: ${X(e)} != ${X(t)}`);const n=[Sr(e),Sr(t)];if(n[0].t&&n[1].t&&n[0].t[0]!==n[1].t[0])throw new T(e,void 0,`${X(e)}: type names mismatch: ${n[0].t[0]} != ${n[1].t[0]}`);if(r&&n[0].f&&n[1].f&&n[0].f[0]!==n[1].f[0])throw new T(e,void 0,`${X(e)}: field names mismatch: ${n[0].f[0]} != ${n[1].f}`);if(Ne(e)){const i=Lt("pair",e),s=Lt("pair",t);Gt(i.args[0],s.args[0],!0),Gt(i.args[1],s.args[1],!0);return}switch(e.prim){case"option":case"list":case"contract":case"set":case"ticket":Gt(e.args[0],t.args[0]);break;case"or":Gt(e.args[0],t.args[0],!0),Gt(e.args[1],t.args[1],!0);break;case"lambda":case"map":case"big_map":Gt(e.args[0],t.args[0]),Gt(e.args[1],t.args[1]);break;case"sapling_state":case"sapling_transaction":if(parseInt(e.args[0].int,10)!==parseInt(t.args[0].int,10))throw new T(e,void 0,`${X(e)}: type argument mismatch: ${e.args[0].int} != ${t.args[0].int}`)}}function pu(e,t){if(e.length!==t.length)throw new T(e,void 0,`stack length mismatch: ${e.length} != ${t.length}`);for(let r=0;r<e.length;r++)Gt(e[r],t[r])}function rt(e,t=!1){var r,n,i;if(!Array.isArray(e)){const s=Sr(e);if((((r=s.t)===null||r===void 0?void 0:r.length)||0)>1)throw new T(e,void 0,`${e.prim}: at most one type annotation allowed: ${e.annots}`);if(t){if((((n=s.f)===null||n===void 0?void 0:n.length)||0)>1)throw new T(e,void 0,`${e.prim}: at most one field annotation allowed: ${e.annots}`)}else if((((i=s.f)===null||i===void 0?void 0:i.length)||0)>0)throw new T(e,void 0,`${e.prim}: field annotations aren't allowed: ${e.annots}`)}if(Ne(e)){const s=Un(e);for(const o of s)rt(o,!0);return}switch(e.prim){case"option":case"list":case"contract":case"set":rt(e.args[0]);break;case"or":for(const s of e.args)rt(s,!0);break;case"lambda":case"map":case"big_map":rt(e.args[0]),rt(e.args[1])}}function du(e){if(!Array.isArray(e))return!1;for(const t of e)if(!(Array.isArray(t)&&du(t)||"prim"in t&&uu(t)))return!1;return!0}function Ut(e,t,r){if(Ne(t)){if(tu(e)){ws(e);const n=Lt("Pair",e),i=Lt("pair",t);Ut(n.args[0],i.args[0],r),Ut(n.args[1],i.args[1],r);return}throw new T(t,e,`pair expected: ${JSON.stringify(e)}`)}switch(t.prim){case"int":if("int"in e&&_s(e.int))return;throw new T(t,e,`integer value expected: ${JSON.stringify(e)}`);case"nat":case"mutez":if("int"in e&&Qc(e.int))return;throw new T(t,e,`natural value expected: ${JSON.stringify(e)}`);case"string":if("string"in e)return;throw new T(t,e,`string value expected: ${JSON.stringify(e)}`);case"bytes":case"bls12_381_g1":case"bls12_381_g2":if("bytes"in e&&Rr(e.bytes)!==null)return;throw new T(t,e,`bytes value expected: ${JSON.stringify(e)}`);case"bool":if("prim"in e&&(e.prim==="True"||e.prim==="False"))return;throw new T(t,e,`boolean value expected: ${JSON.stringify(e)}`);case"key_hash":if("string"in e&&Te(e.string,"ED25519PublicKeyHash","SECP256K1PublicKeyHash","P256PublicKeyHash")!==null)return;if("bytes"in e)try{em(e);return}catch{}throw new T(t,e,`key hash expected: ${JSON.stringify(e)}`);case"timestamp":if(("string"in e||"int"in e)&&eu(e)!==null)return;throw new T(t,e,`timestamp expected: ${JSON.stringify(e)}`);case"address":if("string"in e){let n=e.string;const i=e.string.indexOf("%");if(i>=0&&(n=e.string.slice(0,i)),Te(n,"ED25519PublicKeyHash","SECP256K1PublicKeyHash","P256PublicKeyHash","ContractHash","TxRollupL2Address","RollupAddress")!==null)return}else if("bytes"in e)try{tm(e);return}catch{}throw new T(t,e,`address expected: ${JSON.stringify(e)}`);case"key":if("string"in e&&Te(e.string,"ED25519PublicKey","SECP256K1PublicKey","P256PublicKey")!==null)return;if("bytes"in e)try{rm(e);return}catch{}throw new T(t,e,`public key expected: ${JSON.stringify(e)}`);case"unit":if("prim"in e&&e.prim==="Unit")return;throw new T(t,e,`unit value expected: ${JSON.stringify(e)}`);case"signature":if("bytes"in e||"string"in e&&Te(e.string,"ED25519Signature","SECP256K1Signature","P256Signature","GenericSignature")!==null)return;throw new T(t,e,`signature expected: ${JSON.stringify(e)}`);case"chain_id":if(("bytes"in e||"string"in e)&&("string"in e?Xc(e.string):Rr(e.bytes))!==null)return;throw new T(t,e,`chain id expected: ${JSON.stringify(e)}`);case"option":if("prim"in e){if(e.prim==="None")return;if(e.prim==="Some"){Ut(e.args[0],t.args[0],r);return}}throw new T(t,e,`option expected: ${JSON.stringify(e)}`);case"list":case"set":if(ws(e)){for(const n of e)Ut(n,t.args[0],r);return}throw new T(t,e,`${t.prim} expected: ${JSON.stringify(e)}`);case"or":if("prim"in e){if(e.prim==="Left"){Ut(e.args[0],t.args[0],r);return}else if(e.prim==="Right"){Ut(e.args[0],t.args[1],r);return}}throw new T(t,e,`union (or) expected: ${JSON.stringify(e)}`);case"lambda":if(du(e)){const n=ut(e,[t.args[0]],r);if("failed"in n)throw new T(t,e,`function is failed with error type: ${n.failed}`);if(n.length!==1)throw new T(t,e,"function must return a value");Gt(t.args[1],n[0]);return}throw new T(t,e,`function expected: ${JSON.stringify(e)}`);case"map":case"big_map":if(Array.isArray(e)){for(const n of e){if(!("prim"in n)||n.prim!=="Elt")throw new T(t,e,`map elements expected: ${JSON.stringify(e)}`);Ut(n.args[0],t.args[0],r),Ut(n.args[1],t.args[1],r)}return}throw new T(t,e,`${t.prim} expected: ${JSON.stringify(e)}`);case"bls12_381_fr":if("int"in e&&_s(e.int)||"bytes"in e&&Rr(e.bytes)!==null)return;throw new T(t,e,`BLS12-381 element expected: ${JSON.stringify(e)}`);case"sapling_state":if(Array.isArray(e))return;throw new T(t,e,`sapling state expected: ${JSON.stringify(e)}`);case"ticket":Ut(e,{prim:"pair",args:[{prim:"address"},t.args[0],{prim:"nat"}]},r);return;default:throw new T(t,e,`type ${X(t)} don't have Michelson literal representation`)}}function nm(e,t,r){let n=t,i=t,s=0;for(const o of e){const a=ut(o,i,r);if(n=a,"failed"in a)break;i=a,s++}if("failed"in n&&n.level==0&&(!("prim"in n.failed)||n.failed.prim!=="never")&&s!==e.length-1)throw new $(e,n,"FAIL must appear in a tail position");if((r==null?void 0:r.traceCallback)!==void 0){const o={op:e,in:t,out:n};r.traceCallback(o)}return"failed"in n?{failed:n.failed,level:n.level+1}:n}function ut(e,t,r){const n=(r==null?void 0:r.protocol)||Jc;if(Array.isArray(e))return nm(e,t,r);const i=e;function s(f,...O){if(t.length<O.length+f)throw new $(i,t,`${i.prim}: stack must have at least ${O.length} element(s)`);let I=f;for(const j of O){if(j!==null&&j.length!==0){let D=0;for(;D<j.length&&j[D]!==X(t[I]);)D++;if(D===j.length)throw new $(i,t,`${i.prim}: stack type mismatch: [${I}] expected to be ${j}, got ${X(t[I])} instead`)}I++}return t.slice(f,O.length+f)}function o(f){return(...O)=>{try{return f(...O)}catch(I){throw I instanceof $t?new $(i,t,I.message):I}}}function a(f){return O=>{try{return f(O)}catch(I){throw I instanceof $t?new $(i,t,I.message):I}}}const c=o(Sr),d=o(pu),p=o(Gt),l=a(De),y=a(Js),_=a(Xs),N=a(Tr),K=a(Ei);function P(f,O){const I=c(i,Object.assign(Object.assign({},O),{emptyFields:f.f!==void 0&&f.f>1,emptyVar:f.v!==void 0&&f.v>1})),j=(D,pt,u)=>{if(D&&D.length>(pt||0))throw new $(i,t,`${i.prim}: at most ${pt||0} ${u} annotations allowed`)};return j(I.f,f.f,"field"),j(I.t,f.t,"type"),j(I.v,f.v,"variable"),I}function w(f,O){const I=f,j=Array.isArray(I)?{prim:"pair",args:I}:I,D=c(j),pt=O.v!==void 0||O.t!==void 0||O.f!==void 0?[...(O.v===null?D.v:O.v)||[],...(O.t===null?D.t:O.t)||[],...(O.f===null?D.f:O.f)||[]]:void 0,u=Ug(j,["annots"]);return Object.assign(Object.assign({},u),pt&&pt.length!==0&&{annots:pt})}function v(f,O){const I=P({v:1});return w(f,{v:I.v!==void 0?I.v:O!==void 0?[O]:null,t:null})}function Kt(f,O,I,j,D){var pt,u,m,A;const S=(pt=c(O).f)===null||pt===void 0?void 0:pt[0],St=(u=I.f)===null||u===void 0?void 0:u[j];if(St!==void 0&&St!=="%"&&S!==void 0&&St!==S)throw new $(i,t,`${i.prim}: field names doesn't match: ${St} !== ${S}`);const vt=(m=I.v)===null||m===void 0?void 0:m[j],Ht=(A=c(f).v)===null||A===void 0?void 0:A[0];return w(O,{t:null,v:vt?vt==="@%"?S?["@"+S.slice(1)]:void 0:vt==="@%%"?Ht?["@"+Ht.slice(1)+"."+(S?S.slice(1):D)]:S?["@"+S.slice(1)]:void 0:[vt]:null})}function E(f,O,I=O){const j=Lt("pair",f);if(I===1)return[j.args[0]];if(I===2)return j.args;const D=j.args[1];if(Ne(D))return[j.args[0],...E(D,O,I-1)];throw new $(i,t,`${i.prim}: at least ${O} fields are expected`)}function H(f,O,I=O){if(I===0)return f;const j=Lt("pair",f);if(I===1)return j.args[0];const D=j.args[1];if(Ne(D))return H(D,O,I-2);if(I===2)return D;throw new $(i,t,`${i.prim}: at least ${O+1} fields are expected`)}function ye(f,O,I,j=I){if(j===0)return O;const D=Lt("pair",f);if(j===1)return Object.assign(Object.assign({},D),{args:[O,D.args[1]]});const pt=D.args[1];if(Ne(pt))return Object.assign(Object.assign({},D),{args:[D.args[0],ye(pt,O,I,j-2)]});if(j===2)return Object.assign(Object.assign({},D),{args:[D.args[0],O]});throw new $(i,t,`${i.prim}: at least ${I+1} fields are expected`)}const mt=(f,O)=>["@"+(f.v?f.v[0].slice(1)+".":"")+O];function Ft(f,O){return"failed"in f||"failed"in O?"failed"in f?O:f:(d(f,O),f)}const $e=(f=>{var O,I,j,D,pt;switch(f.prim){case"DUP":{const u=f.args?parseInt(f.args[0].int,10):1;if(u===0)throw new $(f,t,"DUP 0 is forbidden");const m=s(u-1,null)[0];if(X(m)==="ticket")throw new $(f,t,"ticket can't be DUPed");return[m,...t]}case"SWAP":{const u=s(0,null,null);return P({}),[u[1],u[0],...t.slice(2)]}case"SOME":return[w({prim:"option",args:[s(0,null)[0]]},P({t:1,v:1})),...t.slice(1)];case"UNIT":return[w({prim:"unit"},P({v:1,t:1})),...t];case"PAIR":{const u=f.args?parseInt(f.args[0].int,10):2;if(u<2)throw new $(f,t,`PAIR ${u} is forbidden`);const m=s(0,...new Array(u).fill(null)),A=P({f:u,t:1,v:1},{specialFields:!0}),S=vt=>{const Ht=vt.lastIndexOf(".");return vt.slice(Ht>0?Ht+1:1)},St=m.map((vt,Ht)=>{var Ii;const io=c(vt),xl=A.f&&A.f.length>Ht&&A.f[Ht]!=="%"?A.f[Ht]==="%@"?io.v?["%"+S(((Ii=io.v)===null||Ii===void 0?void 0:Ii[0])||"")]:void 0:[A.f[Ht]]:void 0;return w(vt,{v:null,t:null,f:xl})});return[w({prim:"pair",args:St},{t:A.t,v:A.v}),...t.slice(u)]}case"UNPAIR":{const u=f.args?parseInt(f.args[0].int,10):2;if(u<2)throw new $(f,t,`UNPAIR ${u} is forbidden`);const m=s(0,["pair"])[0],A=P({f:2,v:2},{specialVar:!0});return[...E(m,u).map((St,vt)=>Kt(m,St,A,vt,vt===0?"car":"cdr")),...t.slice(1)]}case"CAR":case"CDR":{const u=Lt("pair",s(0,["pair"])[0]),m=u.args[f.prim==="CAR"?0:1],A=P({f:1,v:1},{specialVar:!0});return[Kt(u,m,A,0,f.prim.toLocaleLowerCase()),...t.slice(1)]}case"CONS":{const u=s(0,null,["list"]);return p(u[0],u[1].args[0]),[v({prim:"list",args:[u[1].args[0]]}),...t.slice(2)]}case"SIZE":return s(0,["string","list","set","map","bytes"]),[v({prim:"nat"}),...t.slice(1)];case"MEM":{const u=s(0,null,["set","map","big_map"]);return l(u[0]),p(u[0],u[1].args[0]),[v({prim:"bool"}),...t.slice(2)]}case"GET":if(f.args){const u=parseInt(f.args[0].int,10),m=s(0,["pair"])[0];return[v(H(m,u)),...t.slice(1)]}else{const u=s(0,null,["map","big_map"]);return l(u[0]),p(u[0],u[1].args[0]),[v({prim:"option",args:[u[1].args[1]]}),...t.slice(2)]}case"UPDATE":if(f.args){const u=parseInt(f.args[0].int,10),m=s(0,null,["pair"]);return[v(ye(m[1],m[0],u)),...t.slice(2)]}else{const u=s(0,null,["bool","option"]);if(l(u[0]),u[1].prim==="bool"){const A=s(2,["set"]);return p(u[0],A[0].args[0]),[v({prim:"set",args:[w(u[0],{t:null})]}),...t.slice(3)]}const m=s(2,["map","big_map"]);return p(u[0],m[0].args[0]),m[0].prim==="map"?[v({prim:"map",args:[w(u[0],{t:null}),w(u[1].args[0],{t:null})]}),...t.slice(3)]:(K(u[1].args[0]),[v({prim:"big_map",args:[w(u[0],{t:null}),w(u[1].args[0],{t:null})]}),...t.slice(3)])}case"GET_AND_UPDATE":{const u=P({v:2}),m=s(0,null,["option"],["map","big_map"]);l(m[0]),p(m[0],m[2].args[0]),p(m[1].args[0],m[2].args[1]);const A=(O=u.v)===null||O===void 0?void 0:O.map(S=>S!=="@"?[S]:void 0);return m[2].prim==="map"?[w({prim:"option",args:[m[2].args[1]]},{v:A==null?void 0:A[0]}),w({prim:"map",args:[w(m[0],{t:null}),w(m[1].args[0],{t:null})]},{v:A==null?void 0:A[1]}),...t.slice(3)]:(K(m[1].args[0]),[w({prim:"option",args:[m[2].args[1]]},{v:A==null?void 0:A[0]}),w({prim:"big_map",args:[w(m[0],{t:null}),w(m[1].args[0],{t:null})]},{v:A==null?void 0:A[1]}),...t.slice(3)])}case"EXEC":{const u=s(0,null,["lambda"]);return p(u[0],u[1].args[0]),[v(u[1].args[1]),...t.slice(2)]}case"APPLY":{const u=s(0,null,["lambda"]);if(_(u[0]),N(u[0]),!Ne(u[1].args[0]))throw new $(f,t,`${f.prim}: function's argument must be a pair: ${X(u[1].args[0])}`);const m=u[1].args[0];return p(u[0],Un(m)[0]),[v({prim:"lambda",args:[Un(m)[1],u[1].args[1]]}),...t.slice(2)]}case"FAILWITH":{const u=s(0,null)[0];return _r(n,Me.PtEdo2Zk)||y(u),{failed:u,level:0}}case"NEVER":return s(0,["never"]),{failed:{prim:"never"},level:0};case"RENAME":return[v(s(0,null)[0]),...t.slice(1)];case"CONCAT":{const u=s(0,["string","list","bytes"]);if(u[0].prim==="list"){if(X(u[0].args[0])!=="string"&&X(u[0].args[0])!=="bytes")throw new $(f,t,`${f.prim}: can't concatenate list of ${X(u[0].args[0])}'s`);return[v(u[0].args[0]),...t.slice(1)]}const m=s(1,["string","bytes"]);if(u[0].prim!==m[0].prim)throw new $(f,t,`${f.prim}: can't concatenate ${u[0].prim} with ${m[0].prim}`);return[v(m[0]),...t.slice(2)]}case"SLICE":return[v({prim:"option",args:[s(0,["nat"],["nat"],["string","bytes"])[2]]},"@slice"),...t.slice(3)];case"PACK":{const u=s(0,null)[0];return y(u),[v({prim:"bytes"},"@packed"),...t.slice(1)]}case"ADD":{const u=s(0,["nat","int","timestamp","mutez","bls12_381_g1","bls12_381_g2","bls12_381_fr"],["nat","int","timestamp","mutez","bls12_381_g1","bls12_381_g2","bls12_381_fr"]);if(u[0].prim==="nat"&&u[1].prim==="int"||u[0].prim==="int"&&u[1].prim==="nat")return[v({prim:"int"}),...t.slice(2)];if(u[0].prim==="int"&&u[1].prim==="timestamp"||u[0].prim==="timestamp"&&u[1].prim==="int")return[v({prim:"timestamp"}),...t.slice(2)];if((u[0].prim==="int"||u[0].prim==="nat"||u[0].prim==="mutez"||u[0].prim==="bls12_381_g1"||u[0].prim==="bls12_381_g2"||u[0].prim==="bls12_381_fr")&&u[0].prim===u[1].prim)return[v(u[0]),...t.slice(2)];throw new $(f,t,`${f.prim}: can't add ${u[0].prim} to ${u[1].prim}`)}case"SUB":{const u=_r(n,Me.PsiThaCa)?s(0,["nat","int","timestamp","mutez"],["nat","int","timestamp","mutez"]):s(0,["nat","int","timestamp"],["nat","int","timestamp"]);if((u[0].prim==="nat"||u[0].prim==="int")&&(u[1].prim==="nat"||u[1].prim==="int")||u[0].prim==="timestamp"&&u[1].prim==="timestamp")return[v({prim:"int"}),...t.slice(2)];if(u[0].prim==="timestamp"&&u[1].prim==="int")return[v({prim:"timestamp"}),...t.slice(2)];if(u[0].prim==="mutez"&&u[1].prim==="mutez")return[v({prim:"mutez"}),...t.slice(2)];throw new $(f,t,`${f.prim}: can't subtract ${u[0].prim} from ${u[1].prim}`)}case"SUB_MUTEZ":return s(0,["mutez"],["mutez"]),[v({prim:"option",args:[{prim:"mutez"}]}),...t.slice(2)];case"MUL":{const u=s(0,["nat","int","mutez","bls12_381_g1","bls12_381_g2","bls12_381_fr"],["nat","int","mutez","bls12_381_g1","bls12_381_g2","bls12_381_fr"]);if(u[0].prim==="nat"&&u[1].prim==="int"||u[0].prim==="int"&&u[1].prim==="nat")return[v({prim:"int"}),...t.slice(2)];if(u[0].prim==="nat"&&u[1].prim==="mutez"||u[0].prim==="mutez"&&u[1].prim==="nat")return[v({prim:"mutez"}),...t.slice(2)];if((u[0].prim==="bls12_381_g1"||u[0].prim==="bls12_381_g2"||u[0].prim==="bls12_381_fr")&&u[1].prim==="bls12_381_fr"||(u[0].prim==="nat"||u[0].prim==="int")&&u[0].prim===u[1].prim)return[v(u[0]),...t.slice(2)];if((u[0].prim==="nat"||u[0].prim==="int")&&u[1].prim==="bls12_381_fr"||(u[1].prim==="nat"||u[1].prim==="int")&&u[0].prim==="bls12_381_fr")return[v({prim:"bls12_381_fr"}),...t.slice(2)];throw new $(f,t,`${f.prim}: can't multiply ${u[0].prim} by ${u[1].prim}`)}case"EDIV":{const u=(A,S)=>({prim:"option",args:[{prim:"pair",args:[{prim:A},{prim:S}]}]}),m=s(0,["nat","int","mutez"],["nat","int","mutez"]);if(m[0].prim==="nat"&&m[1].prim==="nat")return[v(u("nat","nat")),...t.slice(2)];if((m[0].prim==="nat"||m[0].prim==="int")&&(m[1].prim==="nat"||m[1].prim==="int"))return[v(u("int","nat")),...t.slice(2)];if(m[0].prim==="mutez"&&m[1].prim==="nat")return[v(u("mutez","mutez")),...t.slice(2)];if(m[0].prim==="mutez"&&m[1].prim==="mutez")return[v(u("nat","mutez")),...t.slice(2)];throw new $(f,t,`${f.prim}: can't euclideally divide ${m[0].prim} by ${m[1].prim}`)}case"ABS":return s(0,["int"]),[v({prim:"nat"}),...t.slice(1)];case"ISNAT":return s(0,["int"]),[v({prim:"option",args:[{prim:"nat"}]}),...t.slice(1)];case"INT":return s(0,["nat","bls12_381_fr","bytes"]),[v({prim:"int"}),...t.slice(1)];case"BYTES":return s(0,["nat","int"]),[v({prim:"bytes"}),...t.slice(1)];case"NAT":return s(0,["bytes"]),[v({prim:"nat"}),...t.slice(1)];case"NEG":{const u=s(0,["nat","int","bls12_381_g1","bls12_381_g2","bls12_381_fr"])[0];return u.prim==="nat"||u.prim==="int"?[v({prim:"int"}),...t.slice(1)]:[v(u),...t.slice(1)]}case"LSL":case"LSR":return s(0,["nat","bytes"],["nat","bytes"]),[v({prim:"nat"}),...t.slice(2)];case"OR":case"XOR":{const u=s(0,["nat","bytes","bool"],["nat","bytes","bool"]);if(u[0].prim!==u[1].prim)throw new $(f,t,`${f.prim}: both arguments must be of the same type: ${u[0].prim}, ${u[1].prim}`);return[v(u[1]),...t.slice(2)]}case"AND":{const u=s(0,["nat","bytes","bool","int"],["nat","bytes","bool"]);if((u[0].prim!=="int"||u[1].prim!=="nat")&&u[0].prim!==u[1].prim)throw new $(f,t,`${f.prim}: both arguments must be of the same type: ${u[0].prim}, ${u[1].prim}`);return[v(u[1]),...t.slice(2)]}case"NOT":return s(0,["nat","bytes","bool","int"])[0].prim==="bool"?[v({prim:"bool"}),...t.slice(1)]:[v({prim:"int"}),...t.slice(1)];case"COMPARE":{const u=s(0,null,null);return l(u[0]),l(u[1]),[v({prim:"int"}),...t.slice(2)]}case"EQ":case"NEQ":case"LT":case"GT":case"LE":case"GE":return s(0,["int"]),[v({prim:"bool"}),...t.slice(1)];case"SELF":{if((r==null?void 0:r.contract)===void 0)throw new $(f,t,`${f.prim}: contract required`);const u=P({f:1,v:1}),m=As(r.contract,(I=u.f)===null||I===void 0?void 0:I[0]);if(m===null)throw new $(f,t,`${f.prim}: contract has no entrypoint ${m}`);return[w({prim:"contract",args:[m]},{v:u.v?u.v:["@self"]}),...t]}case"TRANSFER_TOKENS":{const u=s(0,null,["mutez"],["contract"]);return p(u[0],u[2].args[0]),[v({prim:"operation"}),...t.slice(3)]}case"SET_DELEGATE":{const u=s(0,["option"])[0];if(X(u.args[0])!=="key_hash")throw new $(f,t,`${f.prim}: key hash expected: ${X(u.args[0])}`);return[v({prim:"operation"}),...t.slice(1)]}case"IMPLICIT_ACCOUNT":return s(0,["key_hash"]),[v({prim:"contract",args:[{prim:"unit"}]}),...t.slice(1)];case"NOW":return[v({prim:"timestamp"},"@now"),...t];case"AMOUNT":return[v({prim:"mutez"},"@amount"),...t];case"BALANCE":return[v({prim:"mutez"},"@balance"),...t];case"CHECK_SIGNATURE":return s(0,["key"],["signature"],["bytes"]),[v({prim:"bool"}),...t.slice(3)];case"BLAKE2B":case"SHA256":case"SHA512":case"KECCAK":case"SHA3":return s(0,["bytes"]),[v({prim:"bytes"}),...t.slice(1)];case"HASH_KEY":return s(0,["key"]),[v({prim:"key_hash"}),...t.slice(1)];case"SOURCE":return[v({prim:"address"},"@source"),...t];case"SENDER":return[v({prim:"address"},"@sender"),...t];case"ADDRESS":{const u=s(0,["contract"])[0],m=P({v:1});return[w({prim:"address",[En]:u},{v:m.v?m.v:mt(c(u),"address")}),...t.slice(1)]}case"SELF_ADDRESS":{const u={prim:"address"};return(r==null?void 0:r.contract)!==void 0&&(u[En]={prim:"contract",args:[pe(r.contract,"parameter").args[0]]}),[v(u,"@address"),...t]}case"CHAIN_ID":return[v({prim:"chain_id"}),...t];case"DROP":{P({});const u=f.args!==void 0?parseInt(f.args[0].int,10):1;return s(u-1,null),t.slice(u)}case"DIG":{P({});const u=parseInt(f.args[0].int,10);return[s(u,null)[0],...t.slice(0,u),...t.slice(u+1)]}case"DUG":{P({});const u=parseInt(f.args[0].int,10);return[...t.slice(1,u+1),s(0,null)[0],...t.slice(u+1)]}case"NONE":return rt(f.args[0]),[w({prim:"option",args:[f.args[0]]},P({t:1,v:1})),...t];case"LEFT":case"RIGHT":{const u=s(0,null)[0],m=P({f:2,t:1,v:1},{specialFields:!0}),A=c(u),S=[w(u,{t:null,v:null,f:m.f&&m.f.length>0&&m.f[0]!=="%"?m.f[0]==="%@"?A.v?["%"+A.v[0].slice(1)]:void 0:m.f:void 0}),w(f.args[0],{t:null,f:m.f&&m.f.length>1&&m.f[1]!=="%"?m.f:void 0})];return[w({prim:"or",args:f.prim==="LEFT"?S:[S[1],S[0]]},{t:m.t,v:m.v}),...t.slice(1)]}case"NIL":return rt(f.args[0]),[w({prim:"list",args:[f.args[0]]},P({t:1,v:1})),...t];case"UNPACK":return s(0,["bytes"]),rt(f.args[0]),[v({prim:"option",args:[f.args[0]]},"@unpacked"),...t.slice(1)];case"CONTRACT":{const u=s(0,["address"])[0];rt(f.args[0]);const m=P({v:1,f:1}),A=u[En];if(A!==void 0){const S=As(A,(j=m.f)===null||j===void 0?void 0:j[0]);if(S===null)throw new $(f,t,`${f.prim}: contract has no entrypoint ${S}`);p(S,f.args[0])}return[w({prim:"option",args:[{prim:"contract",args:[f.args[0]]}]},{v:m.v?m.v:mt(c(u),"contract")}),...t.slice(1)]}case"CAST":{P({});const u=s(0,null)[0];return rt(f.args[0]),p(f.args[0],u),[f.args[0],...t.slice(1)]}case"IF_NONE":{P({});const u=s(0,["option"])[0],m=t.slice(1),A=ut(f.args[0],m,r),S=ut(f.args[1],[w(u.args[0],{t:null,v:mt(c(u),"some")}),...m],r);return Ft(A,S)}case"IF_LEFT":{P({});const u=s(0,["or"])[0],m=c(u),A=c(u.args[0]),S=c(u.args[1]),St=t.slice(1),vt=ut(f.args[0],[w(u.args[0],{t:null,v:mt(m,A.f?A.f[0].slice(1):"left")}),...St],r),Ht=ut(f.args[1],[w(u.args[1],{t:null,v:mt(m,S.f?S.f[0].slice(1):"right")}),...St],r);return Ft(vt,Ht)}case"IF_CONS":{P({});const u=s(0,["list"])[0],m=c(u),A=t.slice(1),S=ut(f.args[0],[w(u.args[0],{t:null,v:mt(m,"hd")}),w(u,{t:null,v:mt(m,"tl")}),...A],r),St=ut(f.args[1],A,r);return Ft(S,St)}case"IF":{P({}),s(0,["bool"]);const u=t.slice(1),m=ut(f.args[0],u,r),A=ut(f.args[1],u,r);return Ft(m,A)}case"MAP":{const u=s(0,["list","map","option"])[0],m=t.slice(1),A=u.prim==="map"?{prim:"pair",args:u.args}:u.args[0],S=ut(f.args[0],[w(A,{t:null,v:mt(c(u),"elt")}),...m],r);if("failed"in S){if(!("prim"in S.failed)||S.failed.prim!=="never")throw new $(f,t,`${f.prim}: FAIL is not allowed in MAP`);return{failed:S.failed,level:S.level+1}}if(S.length<1)throw new $(f,t,`${f.prim}: function must return a value`);return d(S.slice(1),m),u.prim==="list"?[v({prim:"list",args:[S[0]]}),...m]:u.prim==="map"?[v({prim:"map",args:[u.args[0],S[0]]}),...m]:[v({prim:"option",args:[S[0]]}),...m]}case"ITER":{P({});const u=s(0,["set","list","map"])[0],m=t.slice(1),A=u.prim==="map"?{prim:"pair",args:u.args}:u.args[0],S=ut(f.args[0],[w(A,{t:null,v:mt(c(u),"elt")}),...m],r);return"failed"in S?{failed:S.failed,level:S.level+1}:(d(S,m),m)}case"LOOP":{P({}),s(0,["bool"]);const u=t.slice(1),m=ut(f.args[0],u,r);return"failed"in m?{failed:m.failed,level:m.level+1}:(d(m,[{prim:"bool"},...u]),u)}case"LOOP_LEFT":{P({});const u=s(0,["or"])[0],m=t.slice(1),A=ut(f.args[0],[w(u.args[0],{t:null,v:mt(c(u),"left")}),...m],r);return"failed"in A?{failed:A.failed,level:A.level+1}:(d(A,[u,...m]),[w(u.args[1],{t:null,v:P({v:1}).v}),...m])}case"DIP":{P({});const u=f.args.length===2?parseInt(f.args[0].int,10):1;s(u-1,null);const m=t.slice(0,u),A=t.slice(u),S=f.args.length===2?ut(f.args[1],A,r):ut(f.args[0],A,r);return"failed"in S?{failed:S.failed,level:S.level+1}:[...m,...S]}case"CREATE_CONTRACT":{const u=P({v:2}),m=s(0,["option"],["mutez"],null);if(X(m[0].args[0])!=="key_hash")throw new $(f,t,`${f.prim}: key hash expected: ${X(m[0].args[0])}`);_(m[2])&&(gu(f.args[0]),Gt(pe(f.args[0],"storage").args[0],m[2]));const A=(D=u.v)===null||D===void 0?void 0:D.map(S=>S!=="@"?[S]:void 0);return[w({prim:"operation"},{v:A==null?void 0:A[0]}),w({prim:"address",[En]:{prim:"contract",args:[pe(f.args[0],"parameter").args[0]]}},{v:A==null?void 0:A[1]}),...t.slice(3)]}case"PUSH":return rt(f.args[0]),Ut(f.args[1],f.args[0],Object.assign(Object.assign({},r),{contract:void 0})),[v(f.args[0]),...t];case"EMPTY_SET":return rt(f.args[0]),l(f.args[0]),[w({prim:"set",args:f.args},P({t:1,v:1})),...t];case"EMPTY_MAP":return rt(f.args[0]),l(f.args[0]),rt(f.args[1]),[w({prim:"map",args:f.args},P({t:1,v:1})),...t];case"EMPTY_BIG_MAP":return rt(f.args[0]),l(f.args[0]),rt(f.args[1]),K(f.args[0]),[w({prim:"big_map",args:f.args},P({t:1,v:1})),...t];case"LAMBDA_REC":case"LAMBDA":{rt(f.args[0]),rt(f.args[1]);const u=[f.args[0]];f.prim==="LAMBDA_REC"&&u.push({prim:"lambda",args:[f.args[0],f.args[1]]});const m=ut(f.args[2],u,Object.assign(Object.assign({},r),{contract:void 0}));if("failed"in m)return{failed:m.failed,level:m.level+1};if(m.length!==1)throw new $(f,t,`${f.prim}: function must return a value`);return p(f.args[1],m[0]),[v({prim:"lambda",args:[f.args[0],f.args[1]]}),...t]}case"LEVEL":return[v({prim:"nat"},"@level"),...t];case"TOTAL_VOTING_POWER":return[v({prim:"nat"}),...t];case"VOTING_POWER":return s(0,["key_hash"]),[v({prim:"nat"}),...t.slice(1)];case"TICKET":{const u=s(0,null,["nat"])[0];return l(u),_r(n,Me.PtLimaPtL)?[w({prim:"ticket",args:[u]},P({t:1,v:1})),...t.slice(2)]:[v({prim:"option",args:[w({prim:"ticket",args:[u]},P({t:1,v:1}))]}),...t.slice(2)]}case"JOIN_TICKETS":{const u=Lt("pair",s(0,["pair"])[0]);if(X(u.args[0])!=="ticket")throw new $(f,t,`${f.prim}: ticket expected: ${X(u.args[0])}`);return p(u.args[0],u.args[1]),[v({prim:"option",args:[w(u.args[0],{t:null})]}),...t.slice(1)]}case"SPLIT_TICKET":{const u=s(0,["ticket"],["pair"]),m=Lt("pair",u[1]);if(X(m.args[0])!=="nat")throw new $(f,t,`${f.prim}: nat expected: ${X(m.args[0])}`);return p(m.args[0],m.args[1]),[v({prim:"option",args:[{prim:"pair",args:[w(u[0],{t:null}),w(u[0],{t:null})]}]}),...t.slice(2)]}case"READ_TICKET":{const u=P({v:2}),m=s(0,["ticket"])[0],A=(pt=u.v)===null||pt===void 0?void 0:pt.map(S=>S!=="@"?[S]:void 0);return[w({prim:"pair",args:[{prim:"address"},w(m.args[0],{t:null}),{prim:"nat"}]},{v:A==null?void 0:A[0]}),w(m,{v:A==null?void 0:A[1],t:null}),...t.slice(1)]}case"PAIRING_CHECK":{const u=s(0,["list"])[0].args[0];if(!Ne(u))throw new $(f,t,`${f.prim}: pair expected: ${X(u)}`);const m=Lt("pair",u);if(X(m.args[0])!=="bls12_381_g1")throw new $(f,t,`${f.prim}: bls12_381_g1 expected: ${X(m.args[0])}`);if(X(m.args[1])!=="bls12_381_g2")throw new $(f,t,`${f.prim}: bls12_381_g2 expected: ${X(m.args[1])}`);return[v({prim:"bool"}),...t.slice(1)]}case"SAPLING_EMPTY_STATE":return[w({prim:"sapling_state",args:[f.args[0]]},P({v:1,t:1})),...t];case"SAPLING_VERIFY_UPDATE":{const u=s(0,["sapling_transaction"],["sapling_state"]);if(parseInt(u[0].args[0].int,10)!==parseInt(u[1].args[0].int,10))throw new $(f,t,`${f.prim}: sapling memo size mismatch: ${u[0].args[0].int} != ${u[1].args[0].int}`);return _r(n,Me.PtJakarta)?[v({prim:"option",args:[{prim:"pair",args:[{prim:"int"},w(u[1],{t:null})]}]}),...t.slice(2)]:[v({prim:"option",args:[{prim:"pair",args:[{prim:"bytes"},{prim:"pair",args:[{prim:"int"},w(u[1],{t:null})]}]}]}),...t.slice(2)]}case"OPEN_CHEST":return s(0,["chest_key"],["chest"],["nat"]),[v({prim:"or",args:[{prim:"bytes"},{prim:"bool"}]}),...t.slice(3)];case"VIEW":{const u=s(0,null,["address"]);return N(u[0]),[v({prim:"option",args:[f.args[1]]}),...t.slice(2)]}case"MIN_BLOCK_TIME":return[v({prim:"nat"}),...t];case"EMIT":{const u=P({f:1,t:1});if(f.args){const m=s(0,null);return p(m[0],f.args[0]),[w({prim:"operation"},u),...t.slice(1)]}return[w({prim:"operation"},u),...t.slice(1)]}default:throw new $t(f,`unexpected instruction: ${f.prim}`)}})(i);if((r==null?void 0:r.traceCallback)!==void 0){const f={op:i,in:t,out:$e};r.traceCallback(f)}return $e}function pe(e,t){for(const r of e)if(r.prim===t)return r;throw new $t(e,`missing contract section: ${t}`)}function im(e){const t={};for(const r of e)r.prim==="view"&&(t[r.args[0].string]=r);return t}function fu(e){if(Array.isArray(e)){for(const t of e)if("prim"in t&&(t.prim==="parameter"||t.prim==="storage"||t.prim==="code"))return!0}return!1}function As(e,t){t=t||"%default";const r=Gn(e).find(n=>n[0]===t);return r!==void 0?r[1]:t==="%default"?fu(e)?pe(e,"parameter").args[0]:e:null}function sm(e){return Array.isArray(e)||e.prim==="or"}function Gn(e){if(fu(e)){const t=pe(e,"parameter"),r=Gn(t.args[0]),n=Sr(t);return n.f?[[n.f[0],t.args[0]],...r]:r}if(sm(e)){const t=Un(e),r=n=>{const i=Sr(t[n]);if(X(t[n])==="or"){const s=Gn(t[n]);return i.f?[[i.f[0],t[n]],...s]:s}return i.f?[[i.f[0],t[n]]]:[]};return[...r(0),...r(1)]}return[]}function gu(e,t){const r=(c,d,p,l)=>{rt(c,!0),rt(d);const y={prim:"pair",args:[Object.assign(Object.assign({},c),{annots:["@parameter"]}),Object.assign(Object.assign({},d),{annots:["@storage"]})]},_=ut(l,[y],Object.assign(Object.assign({},t),{contract:e}));if("failed"in _)return _;try{pu(_,[p])}catch(N){throw N instanceof $t?new $(l,_,N.message):N}return _},n=pe(e,"parameter").args[0],i=pe(e,"storage").args[0],s=pe(e,"code").args[0],a=r(n,i,{prim:"pair",args:[{prim:"list",args:[{prim:"operation"}]},i]},s);for(const c of Object.values(im(e)))r(c.args[1],i,c.args[2],c.args[3]);return a}function mu(e,t,r){rt(t),Ut(e,t,r||null)}function om(e,t,r){for(const n of t)rt(n);if((r==null?void 0:r.contract)!==void 0)for(const n of["parameter","storage"]){const i=pe(r.contract,n).args[0];rt(i)}return ut(e,t,r||null)}function am(e,t,r){try{return mu(e,t,r),!0}catch{return!1}}class Zs{constructor(t,r){this.contract=t,this.ctx=Object.assign({contract:t},r),this.output=gu(t,this.ctx)}static parse(t,r){const n=new ur(r),i=typeof t=="string"?n.parseScript(t):n.parseJSON(t);if(i===null)throw new Tg("empty contract");if(cu(i))return new Zs(i,r)}static parseTypeExpression(t,r){const n=new ur(r),i=typeof t=="string"?n.parseScript(t):n.parseJSON(t);if(i===null)throw new Ng("empty type expression");if(Le(i))return rt(i),i}static parseDataExpression(t,r){const n=new ur(r),i=typeof t=="string"?n.parseScript(t):n.parseJSON(t);if(i===null)throw new Lg("empty data expression");if(ar(i))return i;throw void 0}section(t){return pe(this.contract,t)}entryPoints(){return Gn(this.contract)}entryPoint(t){return As(this.contract,t)}assertDataValid(t,r){mu(t,r,this.ctx)}isDataValid(t,r){return am(t,r,this.ctx)}assertParameterValid(t,r){const n=this.entryPoint(t||void 0);if(n===null)throw new xg(t==null?void 0:t.toString());this.assertDataValid(r,n)}isParameterValid(t,r){try{return this.assertParameterValid(t,r),!0}catch{return!1}}functionType(t,r){return om(t,r,this.ctx)}}new Zs([{prim:"parameter",args:[{prim:"unit"}]},{prim:"storage",args:[{prim:"unit"}]},{prim:"code",args:[[{prim:"CAR"},{prim:"NIL",args:[{prim:"operation"}]},{prim:"PAIR"}]]}]);const Kn=e=>e.reduce((t,r)=>t+r.toString(16).padStart(2,"0"),""),W=(e,t=8)=>e.toString(16).padStart(t,"0"),Xr=31;var h;(function(e){e.SECRET="secret",e.RAW="raw",e.TZ1="tz1",e.BRANCH="branch",e.ZARITH="zarith",e.PUBLIC_KEY="public_key",e.PKH="pkh",e.DELEGATE="delegate",e.SCRIPT="script",e.BALLOT_STATEMENT="ballotStmt",e.PROPOSAL="proposal",e.PROPOSAL_ARR="proposalArr",e.INT32="int32",e.INT16="int16",e.PARAMETERS="parameters",e.ADDRESS="address",e.SMART_CONTRACT_ADDRESS="smart_contract_address",e.VALUE="value",e.MANAGER="manager",e.BLOCK_PAYLOAD_HASH="blockPayloadHash",e.ENTRYPOINT="entrypoint",e.OPERATION="operation",e.OP_ACTIVATE_ACCOUNT="activate_account",e.OP_DELEGATION="delegation",e.OP_TRANSACTION="transaction",e.OP_ORIGINATION="origination",e.OP_BALLOT="ballot",e.OP_ENDORSEMENT="endorsement",e.OP_SEED_NONCE_REVELATION="seed_nonce_revelation",e.OP_REVEAL="reveal",e.OP_PROPOSALS="proposals",e.OP_REGISTER_GLOBAL_CONSTANT="register_global_constant",e.OP_TRANSFER_TICKET="transfer_ticket",e.OP_TX_ROLLUP_ORIGINATION="tx_rollup_origination",e.OP_TX_ROLLUP_SUBMIT_BATCH="tx_rollup_submit_batch",e.BURN_LIMIT="burn_limit",e.TX_ROLLUP_ORIGINATION_PARAM="tx_rollup_origination_param",e.TX_ROLLUP_ID="tx_rollup_id",e.TX_ROLLUP_BATCH_CONTENT="tx_rollup_batch_content",e.OP_INCREASE_PAID_STORAGE="increase_paid_storage",e.OP_UPDATE_CONSENSUS_KEY="update_consensus_key",e.OP_DRAIN_DELEGATE="drain_delegate",e.DEPOSITS_LIMIT="deposits_limit",e.OP_SET_DEPOSITS_LIMIT="set_deposits_limit"})(h||(h={}));const Yt={"00":"parameter","01":"storage","02":"code","03":"False","04":"Elt","05":"Left","06":"None","07":"Pair","08":"Right","09":"Some","0a":"True","0b":"Unit","0c":"PACK","0d":"UNPACK","0e":"BLAKE2B","0f":"SHA256",10:"SHA512",11:"ABS",12:"ADD",13:"AMOUNT",14:"AND",15:"BALANCE",16:"CAR",17:"CDR",18:"CHECK_SIGNATURE",19:"COMPARE","1a":"CONCAT","1b":"CONS","1c":"CREATE_ACCOUNT","1d":"CREATE_CONTRACT","1e":"IMPLICIT_ACCOUNT","1f":"DIP",20:"DROP",21:"DUP",22:"EDIV",23:"EMPTY_MAP",24:"EMPTY_SET",25:"EQ",26:"EXEC",27:"FAILWITH",28:"GE",29:"GET","2a":"GT","2b":"HASH_KEY","2c":"IF","2d":"IF_CONS","2e":"IF_LEFT","2f":"IF_NONE",30:"INT",31:"LAMBDA",32:"LE",33:"LEFT",34:"LOOP",35:"LSL",36:"LSR",37:"LT",38:"MAP",39:"MEM","3a":"MUL","3b":"NEG","3c":"NEQ","3d":"NIL","3e":"NONE","3f":"NOT",40:"NOW",41:"OR",42:"PAIR",43:"PUSH",44:"RIGHT",45:"SIZE",46:"SOME",47:"SOURCE",48:"SENDER",49:"SELF","4a":"STEPS_TO_QUOTA","4b":"SUB","4c":"SWAP","4d":"TRANSFER_TOKENS","4e":"SET_DELEGATE","4f":"UNIT",50:"UPDATE",51:"XOR",52:"ITER",53:"LOOP_LEFT",54:"ADDRESS",55:"CONTRACT",56:"ISNAT",57:"CAST",58:"RENAME",59:"bool","5a":"contract","5b":"int","5c":"key","5d":"key_hash","5e":"lambda","5f":"list",60:"map",61:"big_map",62:"nat",63:"option",64:"or",65:"pair",66:"set",67:"signature",68:"string",69:"bytes","6a":"mutez","6b":"timestamp","6c":"unit","6d":"operation","6e":"address","6f":"SLICE",70:"DIG",71:"DUG",72:"EMPTY_BIG_MAP",73:"APPLY",74:"chain_id",75:"CHAIN_ID",76:"LEVEL",77:"SELF_ADDRESS",78:"never",79:"NEVER","7a":"UNPAIR","7b":"VOTING_POWER","7c":"TOTAL_VOTING_POWER","7d":"KECCAK","7e":"SHA3","7f":"PAIRING_CHECK",80:"bls12_381_g1",81:"bls12_381_g2",82:"bls12_381_fr",83:"sapling_state",84:"sapling_transaction_deprecated",85:"SAPLING_EMPTY_STATE",86:"SAPLING_VERIFY_UPDATE",87:"ticket",88:"TICKET_DEPRECATED",89:"READ_TICKET","8a":"SPLIT_TICKET","8b":"JOIN_TICKETS","8c":"GET_AND_UPDATE","8d":"chest","8e":"chest_key","8f":"OPEN_CHEST",90:"VIEW",91:"view",92:"constant",93:"SUB_MUTEZ",94:"tx_rollup_l2_address",95:"MIN_BLOCK_TIME",96:"sapling_transaction",97:"EMIT",98:"Lambda_rec",99:"LAMBDA_REC","9a":"TICKET"},cm=(()=>{const e={};return Object.keys(Yt).forEach(t=>{e[Yt[t]]=t}),e})(),Rs={4:"activate_account",107:"reveal",110:"delegation",108:"transaction",109:"origination",6:"ballot",21:"endorsement",1:"seed_nonce_revelation",5:"proposals",111:"register_global_constant",150:"tx_rollup_origination",151:"tx_rollup_submit_batch",158:"transfer_ticket",112:"set_deposits_limit",113:"increase_paid_storage",114:"update_consensus_key",9:"drain_delegate"},Ta=(()=>{const e={};return Object.keys(Rs).forEach(t=>{const r=typeof t=="string"?parseInt(t,10):t;e[Rs[r]]=W(r,2)}),e})(),Fn={"00":"default","01":"root","02":"do","03":"set_delegate","04":"remove_delegate","05":"deposit"},Na=(()=>{const e={};return Object.keys(Fn).forEach(t=>{e[Fn[t]]=t}),e})();class um extends Error{constructor(t){super(t),this.message=t,this.name="InvalidBlockHashError"}}class La extends Error{constructor(t){super(t),this.message=t,this.name="InvalidOperationSchemaError"}}class bi extends Error{constructor(t){super(`Oversized entrypoint: ${t}. The maximum length of entrypoint is ${Xr}`),this.entrypoint=t,this.name="OversizedEntryPointError"}}class lm extends Error{constructor(t){super(`The ballot value '${t}' is invalid`),this.ballotValue=t,this.name="InvalidBallotValueError"}}class hm extends Error{constructor(t){super(`Failed to decode ballot value ${t}`),this.ballotValue=t,this.name="DecodeBallotValueError"}}class yu extends Error{constructor(t){super(`The hex string '${t}' is invalid`),this.hexString=t,this.name="InvalidHexStringError"}}class Eu extends Error{constructor(t){super(`Failed to encode michelson value '${t}'`),this.value=t,this.name="UnexpectedMichelsonValueError"}}class bu extends Error{constructor(t){super(t),this.message=t,this.name="OperationDecodingError"}}class pm extends Error{constructor(t){super(t),this.message=t,this.name="OperationEncodingError"}}class dm extends Error{constructor(t){super(`The operation '${t}' is unsupported`),this.op=t,this.name="UnsupportedOperationError"}}class bt{constructor(t,r=0){this.arr=t,this.offset=r}static fromHexString(t){const r=t.toLowerCase();if(/^(([a-f]|\d){2})*$/.test(r)){const n=new Uint8Array((r.match(/([a-z]|\d){2}/g)||[]).map(i=>parseInt(i,16)));return new bt(n)}else throw new yu(r)}consume(t){const r=this.arr.subarray(this.offset,this.offset+t);return this.offset+=t,r}get(t){return this.arr[this.offset+t]}length(){return this.arr.length-this.offset}}const vu=e=>"prim"in e,_u=e=>"bytes"in e&&typeof e.bytes=="string",wu=e=>"string"in e&&typeof e.string=="string",Au=e=>"int"in e&&typeof e.int=="string",fm=e=>{const t=Je(e.code),r=Je(e.storage);return`${W(t.length/2,8)}${t}${W(r.length/2,8)}${r}`},gm=e=>{const t=ht(e),r=ht(e);return{code:Xe(new bt(t)),storage:Xe(new bt(r))}},Je=e=>{if(Array.isArray(e)){const t=e.map(n=>Je(n)).join(""),r=t.length/2;return`02${W(r)}${t}`}else{if(vu(e))return mm(e);if(_u(e))return Ru(e);if(wu(e))return Pu(e);if(Au(e))return Su(e)}throw new Eu(JSON.stringify(e))},Xe=e=>{const t=e.consume(1);switch(t[0]){case 10:return Ou(e);case 1:return Iu(e);case 0:return Tu(e);case 2:{const r=new bt(ht(e)),n=[];for(;r.length()>0;)n.push(Xe(r));return n}default:return ym(e,t)}},ht=(e,t=4)=>{const r=e.consume(t),n=parseInt(Buffer.from(r).toString("hex"),16);return e.consume(n)},Ru=e=>{if(!/^([A-Fa-f0-9]{2})*$/.test(e.bytes))throw new yu(e.bytes);const t=e.bytes.length/2;return`0a${W(t)}${e.bytes}`},Ou=e=>{const t=ht(e);return{bytes:Buffer.from(t).toString("hex")}},Pu=e=>{const t=Buffer.from(e.string,"utf8").toString("hex"),r=t.length/2;return`01${W(r)}${t}`},Iu=e=>{const t=ht(e);return{string:Buffer.from(t).toString("utf8")}},Su=({int:e})=>{const t=new R(e,10),r=t.toString(2)[0]==="-"?"1":"0",n=t.toString(2).replace(/-/g,""),i=n.length<=6?6:(n.length-6)%7?n.length+7-(n.length-6)%7:n.length,o=n.padStart(i,"0").match(/\d{6,7}/g).reverse();return o[0]=r+o[0],`00${o.map((c,d)=>parseInt((d===o.length-1?"0":"1")+c,2).toString(16).padStart(2,"0")).join("")}`},Tu=e=>{let t=e.consume(1)[0];const r=[],n=1<<7;for(;t&n;)r.push(t),t=e.consume(1)[0];r.push(t);const i=!!(1<<6&r[0]);r[0]=r[0]&127;const s=r.map((a,c)=>a.toString(2).slice(c===0?-6:-7).padStart(c===0?6:7,"0")).reverse();let o=new R(s.join(""),2);return i&&(o=o.times(-1)),{int:o.toFixed()}},mm=e=>{const t=+Array.isArray(e.annots),r=Array.isArray(e.args)?e.args.length:0,n=W(Math.min(2*r+t+3,9),2),i=cm[e.prim];let s=(e.args||[]).map(a=>Je(a)).join("");const o=Array.isArray(e.annots)?Nu(e.annots):"";return(e.prim==="LAMBDA"||e.prim==="LAMBDA_REC")&&r&&(s=W(s.length/2)+s+W(0)),(e.prim==="pair"||e.prim==="Pair")&&r>2&&(s=o===""?W(s.length/2)+s+W(0):W(s.length/2)+s),e.prim==="view"&&e.args&&(s=W(s.length/2)+s+W(0)),`${n}${i}${s}${o}`},ym=(e,t)=>{const r=(t[0]-3)%2===1;let n=Math.floor((t[0]-3)/2);const i=e.consume(1)[0].toString(16).padStart(2,"0"),s={prim:Yt[i]};if((Yt[i]==="LAMBDA"||Yt[i]==="LAMBDA_REC")&&e.consume(4),Yt[i]==="view")return n!=0?Em(e,s):s;let o,a;(Yt[i]==="pair"||Yt[i]==="Pair")&&n>2&&(o=bm(e),n=0,a=qn(e));const c=new Array(n).fill(0).map(()=>Xe(e));return(Yt[i]==="LAMBDA"||Yt[i]==="LAMBDA_REC")&&e.consume(4),o?s.args=o:c.length&&(s.args=c),a&&a[0]!==""?s.annots=a:r&&(s.annots=qn(e)),s},Em=(e,t)=>(e.consume(4),t.args=new Array(4).fill(0).map(()=>Xe(e)),e.consume(4),t),bm=e=>{const t=new bt(ht(e)),r=[];for(;t.length()>0;)r.push(Xe(t));return r},Nu=e=>{const t=e.map(n=>Buffer.from(n,"utf8").toString("hex")).join("20"),r=t.length/2;return`${W(r)}${t}`},qn=e=>{const t=e.consume(4),r=parseInt(Buffer.from(t).toString("hex"),16),n=e.consume(r);return Buffer.from(n).toString("hex").split("20").map(s=>Buffer.from(s,"hex").toString("utf8"))},Bt=e=>t=>kl(Buffer.from(Fa(t,Ts[e]))),kt=e=>t=>{const r=t.consume(jl[e]);return Hl(r,Ts[e])},Lu=kt(C.TZ1),xu=kt(C.B),vi=e=>{const t=e.consume(1);if(t[0]===0)return kt(C.TZ1)(e);if(t[0]===1)return kt(C.TZ2)(e);if(t[0]===2)return kt(C.TZ3)(e)},Cu=Bt(C.B),Mu=Bt(C.TZ1),xa=e=>e?"ff":"00",Qs=e=>Bt(C.P)(e),to=e=>kt(C.P)(e),Du=e=>{const t=[];for(e.consume(4);e.length()>0;)t.push(to(e));return t},$u=e=>W(32*e.length)+e.map(t=>Qs(t)).join(""),Bu=e=>{switch(e){case"yay":return"00";case"nay":return"01";case"pass":return"02";default:throw new lm(e)}},ku=e=>{const t=e.consume(1);switch(t[0]){case 0:return"yay";case 1:return"nay";case 2:return"pass";default:throw new hm(t[0].toString())}},ju=e=>e?xa(!0)+_i(e):xa(!1),Hu=e=>{const t=parseInt(String(e),10),r=[];for(let n=0;n<4;n++){const i=(4-(n+1))*8;r.push((t&255<<i)>>i)}return Buffer.from(r).toString("hex")},Vu=e=>{const t=e.consume(4);let r=0;for(let n=0;n<t.length;n++)r=r|t[n]<<(t.length-(n+1))*8;return r},Uu=e=>{const t=parseInt(String(e),10),r=[];for(let n=0;n<2;n++){const i=(2-(n+1))*8;r.push((t&255<<i)>>i)}return Buffer.from(r).toString("hex")},Gu=e=>{const t=e.consume(2);let r=0;for(let n=0;n<t.length;n++)r=r|t[n]<<(t.length-(n+1))*8;return r},vm=e=>e.consume(1)[0]===255,Ku=e=>{if(vm(e))return vi(e)},_i=e=>{switch(e.substr(0,3)){case C.TZ1:return"00"+Bt(C.TZ1)(e);case C.TZ2:return"01"+Bt(C.TZ2)(e);case C.TZ3:return"02"+Bt(C.TZ3)(e);default:throw new Ls(e)}},Fu=e=>{switch(e.substr(0,4)){case C.EDPK:return"00"+Bt(C.EDPK)(e);case C.SPPK:return"01"+Bt(C.SPPK)(e);case C.P2PK:return"02"+Bt(C.P2PK)(e);default:throw new za(e)}},qu=e=>{switch(e.substr(0,3)){case C.TZ1:case C.TZ2:case C.TZ3:return"00"+_i(e);case C.KT1:return"01"+Bt(C.KT1)(e)+"00";default:throw new tt(e)}},zu=e=>{if(e.substring(0,3)===C.KT1)return"01"+Bt(C.KT1)(e)+"00";throw new Ce(e)},Yu=e=>{switch(e.consume(1)[0]){case 0:return kt(C.EDPK)(e);case 1:return kt(C.SPPK)(e);case 2:return kt(C.P2PK)(e);default:throw new za(e.toString())}},Wu=e=>{switch(e.consume(1)[0]){case 0:return vi(e);case 1:{const r=kt(C.KT1)(e);return e.consume(1),r}default:throw new tt(e.toString())}},Ju=e=>{if(e.consume(1)[0]===1){const r=kt(C.KT1)(e);return e.consume(1),r}throw new Ce(e.toString())},wi=e=>{const t=[];let r=new R(e,10);if(r.isNaN())throw new TypeError(`Invalid zarith number ${e}`);for(;;)if(r.lt(128)){r.lt(16)&&t.push("0"),t.push(r.toString(16));break}else{let n=r.mod(128);r=r.minus(n),r=r.dividedBy(128),n=n.plus(128),t.push(n.toString(16))}return t.join("")},Ai=e=>{let t=0;for(;t<e.length()&&e.get(t)&128;)t+=1;let r=new R(0);for(let n=t;n>=0;n-=1){const i=e.get(n)&127;r=r.multipliedBy(128),r=r.plus(i)}return e.consume(t+1),new R(r).toString()},_m=e=>{const t=W(e.consume(1)[0],2);if(t in Fn)return Fn[t];{const r=ht(e,1),n=Buffer.from(r).toString("utf8");if(n.length>Xr)throw new bi(n);return n}},wm=e=>{if(e.consume(1)[0]!==0){const r=_m(e),n=ht(e),i=Xe(new bt(n));return{entrypoint:r,value:i}}},Am=e=>{if(e in Na)return`${Na[e]}`;if(e.length>Xr)throw new bi(e);return`ff${Je({string:e}).slice(8)}`},Rm=e=>{if(!e||e.entrypoint==="default"&&"prim"in e.value&&e.value.prim==="Unit")return"00";const t=Am(e.entrypoint),r=Je(e.value),n=(r.length/2).toString(16).padStart(8,"0");return`ff${t}${n}${r}`},Om=e=>{const t=Je(e);return`${W(t.length/2)}${t}`},Pm=e=>{const t=ht(e);return Xe(new bt(t))},Xu=Bt(C.VH),Zu=kt(C.VH),Im=e=>`${Je({string:e}).slice(2)}`,Qu=e=>{const t=ht(e);return Buffer.from(t).toString("utf8")},tl=e=>"",el=e=>({}),rl=Bt(C.TXR1),nl=kt(C.TXR1),il=e=>`${W(e.length/2)}${e}`,sl=e=>{const t=ht(e);return Buffer.from(t).toString("hex")},ol=e=>e?`ff${wi(e)}`:"00",al=e=>{const t=e.consume(1);if(Buffer.from(t).toString("hex")!=="00")return Ai(e)},cl=e=>e?`ff${wi(e)}`:"00",ul=e=>{const t=e.consume(1);if(Buffer.from(t).toString("hex")!=="00")return Ai(e)},Ri={branch:h.BRANCH,contents:[h.OPERATION]},Zr={pkh:h.TZ1,secret:h.SECRET},Qr={source:h.PKH,fee:h.ZARITH,counter:h.ZARITH,gas_limit:h.ZARITH,storage_limit:h.ZARITH,public_key:h.PUBLIC_KEY},tn={source:h.PKH,fee:h.ZARITH,counter:h.ZARITH,gas_limit:h.ZARITH,storage_limit:h.ZARITH,delegate:h.DELEGATE},en={source:h.PKH,fee:h.ZARITH,counter:h.ZARITH,gas_limit:h.ZARITH,storage_limit:h.ZARITH,amount:h.ZARITH,destination:h.ADDRESS,parameters:h.PARAMETERS},rn={source:h.PKH,fee:h.ZARITH,counter:h.ZARITH,gas_limit:h.ZARITH,storage_limit:h.ZARITH,balance:h.ZARITH,delegate:h.DELEGATE,script:h.SCRIPT},nn={source:h.PKH,period:h.INT32,proposal:h.PROPOSAL,ballot:h.BALLOT_STATEMENT},sn={slot:h.INT16,level:h.INT32,round:h.INT32,block_payload_hash:h.BLOCK_PAYLOAD_HASH},on={level:h.INT32,nonce:h.RAW},an={source:h.PKH,period:h.INT32,proposals:h.PROPOSAL_ARR},cn={source:h.PKH,fee:h.ZARITH,counter:h.ZARITH,gas_limit:h.ZARITH,storage_limit:h.ZARITH,value:h.VALUE},un={source:h.PKH,fee:h.ZARITH,counter:h.ZARITH,gas_limit:h.ZARITH,storage_limit:h.ZARITH,ticket_contents:h.VALUE,ticket_ty:h.VALUE,ticket_ticketer:h.ADDRESS,ticket_amount:h.ZARITH,destination:h.ADDRESS,entrypoint:h.ENTRYPOINT},ln={source:h.PKH,fee:h.ZARITH,counter:h.ZARITH,gas_limit:h.ZARITH,storage_limit:h.ZARITH,tx_rollup_origination:h.TX_ROLLUP_ORIGINATION_PARAM},hn={source:h.PKH,fee:h.ZARITH,counter:h.ZARITH,gas_limit:h.ZARITH,storage_limit:h.ZARITH,rollup:h.TX_ROLLUP_ID,content:h.TX_ROLLUP_BATCH_CONTENT,burn_limit:h.BURN_LIMIT},pn={source:h.PKH,fee:h.ZARITH,counter:h.ZARITH,gas_limit:h.ZARITH,storage_limit:h.ZARITH,amount:h.ZARITH,destination:h.SMART_CONTRACT_ADDRESS},eo={source:h.PKH,fee:h.ZARITH,counter:h.ZARITH,gas_limit:h.ZARITH,storage_limit:h.ZARITH,pk:h.PUBLIC_KEY},ro={consensus_key:h.PKH,delegate:h.PKH,destination:h.PKH},dn={source:h.PKH,fee:h.ZARITH,counter:h.ZARITH,gas_limit:h.ZARITH,storage_limit:h.ZARITH,limit:h.DEPOSITS_LIMIT},ll=e=>t=>{if(!(t.kind in e)||!(t.kind in Ta))throw new We(t.kind);return Ta[t.kind]+e[t.kind](t)},hl=e=>t=>{const r=t.consume(1),n=Rs[r[0]];if(n===void 0)throw new dm(r[0].toString());const i=e[n](t);if(typeof i!="object")throw new bu("Decoded invalid operation");return Object.assign({kind:n},i)},z=e=>t=>r=>Object.keys(t).reduce((i,s)=>{const o=t[s];if(r&&Array.isArray(o)){const a=e[o[0]],c=r[s];if(!Array.isArray(c))throw new pm(`Expected value to be Array ${JSON.stringify(c)}`);return i+c.reduce((d,p)=>d+a(p),"")}else{const a=e[o];return i+a(r[s])}},""),Y=e=>t=>r=>Object.keys(t).reduce((i,s)=>{const o=t[s];if(Array.isArray(o)){const a=e[o[0]],c=[],d=r.length();for(;r.length()>0;)if(c.push(a(r)),d===r.length())throw new bu("Unable to decode value");return Object.assign(Object.assign({},i),{[s]:c})}else{const a=e[o];a||console.log("decoding",o,a,e,s,t);const c=a(r);return typeof c<"u"?Object.assign(Object.assign({},i),{[s]:c}):Object.assign({},i)}},{}),B={[h.SECRET]:e=>Kn(e.consume(20)),[h.RAW]:e=>Kn(e.consume(32)),[h.TZ1]:Lu,[h.BRANCH]:xu,[h.ZARITH]:Ai,[h.PUBLIC_KEY]:Yu,[h.PKH]:vi,[h.DELEGATE]:Ku,[h.INT32]:Vu,[h.SCRIPT]:gm,[h.BALLOT_STATEMENT]:ku,[h.PROPOSAL]:to,[h.PROPOSAL_ARR]:Du,[h.PARAMETERS]:wm,[h.ADDRESS]:Wu,[h.SMART_CONTRACT_ADDRESS]:Ju,[h.VALUE]:Pm,[h.INT16]:Gu,[h.BLOCK_PAYLOAD_HASH]:Zu,[h.ENTRYPOINT]:Qu,[h.TX_ROLLUP_ORIGINATION_PARAM]:el,[h.TX_ROLLUP_ID]:nl,[h.TX_ROLLUP_BATCH_CONTENT]:sl,[h.BURN_LIMIT]:al,[h.DEPOSITS_LIMIT]:ul};B[h.OPERATION]=hl(B);B[h.OP_ACTIVATE_ACCOUNT]=e=>Y(B)(Zr)(e);B[h.OP_DELEGATION]=e=>Y(B)(tn)(e);B[h.OP_TRANSACTION]=e=>Y(B)(en)(e);B[h.OP_ORIGINATION]=e=>Y(B)(rn)(e);B[h.OP_BALLOT]=e=>Y(B)(nn)(e);B[h.OP_ENDORSEMENT]=e=>Y(B)(sn)(e);B[h.OP_SEED_NONCE_REVELATION]=e=>Y(B)(on)(e);B[h.OP_PROPOSALS]=e=>Y(B)(an)(e);B[h.OP_REVEAL]=e=>Y(B)(Qr)(e);B[h.OP_REGISTER_GLOBAL_CONSTANT]=e=>Y(B)(cn)(e);B[h.OP_TRANSFER_TICKET]=e=>Y(B)(un)(e);B[h.OP_TX_ROLLUP_ORIGINATION]=e=>Y(B)(ln)(e);B[h.OP_TX_ROLLUP_SUBMIT_BATCH]=e=>Y(B)(hn)(e);B[h.OP_INCREASE_PAID_STORAGE]=e=>Y(B)(pn)(e);B[h.OP_UPDATE_CONSENSUS_KEY]=e=>Y(B)(eo)(e);B[h.OP_DRAIN_DELEGATE]=e=>Y(B)(ro)(e);B[h.MANAGER]=Y(B)(Ri);B[h.OP_SET_DEPOSITS_LIMIT]=e=>Y(B)(dn)(e);const k={[h.SECRET]:e=>e,[h.RAW]:e=>e,[h.TZ1]:Mu,[h.BRANCH]:Cu,[h.ZARITH]:wi,[h.PUBLIC_KEY]:Fu,[h.PKH]:_i,[h.DELEGATE]:ju,[h.SCRIPT]:fm,[h.BALLOT_STATEMENT]:Bu,[h.PROPOSAL]:Qs,[h.PROPOSAL_ARR]:$u,[h.INT32]:Hu,[h.PARAMETERS]:Rm,[h.ADDRESS]:qu,[h.SMART_CONTRACT_ADDRESS]:zu,[h.VALUE]:Om,[h.INT16]:Uu,[h.BLOCK_PAYLOAD_HASH]:Xu,[h.ENTRYPOINT]:Im,[h.TX_ROLLUP_ORIGINATION_PARAM]:tl,[h.TX_ROLLUP_ID]:rl,[h.TX_ROLLUP_BATCH_CONTENT]:il,[h.BURN_LIMIT]:ol,[h.DEPOSITS_LIMIT]:cl};k[h.OPERATION]=ll(k);k[h.OP_ACTIVATE_ACCOUNT]=e=>z(k)(Zr)(e);k[h.OP_DELEGATION]=e=>z(k)(tn)(e);k[h.OP_TRANSACTION]=e=>z(k)(en)(e);k[h.OP_ORIGINATION]=e=>z(k)(rn)(e);k[h.OP_BALLOT]=e=>z(k)(nn)(e);k[h.OP_ENDORSEMENT]=e=>z(k)(sn)(e);k[h.OP_SEED_NONCE_REVELATION]=e=>z(k)(on)(e);k[h.OP_PROPOSALS]=e=>z(k)(an)(e);k[h.OP_REVEAL]=e=>z(k)(Qr)(e);k[h.OP_REGISTER_GLOBAL_CONSTANT]=e=>z(k)(cn)(e);k[h.OP_TRANSFER_TICKET]=e=>z(k)(un)(e);k[h.OP_TX_ROLLUP_ORIGINATION]=e=>z(k)(ln)(e);k[h.OP_TX_ROLLUP_SUBMIT_BATCH]=e=>z(k)(hn)(e);k[h.OP_INCREASE_PAID_STORAGE]=e=>z(k)(pn)(e);k[h.OP_UPDATE_CONSENSUS_KEY]=e=>z(k)(eo)(e);k[h.OP_DRAIN_DELEGATE]=e=>z(k)(ro)(e);k[h.MANAGER]=z(k)(Ri);k[h.OP_SET_DEPOSITS_LIMIT]=e=>z(k)(dn)(e);const pl={activate_account:Zr,reveal:Qr,delegation:tn,transaction:en,origination:rn,ballot:nn,endorsement:sn,seed_nonce_revelation:on,proposals:an,register_global_constant:cn,transfer_ticket:un,tx_rollup_origination:ln,tx_rollup_submit_batch:hn,increase_paid_storage:pn,update_consensus_key:eo,drain_delegate:ro,set_deposits_limit:dn},Sm=(e,t)=>t.filter(r=>!e.includes(r)),Tm=(e,t)=>e.filter(r=>r!==t),Nm=e=>Object.keys(pl).includes(e),Lm=e=>{const t=e.kind,r=Object.keys(e),n=Tm(r,"kind"),i=Object.keys(pl[t]);return Sm(n,i)};var zn;(function(e){e.Pt24m4xi="Pt24m4xiPbLDhVgVfABUjirbmda3yohdN82Sp9FeuAXJ4eV9otd",e.PsBABY5H="PsBABY5HQTSkA4297zNHfsZNKtxULfL18y95qb3m53QJiXGmrbU",e.PsBabyM1="PsBabyM1eUXZseaJdmXFApDSBqj8YBfwELoxZHHW77EMcAbbwAS",e.PsCARTHA="PsCARTHAGazKbHtnKfLzQg3kms52kSRpgnDY982a9oYsSXRLQEb",e.PsDELPH1="PsDELPH1Kxsxt8f9eWbxQeRxkjfbxoqM52jvs5Y5fBxWWh4ifpo",e.PtEdo2Zk="PtEdo2ZkT9oKpimTah6x2embF25oss54njMuPzkJTEi5RqfdZFA",e.PsFLorena="PsFLorenaUUuikDWvMDr6fGBRG8kt3e3D3fHoXK1j1BFRxeSH4i",e.PtGRANADs="PtGRANADsDU8R9daYKAgWnQYAJ64omN1o3KMGVCykShA97vQbvV",e.PtHangz2="PtHangz2aRngywmSRGGvrcTyMbbdpWdpFKuS4uMWxg2RaH9i1qx",e.Psithaca2="Psithaca2MLRFYargivpo7YvUr7wUDqyxrdhC5CQq78mRvimz6A",e.PtJakart2="PtJakart2xVj7pYXJBXrqHgd82rdkLey5ZeeGwDgPp9rhQUbSqY",e.PtKathman="PtKathmankSpLLDALzWw7CGD2j2MtyveTwboEYokqUCP4a1LxMg",e.PtLimaPtL="PtLimaPtLMwfNinJi9rCfDPWea8dFgTZ1MeJ9f1m2SRic6ayiwW",e.ProtoALpha="ProtoALphaALphaALphaALphaALphaALphaALphaALphaDdp3zK"})(zn||(zn={}));const Ca={Pt24m4xiPbLDhVgVfABUjirbmda3yohdN82Sp9FeuAXJ4eV9otd:4,PsBABY5HQTSkA4297zNHfsZNKtxULfL18y95qb3m53QJiXGmrbU:5,PsBabyM1eUXZseaJdmXFApDSBqj8YBfwELoxZHHW77EMcAbbwAS:5,PsCARTHAGazKbHtnKfLzQg3kms52kSRpgnDY982a9oYsSXRLQEb:6,PsDELPH1Kxsxt8f9eWbxQeRxkjfbxoqM52jvs5Y5fBxWWh4ifpo:7,PtEdo2ZkT9oKpimTah6x2embF25oss54njMuPzkJTEi5RqfdZFA:8,PsFLorenaUUuikDWvMDr6fGBRG8kt3e3D3fHoXK1j1BFRxeSH4i:9,PtGRANADsDU8R9daYKAgWnQYAJ64omN1o3KMGVCykShA97vQbvV:10,PtHangz2aRngywmSRGGvrcTyMbbdpWdpFKuS4uMWxg2RaH9i1qx:11,Psithaca2MLRFYargivpo7YvUr7wUDqyxrdhC5CQq78mRvimz6A:12,PtJakart2xVj7pYXJBXrqHgd82rdkLey5ZeeGwDgPp9rhQUbSqY:13,PtKathmankSpLLDALzWw7CGD2j2MtyveTwboEYokqUCP4a1LxMg:14,PtLimaPtLMwfNinJi9rCfDPWea8dFgTZ1MeJ9f1m2SRic6ayiwW:15,ProtoALphaALphaALphaALphaALphaALphaALphaALphaDdp3zK:16};function xm(e,t){return Ca[e]<Ca[t]}const je={"00":"parameter","01":"storage","02":"code","03":"False","04":"Elt","05":"Left","06":"None","07":"Pair","08":"Right","09":"Some","0a":"True","0b":"Unit","0c":"PACK","0d":"UNPACK","0e":"BLAKE2B","0f":"SHA256",10:"SHA512",11:"ABS",12:"ADD",13:"AMOUNT",14:"AND",15:"BALANCE",16:"CAR",17:"CDR",18:"CHECK_SIGNATURE",19:"COMPARE","1a":"CONCAT","1b":"CONS","1c":"CREATE_ACCOUNT","1d":"CREATE_CONTRACT","1e":"IMPLICIT_ACCOUNT","1f":"DIP",20:"DROP",21:"DUP",22:"EDIV",23:"EMPTY_MAP",24:"EMPTY_SET",25:"EQ",26:"EXEC",27:"FAILWITH",28:"GE",29:"GET","2a":"GT","2b":"HASH_KEY","2c":"IF","2d":"IF_CONS","2e":"IF_LEFT","2f":"IF_NONE",30:"INT",31:"LAMBDA",32:"LE",33:"LEFT",34:"LOOP",35:"LSL",36:"LSR",37:"LT",38:"MAP",39:"MEM","3a":"MUL","3b":"NEG","3c":"NEQ","3d":"NIL","3e":"NONE","3f":"NOT",40:"NOW",41:"OR",42:"PAIR",43:"PUSH",44:"RIGHT",45:"SIZE",46:"SOME",47:"SOURCE",48:"SENDER",49:"SELF","4a":"STEPS_TO_QUOTA","4b":"SUB","4c":"SWAP","4d":"TRANSFER_TOKENS","4e":"SET_DELEGATE","4f":"UNIT",50:"UPDATE",51:"XOR",52:"ITER",53:"LOOP_LEFT",54:"ADDRESS",55:"CONTRACT",56:"ISNAT",57:"CAST",58:"RENAME",59:"bool","5a":"contract","5b":"int","5c":"key","5d":"key_hash","5e":"lambda","5f":"list",60:"map",61:"big_map",62:"nat",63:"option",64:"or",65:"pair",66:"set",67:"signature",68:"string",69:"bytes","6a":"mutez","6b":"timestamp","6c":"unit","6d":"operation","6e":"address","6f":"SLICE",70:"DIG",71:"DUG",72:"EMPTY_BIG_MAP",73:"APPLY",74:"chain_id",75:"CHAIN_ID",76:"LEVEL",77:"SELF_ADDRESS",78:"never",79:"NEVER","7a":"UNPAIR","7b":"VOTING_POWER","7c":"TOTAL_VOTING_POWER","7d":"KECCAK","7e":"SHA3","7f":"PAIRING_CHECK",80:"bls12_381_g1",81:"bls12_381_g2",82:"bls12_381_fr",83:"sapling_state",84:"sapling_transaction_deprecated",85:"SAPLING_EMPTY_STATE",86:"SAPLING_VERIFY_UPDATE",87:"ticket",88:"TICKET",89:"READ_TICKET","8a":"SPLIT_TICKET","8b":"JOIN_TICKETS","8c":"GET_AND_UPDATE","8d":"chest","8e":"chest_key","8f":"OPEN_CHEST",90:"VIEW",91:"view",92:"constant",93:"SUB_MUTEZ",94:"tx_rollup_l2_address",95:"MIN_BLOCK_TIME",96:"sapling_transaction",97:"EMIT"},Cm=(()=>{const e={};return Object.keys(je).forEach(t=>{e[je[t]]=t}),e})(),Yn={"00":"default","01":"root","02":"do","03":"set_delegate","04":"remove_delegate"},Ma=(()=>{const e={};return Object.keys(Yn).forEach(t=>{e[Yn[t]]=t}),e})(),Mm=e=>{const t=Ze(e.code),r=Ze(e.storage);return`${W(t.length/2,8)}${t}${W(r.length/2,8)}${r}`},Dm=e=>{const t=ht(e),r=ht(e);return{code:Qe(new bt(t)),storage:Qe(new bt(r))}},Ze=e=>{if(Array.isArray(e)){const t=e.map(n=>Ze(n)).join(""),r=t.length/2;return`02${W(r)}${t}`}else{if(vu(e))return $m(e);if(_u(e))return Ru(e);if(wu(e))return Pu(e);if(Au(e))return Su(e)}throw new Eu(JSON.stringify(e))},Qe=e=>{const t=e.consume(1);switch(t[0]){case 10:return Ou(e);case 1:return Iu(e);case 0:return Tu(e);case 2:{const r=new bt(ht(e)),n=[];for(;r.length()>0;)n.push(Qe(r));return n}default:return Bm(e,t)}},$m=e=>{const t=+Array.isArray(e.annots),r=Array.isArray(e.args)?e.args.length:0,n=W(Math.min(2*r+t+3,9),2),i=Cm[e.prim];let s=(e.args||[]).map(a=>Ze(a)).join("");const o=Array.isArray(e.annots)?Nu(e.annots):"";return e.prim==="LAMBDA"&&r&&(s=W(s.length/2)+s+W(0)),(e.prim==="pair"||e.prim==="Pair")&&r>2&&(s=o===""?W(s.length/2)+s+W(0):W(s.length/2)+s),e.prim==="view"&&e.args&&(s=W(s.length/2)+s+W(0)),`${n}${i}${s}${o}`},Bm=(e,t)=>{const r=(t[0]-3)%2===1;let n=Math.floor((t[0]-3)/2);const i=e.consume(1)[0].toString(16).padStart(2,"0"),s={prim:je[i]};if(je[i]==="LAMBDA"&&e.consume(4),je[i]==="view")return n!=0?km(e,s):s;let o,a;(je[i]==="pair"||je[i]==="Pair")&&n>2&&(o=jm(e),n=0,a=qn(e));const c=new Array(n).fill(0).map(()=>Qe(e));return je[i]==="LAMBDA"&&e.consume(4),o?s.args=o:c.length&&(s.args=c),a&&a[0]!==""?s.annots=a:r&&(s.annots=qn(e)),s},km=(e,t)=>(e.consume(4),t.args=new Array(4).fill(0).map(()=>Qe(e)),e.consume(4),t),jm=e=>{const t=new bt(ht(e)),r=[];for(;t.length()>0;)r.push(Qe(t));return r},Hm=e=>{if(e.consume(1)[0]!==0){const r=Um(e),n=ht(e),i=Qe(new bt(n));return{entrypoint:r,value:i}}},Vm=e=>{if(e in Ma)return`${Ma[e]}`;if(e.length>Xr)throw new bi(e);return`ff${Ze({string:e}).slice(8)}`},Um=e=>{const t=W(e.consume(1)[0],2);if(t in Yn)return Yn[t];{const r=ht(e,1),n=Buffer.from(r).toString("utf8");if(n.length>Xr)throw new bi(n);return n}},Gm=e=>{if(!e||e.entrypoint==="default"&&"prim"in e.value&&e.value.prim==="Unit")return"00";const t=Vm(e.entrypoint),r=Ze(e.value),n=(r.length/2).toString(16).padStart(8,"0");return`ff${t}${n}${r}`},Km=e=>{const t=Ze(e);return`${W(t.length/2)}${t}`},Fm=e=>{const t=ht(e);return Qe(new bt(t))},qm=e=>`${Ze({string:e}).slice(2)}`,U={[h.SECRET]:e=>Kn(e.consume(20)),[h.RAW]:e=>Kn(e.consume(32)),[h.TZ1]:Lu,[h.BRANCH]:xu,[h.ZARITH]:Ai,[h.PUBLIC_KEY]:Yu,[h.PKH]:vi,[h.DELEGATE]:Ku,[h.INT32]:Vu,[h.SCRIPT]:Dm,[h.BALLOT_STATEMENT]:ku,[h.PROPOSAL]:to,[h.PROPOSAL_ARR]:Du,[h.PARAMETERS]:Hm,[h.ADDRESS]:Wu,[h.SMART_CONTRACT_ADDRESS]:Ju,[h.VALUE]:Fm,[h.INT16]:Gu,[h.BLOCK_PAYLOAD_HASH]:Zu,[h.ENTRYPOINT]:Qu,[h.TX_ROLLUP_ORIGINATION_PARAM]:el,[h.TX_ROLLUP_ID]:nl,[h.TX_ROLLUP_BATCH_CONTENT]:sl,[h.BURN_LIMIT]:al,[h.DEPOSITS_LIMIT]:ul};U[h.OPERATION]=hl(U);U[h.OP_ACTIVATE_ACCOUNT]=e=>Y(U)(Zr)(e);U[h.OP_DELEGATION]=e=>Y(U)(tn)(e);U[h.OP_TRANSACTION]=e=>Y(U)(en)(e);U[h.OP_ORIGINATION]=e=>Y(U)(rn)(e);U[h.OP_BALLOT]=e=>Y(U)(nn)(e);U[h.OP_ENDORSEMENT]=e=>Y(U)(sn)(e);U[h.OP_SEED_NONCE_REVELATION]=e=>Y(U)(on)(e);U[h.OP_PROPOSALS]=e=>Y(U)(an)(e);U[h.OP_REVEAL]=e=>Y(U)(Qr)(e);U[h.OP_REGISTER_GLOBAL_CONSTANT]=e=>Y(U)(cn)(e);U[h.OP_TRANSFER_TICKET]=e=>Y(U)(un)(e);U[h.OP_TX_ROLLUP_ORIGINATION]=e=>Y(U)(ln)(e);U[h.OP_TX_ROLLUP_SUBMIT_BATCH]=e=>Y(U)(hn)(e);U[h.OP_INCREASE_PAID_STORAGE]=e=>Y(U)(pn)(e);U[h.MANAGER]=Y(U)(Ri);U[h.OP_SET_DEPOSITS_LIMIT]=e=>Y(U)(dn)(e);const G={[h.SECRET]:e=>e,[h.RAW]:e=>e,[h.TZ1]:Mu,[h.BRANCH]:Cu,[h.ZARITH]:wi,[h.PUBLIC_KEY]:Fu,[h.PKH]:_i,[h.DELEGATE]:ju,[h.SCRIPT]:Mm,[h.BALLOT_STATEMENT]:Bu,[h.PROPOSAL]:Qs,[h.PROPOSAL_ARR]:$u,[h.INT32]:Hu,[h.PARAMETERS]:Gm,[h.ADDRESS]:qu,[h.SMART_CONTRACT_ADDRESS]:zu,[h.VALUE]:Km,[h.INT16]:Uu,[h.BLOCK_PAYLOAD_HASH]:Xu,[h.ENTRYPOINT]:qm,[h.TX_ROLLUP_ORIGINATION_PARAM]:tl,[h.TX_ROLLUP_ID]:rl,[h.TX_ROLLUP_BATCH_CONTENT]:il,[h.BURN_LIMIT]:ol,[h.DEPOSITS_LIMIT]:cl};G[h.OPERATION]=ll(G);G[h.OP_ACTIVATE_ACCOUNT]=e=>z(G)(Zr)(e);G[h.OP_DELEGATION]=e=>z(G)(tn)(e);G[h.OP_TRANSACTION]=e=>z(G)(en)(e);G[h.OP_ORIGINATION]=e=>z(G)(rn)(e);G[h.OP_BALLOT]=e=>z(G)(nn)(e);G[h.OP_ENDORSEMENT]=e=>z(G)(sn)(e);G[h.OP_SEED_NONCE_REVELATION]=e=>z(G)(on)(e);G[h.OP_PROPOSALS]=e=>z(G)(an)(e);G[h.OP_REVEAL]=e=>z(G)(Qr)(e);G[h.OP_REGISTER_GLOBAL_CONSTANT]=e=>z(G)(cn)(e);G[h.OP_TRANSFER_TICKET]=e=>z(G)(un)(e);G[h.OP_TX_ROLLUP_ORIGINATION]=e=>z(G)(ln)(e);G[h.OP_TX_ROLLUP_SUBMIT_BATCH]=e=>z(G)(hn)(e);G[h.OP_INCREASE_PAID_STORAGE]=e=>z(G)(pn)(e);G[h.MANAGER]=z(G)(Ri);G[h.OP_SET_DEPOSITS_LIMIT]=e=>z(G)(dn)(e);const dl=zn.PtLimaPtL;function zm(e,t){return t===zn.PtKathman||xm(t,dl)?{encoder:G[e],decoder:r=>{const n=bt.fromHexString(r);return U[e](n)}}:{encoder:k[e],decoder:r=>{const n=bt.fromHexString(r);return B[e](n)}}}class fl{constructor(t=dl){this.protocolHash=t,this.codec=zm(h.MANAGER,this.protocolHash)}forge(t){if(Vl(t.branch)!==x.VALID)throw new um(`The block hash ${t.branch} is invalid`);for(const n of t.contents){if(!Nm(n.kind))throw new We(n.kind);const i=Lm(n);if(i.length===1){if(n.kind==="delegation"&&i[0]==="delegate")continue;if(n.kind==="origination"&&i[0]==="delegate")continue;if(n.kind==="transaction"&&i[0]==="parameters")continue;if(n.kind==="set_deposits_limit"&&i[0]==="limit")continue;if(n.kind==="tx_rollup_submit_batch"&&i[0]==="burn_limit")continue;throw console.log(i,n.kind),new La(`Missing properties: ${i.join(", ").toString()}`)}else if(i.length>1)throw new La(`Missing properties: ${i.join(", ").toString()}`)}const r=this.codec.encoder(t).toLowerCase();return Promise.resolve(r)}parse(t){return Promise.resolve(this.codec.decoder(t))}}const E0=new fl;function qt(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function g(e,t,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(p){try{d(n.next(p))}catch(l){o(l)}}function c(p){try{d(n.throw(p))}catch(l){o(l)}}function d(p){p.done?s(p.value):i(p.value).then(a,c)}d((n=n.apply(e,t||[])).next())})}function Ym(e,t){const r=JSON.parse(e.body);if(r[0]&&r[0].kind&&r[0].msg){const n=JSON.stringify({kind:r[0].kind,id:r[0].id,msg:r[0].msg.replace(t,"")});return new di(`Http error response: (${e.status}) ${n}`,e.status,e.statusText,n,e.url)}else return e}class Wm{constructor(t){this.context=t}inject(t){return g(this,void 0,void 0,function*(){let r;try{r=yield this.context.rpc.injectOperation(t)}catch(n){const i=". You may want to use --replace to provide adequate fee and replace it";throw n instanceof di&&n.message.includes(i)?Ym(n,i):n}return r})}}class bn extends Error{constructor(){super("No signer has been configured. Please configure one by calling setProvider({signer}) on your TezosToolkit instance."),this.name="UnconfiguredSignerError"}}class Os{publicKey(){return g(this,void 0,void 0,function*(){throw new bn})}publicKeyHash(){return g(this,void 0,void 0,function*(){throw new bn})}secretKey(){return g(this,void 0,void 0,function*(){throw new bn})}sign(t,r){return g(this,void 0,void 0,function*(){throw new bn})}}function gl(e){return new nt(t=>(e.on("data",r=>{t.next(r)}),e.on("error",r=>{t.error(r)}),e.on("close",()=>{t.complete()}),()=>{e.close()}))}var tr;(function(e){e[e.DELEGATION=10600]="DELEGATION",e[e.ORIGINATION=10600]="ORIGINATION",e[e.TRANSFER=10600]="TRANSFER",e[e.REVEAL=1100]="REVEAL"})(tr||(tr={}));var er;(function(e){e[e.DELEGATION=1257]="DELEGATION",e[e.ORIGINATION=1e4]="ORIGINATION",e[e.TRANSFER=1e4]="TRANSFER",e[e.REVEAL=374]="REVEAL"})(er||(er={}));var rr;(function(e){e[e.DELEGATION=0]="DELEGATION",e[e.ORIGINATION=257]="ORIGINATION",e[e.TRANSFER=257]="TRANSFER",e[e.REVEAL=0]="REVEAL"})(rr||(rr={}));const Jm=250;var lt;(function(e){e.Pt24m4xi="Pt24m4xiPbLDhVgVfABUjirbmda3yohdN82Sp9FeuAXJ4eV9otd",e.PsBABY5H="PsBABY5HQTSkA4297zNHfsZNKtxULfL18y95qb3m53QJiXGmrbU",e.PsBabyM1="PsBabyM1eUXZseaJdmXFApDSBqj8YBfwELoxZHHW77EMcAbbwAS",e.PsCARTHA="PsCARTHAGazKbHtnKfLzQg3kms52kSRpgnDY982a9oYsSXRLQEb",e.PsDELPH1="PsDELPH1Kxsxt8f9eWbxQeRxkjfbxoqM52jvs5Y5fBxWWh4ifpo",e.PtEdo2Zk="PtEdo2ZkT9oKpimTah6x2embF25oss54njMuPzkJTEi5RqfdZFA",e.PsFLorena="PsFLorenaUUuikDWvMDr6fGBRG8kt3e3D3fHoXK1j1BFRxeSH4i",e.PtGRANADs="PtGRANADsDU8R9daYKAgWnQYAJ64omN1o3KMGVCykShA97vQbvV",e.PtHangz2="PtHangz2aRngywmSRGGvrcTyMbbdpWdpFKuS4uMWxg2RaH9i1qx",e.PsiThaCa="PsiThaCaT47Zboaw71QWScM8sXeMM7bbQFncK9FLqYc6EKdpjVP",e.Psithaca2="Psithaca2MLRFYargivpo7YvUr7wUDqyxrdhC5CQq78mRvimz6A",e.PtJakart2="PtJakart2xVj7pYXJBXrqHgd82rdkLey5ZeeGwDgPp9rhQUbSqY",e.PtKathman="PtKathmankSpLLDALzWw7CGD2j2MtyveTwboEYokqUCP4a1LxMg",e.PtLimaPtL="PtLimaPtLMwfNinJi9rCfDPWea8dFgTZ1MeJ9f1m2SRic6ayiwW",e.ProtoALpha="ProtoALphaALphaALphaALphaALphaALphaALphaALphaDdp3zK"})(lt||(lt={}));lt.Pt24m4xi,lt.PsBABY5H,lt.PsBabyM1,lt.PsCARTHA,lt.PsDELPH1,lt.PtEdo2Zk,lt.PsFLorena,lt.PtGRANADs,lt.PtHangz2,lt.PsiThaCa,lt.Psithaca2,lt.PtJakart2,lt.PtKathman,lt.PtLimaPtL,lt.ProtoALpha;var Da;(function(e){e.MAINNET="NetXdQprcVkpaWU",e.CARTHAGENET="NetXjD3HPJJjmcd",e.DELPHINET="NetXm8tYqnMWky1",e.EDONET="NetXSgo1ZT2DRUG",e.FLORENCENET="NetXxkAx4woPLyu",e.GRANADANET="NetXz969SFaFn8k",e.HANGZHOUNET="NetXZSsxBpMQeAT",e.ITHACANET="NetXbhmtAbMukLc",e.ITHACANET2="NetXnHfVqm9iesp",e.JAKARTANET2="NetXLH1uAxK7CCh",e.KATHMANDUNET="NetXazhm4yetmff",e.LIMANET="NetXizpkH94bocH"})(Da||(Da={}));class ml extends Error{constructor(t,r,n){super(`${t} Received ${n.length} arguments while expecting one of the following signatures (${JSON.stringify(r)})`),this.smartContractMethodName=t,this.sigs=r,this.args=n,this.name="Invalid parameters error"}}class Xm extends Error{constructor(t){super(`Since Babylon delegation source can no longer be a contract address ${t}. Please use the smart contract abstraction to set your delegate.`),this.source=t,this.name="Invalid delegation source error"}}class Wn extends Error{constructor(t,r){super(t),this.message=t,this.data=r,this.name="InvalidCodeParameter"}}class yl extends Error{constructor(t,r){super(t),this.message=t,this.data=r,this.name="InvalidInitParameter"}}class Zm extends Error{constructor(t,r,n,i){super(`Unable to encode the parameter of the view: ${t}. Received ${n} as parameter while expecting one of the following signatures (${JSON.stringify(r)})`),this.smartContractViewName=t,this.sigs=r,this.args=n,this.originalError=i,this.name="Invalid view parameters error",this.cause=i}}class Qm extends Error{constructor(t,r,n,i){super(t),this.message=t,this.viewName=r,this.failWith=n,this.originalError=i,this.name="ViewSimulationError"}}const ty=e=>{if(ey(e.body)){const t=JSON.parse(e.body);if(Array.isArray(t)&&"with"in t[t.length-1])return t[t.length-1].with}},ey=e=>{try{JSON.parse(e)}catch{return!1}return!0};class $a extends Error{constructor(t){super(`${t} Please configure the context of the view execution in the executeView method.`),this.info=t,this.name="InvalidViewSimulationContext"}}class ry extends Error{constructor(t){super(t),this.message=t,this.name="RevealOperationError"}}class ny extends Error{constructor(t){super(t),this.message=t,this.name="OriginationParameterError"}}class iy extends Error{constructor(t){super(t),this.message=t,this.name="IntegerError"}}const Jn=({code:e,init:t,balance:r="0",delegate:n,storage:i,fee:s=er.ORIGINATION,gasLimit:o=tr.ORIGINATION,storageLimit:a=rr.ORIGINATION,mutez:c=!1})=>g(void 0,void 0,void 0,function*(){if(i!==void 0&&t!==void 0)throw new ny("Storage and Init cannot be set a the same time. Please either use storage or init but not both.");if(!Array.isArray(e))throw new Wn("Wrong code parameter type, expected an array",e);let d;if(i!==void 0){const y=e.find(N=>"prim"in N&&N.prim==="storage");if((y==null?void 0:y.args)===void 0)throw new Wn("The storage section is missing from the script",e);d=new Mt(y.args[0]).Encode(i)}else if(t!==void 0&&typeof t=="object")d=t;else throw new yl("Wrong init parameter type, expected JSON Michelson",t);const p={code:e,storage:d};if(isNaN(Number(r)))throw new iy(`Unexpected Invalid Integer ${r}`);const l={kind:b.ORIGINATION,fee:s,gas_limit:o,storage_limit:a,balance:c?r.toString():xs("tz","mutez",r).toString(),script:p};return n&&(l.delegate=n),l}),Xn=({to:e,amount:t,parameter:r,fee:n=er.TRANSFER,gasLimit:i=tr.TRANSFER,storageLimit:s=rr.TRANSFER,mutez:o=!1})=>g(void 0,void 0,void 0,function*(){return{kind:b.TRANSACTION,fee:n,gas_limit:i,storage_limit:s,amount:o?t.toString():xs("tz","mutez",t).toString(),destination:e,parameters:r}}),Zn=({delegate:e,source:t,fee:r=er.DELEGATION,gasLimit:n=tr.DELEGATION,storageLimit:i=rr.DELEGATION})=>g(void 0,void 0,void 0,function*(){return{kind:b.DELEGATION,source:t,fee:r,gas_limit:n,storage_limit:i,delegate:e}}),El=({fee:e=er.DELEGATION,gasLimit:t=tr.DELEGATION,storageLimit:r=rr.DELEGATION},n)=>g(void 0,void 0,void 0,function*(){return{kind:b.DELEGATION,fee:e,gas_limit:t,storage_limit:r,delegate:n}}),Gr=({fee:e=er.REVEAL,gasLimit:t=tr.REVEAL,storageLimit:r=rr.REVEAL},n,i)=>g(void 0,void 0,void 0,function*(){return{kind:b.REVEAL,fee:e,public_key:i,source:n,gas_limit:t,storage_limit:r}}),Qn=({value:e,source:t,fee:r,gasLimit:n,storageLimit:i})=>g(void 0,void 0,void 0,function*(){return{kind:b.REGISTER_GLOBAL_CONSTANT,value:e,fee:r,gas_limit:n,storage_limit:i,source:t}}),ti=({source:e,fee:t,gasLimit:r,storageLimit:n})=>g(void 0,void 0,void 0,function*(){return{kind:b.TX_ROLLUP_ORIGINATION,fee:t,gas_limit:r,storage_limit:n,source:e,tx_rollup_origination:{}}}),ei=({content:e,rollup:t,source:r,fee:n,gasLimit:i,storageLimit:s})=>g(void 0,void 0,void 0,function*(){return{kind:b.TX_ROLLUP_SUBMIT_BATCH,fee:n,gas_limit:i,storage_limit:s,source:r,content:e,rollup:t}}),ri=({ticketContents:e,ticketTy:t,ticketTicketer:r,ticketAmount:n,destination:i,entrypoint:s,source:o,fee:a,gasLimit:c,storageLimit:d})=>g(void 0,void 0,void 0,function*(){return{kind:b.TRANSFER_TICKET,fee:a,gas_limit:c,storage_limit:d,source:o,ticket_contents:e,ticket_ty:t,ticket_ticketer:r,ticket_amount:n,destination:i,entrypoint:s}}),ni=({source:e,fee:t,gasLimit:r,storageLimit:n,amount:i,destination:s})=>g(void 0,void 0,void 0,function*(){return{kind:b.INCREASE_PAID_STORAGE,source:e,fee:t,gas_limit:r,storage_limit:n,amount:i,destination:s}}),sy=({consensus_key:e,delegate:t,destination:r})=>g(void 0,void 0,void 0,function*(){return{kind:b.DRAIN_DELEGATE,consensus_key:e,delegate:t,destination:r}}),oy=({source:e,proposal:t,ballot:r})=>g(void 0,void 0,void 0,function*(){return{kind:b.BALLOT,source:e,proposal:t,ballot:r}}),ay=({source:e,proposals:t})=>g(void 0,void 0,void 0,function*(){return{kind:b.PROPOSALS,source:e,proposals:t}}),bl=({source:e,fee:t,gasLimit:r,storageLimit:n,pk:i})=>g(void 0,void 0,void 0,function*(){return{kind:b.UPDATE_CONSENSUS_KEY,source:e,fee:t,gas_limit:r,storage_limit:n,pk:i}}),as=(e,t)=>Object.assign(Object.assign({},e),{kind:t}),Ba=(e,t)=>{if(Array.isArray(e)){const r=e.find(n=>n.kind===t);if(r&&cy(r,t))return r}},cy=(e,t)=>e.kind===t,vl=e=>["transaction","delegation","origination","reveal","register_global_constant","increase_paid_storage","tx_rollup_origination","tx_rollup_submit_batch","transfer_ticket","update_consensus_key"].indexOf(e.kind)!==-1,Ps=e=>["transaction","delegation","origination","register_global_constant","increase_paid_storage","tx_rollup_origination","tx_rollup_submit_batch","transfer_ticket","update_consensus_key"].indexOf(e.kind)!==-1,no=e=>"metadata"in e,Dr=e=>no(e)&&"operation_result"in e.metadata,uy=e=>no(e)&&"internal_operation_results"in e.metadata,ly=e=>"with"in e;class _l extends Error{constructor(t,r){super(),this.errors=t,this.errorDetails=r,this.name="TezosOperationError";const n=t[t.length-1];this.id=n.id,this.kind=n.kind,this.message=`(${this.kind}) ${this.id}`,ly(n)&&(n.with.string?this.message=n.with.string:n.with.int?this.message=n.with.int:this.message=JSON.stringify(n.with))}}class hy extends Error{constructor(t){super("Preapply returned an unexpected result"),this.result=t,this.name="TezosPreapplyFailureError"}}const de=e=>{const t=Array.isArray(e)?e:[e],r=[];for(let n=0;n<t.length;n++)for(let i=0;i<t[n].contents.length;i++){const s=t[n].contents[i];Dr(s)&&(r.push(Object.assign({fee:s.fee},s.metadata.operation_result)),Array.isArray(s.metadata.internal_operation_results)&&s.metadata.internal_operation_results.forEach(o=>r.push(o.result)))}return r},xr=(e,t="failed")=>{const r=Array.isArray(e)?e:[e];let n=[];for(let i=0;i<r.length;i++)for(let s=0;s<r[i].contents.length;s++){const o=r[i].contents[s];if(no(o)&&(Dr(o)&&o.metadata.operation_result.status===t&&(n=n.concat(o.metadata.operation_result.errors||[])),uy(o)&&Array.isArray(o.metadata.internal_operation_results)))for(const a of o.metadata.internal_operation_results)"result"in a&&a.result.status===t&&(n=n.concat(a.result.errors||[]))}return n};class py extends Error{constructor(t){super(t),this.message=t,this.name="OriginationOperationError"}}class wl extends Error{constructor(t){super(t),this.message=t,this.name="InvalidConfirmationCountError"}}class dy extends Error{constructor(t){super(t),this.message=t,this.name="ConfirmationUndefinedError"}}class fy extends Error{constructor(t){super(t),this.message=t,this.name="InvalidFilterExpressionError"}}class cs extends Error{constructor(t){super(t),this.message=t,this.name="RPCResponseError"}}class Rt{constructor(t,r,n,i){if(this.hash=t,this.raw=r,this.results=n,this.context=i,this._pollingConfig$=new Vr(1),this.currentHead$=this._pollingConfig$.pipe(he(s=>new fi(s).pipe(Gc(s.timeout*1e3,Fs(new Error("Confirmation polling timed out"))))),he(()=>jc(()=>gl(this.context.stream.subscribeBlock("head"))).pipe(he(s=>{var o,a;const c=(a=(o=this.lastHead)===null||o===void 0?void 0:o.header.level)!==null&&a!==void 0?a:s.header.level-1;return zs(c+1,s.header.level-c-1).pipe(Jr(d=>this.context.readProvider.getBlock(d)),Vc(s))}),jn(s=>this.lastHead=s))),la({refCount:!0})),this.confirmed$=this.currentHead$.pipe(lr(s=>{for(let o=3;o>=0;o--)s.operations[o].forEach(a=>{a.hash===this.hash&&(this._foundAt=s.header.level)});if(s.header.level-this._foundAt>=0)return this._foundAt}),kn(s=>s!==void 0),Se(),la()),this._foundAt=Number.POSITIVE_INFINITY,Ya(this.hash)!==x.VALID)throw new Wa(this.hash);this.confirmed$.pipe(Se(),Ys(()=>Cr(xc))).subscribe()}get includedInBlock(){return this._foundAt}get revealOperation(){return Array.isArray(this.results)&&this.results.find(t=>t.kind==="reveal")}get revealStatus(){return this.revealOperation?this.revealOperation.metadata.operation_result.status:"unknown"}get status(){return this.results.map(t=>Dr(t)?t.metadata.operation_result.status:"unknown")[0]||"unknown"}confirmation(t,r){return g(this,void 0,void 0,function*(){if(typeof t<"u"&&t<1)throw new wl("Confirmation count must be at least 1");const{defaultConfirmationCount:n,confirmationPollingTimeoutSecond:i}=this.context.config;this._pollingConfig$.next({timeout:r||i});const s=t!==void 0?t:n;return new Promise((o,a)=>{this.confirmed$.pipe(he(()=>this.currentHead$),kn(c=>c.header.level-this._foundAt>=s-1),Se()).subscribe(c=>{o(this._foundAt+(s-1))},a)})})}}class gy extends Rt{constructor(t,r,n,i,s,o){super(t,i,s,o),this.params=r,this.source=n}sumProp(t,r){return t.reduce((n,i)=>r in i?Number(i[r])+n:n,0)}getOriginatedContractAddresses(){const t=this.results.filter(n=>n.kind==="origination");let r=[];for(const n of t)n.metadata.operation_result.originated_contracts&&(r=[...r,...n.metadata.operation_result.originated_contracts]);return r}get status(){return this.results.filter(t=>Al.indexOf(t.kind)!==-1).map(t=>Dr(t)?t.metadata.operation_result.status:"unknown")[0]||"unknown"}get fee(){return this.sumProp(this.params,"fee")}get gasLimit(){return this.sumProp(this.params,"gas_limit")}get storageLimit(){return this.sumProp(this.params,"storage_limit")}get consumedGas(){return R.config({DECIMAL_PLACES:0,ROUNDING_MODE:R.ROUND_UP}),new R(this.consumedMilliGas).dividedBy(1e3).toString()}get consumedMilliGas(){return String(this.sumProp(de({contents:this.results}),"consumed_milligas"))}get storageDiff(){return String(this.sumProp(de({contents:this.results}),"paid_storage_size_diff"))}get errors(){return xr({contents:this.results})}}class Oi{constructor(t){this.context=t}get rpc(){return this.context.rpc}get signer(){return this.context.signer}isRevealOpNeeded(t,r){return g(this,void 0,void 0,function*(){return!(!(yield this.isAccountRevealRequired(r))||!this.isRevealRequiredForOpType(t))})}isAccountRevealRequired(t){return g(this,void 0,void 0,function*(){return!(yield this.context.readProvider.isAccountRevealed(t,"head"))})}isRevealRequiredForOpType(t){let r=!1;for(const n of t)Ps(n)&&(r=!0);return r}prepareOperation({operation:t,source:r},n){return g(this,void 0,void 0,function*(){const i={};let s=[];const o=this.context.readProvider.getBlockHash("head~2"),a=this.context.readProvider.getNextProtocol("head");Array.isArray(t)?s=[...t]:s=[t];const c=n||(yield this.signer.publicKeyHash());let d=Promise.resolve(void 0),p=Promise.resolve(void 0);s.find(E=>g(this,void 0,void 0,function*(){if(E.kind==="ballot"||E.kind==="proposals")try{p=this.rpc.getCurrentPeriod()}catch(H){throw new cs(`Failed to get the current voting period index: ${JSON.stringify(H)}`)}}));for(let E=0;E<s.length;E++)if(Ps(s[E])||s[E].kind==="reveal"){d=this.context.readProvider.getCounter(c,"head");break}const[l,y,_,N]=yield Promise.all([o,a,d,p]),K=parseInt(_||"0",10);(!i[c]||i[c]<K)&&(i[c]=K);const P=E=>({counter:`${++i[c]}`,fee:typeof E.fee>"u"?"0":`${E.fee}`,gas_limit:typeof E.gas_limit>"u"?"0":`${E.gas_limit}`,storage_limit:typeof E.storage_limit>"u"?"0":`${E.storage_limit}`}),w=E=>({source:typeof E.source>"u"?r||c:E.source}),Kt=(E=>E.map(H=>{switch(H.kind){case b.ACTIVATION:case b.DRAIN_DELEGATE:return Object.assign({},H);case b.ORIGINATION:return Object.assign(Object.assign(Object.assign(Object.assign({},H),{balance:typeof H.balance<"u"?`${H.balance}`:"0"}),w(H)),P(H));case b.TRANSACTION:{const ye=Object.assign(Object.assign(Object.assign(Object.assign({},H),{amount:typeof H.amount<"u"?`${H.amount}`:"0"}),w(H)),P(H));if(ye.source.toLowerCase().startsWith("kt1"))throw new Ja(`KT1 addresses are not supported as source since ${lt.PsBabyM1}`);return ye}case b.REVEAL:case b.DELEGATION:case b.REGISTER_GLOBAL_CONSTANT:case b.TX_ROLLUP_ORIGINATION:case b.TX_ROLLUP_SUBMIT_BATCH:case b.UPDATE_CONSENSUS_KEY:return Object.assign(Object.assign(Object.assign({},H),w(H)),P(H));case b.TRANSFER_TICKET:return Object.assign(Object.assign(Object.assign(Object.assign({},H),{ticket_amount:`${H.ticket_amount}`}),w(H)),P(H));case b.INCREASE_PAID_STORAGE:return Object.assign(Object.assign(Object.assign(Object.assign({},H),{amount:`${H.amount}`}),w(H)),P(H));case b.BALLOT:if(N===void 0)throw new cs("Failed to get the current voting period index");return Object.assign(Object.assign({},H),{period:N==null?void 0:N.voting_period.index});case b.PROPOSALS:if(N===void 0)throw new cs("Failed to get the current voting period index");return Object.assign(Object.assign({},H),{period:N==null?void 0:N.voting_period.index});default:throw new We(H.kind)}}))(s);return{opOb:{branch:l,contents:Kt,protocol:y},counter:K}})}forge({opOb:{branch:t,contents:r,protocol:n},counter:i}){return g(this,void 0,void 0,function*(){return{opbytes:yield this.context.forger.forge({branch:t,contents:r}),opOb:{branch:t,contents:r,protocol:n},counter:i}})}simulate(t){return g(this,void 0,void 0,function*(){return{opResponse:yield this.rpc.runOperation(t),op:t,context:this.context.clone()}})}estimate(t,r){var{fee:n,gasLimit:i,storageLimit:s}=t,o=qt(t,["fee","gasLimit","storageLimit"]);return g(this,void 0,void 0,function*(){let a=n,c=i,d=s;if(n===void 0||i===void 0||s===void 0){const p=yield r(Object.assign({fee:n,gasLimit:i,storageLimit:s},o));a===void 0&&(a=p.suggestedFeeMutez),c===void 0&&(c=p.gasLimit),d===void 0&&(d=p.storageLimit)}return{fee:a,gasLimit:c,storageLimit:d}})}signAndInject(t){return g(this,void 0,void 0,function*(){const r=yield this.signer.sign(t.opbytes,new Uint8Array([3]));t.opbytes=r.sbytes,t.opOb.signature=r.prefixSig;const n=[],i=yield this.rpc.preapplyOperations([t.opOb]);if(!Array.isArray(i))throw new hy(i);for(let o=0;o<i.length;o++)for(let a=0;a<i[o].contents.length;a++)n.push(i[o].contents[a]);const s=xr(i);if(s.length)throw new _l(s,"Error occurred during validation simulation of operation");return{hash:yield this.context.injector.inject(t.opbytes),forgedBytes:t,opResponse:n,context:this.context.clone()}})}}const Al=[b.ACTIVATION,b.ORIGINATION,b.TRANSACTION,b.DELEGATION];class Rl extends Oi{constructor(t,r){super(t),this.estimator=r,this.operations=[]}withTransfer(t){if(Q(t.to)!==x.VALID)throw new tt(t.to);return this.operations.push(Object.assign({kind:b.TRANSACTION},t)),this}withTransferTicket(t){if(xe(t.destination)!==x.VALID)throw new Ce(t.destination);return this.operations.push(Object.assign({kind:b.TRANSFER_TICKET},t)),this}withContractCall(t,r={}){return this.withTransfer(t.toTransferParams(r))}withDelegation(t){if(t.source&&Q(t.source)!==x.VALID)throw new tt(t.source);if(t.delegate&&Q(t.delegate)!==x.VALID)throw new tt(t.delegate);return this.operations.push(Object.assign({kind:b.DELEGATION},t)),this}withActivation({pkh:t,secret:r}){if(Ns(t)!==x.VALID)throw new Ls(t);return this.operations.push({kind:b.ACTIVATION,pkh:t,secret:r}),this}withOrigination(t){return this.operations.push(Object.assign({kind:b.ORIGINATION},t)),this}withRegisterGlobalConstant(t){return this.operations.push(Object.assign({kind:b.REGISTER_GLOBAL_CONSTANT},t)),this}withIncreasePaidStorage(t){return this.operations.push(Object.assign({kind:b.INCREASE_PAID_STORAGE},t)),this}withTxRollupOrigination(t){return this.operations.push(Object.assign({kind:b.TX_ROLLUP_ORIGINATION},t)),this}withTxRollupSubmitBatch(t){return this.operations.push(Object.assign({kind:b.TX_ROLLUP_SUBMIT_BATCH},t)),this}getRPCOp(t){return g(this,void 0,void 0,function*(){switch(t.kind){case b.TRANSACTION:return Xn(Object.assign({},t));case b.ORIGINATION:return Jn(yield this.context.parser.prepareCodeOrigination(Object.assign({},t)));case b.DELEGATION:return Zn(Object.assign({},t));case b.ACTIVATION:return Object.assign({},t);case b.REGISTER_GLOBAL_CONSTANT:return Qn(Object.assign({},t));case b.INCREASE_PAID_STORAGE:return ni(Object.assign({},t));case b.TX_ROLLUP_ORIGINATION:return ti(Object.assign({},t));case b.TX_ROLLUP_SUBMIT_BATCH:return ei(Object.assign({},t));case b.TRANSFER_TICKET:return ri(Object.assign({},t));default:throw new We(t.kind)}})}with(t){for(const r of t)switch(r.kind){case b.TRANSACTION:this.withTransfer(r);break;case b.ORIGINATION:this.withOrigination(r);break;case b.DELEGATION:this.withDelegation(r);break;case b.ACTIVATION:this.withActivation(r);break;case b.REGISTER_GLOBAL_CONSTANT:this.withRegisterGlobalConstant(r);break;case b.INCREASE_PAID_STORAGE:this.withIncreasePaidStorage(r);break;case b.TX_ROLLUP_ORIGINATION:this.withTxRollupOrigination(r);break;case b.TX_ROLLUP_SUBMIT_BATCH:this.withTxRollupSubmitBatch(r);break;case b.TRANSFER_TICKET:this.withTransferTicket(r);break;default:throw new We(r.kind)}return this}send(t){return g(this,void 0,void 0,function*(){const r=yield this.signer.publicKeyHash(),n=yield this.signer.publicKey(),i=yield this.estimator.batch(this.operations),s=yield this.isRevealOpNeeded(this.operations,r);let o=s?1:0;const a=[];for(const K of this.operations){if(vl(K)){const P=yield this.estimate(K,()=>g(this,void 0,void 0,function*(){return i[o]}));a.push(yield this.getRPCOp(Object.assign(Object.assign({},K),P)))}else a.push(Object.assign({},K));o++}if(s){const K={kind:b.REVEAL},P=yield this.estimate(K,()=>g(this,void 0,void 0,function*(){return i[0]}));a.unshift(yield Gr(Object.assign({},P),r,n))}const c=t&&t.source||r,d=yield this.prepareOperation({operation:a,source:c}),p=yield this.forge(d),{hash:l,context:y,forgedBytes:_,opResponse:N}=yield this.signAndInject(p);return new gy(l,a,c,_,N,y)})}}class my{constructor(t,r){this.context=t,this.estimator=r}batch(t){const r=new Rl(this.context,this.estimator);return Array.isArray(t)&&r.with(t),r}}const yy=(e,{ALLOCATION_BURN:t,ORIGINATION_BURN:r}={ALLOCATION_BURN:257,ORIGINATION_BURN:257})=>{R.config({DECIMAL_PLACES:0,ROUNDING_MODE:R.ROUND_UP});const n=de({contents:e});let i=new R(0),s=new R(0),o=new R(0),a=new R(0),c=new R(0),d=new R(0);return n.forEach(p=>{o=o.plus(p.fee||0),a=a.plus(Array.isArray(p.originated_contracts)?p.originated_contracts.length*r:0),c=c.plus("allocated_destination_contract"in p?t:0),i=i.plus(p.consumed_milligas||0),d=d.plus("paid_storage_size_diff"in p&&Number(p.paid_storage_size_diff)||0)}),s=s.plus(c).plus(a).plus(d),{totalFee:o,totalMilliGas:i,totalGas:i.dividedBy(1e3),totalStorage:s,totalAllocationBurn:c,totalOriginationBurn:a,totalPaidStorageDiff:d,totalStorageBurn:new R(s.multipliedBy(Jm))}},Ey=60;class fn{constructor(t,r,n){if(this.opHash=t,this.context=r,this._newHead$=n,this._operationResult=new Vr(1),this._includedInBlock=new Vr(1),this._included=!1,this.newHead$=this._newHead$.pipe(he(i=>{var s,o;const a=(o=(s=this.lastHead)===null||s===void 0?void 0:s.header.level)!==null&&o!==void 0?o:i.header.level-1;return zs(a+1,i.header.level-a-1).pipe(Jr(c=>this.context.readProvider.getBlock(c)),Vc(i))}),jn(i=>this.lastHead=i),Es(1),jr()),this.confirmed$=this.newHead$.pipe(lr(i=>{for(const s of i.operations)for(const o of s)if(o.hash===this.opHash)return this._included=!0,this._includedInBlock.next(i),this._operationResult.next(o.contents),i}),kn(i=>typeof i<"u"),Se(),Es(1),jr()),Ya(this.opHash)!==x.VALID)throw new Wa(this.opHash);this.confirmed$.pipe(Se(),Ys(()=>Cr(void 0))).subscribe()}operationResults(){return g(this,void 0,void 0,function*(){return this._operationResult.pipe(Se()).toPromise()})}receipt(){return g(this,void 0,void 0,function*(){return yy(yield this.operationResults())})}getCurrentConfirmation(){return g(this,void 0,void 0,function*(){return this._included?oa([this._includedInBlock,pr(this.context.readProvider.getBlock("head"))]).pipe(lr(([t,r])=>r.header.level-t.header.level+1),Se()).toPromise():0})}isInCurrentBranch(t="head"){return g(this,void 0,void 0,function*(){if(!this._included)return!0;const r=yield this.context.readProvider.getBlockLevel(t),n=yield this._includedInBlock.pipe(Se()).toPromise(),i=r-n.header.level;if(i<=0)return!0;const s=Math.min(n.header.level+i,n.header.level+Ey);return new Set(yield this.context.readProvider.getLiveBlocks(s)).has(n.hash)})}confirmationObservable(t){if(typeof t<"u"&&t<1)throw new wl("Confirmation count must be at least 1");const{defaultConfirmationCount:r}=this.context.config,n=t!==void 0?t:r;if(n===void 0)throw new dy("Default confirmation count can not be undefined!");return oa([this._includedInBlock,this.newHead$]).pipe(Hc(([,i],[,s])=>i.hash===s.hash),lr(([i,s])=>({block:s,expectedConfirmation:n,currentConfirmation:s.header.level-i.header.level+1,completed:s.header.level-i.header.level>=n-1,isInCurrentBranch:()=>this.isInCurrentBranch(s.hash)})),wf(({completed:i})=>!i,!0))}confirmation(t){return this.confirmationObservable(t).toPromise()}}class by extends fn{constructor(t,r,n){super(t,r,n),this.opHash=t,this.context=r,this.getOriginatedContractAddresses=()=>g(this,void 0,void 0,function*(){const s=(yield this.operationResults()).filter(a=>a.kind==="origination");let o=[];for(const a of s)a.metadata.operation_result.originated_contracts&&(o=[...o,...a.metadata.operation_result.originated_contracts]);return o})}revealOperation(){return g(this,void 0,void 0,function*(){return(yield this.operationResults()).find(r=>r.kind===b.REVEAL)})}status(){return g(this,void 0,void 0,function*(){return this._included?(yield this.operationResults()).filter(r=>Al.indexOf(r.kind)!==-1).map(r=>Dr(r)?r.metadata.operation_result.status:"unknown")[0]||"unknown":"pending"})}}class vy extends fn{constructor(t,r,n){super(t,r,n),this.opHash=t,this.context=r}revealOperation(){return g(this,void 0,void 0,function*(){return(yield this.operationResults()).find(r=>r.kind===b.REVEAL)})}delegationOperation(){return g(this,void 0,void 0,function*(){return(yield this.operationResults()).find(r=>r.kind===b.DELEGATION)})}status(){return g(this,void 0,void 0,function*(){if(!this._included)return"pending";const t=yield this.delegationOperation();return t?t.metadata.operation_result.status:"unknown"})}}class _y extends fn{constructor(t,r,n){super(t,r,n),this.opHash=t,this.context=r}originationOperation(){return g(this,void 0,void 0,function*(){const t=yield this.operationResults();return Ba(t,b.ORIGINATION)})}revealOperation(){return g(this,void 0,void 0,function*(){const t=yield this.operationResults();return Ba(t,b.REVEAL)})}status(){return g(this,void 0,void 0,function*(){if(!this._included)return"pending";const t=yield this.originationOperation();return t?t.metadata.operation_result.status:"unknown"})}contract(){return g(this,void 0,void 0,function*(){const t=yield this.originationOperation(),r=((t==null?void 0:t.metadata.operation_result.originated_contracts)||[])[0];return this.context.wallet.at(r)})}}class wy extends fn{constructor(t,r,n){super(t,r,n),this.opHash=t,this.context=r}revealOperation(){return g(this,void 0,void 0,function*(){return(yield this.operationResults()).find(r=>r.kind===b.REVEAL)})}transactionOperation(){return g(this,void 0,void 0,function*(){return(yield this.operationResults()).find(r=>r.kind===b.TRANSACTION)})}status(){return g(this,void 0,void 0,function*(){if(!this._included)return"pending";const t=yield this.transactionOperation();return t?t.metadata.operation_result.status:"unknown"})}}function Ay(e){return function(r){return new fi(null).pipe(Gc(e,Fs(new Error("Confirmation polling timed out"))),mi(()=>r))}}const Ry=(e,t,r)=>e.pipe(Ay(t.config.confirmationPollingTimeoutSecond*1e3),Es(1),jr());class Oy{constructor(t){this.context=t,this.sharedHeadObs=jc(()=>gl(this.context.stream.subscribeBlock("head")))}createNewHeadObservable(){return g(this,void 0,void 0,function*(){return Ry(this.sharedHeadObs,this.context)})}createPastBlockWalker(t,r=1){return pr(this.context.readProvider.getBlock(t)).pipe(he(n=>r===1?Cr(n):zs(n.header.level,r-1).pipe(mf(n),Jr(i=>g(this,void 0,void 0,function*(){return this.context.readProvider.getBlock(typeof i=="number"?i:i.header.level)})))))}createHeadObservableFromConfig({blockIdentifier:t}){return g(this,void 0,void 0,function*(){const r=[];return t&&r.push(this.createPastBlockWalker(t)),r.push(yield this.createNewHeadObservable()),Bn(...r)})}createOperation(t,r={}){return g(this,void 0,void 0,function*(){return new fn(t,this.context.clone(),yield this.createHeadObservableFromConfig(r))})}createBatchOperation(t,r={}){return g(this,void 0,void 0,function*(){return new by(t,this.context.clone(),yield this.createHeadObservableFromConfig(r))})}createTransactionOperation(t,r={}){return g(this,void 0,void 0,function*(){return new wy(t,this.context.clone(),yield this.createHeadObservableFromConfig(r))})}createDelegationOperation(t,r={}){return g(this,void 0,void 0,function*(){return new vy(t,this.context.clone(),yield this.createHeadObservableFromConfig(r))})}createOriginationOperation(t,r={}){return g(this,void 0,void 0,function*(){return new _y(t,this.context.clone(),yield this.createHeadObservableFromConfig(r))})}}class Py extends Oi{constructor(t){super(t)}getBalance(t){return g(this,void 0,void 0,function*(){if(Q(t)!==x.VALID)throw new tt(t);return this.context.readProvider.getBalance(t,"head")})}getDelegate(t){return g(this,void 0,void 0,function*(){if(Q(t)!==x.VALID)throw new tt(t);return this.context.readProvider.getDelegate(t,"head")})}activate(t,r){return g(this,void 0,void 0,function*(){if(Ns(t)!==x.VALID)throw new Ls(t);const n={kind:b.ACTIVATION,pkh:t,secret:r},i=yield this.prepareOperation({operation:[n],source:t}),s=yield this.forge(i),o=`${s.opbytes}00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000`;return new Rt(yield this.rpc.injectOperation(o),Object.assign(Object.assign({},s),{opbytes:o}),[],this.context.clone())})}}const vn=100,Iy=1,Sy=.1,ka=100;class wt{constructor(t,r,n,i,s=vn){this._milligasLimit=t,this._storageLimit=r,this.opSize=n,this.minimalFeePerStorageByteMutez=i,this.baseFeeMutez=s}get burnFeeMutez(){return this.roundUp(Number(this.storageLimit)*Number(this.minimalFeePerStorageByteMutez))}get storageLimit(){const t=Math.max(Number(this._storageLimit),0);return t>0?t:0}get gasLimit(){return this.roundUp(Number(this._milligasLimit)/1e3+ka)}get operationFeeMutez(){return(Number(this._milligasLimit)/1e3+ka)*Sy+Number(this.opSize)*Iy}roundUp(t){return Math.ceil(Number(t))}get minimalFeeMutez(){return this.roundUp(vn+this.operationFeeMutez)}get suggestedFeeMutez(){return this.roundUp(this.operationFeeMutez+vn*2)}get usingBaseFeeMutez(){return Math.max(Number(this.baseFeeMutez),vn)+this.roundUp(this.operationFeeMutez)}get totalCost(){return this.minimalFeeMutez+this.burnFeeMutez}get consumedMilligas(){return Number(this._milligasLimit)}static createEstimateInstanceFromProperties(t){let r=0,n=0,i=0,s=0,o;return t.forEach(a=>{r+=a.milligasLimit,n+=a.storageLimit,i+=a.opSize,s=Math.max(a.minimalFeePerStorageByteMutez,s),a.baseFeeMutez&&(o=o?o+a.baseFeeMutez:a.baseFeeMutez)}),new wt(r,n,i,s,o)}static createArrayEstimateInstancesFromProperties(t){return t.map(r=>new wt(r.milligasLimit,r.storageLimit,r.opSize,r.minimalFeePerStorageByteMutez,r.baseFeeMutez))}}class ja extends Error{constructor(){super("Unable to estimate the reveal operation, the public key is unknown"),this.name="Reveal Estimate Error"}}const dt=(e,t)=>({fee:typeof e.fee>"u"?t.fee:e.fee,gasLimit:typeof e.gasLimit>"u"?t.gasLimit:e.gasLimit,storageLimit:typeof e.storageLimit>"u"?t.storageLimit:e.storageLimit}),Ty="edsigtkpiSSschcaCt9pUVrpNPf7TTcgvgDEDD6NCEHMy8NNQJCGnMfLZzYoQj74yLjo9wx6MPVV29CvVzgi7qEcEUok3k7AuMg";class Ny extends Oi{constructor(){super(...arguments),this.ALLOCATION_STORAGE=257,this.ORIGINATION_STORAGE=257,this.OP_SIZE_REVEAL=128}getKeys(){return g(this,void 0,void 0,function*(){const t=this.context.isAnySignerConfigured();return{publicKeyHash:t?yield this.signer.publicKeyHash():yield this.context.walletProvider.getPKH(),publicKey:t?yield this.signer.publicKey():void 0}})}getAccountLimits(t,r,n){return g(this,void 0,void 0,function*(){const i=yield this.context.readProvider.getBalance(t,"head"),{hard_gas_limit_per_operation:s,hard_gas_limit_per_block:o,hard_storage_limit_per_operation:a,cost_per_byte:c}=r;return{fee:0,gasLimit:n?Math.floor(this.ajustGasForBatchOperation(o,s,n).toNumber()):s.toNumber(),storageLimit:Math.floor(R.min(i.dividedBy(c),a).toNumber())}})}ajustGasForBatchOperation(t,r,n){return R.min(r,t.div(n+1))}getEstimationPropertiesFromOperationContent(t,r,n,i){const s=de({contents:[t]});let o=0,a=0;return s.forEach(c=>{a+="originated_contracts"in c&&typeof c.originated_contracts<"u"?c.originated_contracts.length*this.ORIGINATION_STORAGE:0,a+="allocated_destination_contract"in c?this.ALLOCATION_STORAGE:0,o+=Number(c.consumed_milligas)||0,a+="paid_storage_size_diff"in c&&Number(c.paid_storage_size_diff)||0,a+="storage_size"in c&&"global_address"in c&&Number(c.storage_size)||0,a+="originated_rollup"in c?i:0}),vl(t)?{milligasLimit:o||0,storageLimit:Number(a||0),opSize:r,minimalFeePerStorageByteMutez:n.toNumber()}:{milligasLimit:0,storageLimit:0,opSize:r,minimalFeePerStorageByteMutez:n.toNumber(),baseFeeMutez:0}}prepareEstimate(t,r,n){return g(this,void 0,void 0,function*(){const i=yield this.prepareOperation(t,n),{opbytes:s,opOb:{branch:o,contents:a}}=yield this.forge(i),c={operation:{branch:o,contents:a,signature:Ty},chain_id:yield this.context.readProvider.getChainId()},{opResponse:d}=yield this.simulate(c),{cost_per_byte:p,tx_rollup_origination_size:l}=r,y=[...xr(d,"backtracked"),...xr(d)];if(y.length)throw new _l(y,"Error occurred during estimation");let _=1;return Array.isArray(t.operation)&&t.operation.length>1&&(_=d.contents[0].kind==="reveal"?t.operation.length-1:t.operation.length),d.contents.map(N=>this.getEstimationPropertiesFromOperationContent(N,N.kind==="reveal"?this.OP_SIZE_REVEAL/2:s.length/2/_,p,l??0))})}originate(t){var{fee:r,storageLimit:n,gasLimit:i}=t,s=qt(t,["fee","storageLimit","gasLimit"]);return g(this,void 0,void 0,function*(){const{publicKeyHash:o}=yield this.getKeys(),a=yield this.context.readProvider.getProtocolConstants("head"),c=yield this.getAccountLimits(o,a),d=yield Jn(yield this.context.parser.prepareCodeOrigination(Object.assign(Object.assign({},s),dt({fee:r,storageLimit:n,gasLimit:i},c)))),p=yield this.isRevealOpNeeded([d],o),l=p?yield this.addRevealOp([d],o):d,y=yield this.prepareEstimate({operation:l,source:o},a,o);return p&&y.shift(),wt.createEstimateInstanceFromProperties(y)})}transfer(t){var{fee:r,storageLimit:n,gasLimit:i}=t,s=qt(t,["fee","storageLimit","gasLimit"]);return g(this,void 0,void 0,function*(){if(Q(s.to)!==x.VALID)throw new tt(s.to);if(s.source&&Q(s.source)!==x.VALID)throw new tt(s.source);const o=(yield this.getKeys()).publicKeyHash,a=yield this.context.readProvider.getProtocolConstants("head"),c=yield this.getAccountLimits(o,a),d=yield Xn(Object.assign(Object.assign({},s),dt({fee:r,storageLimit:n,gasLimit:i},c))),p=yield this.isRevealOpNeeded([d],o),l=p?yield this.addRevealOp([d],o):d,y=yield this.prepareEstimate({operation:l,source:o},a,o);return p&&y.shift(),wt.createEstimateInstanceFromProperties(y)})}transferTicket(t){var r,{fee:n,storageLimit:i,gasLimit:s}=t,o=qt(t,["fee","storageLimit","gasLimit"]);return g(this,void 0,void 0,function*(){if(xe(o.destination)!==x.VALID)throw new Ce(o.destination);if(o.source&&Q(o.source)!==x.VALID)throw new tt((r=o.source)!==null&&r!==void 0?r:"");const a=(yield this.getKeys()).publicKeyHash,c=yield this.context.readProvider.getProtocolConstants("head"),d=yield this.getAccountLimits(a,c),p=yield ri(Object.assign(Object.assign({},o),dt({fee:n,storageLimit:i,gasLimit:s},d))),l=yield this.isRevealOpNeeded([p],a),y=l?yield this.addRevealOp([p],a):p,_=yield this.prepareEstimate({operation:y,source:a},c,a);return l&&_.shift(),wt.createEstimateInstanceFromProperties(_)})}setDelegate(t){var{fee:r,gasLimit:n,storageLimit:i}=t,s=qt(t,["fee","gasLimit","storageLimit"]);return g(this,void 0,void 0,function*(){if(s.source&&Q(s.source)!==x.VALID)throw new tt(s.source);if(s.delegate&&Q(s.delegate)!==x.VALID)throw new tt(s.delegate);const o=(yield this.getKeys()).publicKeyHash,a=s.source||o,c=yield this.context.readProvider.getProtocolConstants("head"),d=yield this.getAccountLimits(a,c),p=yield Zn(Object.assign(Object.assign({},s),dt({fee:r,storageLimit:i,gasLimit:n},d))),l=yield this.isRevealOpNeeded([p],o),y=l?yield this.addRevealOp([p],o):p,_=yield this.prepareEstimate({operation:y,source:o},c,o);return l&&_.shift(),wt.createEstimateInstanceFromProperties(_)})}batch(t){return g(this,void 0,void 0,function*(){const{publicKeyHash:r}=yield this.getKeys();let n=[];const i=yield this.context.readProvider.getProtocolConstants("head"),s=yield this.getAccountLimits(r,i,t.length);for(const c of t)switch(c.kind){case b.TRANSACTION:n.push(yield Xn(Object.assign(Object.assign({},c),dt(c,s))));break;case b.ORIGINATION:n.push(yield Jn(yield this.context.parser.prepareCodeOrigination(Object.assign(Object.assign({},c),dt(c,s)))));break;case b.DELEGATION:n.push(yield Zn(Object.assign(Object.assign({},c),dt(c,s))));break;case b.ACTIVATION:n.push(Object.assign(Object.assign({},c),s));break;case b.REGISTER_GLOBAL_CONSTANT:n.push(yield Qn(Object.assign(Object.assign({},c),dt(c,s))));break;case b.TX_ROLLUP_ORIGINATION:n.push(yield ti(Object.assign(Object.assign({},c),dt(c,s))));break;case b.TX_ROLLUP_SUBMIT_BATCH:n.push(yield ei(Object.assign(Object.assign({},c),dt(c,s))));break;case b.TRANSFER_TICKET:n.push(yield ri(Object.assign(Object.assign({},c),dt(c,s))));break;case b.INCREASE_PAID_STORAGE:n.push(yield ni(Object.assign(Object.assign({},c),dt(c,s))));break;default:throw new We(t.kind)}n=(yield this.isRevealOpNeeded(n,r))?yield this.addRevealOp(n,r):n;const a=yield this.prepareEstimate({operation:n,source:r},i,r);return wt.createArrayEstimateInstancesFromProperties(a)})}registerDelegate(t){return g(this,void 0,void 0,function*(){const r=(yield this.getKeys()).publicKeyHash,n=yield this.context.readProvider.getProtocolConstants("head"),i=yield this.getAccountLimits(r,n),s=yield El(Object.assign(Object.assign({},t),i),r),o=yield this.isRevealOpNeeded([s],r),a=o?yield this.addRevealOp([s],r):s,c=yield this.prepareEstimate({operation:a,source:r},n,r);return o&&c.shift(),wt.createEstimateInstanceFromProperties(c)})}reveal(t){return g(this,void 0,void 0,function*(){const{publicKeyHash:r,publicKey:n}=yield this.getKeys();if(!n)throw new ja;if(yield this.isAccountRevealRequired(r)){const i=yield this.context.readProvider.getProtocolConstants("head"),s=yield this.getAccountLimits(r,i),o=yield Gr(Object.assign(Object.assign({},t),s),r,n),a=yield this.prepareEstimate({operation:o,source:r},i,r);return wt.createEstimateInstanceFromProperties(a)}})}registerGlobalConstant(t){var{fee:r,storageLimit:n,gasLimit:i}=t,s=qt(t,["fee","storageLimit","gasLimit"]);return g(this,void 0,void 0,function*(){const o=(yield this.getKeys()).publicKeyHash,a=yield this.context.readProvider.getProtocolConstants("head"),c=yield this.getAccountLimits(o,a),d=yield Qn(Object.assign(Object.assign({},s),dt({fee:r,storageLimit:n,gasLimit:i},c))),p=yield this.isRevealOpNeeded([d],o),l=p?yield this.addRevealOp([d],o):d,y=yield this.prepareEstimate({operation:l,source:o},a,o);return p&&y.shift(),wt.createEstimateInstanceFromProperties(y)})}increasePaidStorage(t){return g(this,void 0,void 0,function*(){const{fee:r,storageLimit:n,gasLimit:i}=t,s=qt(t,["fee","storageLimit","gasLimit"]),o=(yield this.getKeys()).publicKeyHash,a=yield this.context.readProvider.getProtocolConstants("head"),c=yield this.getAccountLimits(o,a),d=yield ni(Object.assign(Object.assign({},s),dt({fee:r,storageLimit:n,gasLimit:i},c))),p=yield this.isRevealOpNeeded([d],o),l=p?yield this.addRevealOp([d],o):d,y=yield this.prepareEstimate({operation:l,source:o},a,o);return p&&y.shift(),wt.createEstimateInstanceFromProperties(y)})}txRollupOriginate(t){return g(this,void 0,void 0,function*(){t=t||{};const{fee:r,storageLimit:n,gasLimit:i}=t,s=qt(t,["fee","storageLimit","gasLimit"]),o=(yield this.getKeys()).publicKeyHash,a=yield this.context.readProvider.getProtocolConstants("head"),c=yield this.getAccountLimits(o,a),d=yield ti(Object.assign(Object.assign({},s),dt({fee:r,storageLimit:n,gasLimit:i},c))),p=yield this.isRevealOpNeeded([d],o),l=p?yield this.addRevealOp([d],o):d,y=yield this.prepareEstimate({operation:l,source:o},a,o);return p&&y.shift(),wt.createEstimateInstanceFromProperties(y)})}txRollupSubmitBatch(t){return g(this,void 0,void 0,function*(){const{fee:r,storageLimit:n,gasLimit:i}=t,s=qt(t,["fee","storageLimit","gasLimit"]),o=(yield this.getKeys()).publicKeyHash,a=yield this.context.readProvider.getProtocolConstants("head"),c=yield this.getAccountLimits(o,a),d=yield ei(Object.assign(Object.assign({},s),dt({fee:r,storageLimit:n,gasLimit:i},c))),p=yield this.isRevealOpNeeded([d],o),l=p?yield this.addRevealOp([d],o):d,y=yield this.prepareEstimate({operation:l,source:o},a,o);return p&&y.shift(),wt.createEstimateInstanceFromProperties(y)})}updateConsensusKey(t){return g(this,void 0,void 0,function*(){const{fee:r,storageLimit:n,gasLimit:i}=t,s=qt(t,["fee","storageLimit","gasLimit"]),o=(yield this.getKeys()).publicKeyHash,a=yield this.context.readProvider.getProtocolConstants("head"),c=yield this.getAccountLimits(o,a),d=yield bl(Object.assign(Object.assign({},s),dt({fee:r,storageLimit:n,gasLimit:i},c))),p=yield this.isRevealOpNeeded([d],o),l=p?yield this.addRevealOp([d],o):d,y=yield this.prepareEstimate({operation:l,source:o},a,o);return p&&y.shift(),wt.createEstimateInstanceFromProperties(y)})}addRevealOp(t,r){return g(this,void 0,void 0,function*(){const{publicKey:n}=yield this.getKeys();if(!n)throw new ja;return t.unshift(yield Gr(Object.assign({fee:er.REVEAL,gasLimit:tr.REVEAL,storageLimit:rr.REVEAL}),r,yield this.signer.publicKey())),t})}}class Ha extends Rt{constructor(t,r,n,i,s,o){super(t,i,s,o),this.params=r,this.source=n}get operationResults(){const t=Array.isArray(this.results)&&this.results.find(n=>n.kind==="delegation"),r=t&&t.metadata&&t.metadata.operation_result;return r||void 0}get status(){var t,r;return(r=(t=this.operationResults)===null||t===void 0?void 0:t.status)!==null&&r!==void 0?r:"unknown"}get delegate(){return this.params.delegate}get isRegisterOperation(){return this.delegate===this.source}get fee(){return this.params.fee}get gasLimit(){return this.params.gas_limit}get storageLimit(){return this.params.storage_limit}get consumedGas(){return R.config({DECIMAL_PLACES:0,ROUNDING_MODE:R.ROUND_UP}),this.consumedMilliGas?new R(this.consumedMilliGas).dividedBy(1e3).toString():void 0}get consumedMilliGas(){var t;return(t=this.operationResults)===null||t===void 0?void 0:t.consumed_milligas}get errors(){var t;return(t=this.operationResults)===null||t===void 0?void 0:t.errors}}class Ly extends Rt{constructor(t,r,n,i,s,o){super(t,n,i,s),this.params=r,this.contractProvider=o;const a=this.operationResults&&this.operationResults.originated_contracts;Array.isArray(a)&&(this.contractAddress=a[0])}get status(){var t,r;return(r=(t=this.operationResults)===null||t===void 0?void 0:t.status)!==null&&r!==void 0?r:"unknown"}get operationResults(){const t=Array.isArray(this.results)&&this.results.find(n=>n.kind==="origination"),r=t&&Dr(t)&&t.metadata.operation_result;return r||void 0}get fee(){return this.params.fee}get gasLimit(){return this.params.gas_limit}get storageLimit(){return this.params.storage_limit}get consumedGas(){return R.config({DECIMAL_PLACES:0,ROUNDING_MODE:R.ROUND_UP}),this.consumedMilliGas?new R(this.consumedMilliGas).dividedBy(1e3).toString():void 0}get consumedMilliGas(){var t;return(t=this.operationResults)===null||t===void 0?void 0:t.consumed_milligas}get storageDiff(){const t=this.operationResults&&this.operationResults.paid_storage_size_diff;return t||void 0}get storageSize(){const t=this.operationResults&&this.operationResults.storage_size;return t||void 0}get errors(){var t;return(t=this.operationResults)===null||t===void 0?void 0:t.errors}contract(t,r){return g(this,void 0,void 0,function*(){if(!this.contractAddress)throw new py("No contract was originated in this operation");return yield this.confirmation(t,r),this.contractProvider.at(this.contractAddress)})}}class xy extends Rt{constructor(t,r,n,i,s,o){super(t,i,s,o),this.params=r,this.source=n,this.globalConstantHash=this.operationResults&&this.operationResults.global_address}get operationResults(){const t=Array.isArray(this.results)&&this.results.find(n=>n.kind==="register_global_constant"),r=t&&t.metadata&&t.metadata.operation_result;return r||void 0}get status(){var t,r;return(r=(t=this.operationResults)===null||t===void 0?void 0:t.status)!==null&&r!==void 0?r:"unknown"}get registeredExpression(){return this.params.value}get fee(){return this.params.fee}get gasLimit(){return this.params.gas_limit}get storageLimit(){return this.params.storage_limit}get errors(){var t;return(t=this.operationResults)===null||t===void 0?void 0:t.errors}get consumedGas(){return R.config({DECIMAL_PLACES:0,ROUNDING_MODE:R.ROUND_UP}),this.consumedMilliGas?new R(this.consumedMilliGas).dividedBy(1e3).toString():void 0}get consumedMilliGas(){var t;return(t=this.operationResults)===null||t===void 0?void 0:t.consumed_milligas}}class Cy extends Rt{constructor(t,r,n,i,s,o){super(t,i,s,o),this.params=r,this.source=n}get operationResults(){const t=Array.isArray(this.results)&&this.results.find(r=>r.kind==="reveal");return t?[t]:[]}get status(){const r=this.operationResults[0];return r?r.metadata.operation_result.status:"unknown"}get fee(){return this.params.fee}get gasLimit(){return this.params.gas_limit}get storageLimit(){return this.params.storage_limit}get publicKey(){return this.params.public_key}sumProp(t,r){return t.reduce((n,i)=>r in i?Number(i[r])+n:n,0)}get consumedGas(){return R.config({DECIMAL_PLACES:0,ROUNDING_MODE:R.ROUND_UP}),new R(this.consumedMilliGas).dividedBy(1e3).toString()}get consumedMilliGas(){return String(this.sumProp(de({contents:this.operationResults}),"consumed_milligas"))}get storageDiff(){return String(this.sumProp(de({contents:this.operationResults}),"paid_storage_size_diff"))}get storageSize(){return String(this.sumProp(de({contents:this.operationResults}),"storage_size"))}get errors(){return xr({contents:this.operationResults})}}class My extends Rt{constructor(t,r,n,i,s,o){super(t,i,s,o),this.params=r,this.source=n}get operationResults(){const t=Array.isArray(this.results)&&this.results.find(r=>r.kind==="transaction");return t?[t]:[]}get status(){const r=this.operationResults[0];return r?r.metadata.operation_result.status:"unknown"}get amount(){return new R(this.params.amount)}get destination(){return this.params.destination}get fee(){return this.params.fee}get gasLimit(){return this.params.gas_limit}get storageLimit(){return this.params.storage_limit}sumProp(t,r){return t.reduce((n,i)=>r in i?Number(i[r])+n:n,0)}get consumedGas(){return R.config({DECIMAL_PLACES:0,ROUNDING_MODE:R.ROUND_UP}),new R(this.consumedMilliGas).dividedBy(1e3).toString()}get consumedMilliGas(){return String(this.sumProp(de({contents:this.operationResults}),"consumed_milligas"))}get storageDiff(){return String(this.sumProp(de({contents:this.operationResults}),"paid_storage_size_diff"))}get storageSize(){return String(this.sumProp(de({contents:this.operationResults}),"storage_size"))}get errors(){return xr({contents:this.operationResults})}}class Dy{constructor(t,r,n,i,s,o=!0,a=!1){this.provider=t,this.address=r,this.parameterSchema=n,this.name=i,this.args=s,this.isMultipleEntrypoint=o,this.isAnonymous=a}validateArgs(t,r,n){const i=r.ExtractSignatures();if(!i.find(s=>s.length===t.length))throw new ml(n,i,t)}get schema(){return this.isAnonymous?this.parameterSchema.ExtractSchema()[this.name]:this.parameterSchema.ExtractSchema()}getSignature(){if(this.isAnonymous){const t=this.parameterSchema.ExtractSignatures().find(r=>r[0]===this.name);if(t)return t.shift(),t}else{const t=this.parameterSchema.ExtractSignatures();return t.length==1?t[0]:t}}send(t={}){return this.provider instanceof Pi?this.provider.transfer(this.toTransferParams(t)).send():this.provider.transfer(this.toTransferParams(t))}toTransferParams({fee:t,gasLimit:r,storageLimit:n,source:i,amount:s=0,mutez:o=!1}={}){return{to:this.address,amount:s,fee:t,mutez:o,source:i,gasLimit:r,storageLimit:n,parameter:{entrypoint:this.isMultipleEntrypoint?this.name:wr,value:this.isAnonymous?this.parameterSchema.Encode(this.name,...this.args):this.parameterSchema.Encode(...this.args)}}}}class $y{constructor(t,r){this.id=t,this.provider=r}getSaplingDiff(t){return g(this,void 0,void 0,function*(){return this.provider.getSaplingDiffByID(this.id.toString(),t)})}getId(){return this.id.toString()}}class By{constructor(t,r){this.walletProvider=t,this.context=r,this.operations=[]}withTransfer(t){if(Q(t.to)!==x.VALID)throw new tt(t.to);return this.operations.push(Object.assign({kind:b.TRANSACTION},t)),this}withContractCall(t,r={}){return this.withTransfer(t.toTransferParams(r))}withDelegation(t){if(t.delegate&&Q(t.delegate)!==x.VALID)throw new tt(t.delegate);return this.operations.push(Object.assign({kind:b.DELEGATION},t)),this}withOrigination(t){return this.operations.push(Object.assign({kind:b.ORIGINATION},t)),this}mapOperation(t){return g(this,void 0,void 0,function*(){switch(t.kind){case b.TRANSACTION:return this.walletProvider.mapTransferParamsToWalletParams(()=>g(this,void 0,void 0,function*(){return t}));case b.ORIGINATION:return this.walletProvider.mapOriginateParamsToWalletParams(()=>g(this,void 0,void 0,function*(){return this.context.parser.prepareCodeOrigination(Object.assign({},t))}));case b.DELEGATION:return this.walletProvider.mapDelegateParamsToWalletParams(()=>g(this,void 0,void 0,function*(){return t}));default:throw new We(t.kind)}})}with(t){for(const r of t)switch(r.kind){case b.TRANSACTION:this.withTransfer(r);break;case b.ORIGINATION:this.withOrigination(r);break;case b.DELEGATION:this.withDelegation(r);break;default:throw new We(r.kind)}return this}send(){return g(this,void 0,void 0,function*(){const t=[];for(const n of this.operations)t.push(yield this.mapOperation(n));const r=yield this.walletProvider.sendOperations(t);return this.context.operationFactory.createBatchOperation(r)})}}class Pi{constructor(t){this.context=t,this.walletCommand=r=>({send:r})}get walletProvider(){return this.context.walletProvider}pkh({forceRefetch:t}={}){return g(this,void 0,void 0,function*(){return(!this._pkh||t)&&(this._pkh=yield this.walletProvider.getPKH()),this._pkh})}originate(t){return this.walletCommand(()=>g(this,void 0,void 0,function*(){const r=yield this.walletProvider.mapOriginateParamsToWalletParams(()=>this.context.parser.prepareCodeOrigination(Object.assign({},t))),n=yield this.walletProvider.sendOperations([r]);return this.context.operationFactory.createOriginationOperation(n)}))}setDelegate(t){if(t.delegate&&Q(t.delegate)!==x.VALID)throw new tt(t.delegate);return this.walletCommand(()=>g(this,void 0,void 0,function*(){const r=yield this.walletProvider.mapDelegateParamsToWalletParams(()=>g(this,void 0,void 0,function*(){return t})),n=yield this.walletProvider.sendOperations([r]);return this.context.operationFactory.createDelegationOperation(n)}))}registerDelegate(){return this.walletCommand(()=>g(this,void 0,void 0,function*(){const t=yield this.walletProvider.mapDelegateParamsToWalletParams(()=>g(this,void 0,void 0,function*(){return{delegate:yield this.pkh()}})),r=yield this.walletProvider.sendOperations([t]);return this.context.operationFactory.createDelegationOperation(r)}))}transfer(t){if(Q(t.to)!==x.VALID)throw new tt(t.to);return this.walletCommand(()=>g(this,void 0,void 0,function*(){const r=yield this.walletProvider.mapTransferParamsToWalletParams(()=>g(this,void 0,void 0,function*(){return t})),n=yield this.walletProvider.sendOperations([r]);return this.context.operationFactory.createTransactionOperation(n)}))}batch(t){const r=new By(this.walletProvider,this.context);return Array.isArray(t)&&r.with(t),r}at(t,r=n=>n){return g(this,void 0,void 0,function*(){if(xe(t)!==x.VALID)throw new Ce(t);const n=this.context.withExtensions().rpc,i=this.context.withExtensions().readProvider,s=yield i.getScript(t,"head"),o=yield i.getEntrypoints(t),a=new Pl(t,s,this,this.context.contract,o,n,i);return r(a,this.context)})}}class Ol{constructor(t){this.context=t}getPKH(){return g(this,void 0,void 0,function*(){return this.context.signer.publicKeyHash()})}mapTransferParamsToWalletParams(t){return g(this,void 0,void 0,function*(){return as(yield t(),b.TRANSACTION)})}mapOriginateParamsToWalletParams(t){return g(this,void 0,void 0,function*(){return as(yield t(),b.ORIGINATION)})}mapDelegateParamsToWalletParams(t){return g(this,void 0,void 0,function*(){return as(yield t(),b.DELEGATION)})}sendOperations(t){return g(this,void 0,void 0,function*(){return(yield this.context.batch.batch(t).send()).hash})}}class ky{constructor(t,r,n,i,s="unit",o=!0,a=!1){this.provider=t,this.address=r,this.parameterSchema=n,this.name=i,this.args=s,this.isMultipleEntrypoint=o,this.isAnonymous=a}getSignature(){return this.isAnonymous?this.parameterSchema.ExtractSchema()[this.name]:this.parameterSchema.ExtractSchema()}send(t={}){return this.provider instanceof Pi?this.provider.transfer(this.toTransferParams(t)).send():this.provider.transfer(this.toTransferParams(t))}toTransferParams({fee:t,gasLimit:r,storageLimit:n,source:i,amount:s=0,mutez:o=!1}={}){return{to:this.address,amount:s,fee:t,mutez:o,source:i,gasLimit:r,storageLimit:n,parameter:{entrypoint:this.isMultipleEntrypoint?this.name:wr,value:this.isAnonymous?this.parameterSchema.EncodeObject({[this.name]:this.args}):this.parameterSchema.EncodeObject(this.args)}}}}class jy{constructor(t,r,n,i,s,o="Unit"){this._rpc=t,this._readProvider=r,this._contractAddress=n,this._smartContractViewSchema=i,this._contractStorageType=s,this._args=o}getSignature(){return{parameter:this._smartContractViewSchema.extractArgsSchema(),result:this._smartContractViewSchema.extractResultSchema()}}executeView(t){return g(this,void 0,void 0,function*(){this.verifyContextExecution(t);const r=yield this._readProvider.getChainId(),n=this.transformArgsToMichelson(),i={contract:this._contractAddress,view:this._smartContractViewSchema.viewName,input:n,chain_id:r,source:t.viewCaller};return t.source&&(i.payer=t.source),this.executeViewAndDecodeResult(i)})}verifyContextExecution(t){if(t.source&&Q(t.source)!==x.VALID)throw new $a(`The source account who initialized the view execution is invalid: ${t.source}.`);if(!t.viewCaller||Q(t.viewCaller)!==x.VALID)throw new $a(`The contract which is the caller of view is invalid: ${t.viewCaller}.`)}transformArgsToMichelson(){try{return this._smartContractViewSchema.encodeViewArgs(this._args)}catch(t){throw new Zm(this._smartContractViewSchema.viewName,this.getSignature(),this._args,t)}}adaptViewCodeToContext(t,r,n){const i={BALANCE:[{prim:"PUSH",args:[{prim:"mutez"},{int:n}]}],SENDER:[{prim:"PUSH",args:[{prim:"address"},{string:r}]}],SELF_ADDRESS:[{prim:"PUSH",args:[{prim:"address"},{string:this._contractAddress}]}],AMOUNT:[{prim:"PUSH",args:[{prim:"mutez"},{int:"0"}]}]};return t.forEach((s,o)=>{s.prim in i&&(t[o]=Object(i)[s.prim]),s.args&&s.args.length!==0?this.adaptViewCodeToContext(s.args,r,n):Array.isArray(s)&&this.adaptViewCodeToContext(s,r,n)}),t}executeViewAndDecodeResult(t){return g(this,void 0,void 0,function*(){let r;try{r=(yield this._rpc.runScriptView(t)).data}catch(n){const i=ty(n);throw i?new Qm(`The simulation of the on-chain view named ${this._smartContractViewSchema.viewName} failed with: ${JSON.stringify(i)}`,this._smartContractViewSchema.viewName,i,n):n}return this._smartContractViewSchema.decodeViewResult(r)})}}class Hy{constructor(t,r){this.provider=t,this.contractAddress=r}createContractMethodFlatParams(t,r,n,i=!0,s=!1){return new Dy(this.provider,this.contractAddress,t,r,n,i,s)}createContractMethodObjectParam(t,r,n,i=!0,s=!1){return new ky(this.provider,this.contractAddress,t,r,n,i,s)}createContractViewObjectParam(t,r,n,i,s){return new jy(t,r,this.contractAddress,n,i,s)}}const wr="default";class Vy{constructor(t,r,n,i,s,o,a){this.currentContract=t,this.name=r,this.callbackParametersSchema=n,this.parameterSchema=i,this.args=s,this.rpc=o,this.readProvider=a}read(t){return g(this,void 0,void 0,function*(){if(xe(t??"")==x.VALID)throw new Ja("Since version 12, the lambda view no longer depends on a lambda contract. The read method no longer accepts a contract address as a parameter.");if(t&&qa(t)!==x.VALID)throw new Gl(t);const r=this.parameterSchema.Encode(...this.args),n=yield this.rpc.runView({contract:this.currentContract.address,entrypoint:this.name,input:r,chain_id:t||(yield this.readProvider.getChainId())});return this.callbackParametersSchema.Execute(n.data)})}}const Uy=(e,t,r)=>{const n=t.ExtractSignatures();if(!n.find(i=>i.length===e.length))throw new ml(r,n,e)},Gy=e=>{let t=!1;if("prim"in e&&e.prim==="pair"&&e.args){const r=e.args[e.args.length-1];"prim"in r&&r.prim==="contract"&&(t=!0)}return t};class Pl{constructor(t,r,n,i,s,o,a){this.address=t,this.script=r,this.storageProvider=i,this.entrypoints=s,this.rpc=o,this.readProvider=a,this.methods={},this.methodsObject={},this.views={},this.contractViews={},this.contractMethodFactory=new Hy(n,t),this.schema=Mt.fromRPCResponse({script:this.script}),this.parameterSchema=vr.fromRPCResponse({script:this.script}),this.viewSchema=Ws.fromRPCResponse({script:this.script}),this.viewSchema.length!==0&&this._initializeOnChainViews(this,o,this.readProvider,this.viewSchema),this._initializeMethods(this,this.entrypoints.entrypoints,this.rpc,this.readProvider)}_initializeMethods(t,r,n,i){const s=this.parameterSchema,o=Object.keys(r);if(s.isMultipleEntryPoint)o.forEach(c=>{const d=new vr(r[c]);if(this.methods[c]=function(...p){return t.contractMethodFactory.createContractMethodFlatParams(d,c,p)},this.methodsObject[c]=function(p){return t.contractMethodFactory.createContractMethodObjectParam(d,c,p)},Gy(r[c])){const p=function(...l){const y=r[c].args[0],_=new vr(y),N=r[c].args[1].args[0],K=new vr(N);return Uy(l,_,c),new Vy(t,c,K,_,l,n,i)};this.views[c]=p}}),Object.keys(s.ExtractSchema()).filter(c=>Object.keys(r).indexOf(c)===-1).forEach(c=>{this.methods[c]=function(...d){return t.contractMethodFactory.createContractMethodFlatParams(s,c,d,!1,!0)},this.methodsObject[c]=function(d){return t.contractMethodFactory.createContractMethodObjectParam(s,c,d,!1,!0)}});else{const a=this.parameterSchema;this.methods[wr]=function(...c){return t.contractMethodFactory.createContractMethodFlatParams(a,wr,c,!1)},this.methodsObject[wr]=function(c){return t.contractMethodFactory.createContractMethodObjectParam(a,wr,c,!1)}}}_initializeOnChainViews(t,r,n,i){const s=this.schema.val;i.forEach(o=>{this.contractViews[o.viewName]=function(a){return t.contractMethodFactory.createContractViewObjectParam(r,n,o,s,a)}})}storage(){return this.storageProvider.getStorage(this.address,this.schema)}bigMap(t){return this.storageProvider.getBigMapKey(this.address,t,this.schema)}}class Ky{constructor(t,r,n){this.id=t,this.schema=r,this.provider=n}get(t,r){return g(this,void 0,void 0,function*(){try{return yield this.provider.getBigMapKeyByID(this.id.toString(),t,this.schema,r)}catch(n){if(n instanceof di&&n.status===Cn.NOT_FOUND)return;throw n}})}getMultipleValues(t,r,n=5){return g(this,void 0,void 0,function*(){return this.provider.getBigMapKeysByID(this.id.toString(),t,this.schema,r,n)})}toJSON(){return this.id.toString()}toString(){return this.id.toString()}}const Va=e=>({big_map:(t,r)=>{if(!t||!("int"in t)||t.int===void 0)return{};{const n=new Mt(r);return new Ky(new R(t.int),n,e)}},sapling_state:t=>!t||!("int"in t)||t.int===void 0?{}:new $y(new R(t.int),e)});class Fy extends Rt{constructor(t,r,n,i,s,o){super(t,i,s,o),this.params=r,this.source=n,this.originatedRollup=this.operationResults&&this.operationResults.originated_rollup}get operationResults(){const t=Array.isArray(this.results)&&this.results.find(n=>n.kind==="tx_rollup_origination"),r=t&&t.metadata&&t.metadata.operation_result;return r||void 0}get status(){var t,r;return(r=(t=this.operationResults)===null||t===void 0?void 0:t.status)!==null&&r!==void 0?r:"unknown"}get fee(){return this.params.fee}get gasLimit(){return this.params.gas_limit}get storageLimit(){return this.params.storage_limit}get errors(){var t;return(t=this.operationResults)===null||t===void 0?void 0:t.errors}get consumedGas(){return R.config({DECIMAL_PLACES:0,ROUNDING_MODE:R.ROUND_UP}),this.consumedMilliGas?new R(this.consumedMilliGas).dividedBy(1e3).toString():void 0}get consumedMilliGas(){var t;return(t=this.operationResults)===null||t===void 0?void 0:t.consumed_milligas}}class qy extends Rt{constructor(t,r,n,i,s,o){super(t,i,s,o),this.params=r,this.source=n}get operationResults(){const t=Array.isArray(this.results)&&this.results.find(n=>n.kind==="tx_rollup_submit_batch"),r=t&&t.metadata&&t.metadata.operation_result;return r||void 0}get status(){var t,r;return(r=(t=this.operationResults)===null||t===void 0?void 0:t.status)!==null&&r!==void 0?r:"unknown"}get content(){return this.params.content}get fee(){return this.params.fee}get gasLimit(){return this.params.gas_limit}get storageLimit(){return this.params.storage_limit}get errors(){var t;return(t=this.operationResults)===null||t===void 0?void 0:t.errors}get consumedGas(){return R.config({DECIMAL_PLACES:0,ROUNDING_MODE:R.ROUND_UP}),this.consumedMilliGas?new R(this.consumedMilliGas).dividedBy(1e3).toString():void 0}get consumedMilliGas(){var t;return(t=this.operationResults)===null||t===void 0?void 0:t.consumed_milligas}}class zy extends Rt{constructor(t,r,n,i,s,o){super(t,i,s,o),this.params=r,this.source=n}get operationResults(){const r=Array.isArray(this.results)&&this.results.find(n=>n.kind==="ballot");return r||void 0}get period(){var t;return(t=this.operationResults)===null||t===void 0?void 0:t.period}get proposal(){return this.params.proposal}get ballot(){return this.params.ballot}}class Yy extends Rt{constructor(t,r,n,i,s){super(t,n,i,s),this.params=r}get operationResults(){const t=Array.isArray(this.results)&&this.results.find(n=>n.kind==="drain_delegate"),r=t&&t.metadata&&t.metadata.balance_updates;return r||void 0}get consensusKey(){return this.params.consensus_key}get delegate(){return this.params.delegate}get destination(){return this.params.destination}}class Wy extends Rt{constructor(t,r,n,i,s,o){super(t,i,s,o),this.params=r,this.source=n}get operationResults(){const t=Array.isArray(this.results)&&this.results.find(n=>n.kind===b.TRANSFER_TICKET),r=t&&t.metadata&&t.metadata.operation_result;return r||void 0}get status(){var t,r;return(r=(t=this.operationResults)===null||t===void 0?void 0:t.status)!==null&&r!==void 0?r:"unknown"}get fee(){return this.params.fee}get gasLimit(){return this.params.gas_limit}get storageLimit(){return this.params.storage_limit}get consumedGas(){return R.config({DECIMAL_PLACES:0,ROUNDING_MODE:R.ROUND_UP}),this.consumedMilliGas?new R(this.consumedMilliGas).dividedBy(1e3).toString():void 0}get consumedMilliGas(){var t;return(t=this.operationResults)===null||t===void 0?void 0:t.consumed_milligas}}class Jy extends Rt{constructor(t,r,n,i,s,o){super(t,i,s,o),this.params=r,this.source=n}get operationResults(){const t=Array.isArray(this.results)&&this.results.find(n=>n.kind==="increase_paid_storage"),r=t&&t.metadata&&t.metadata.operation_result;return r||void 0}get status(){var t,r;return(r=(t=this.operationResults)===null||t===void 0?void 0:t.status)!==null&&r!==void 0?r:"unknown"}get fee(){return this.params.fee}get gasLimit(){return this.params.gas_limit}get storageLimit(){return this.params.storage_limit}get errors(){var t;return(t=this.operationResults)===null||t===void 0?void 0:t.errors}get consumedMilliGas(){var t;return(t=this.operationResults)===null||t===void 0?void 0:t.consumed_milligas}get amount(){return this.params.amount}get destination(){return this.params.destination}}class Xy extends Rt{constructor(t,r,n,i,s,o){super(t,i,s,o),this.params=r,this.source=n}get operationResults(){const r=Array.isArray(this.results)&&this.results.find(n=>n.kind==="proposals");return r||void 0}get proposals(){return this.params.proposals}get period(){var t;return(t=this.operationResults)===null||t===void 0?void 0:t.period}}class Zy extends Rt{constructor(t,r,n,i,s,o){super(t,i,s,o),this.params=r,this.source=n}get operationResults(){const t=Array.isArray(this.results)&&this.results.find(n=>n.kind==="update_consensus_key"),r=t&&t.metadata&&t.metadata.operation_result;return r||void 0}get status(){var t,r;return(r=(t=this.operationResults)===null||t===void 0?void 0:t.status)!==null&&r!==void 0?r:"unknown"}get fee(){return this.params.fee}get gasLimit(){return this.params.gas_limit}get storageLimit(){return this.params.storage_limit}get pk(){return this.params.pk}get consumedMilliGas(){var t;return(t=this.operationResults)===null||t===void 0?void 0:t.consumed_milligas}get errors(){var t;return(t=this.operationResults)===null||t===void 0?void 0:t.errors}}class Qy extends Oi{constructor(t,r){super(t),this.estimator=r,this.contractProviderTypeSymbol=Symbol.for("taquito-contract-provider-type-symbol")}getStorage(t,r){return g(this,void 0,void 0,function*(){if(xe(t)!==x.VALID)throw new Ce(t);const n=yield this.context.readProvider.getScript(t,"head");r||(r=n);let i;return Mt.isSchema(r)?i=r:i=Mt.fromRPCResponse({script:r}),i.Execute(n.storage,Va(this))})}getBigMapKey(t,r,n){return g(this,void 0,void 0,function*(){if(xe(t)!==x.VALID)throw new Ce(t);n||(n=(yield this.rpc.getContract(t)).script);let i;Mt.isSchema(n)?i=n:i=Mt.fromRPCResponse({script:n});const s=i.EncodeBigMapKey(r),o=yield this.rpc.getBigMapKey(t,s);return i.ExecuteOnBigMapValue(o)})}getBigMapKeyByID(t,r,n,i){return g(this,void 0,void 0,function*(){const{key:s,type:o}=n.EncodeBigMapKey(r),{packed:a}=yield this.context.packer.packData({data:s,type:o}),c=Ul(a),d=i?yield this.context.readProvider.getBigMapValue({id:t.toString(),expr:c},i):yield this.context.readProvider.getBigMapValue({id:t.toString(),expr:c},"head");return n.ExecuteOnBigMapValue(d,Va(this))})}getBigMapKeysByID(t,r,n,i,s=5){return g(this,void 0,void 0,function*(){const o=yield this.getBlockForRequest(r,i),a=new Ct;let c=0,d=[];for(;c<r.length;){const l=r.slice(c,c+s).map(y=>this.getBigMapValueOrUndefined(y,t,n,o));d=[...d,...yield Promise.all(l)],c+=s}for(let p=0;p<d.length;p++)a.set(r[p],d[p]);return a})}getBlockForRequest(t,r){return g(this,void 0,void 0,function*(){return t.length===1||typeof r<"u"?r:yield this.context.readProvider.getBlockLevel("head")})}getBigMapValueOrUndefined(t,r,n,i){return g(this,void 0,void 0,function*(){try{return yield this.getBigMapKeyByID(r,t,n,i)}catch(s){if(s instanceof di&&s.status===Cn.NOT_FOUND)return;throw s}})}getSaplingDiffByID(t,r){return g(this,void 0,void 0,function*(){return r?yield this.context.readProvider.getSaplingDiffById({id:t.toString()},r):yield this.context.readProvider.getSaplingDiffById({id:t.toString()},"head")})}addRevealOperationIfNeeded(t,r){return g(this,void 0,void 0,function*(){if(Ps(t)){const n=[t],i=yield this.signer.publicKey(),s=yield this.estimator.reveal();if(s){const o={kind:b.REVEAL},a=yield this.estimate(o,()=>g(this,void 0,void 0,function*(){return s}));return n.unshift(yield Gr(Object.assign({},a),r,i)),n}}return t})}originate(t){return g(this,void 0,void 0,function*(){const r=yield this.estimate(t,this.estimator.originate.bind(this.estimator)),n=yield this.signer.publicKeyHash(),i=yield Jn(yield this.context.parser.prepareCodeOrigination(Object.assign(Object.assign({},t),r))),s=yield this.addRevealOperationIfNeeded(i,n),o=yield this.prepareOperation({operation:s,source:n}),a=yield this.forge(o),{hash:c,context:d,forgedBytes:p,opResponse:l}=yield this.signAndInject(a);return new Ly(c,i,p,l,d,this)})}setDelegate(t){return g(this,void 0,void 0,function*(){if(t.source&&Q(t.source)!==x.VALID)throw new tt(t.source);if(t.delegate&&Q(t.delegate)!==x.VALID)throw new tt(t.delegate);if(/kt1/i.test(t.source))throw new Xm(t.source);const r=yield this.estimate(t,this.estimator.setDelegate.bind(this.estimator)),n=yield this.signer.publicKeyHash(),i=yield Zn(Object.assign(Object.assign({},t),r)),s=t.source||n,o=yield this.addRevealOperationIfNeeded(i,n),a=yield this.prepareOperation({operation:o,source:s}),c=yield this.forge(a),{hash:d,context:p,forgedBytes:l,opResponse:y}=yield this.signAndInject(c);return new Ha(d,i,s,l,y,p)})}registerDelegate(t){return g(this,void 0,void 0,function*(){const r=yield this.estimate(t,this.estimator.registerDelegate.bind(this.estimator)),n=yield this.signer.publicKeyHash(),i=yield El(Object.assign(Object.assign({},t),r),n),s=yield this.addRevealOperationIfNeeded(i,n),o=yield this.prepareOperation({operation:s}),a=yield this.forge(o),{hash:c,context:d,forgedBytes:p,opResponse:l}=yield this.signAndInject(a);return new Ha(c,i,n,p,l,d)})}transfer(t){return g(this,void 0,void 0,function*(){if(Q(t.to)!==x.VALID)throw new tt(t.to);if(t.source&&Q(t.source)!==x.VALID)throw new tt(t.source);const r=yield this.signer.publicKeyHash(),n=yield this.estimate(t,this.estimator.transfer.bind(this.estimator)),i=yield Xn(Object.assign(Object.assign({},t),n)),s=t.source||r,o=yield this.addRevealOperationIfNeeded(i,r),a=yield this.prepareOperation({operation:o,source:t.source}),c=yield this.forge(a),{hash:d,context:p,forgedBytes:l,opResponse:y}=yield this.signAndInject(c);return new My(d,i,s,l,y,p)})}transferTicket(t){var r;return g(this,void 0,void 0,function*(){if(xe(t.destination)!==x.VALID)throw new Ce(t.destination);if(t.source&&Q(t.source)!==x.VALID)throw new tt(t.source);const n=yield this.signer.publicKeyHash(),i=yield this.estimate(t,this.estimator.transferTicket.bind(this.estimator)),s=yield ri(Object.assign(Object.assign({},t),i)),o=(r=t.source)!==null&&r!==void 0?r:n,a=yield this.addRevealOperationIfNeeded(s,n),c=yield this.prepareOperation({operation:a,source:t.source}),d=yield this.forge(c),{hash:p,context:l,forgedBytes:y,opResponse:_}=yield this.signAndInject(d);return new Wy(p,s,o,y,_,l)})}reveal(t){return g(this,void 0,void 0,function*(){const r=yield this.signer.publicKeyHash(),n=yield this.estimator.reveal(t);if(n){const i=yield this.estimate(t,()=>g(this,void 0,void 0,function*(){return n})),s=yield Gr(Object.assign({},i),r,yield this.signer.publicKey()),o=yield this.prepareOperation({operation:s,source:r}),a=yield this.forge(o),{hash:c,context:d,forgedBytes:p,opResponse:l}=yield this.signAndInject(a);return new Cy(c,s,r,p,l,d)}else throw new ry(`The publicKeyHash '${r}' has already been revealed.`)})}registerGlobalConstant(t){return g(this,void 0,void 0,function*(){const r=yield this.signer.publicKeyHash(),n=yield this.estimate(t,this.estimator.registerGlobalConstant.bind(this.estimator)),i=yield Qn(Object.assign(Object.assign({},t),n)),s=yield this.addRevealOperationIfNeeded(i,r),o=yield this.prepareOperation({operation:s,source:r}),a=yield this.forge(o),{hash:c,context:d,forgedBytes:p,opResponse:l}=yield this.signAndInject(a);return new xy(c,i,r,p,l,d)})}increasePaidStorage(t){return g(this,void 0,void 0,function*(){const r=yield this.signer.publicKeyHash(),n=yield this.estimate(t,this.estimator.increasePaidStorage.bind(this.estimator)),i=yield ni(Object.assign(Object.assign({},t),n)),s=yield this.addRevealOperationIfNeeded(i,r),o=yield this.prepareOperation({operation:s,source:r}),a=yield this.forge(o),{hash:c,context:d,forgedBytes:p,opResponse:l}=yield this.signAndInject(a);return new Jy(c,i,r,p,l,d)})}drainDelegate(t){return g(this,void 0,void 0,function*(){const r=yield sy(Object.assign({},t)),n=yield this.prepareOperation({operation:r}),i=yield this.forge(n),{hash:s,context:o,forgedBytes:a,opResponse:c}=yield this.signAndInject(i);return new Yy(s,r,a,c,o)})}txRollupOriginate(t){return g(this,void 0,void 0,function*(){const r=yield this.signer.publicKeyHash(),n=yield this.estimate(t||{},this.estimator.txRollupOriginate.bind(this.estimator)),i=yield ti(Object.assign(Object.assign({},t),n)),s=yield this.addRevealOperationIfNeeded(i,r),o=yield this.prepareOperation({operation:s,source:r}),a=yield this.forge(o),{hash:c,context:d,forgedBytes:p,opResponse:l}=yield this.signAndInject(a);return new Fy(c,i,r,p,l,d)})}txRollupSubmitBatch(t){return g(this,void 0,void 0,function*(){const r=yield this.signer.publicKeyHash(),n=yield this.estimate(t,this.estimator.txRollupSubmitBatch.bind(this.estimator)),i=yield ei(Object.assign(Object.assign({},t),n)),s=yield this.addRevealOperationIfNeeded(i,r),o=yield this.prepareOperation({operation:s,source:r}),a=yield this.forge(o),{hash:c,context:d,forgedBytes:p,opResponse:l}=yield this.signAndInject(a);return new qy(c,i,r,p,l,d)})}ballot(t){var r;return g(this,void 0,void 0,function*(){const n=yield this.signer.publicKeyHash();if(t.source&&Q(t.source)!==x.VALID)throw new tt(t.source);const i=(r=t.source)!==null&&r!==void 0?r:n,s=yield oy(Object.assign(Object.assign({},t),{source:i})),o=yield this.prepareOperation({operation:s,source:i}),a=yield this.forge(o),{hash:c,context:d,forgedBytes:p,opResponse:l}=yield this.signAndInject(a);return new zy(c,s,n,p,l,d)})}proposals(t){var r;return g(this,void 0,void 0,function*(){const n=yield this.signer.publicKeyHash();if(t.source&&Q(t.source)!==x.VALID)throw new tt(t.source);const i=(r=t.source)!==null&&r!==void 0?r:n,s=yield ay(Object.assign(Object.assign({},t),{source:i})),o=yield this.prepareOperation({operation:s,source:i}),a=yield this.forge(o),{hash:c,context:d,forgedBytes:p,opResponse:l}=yield this.signAndInject(a);return new Xy(c,s,n,p,l,d)})}updateConsensusKey(t){return g(this,void 0,void 0,function*(){const r=yield this.signer.publicKeyHash(),n=yield this.estimate(t,this.estimator.updateConsensusKey.bind(this.estimator)),i=yield bl(Object.assign(Object.assign({},t),n)),s=yield this.addRevealOperationIfNeeded(i,r),o=yield this.prepareOperation({operation:s,source:t.source}),a=yield this.forge(o),{hash:c,context:d,forgedBytes:p,opResponse:l}=yield this.signAndInject(a);return new Zy(c,i,r,p,l,d)})}at(t,r=n=>n){return g(this,void 0,void 0,function*(){if(xe(t)!==x.VALID)throw new Ce(t);const n=this.context.withExtensions().rpc,i=this.context.withExtensions().readProvider,s=yield i.getScript(t,"head"),o=yield i.getEntrypoints(t),a=new Pl(t,s,this,this,o,n,i);return r(a,this.context)})}batch(t){const r=new Rl(this.context,this.estimator);return Array.isArray(t)&&r.with(t),r}}class Il{constructor(t){this.context=t}getNextProto(){return g(this,void 0,void 0,function*(){if(!this.context.proto){const t=yield this.context.readProvider.getNextProtocol("head");this.context.proto=t}return this.context.proto})}parseScript(t){return g(this,void 0,void 0,function*(){return new ur({protocol:yield this.getNextProto()}).parseScript(t)})}parseMichelineExpression(t){return g(this,void 0,void 0,function*(){return new ur({protocol:yield this.getNextProto()}).parseMichelineExpression(t)})}parseJSON(t){return g(this,void 0,void 0,function*(){return new ur({protocol:yield this.getNextProto()}).parseJSON(t)})}prepareCodeOrigination(t){return g(this,void 0,void 0,function*(){const r=t;if(r.code=yield this.formatCodeParam(t.code),t.init)r.init=yield this.formatInitParam(t.init);else if(t.storage){const n=r.code.find(o=>"prim"in o&&o.prim==="storage");if(!(n!=null&&n.args))throw new Wn("The storage section is missing from the script",t.code);const i=new Mt(n.args[0]),s=yield this.findGlobalConstantsHashAndValue(i);if(Object.keys(s).length!==0){const a=new ur({expandGlobalConstant:s}).parseJSON(n.args[0]),c=new Mt(a);r.init=c.Encode(t.storage)}else r.init=i.Encode(t.storage);delete r.storage}return r})}formatCodeParam(t){return g(this,void 0,void 0,function*(){let r;if(typeof t=="string"){const n=yield this.parseScript(t);if(n===null)throw new Wn("Invalid code parameter",t);r=n}else{const n=yield this.parseJSON(t),i=["parameter","storage","code"];r=n.sort((s,o)=>i.indexOf(s.prim)-i.indexOf(o.prim))}return r})}formatInitParam(t){return g(this,void 0,void 0,function*(){let r;if(typeof t=="string"){const n=yield this.parseMichelineExpression(t);if(n===null)throw new yl("Invalid init parameter",t);r=n}else r=yield this.parseJSON(t);return r})}findGlobalConstantsHashAndValue(t){return g(this,void 0,void 0,function*(){const r=t.findToken("constant"),n={};if(r.length!==0)for(const i of r){const s=i.tokenVal.args;if(s){const o=s[0];if(o.string){const a=o.string,c=yield this.context.globalConstantsProvider.getGlobalConstantByHash(a);Object.assign(n,{[a]:c})}}}return n})}}class Sl{constructor(t){this.context=t}packData(t){return g(this,void 0,void 0,function*(){return this.context.rpc.packData(t)})}}class t0 extends Error{constructor(){super("No globalThis constants provider has been configured. Please configure one by calling setGlobalConstantsProvider({globalConstantsProvider}) on your TezosToolkit instance."),this.name="UnconfiguredGlobalConstantsProviderError"}}class Tl{getGlobalConstantByHash(t){return g(this,void 0,void 0,function*(){throw new t0})}}class Nl{constructor(t){this.rpc=t}getBalance(t,r){return g(this,void 0,void 0,function*(){return this.rpc.getBalance(t,{block:String(r)})})}getDelegate(t,r){return g(this,void 0,void 0,function*(){return this.rpc.getDelegate(t,{block:String(r)})})}getNextProtocol(t){return g(this,void 0,void 0,function*(){return(yield this.rpc.getProtocols({block:String(t)})).next_protocol})}getProtocolConstants(t){return g(this,void 0,void 0,function*(){const{time_between_blocks:r,minimal_block_delay:n,hard_gas_limit_per_operation:i,hard_gas_limit_per_block:s,hard_storage_limit_per_operation:o,cost_per_byte:a,tx_rollup_origination_size:c}=yield this.rpc.getConstants({block:String(t)});return{time_between_blocks:r,minimal_block_delay:n,hard_gas_limit_per_operation:i,hard_gas_limit_per_block:s,hard_storage_limit_per_operation:o,cost_per_byte:a,tx_rollup_origination_size:c}})}getScript(t,r){return g(this,void 0,void 0,function*(){const{script:n}=yield this.rpc.getContract(t,{block:String(r)});return n})}getStorage(t,r){return g(this,void 0,void 0,function*(){return this.rpc.getStorage(t,{block:String(r)})})}getBlockHash(t){return g(this,void 0,void 0,function*(){const{hash:r}=yield this.rpc.getBlockHeader({block:String(t)});return r})}getBlockLevel(t){return g(this,void 0,void 0,function*(){const{level:r}=yield this.rpc.getBlockHeader({block:String(t)});return r})}getCounter(t,r){return g(this,void 0,void 0,function*(){const{counter:n}=yield this.rpc.getContract(t,{block:String(r)});return n||"0"})}getBlockTimestamp(t){return g(this,void 0,void 0,function*(){const{timestamp:r}=yield this.rpc.getBlockHeader({block:String(t)});return r})}getBigMapValue(t,r){return g(this,void 0,void 0,function*(){return this.rpc.getBigMapExpr(t.id,t.expr,{block:String(r)})})}getSaplingDiffById(t,r){return g(this,void 0,void 0,function*(){return this.rpc.getSaplingDiffById(t.id,{block:String(r)})})}getSaplingDiffByContract(t,r){return g(this,void 0,void 0,function*(){return this.rpc.getSaplingDiffByContract(t,{block:String(r)})})}getEntrypoints(t){return g(this,void 0,void 0,function*(){return this.rpc.getEntrypoints(t)})}getChainId(){return g(this,void 0,void 0,function*(){return this.rpc.getChainId()})}isAccountRevealed(t,r){return g(this,void 0,void 0,function*(){const n=yield this.rpc.getManagerKey(t,{block:String(r)});return n&&typeof n=="object"?!!n.key:!!n})}getBlock(t){return g(this,void 0,void 0,function*(){return this.rpc.getBlock({block:String(t)})})}getLiveBlocks(t){return this.rpc.getLiveBlocks({block:String(t)})}}const e0=(e,t)=>e.hash===t.opHash,r0=(e,t)=>{switch(e.kind){case"endorsement":return"metadata"in e&&e.metadata.delegate===t.source;case"activate_account":return"metadata"in e&&e.pkh===t.source;default:return"source"in e&&e.source===t.source}},n0=(e,t)=>"kind"in e&&e.kind===t.kind,i0=(e,t)=>{switch(e.kind){case"delegation":return e.delegate===t.destination;case"origination":if("metadata"in e&&"operation_result"in e.metadata&&"originated_contracts"in e.metadata.operation_result&&Array.isArray(e.metadata.operation_result.originated_contracts))return e.metadata.operation_result.originated_contracts.some(r=>r===t.destination);break;case"transaction":return e.destination===t.destination;default:return!1}},s0=(e,t,r)=>e.kind==="event"?t&&r?e.source===t&&e.tag===r:t&&!r?e.source===t:r?e.tag===r:!0:!1,o0=(e,t)=>"opHash"in t?e0(e,t):"source"in t?r0(e,t):"kind"in t?n0(e,t):"destination"in t?i0(e,t):!1,a0=(e,t)=>{if(Array.isArray(t.and))return t.and.every(r=>Is(e,r));if(Array.isArray(t.or))return t.or.some(r=>Is(e,r));throw new fy("Filter expression must contain either and/or property")},Is=(e,t)=>{const r=[];return Array.isArray(t)?r.push(...t):r.push(t),r.every(n=>"and"in n||"or"in n?a0(e,n):o0(e,n))};class Ua extends Error{constructor(t){super(t),this.message=t,this.name="UnsupportedEventError"}}class _n{constructor(t,r=!1,n=Uc()){this.shouldRetry=r,this.operatorFunction=n,this.errorListeners=[],this.messageListeners=[],this.closeListeners=[],this.completed$=new Pr,t.pipe(bf(this.completed$),jn(i=>{this.call(this.messageListeners,i)},i=>{this.call(this.errorListeners,i)},()=>{this.call(this.closeListeners)}),this.shouldRetry?n:jn(),Ys(()=>Ud)).subscribe()}call(t,r){for(const n of t)try{n(r)}catch(i){console.error(i)}}remove(t,r){const n=t.indexOf(r);n!==-1&&t.splice(n,1)}on(t,r){switch(t){case"data":this.messageListeners.push(r);break;case"error":this.errorListeners.push(r);break;case"close":this.closeListeners.push(r);break;default:throw new Ua(`Trying to register on an unsupported event: ${t}`)}}off(t,r){switch(t){case"data":this.remove(this.messageListeners,r);break;case"error":this.remove(this.errorListeners,r);break;case"close":this.remove(this.closeListeners,r);break;default:throw new Ua(`Trying to unregister on an unsupported event: ${t}`)}}close(){this.completed$.next()}}const c0={shouldObservableSubscriptionRetry:!1,observableSubscriptionRetryFunction:Uc()},u0=e=>pr(e.rpc.getBlock()).pipe(Se()),l0=e=>Jr(t=>new nt(r=>{for(const n of t.operations)for(const i of n)for(const s of i.contents)Is(Object.assign({hash:i.hash},s),e)&&r.next(Object.assign({hash:i.hash},s));r.complete()})),h0=e=>Jr(t=>new nt(r=>{for(const n of t.operations)for(const i of n)for(const s of i.contents){const a=s.metadata.internal_operation_results;if(a)for(const c of a)s0(c,e==null?void 0:e.address,e==null?void 0:e.tag)&&r.next(Object.assign({opHash:i.hash,blockHash:t.hash,level:t.header.level},c))}r.complete()}));class Ss{constructor(t,r={}){this.context=t,this._config$=new fi(Object.assign(Object.assign({},c0),r)),this.timer$=this._config$.pipe(ua("pollingIntervalMilliseconds"),he(n=>n?ca(0,n):pr(this.getConfirmationPollingInterval()).pipe(he(i=>ca(0,i))))),this.newBlock$=this.timer$.pipe(he(()=>u0(this.context)),ef("hash"),pf(),jr())}get config(){return this._config$.getValue()}getConfirmationPollingInterval(){return g(this,void 0,void 0,function*(){if(!this.config.pollingIntervalMilliseconds)try{const n=yield this.context.readProvider.getProtocolConstants("head"),s=(n.minimal_block_delay?n.minimal_block_delay.multipliedBy(1e3):n.time_between_blocks?n.time_between_blocks[0].multipliedBy(1e3):new R(5e3)).dividedBy(3);this.config.pollingIntervalMilliseconds=s.toNumber()===0?1e3:s.toNumber()}catch{return 5e3}return this.config.pollingIntervalMilliseconds})}subscribeBlock(t){return new _n(this.newBlock$,this.config.shouldObservableSubscriptionRetry,this.config.observableSubscriptionRetryFunction)}subscribe(t){return new _n(this.newBlock$.pipe(ua("hash")),this.config.shouldObservableSubscriptionRetry,this.config.observableSubscriptionRetryFunction)}subscribeOperation(t){return new _n(this.newBlock$.pipe(l0(t)),this.config.shouldObservableSubscriptionRetry,this.config.observableSubscriptionRetryFunction)}subscribeEvent(t){return new _n(this.newBlock$.pipe(h0(t)),this.config.shouldObservableSubscriptionRetry,this.config.observableSubscriptionRetryFunction)}}class Ll{constructor(t){this.context=t}getNextProto(){return g(this,void 0,void 0,function*(){if(!this.context.proto){const t=yield this.context.readProvider.getNextProtocol("head");this.context.proto=t}return this.context.proto})}forge({branch:t,contents:r}){return g(this,void 0,void 0,function*(){return new fl(yield this.getNextProto()).forge({branch:t,contents:r})})}}const p0={defaultConfirmationCount:1,confirmationPollingTimeoutSecond:180};class ii{constructor(t,r=new Os,n,i=new fi(Object.assign({},p0)),s,o,a,c,d,p,l,y){this._rpc=t,this._signer=r,this._proto=n,this._config=i,this.providerDecorator=[],this.tz=new Py(this),this.estimate=new Ny(this),this.contract=new Qy(this,this.estimate),this.batch=new my(this,this.estimate),this.wallet=new Pi(this),this.withExtensions=()=>{let _=this.clone();return this.providerDecorator.forEach(N=>{_=N(_)}),_},typeof this._rpc=="string"?this._rpcClient=new Rn(this._rpc):this._rpcClient=this._rpc,this._forger=s||new Ll(this),this._injector=o||new Wm(this),this.operationFactory=new Oy(this),this._walletProvider=c||new Ol(this),this._parser=d||new Il(this),this._packer=a||new Sl(this),this._globalConstantsProvider=p||new Tl,this._readProvider=l||new Nl(this._rpcClient),this._stream=y||new Ss(this)}get config(){return this._config.getValue()}set config(t){this._config.next(Object.assign({},t))}setPartialConfig(t){this._config.next(Object.assign(Object.assign({},this._config.getValue()),t))}get rpc(){return this._rpcClient}set rpc(t){this._rpcClient=t}get injector(){return this._injector}set injector(t){this._injector=t}get forger(){return this._forger}set forger(t){this._forger=t}get signer(){return this._signer}set signer(t){this._signer=t}get walletProvider(){return this._walletProvider}set walletProvider(t){this._walletProvider=t}set proto(t){this._proto=t}get proto(){return this._proto}get parser(){return this._parser}set parser(t){this._parser=t}get packer(){return this._packer}set packer(t){this._packer=t}get globalConstantsProvider(){return this._globalConstantsProvider}set globalConstantsProvider(t){this._globalConstantsProvider=t}get readProvider(){return this._readProvider}set readProvider(t){this._readProvider=t}get stream(){return this._stream}set stream(t){this._stream=t}isAnyProtocolActive(t=[]){return g(this,void 0,void 0,function*(){if(this._proto)return t.includes(this._proto);{const r=yield this.readProvider.getNextProtocol("head");return t.includes(r)}})}isAnySignerConfigured(){return!(this.signer instanceof Os)}clone(){return new ii(this.rpc,this.signer,this.proto,this._config,this.forger,this._injector,this.packer,this._walletProvider,this._parser,this._globalConstantsProvider,this._readProvider,this._stream)}registerProviderDecorator(t){this.providerDecorator.push(t)}}const d0={commitHash:"ebe5353579be0da07c664f4b294516acdc429f6e",version:"15.0.0"};class b0{constructor(t){this.context=t}forge({branch:t,contents:r}){return this.context.rpc.forgeOperations({branch:t,contents:r})}}class v0{packData(t){return g(this,void 0,void 0,function*(){const{bytes:r}=Qg(t.data,t.type);return{packed:r}})}}class _0{constructor(t){this._rpc=t,this._options={},this.format=xs,typeof this._rpc=="string"?this._rpcClient=new Rn(this._rpc):this._rpcClient=this._rpc,this._context=new ii(t),this._wallet=new Pi(this._context),this.setProvider({rpc:this._rpcClient}),this.batch=this._context.batch.batch.bind(this._context.batch)}setProvider({rpc:t,stream:r,signer:n,protocol:i,config:s,forger:o,wallet:a,packer:c,globalConstantsProvider:d,readProvider:p,parserProvider:l}){this.setRpcProvider(t),this.setStreamProvider(r),this.setSignerProvider(n),this.setForgerProvider(o),this.setWalletProvider(a),this.setPackerProvider(c),this.setGlobalConstantsProvider(d),this.setReadProvider(p),this.setParserProvider(l),this._context.proto=i,s&&this._context.setPartialConfig(s)}setSignerProvider(t){!this._options.signer&&typeof t>"u"?(this._context.signer=new Os,this._options.signer=t):typeof t<"u"&&(this._context.signer=t,this._options.signer=t)}setRpcProvider(t){typeof t=="string"?this._rpcClient=new Rn(t):t===void 0||(this._rpcClient=t),this._options.rpc=this._rpcClient,this._context.rpc=this._rpcClient}setForgerProvider(t){if(typeof t<"u")this._options.forger=t,this._context.forger=t;else if(this._options.forger===void 0){const r=this.getFactory(Ll)();this._options.forger=r,this._context.forger=r}}setStreamProvider(t){if(typeof t=="string"){const r=new Ss(new ii(new Rn(t)));this._options.stream=r,this._context.stream=r}else if(typeof t<"u")this._options.stream=t,this._context.stream=t;else if(this._options.stream===void 0){const r=this.getFactory(Ss)();this._options.stream=r,this._context.stream=r}}setWalletProvider(t){if(!this._options.wallet&&typeof t>"u"){const r=this.getFactory(Ol)();this._options.wallet=r,this._context.walletProvider=r}else typeof t<"u"&&(this._options.wallet=t,this._context.walletProvider=t)}setPackerProvider(t){if(!this._options.packer&&typeof t>"u"){const r=this.getFactory(Sl)();this._context.packer=r,this._options.packer=r}else typeof t<"u"&&(this._context.packer=t,this._options.packer=t)}setGlobalConstantsProvider(t){if(!this._options.globalConstantsProvider&&typeof t>"u"){const r=new Tl;this._context.globalConstantsProvider=r,this._options.globalConstantsProvider=r}else typeof t<"u"&&(this._context.globalConstantsProvider=t,this._options.globalConstantsProvider=t)}setReadProvider(t){const r=t||new Nl(this._context.rpc);this._options.readProvider=r,this._context.readProvider=r}setParserProvider(t){if(!this._options.parserProvider&&typeof t>"u"){const r=new Il(this._context);this._context.parser=r,this._options.parserProvider=r}else typeof t<"u"&&(this._context.parser=t,this._options.parserProvider=t)}get tz(){return this._context.tz}get contract(){return this._context.contract}get wallet(){return this._wallet}get operation(){return this._context.operationFactory}get estimate(){return this._context.estimate}get stream(){return this._context.stream}get rpc(){return this._context.rpc}get signer(){return this._context.signer}get globalConstants(){return this._context.globalConstantsProvider}addExtension(t){Array.isArray(t)?t.forEach(r=>r.configureContext(this._context)):t.configureContext(this._context)}getFactory(t){return(...r)=>new t(this._context,...r)}getVersionInfo(){return d0}}export{er as D,wt as E,zh as H,v0 as M,b as O,b0 as R,ds as S,_0 as T,pc as a,tr as b,rr as c,Xn as d,ni as e,Jn as f,Zn as g,Tf as h,Rp as i,yc as j,y0 as k,E0 as l,dh as m,Pt as n,bh as o,ec as p,So as q,Ep as s,It as u};
