import{D as y,P as v}from"./DAppClient-0df61cf3.js";import{d as P,e as p,f as g,g as w}from"./taquito.es6-0764cd35.js";import"./main-31999e94.js";let n;const S=(o,e)=>(n&&e&&(n.disconnect(),n=void 0),n||(n||(n=new y(o)),n));function r(o,e,t,i){function a(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function f(s){try{d(i.next(s))}catch(u){l(u)}}function m(s){try{d(i.throw(s))}catch(u){l(u)}}function d(s){s.done?c(s.value):a(s.value).then(f,m)}d((i=i.apply(o,e||[])).next())})}const q={commitHash:"c050a62135022aa2e61ba6ef72a98f9c89f1682c",version:"16.0.1"};class h extends Error{constructor(){super("You need to initialize BeaconWallet by calling beaconWallet.requestPermissions first"),this.name="BeaconWalletNotInitialized"}}class O extends Error{constructor(e){super(`Required permissions scopes were not granted: ${e.join(",")}`),this.requiredScopes=e,this.name="MissingRequiredScopes"}}class W{constructor(e){this.client=S(e)}validateRequiredScopesOrFail(e,t){const i=new Set(t);for(const a of e)i.has(a)&&i.delete(a);if(i.size>0)throw new O(Array.from(i))}requestPermissions(e){return r(this,void 0,void 0,function*(){yield this.client.requestPermissions(e)})}getPKH(){return r(this,void 0,void 0,function*(){const e=yield this.client.getActiveAccount();if(!e)throw new h;return e.address})}mapTransferParamsToWalletParams(e){return r(this,void 0,void 0,function*(){let t;yield this.client.showPrepare();try{t=yield e()}catch(i){throw yield this.client.hideUI(),i}return this.removeDefaultParams(t,yield P(this.formatParameters(t)))})}mapIncreasePaidStorageWalletParams(e){return r(this,void 0,void 0,function*(){let t;yield this.client.showPrepare();try{t=yield e()}catch(i){throw yield this.client.hideUI(),i}return this.removeDefaultParams(t,yield p(this.formatParameters(t)))})}mapOriginateParamsToWalletParams(e){return r(this,void 0,void 0,function*(){let t;yield this.client.showPrepare();try{t=yield e()}catch(i){throw yield this.client.hideUI(),i}return this.removeDefaultParams(t,yield g(this.formatParameters(t)))})}mapDelegateParamsToWalletParams(e){return r(this,void 0,void 0,function*(){let t;yield this.client.showPrepare();try{t=yield e()}catch(i){throw yield this.client.hideUI(),i}return this.removeDefaultParams(t,yield w(this.formatParameters(t)))})}formatParameters(e){return e.fee&&(e.fee=e.fee.toString()),e.storageLimit&&(e.storageLimit=e.storageLimit.toString()),e.gasLimit&&(e.gasLimit=e.gasLimit.toString()),e}removeDefaultParams(e,t){return e.fee||delete t.fee,e.storageLimit||delete t.storage_limit,e.gasLimit||delete t.gas_limit,t}sendOperations(e){return r(this,void 0,void 0,function*(){const t=yield this.client.getActiveAccount();if(!t)throw new h;const i=t.scopes;this.validateRequiredScopesOrFail(i,[v.OPERATION_REQUEST]);const{transactionHash:a}=yield this.client.requestOperation({operationDetails:e});return a})}disconnect(){return r(this,void 0,void 0,function*(){yield this.client.destroy()})}clearActiveAccount(){return r(this,void 0,void 0,function*(){yield this.client.setActiveAccount()})}}export{W as BeaconWallet,h as BeaconWalletNotInitialized,O as MissingRequiredScopes,q as VERSION};
