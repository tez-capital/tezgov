import{aD as At,g as Lt,aE as Ot,aF as wt}from"./Input.BdJ1SS61.js";import{c as xt,D as _t}from"./0.C4iJHoNx.js";const Ct={},Dt={},rt=(r,e)=>{Dt[r]=e},o=r=>{class e extends Error{constructor(s,n,l){if(super(s||r,l),Object.setPrototypeOf(this,e.prototype),this.name=r,n)for(const c in n)this[c]=n[c];if(l&&Pt(l)&&"cause"in l&&!("cause"in this)){const c=l.cause;this.cause=c,"stack"in c&&(this.stack=this.stack+`
CAUSE: `+c.stack)}}}return Ct[r]=e,e};function Pt(r){return typeof r=="object"}o("AccountNameRequired");o("AccountNotSupported");o("AccountAwaitingSendPendingOperations");o("AmountRequired");o("BluetoothRequired");o("BtcUnmatchedApp");o("CantOpenDevice");o("CashAddrNotSupported");o("ClaimRewardsFeesWarning");o("CurrencyNotSupported");o("DeviceAppVerifyNotSupported");o("DeviceGenuineSocketEarlyClose");o("DeviceNotGenuine");o("DeviceOnDashboardExpected");o("DeviceOnDashboardUnexpected");o("DeviceInOSUExpected");o("DeviceHalted");o("DeviceNameInvalid");o("DeviceSocketFail");o("DeviceSocketNoBulkStatus");o("DeviceSocketNoBulkStatus");o("UnresponsiveDeviceError");const yt=o("DisconnectedDevice"),Ut=o("DisconnectedDeviceDuringOperation");o("DeviceExtractOnboardingStateError");o("DeviceOnboardingStatePollingError");o("EnpointConfig");o("EthAppPleaseEnableContractData");o("FeeEstimationFailed");o("FirmwareNotRecognized");o("HardResetFail");o("InvalidXRPTag");o("InvalidAddress");o("InvalidNonce");o("InvalidAddressBecauseDestinationIsAlsoSource");o("LatestMCUInstalledError");o("UnknownMCU");o("LedgerAPIError");o("LedgerAPIErrorWithMessage");o("LedgerAPINotAvailable");o("ManagerAppAlreadyInstalled");o("ManagerAppRelyOnBTC");o("ManagerAppDepInstallRequired");o("ManagerAppDepUninstallRequired");o("ManagerDeviceLocked");o("ManagerFirmwareNotEnoughSpace");o("ManagerNotEnoughSpace");o("ManagerUninstallBTCDep");o("NetworkDown");o("NetworkError");o("NoAddressesFound");o("NotEnoughBalance");o("NotEnoughBalanceSwap");o("NotEnoughBalanceToDelegate");o("NotEnoughBalanceInParentAccount");o("NotEnoughSpendableBalance");o("NotEnoughBalanceBecauseDestinationNotCreated");o("NoAccessToCamera");o("NotEnoughGas");o("NotEnoughGasSwap");o("TronEmptyAccount");o("MaybeKeepTronAccountAlive");o("NotSupportedLegacyAddress");o("GasLessThanEstimate");o("PriorityFeeTooLow");o("PriorityFeeTooHigh");o("PriorityFeeHigherThanMaxFee");o("MaxFeeTooLow");o("PasswordsDontMatch");o("PasswordIncorrect");o("RecommendSubAccountsToEmpty");o("RecommendUndelegation");o("TimeoutTagged");o("UnexpectedBootloader");o("MCUNotGenuineToDashboard");o("RecipientRequired");o("UnavailableTezosOriginatedAccountReceive");o("UnavailableTezosOriginatedAccountSend");o("UpdateFetchFileFail");o("UpdateIncorrectHash");o("UpdateIncorrectSig");o("UpdateYourApp");o("UserRefusedDeviceNameChange");o("UserRefusedAddress");o("UserRefusedFirmwareUpdate");o("UserRefusedAllowManager");o("UserRefusedOnDevice");o("ExpertModeRequired");const Le=o("TransportOpenUserCancelled");o("TransportInterfaceNotAvailable");const bt=o("TransportRaceCondition");o("TransportWebUSBGestureRequired");o("TransactionHasBeenValidatedError");o("TransportExchangeTimeoutError");o("DeviceShouldStayInApp");o("WebsocketConnectionError");o("WebsocketConnectionFailed");o("WrongDeviceForAccount");o("WrongDeviceForAccountPayout");o("WrongDeviceForAccountRefund");o("WrongAppForCurrency");o("ETHAddressNonEIP");o("CantScanQRCode");o("FeeNotLoaded");o("FeeNotLoadedSwap");o("FeeRequired");o("FeeTooHigh");o("PendingOperation");o("SyncError");o("PairingFailed");o("PeerRemovedPairing");o("GenuineCheckFailed");o("LedgerAPI4xx");o("LedgerAPI5xx");o("FirmwareOrAppUpdateRequired");o("ReplacementTransactionUnderpriced");o("OpReturnSizeLimit");o("DustLimit");o("LanguageNotFound");o("NoDBPathGiven");o("DBWrongPassword");o("DBNotReset");o("SequenceNumberError");o("DisabledTransactionBroadcastError");var Oe;(function(r){r.Unknown="Unknown",r.LocationServicesDisabled="LocationServicesDisabled",r.LocationServicesUnauthorized="LocationServicesUnauthorized",r.BluetoothScanStartFailed="BluetoothScanStartFailed"})(Oe||(Oe={}));class B extends Error{constructor(e,t){const s="TransportError";super(e||s),this.name=s,this.message=e,this.stack=new Error(e).stack,this.id=t}}rt("TransportError",r=>new B(r.message,r.id));const V={ACCESS_CONDITION_NOT_FULFILLED:38916,ALGORITHM_NOT_SUPPORTED:38020,CLA_NOT_SUPPORTED:28160,CODE_BLOCKED:38976,CODE_NOT_INITIALIZED:38914,COMMAND_INCOMPATIBLE_FILE_STRUCTURE:27009,CONDITIONS_OF_USE_NOT_SATISFIED:27013,CONTRADICTION_INVALIDATION:38928,CONTRADICTION_SECRET_CODE_STATUS:38920,DEVICE_IN_RECOVERY_MODE:26159,CUSTOM_IMAGE_EMPTY:26158,FILE_ALREADY_EXISTS:27273,FILE_NOT_FOUND:37892,GP_AUTH_FAILED:25344,HALTED:28586,INCONSISTENT_FILE:37896,INCORRECT_DATA:27264,INCORRECT_LENGTH:26368,INCORRECT_P1_P2:27392,INS_NOT_SUPPORTED:27904,DEVICE_NOT_ONBOARDED:27911,DEVICE_NOT_ONBOARDED_2:26129,INVALID_KCV:38021,INVALID_OFFSET:37890,LICENSING:28482,LOCKED_DEVICE:21781,MAX_VALUE_REACHED:38992,MEMORY_PROBLEM:37440,MISSING_CRITICAL_PARAMETER:26624,NO_EF_SELECTED:37888,NOT_ENOUGH_MEMORY_SPACE:27268,OK:36864,PIN_REMAINING_ATTEMPTS:25536,REFERENCED_DATA_NOT_FOUND:27272,SECURITY_STATUS_NOT_SATISFIED:27010,TECHNICAL_PROBLEM:28416,UNKNOWN_APDU:27906,USER_REFUSED_ON_DEVICE:21761,NOT_ENOUGH_SPACE:20738,APP_NOT_FOUND_OR_INVALID_CONTEXT:20771,INVALID_APP_NAME_LENGTH:26378,GEN_AES_KEY_FAILED:21529,INTERNAL_CRYPTO_OPERATION_FAILED:21530,INTERNAL_COMPUTE_AES_CMAC_FAILED:21531,ENCRYPT_APP_STORAGE_FAILED:21532,INVALID_BACKUP_STATE:26178,PIN_NOT_SET:21762,INVALID_BACKUP_LENGTH:26419,INVALID_RESTORE_STATE:26179,INVALID_CHUNK_LENGTH:26420,INVALID_BACKUP_HEADER:26698};function Ft(r){switch(r){case 26368:return"Incorrect length";case 26624:return"Missing critical parameter";case 27010:return"Security not satisfied (dongle locked or have invalid access rights)";case 27013:return"Condition of use not satisfied (denied by the user?)";case 27264:return"Invalid data received";case 27392:return"Invalid parameter received";case 21781:return"Locked device"}if(28416<=r&&r<=28671)return"Internal error, please report"}class j extends Error{constructor(e,{canBeMappedToChildError:t=!0}={}){const s=Object.keys(V).find(h=>V[h]===e)||"UNKNOWN_ERROR",n=Ft(e)||s,l=e.toString(16),c=`Ledger device: ${n} (0x${l})`;if(super(c),this.name="TransportStatusError",this.statusCode=e,this.statusText=s,Object.setPrototypeOf(this,j.prototype),t&&e===V.LOCKED_DEVICE)return new pe(c)}}class pe extends j{constructor(e){super(V.LOCKED_DEVICE,{canBeMappedToChildError:!1}),e&&(this.message=e),this.name="LockedDeviceError",Object.setPrototypeOf(this,pe.prototype)}}rt("TransportStatusError",r=>new j(r.statusCode));let st=0;const G=[],we=(r,e,t)=>{const s={type:r,id:String(++st),date:new Date};e&&(s.message=e),nt(s)},Bt=({type:r,message:e,data:t,context:s})=>{const n={type:r,id:String(++st),date:new Date};e&&(n.message=e),t&&(n.data=t),s&&(n.context=s),nt(n)};class Y{constructor(e,t){this.type=e,this.context=t}trace(e,t){Bt({type:this.type,message:e,data:t,context:this.context})}getContext(){return this.context}setContext(e){this.context=e}updateContext(e){this.context=Object.assign(Object.assign({},this.context),e)}getType(){return this.type}setType(e){this.type=e}withType(e){return new Y(e,this.context)}withContext(e){return new Y(this.type,e)}withUpdatedContext(e){return new Y(this.type,Object.assign(Object.assign({},this.context),e))}}const Gt=r=>(G.push(r),()=>{const e=G.indexOf(r);e!==-1&&(G[e]=G[G.length-1],G.pop())});function nt(r){for(let e=0;e<G.length;e++)try{G[e](r)}catch(t){console.error(t)}}typeof window<"u"&&(window.__ledgerLogsListen=Gt);var K=function(r,e,t,s){function n(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function h(u){try{a(s.next(u))}catch(f){c(f)}}function i(u){try{a(s.throw(u))}catch(f){c(f)}}function a(u){u.done?l(u.value):n(u.value).then(h,i)}a((s=s.apply(r,e||[])).next())})};const Mt="transport";class me{constructor({context:e,logType:t}={}){this.exchangeTimeout=3e4,this.unresponsiveTimeout=15e3,this.deviceModel=null,this._events=new At,this.send=(s,n,l,c,...h)=>K(this,[s,n,l,c,...h],void 0,function*(i,a,u,f,T=Buffer.alloc(0),I=[V.OK],{abortTimeoutMs:$}={}){const C=this.tracer.withUpdatedContext({function:"send"});if(T.length>=256)throw C.trace("data.length exceeded 256 bytes limit",{dataLength:T.length}),new B("data.length exceed 256 bytes limit. Got: "+T.length,"DataLengthTooBig");C.trace("Starting an exchange",{abortTimeoutMs:$});const x=yield this.exchange(Buffer.concat([Buffer.from([i,a,u,f]),Buffer.from([T.length]),T]),{abortTimeoutMs:$});C.trace("Received response from exchange");const P=x.readUInt16BE(x.length-2);if(!I.some(H=>H===P))throw new j(P);return x}),this._appAPIlock=null,this.tracer=new Y(t??Mt,e)}exchange(e,{abortTimeoutMs:t}={}){throw new Error("exchange not implemented")}exchangeBulk(e,t){let s=!1;const n=()=>{s=!0};return K(this,void 0,void 0,function*(){if(!s)for(const c of e){const h=yield this.exchange(c);if(s)return;const i=h.readUInt16BE(h.length-2);if(i!==V.OK)throw new j(i);t.next(h)}}).then(()=>!s&&t.complete(),c=>!s&&t.error(c)),{unsubscribe:n}}setScrambleKey(e){}close(){return Promise.resolve()}on(e,t){this._events.on(e,t)}off(e,t){this._events.removeListener(e,t)}emit(e,...t){this._events.emit(e,...t)}setDebugMode(){console.warn("setDebugMode is deprecated. use @ledgerhq/logs instead. No logs are emitted in this anymore.")}setExchangeTimeout(e){this.exchangeTimeout=e}setExchangeUnresponsiveTimeout(e){this.unresponsiveTimeout=e}static create(e=3e3,t){return new Promise((s,n)=>{let l=!1;const c=this.listen({next:i=>{l=!0,c&&c.unsubscribe(),h&&clearTimeout(h),this.open(i.descriptor,e).then(s,n)},error:i=>{h&&clearTimeout(h),n(i)},complete:()=>{h&&clearTimeout(h),l||n(new B(this.ErrorMessage_NoDeviceFound,"NoDeviceFound"))}}),h=t?setTimeout(()=>{c.unsubscribe(),n(new B(this.ErrorMessage_ListenTimeout,"ListenTimeout"))},t):null})}exchangeAtomicImpl(e){return K(this,void 0,void 0,function*(){const t=this.tracer.withUpdatedContext({function:"exchangeAtomicImpl",unresponsiveTimeout:this.unresponsiveTimeout});if(this.exchangeBusyPromise)throw t.trace("Atomic exchange is already busy"),new bt("An action was already pending on the Ledger device. Please deny or reconnect.");let s;const n=new Promise(h=>{s=h});this.exchangeBusyPromise=n;let l=!1;const c=setTimeout(()=>{t.trace('Timeout reached, emitting Transport event "unresponsive"',{unresponsiveTimeout:this.unresponsiveTimeout}),l=!0,this.emit("unresponsive")},this.unresponsiveTimeout);try{const h=yield e();return l&&(t.trace("Device was unresponsive, emitting responsive"),this.emit("responsive")),h}finally{t.trace("Finalize, clearing busy guard"),clearTimeout(c),s&&s(),this.exchangeBusyPromise=null}})}decorateAppAPIMethods(e,t,s){for(const n of t)e[n]=this.decorateAppAPIMethod(n,e[n],e,s)}decorateAppAPIMethod(e,t,s,n){return(...l)=>K(this,void 0,void 0,function*(){const{_appAPIlock:c}=this;if(c)return Promise.reject(new B("Ledger Device is busy (lock "+c+")","TransportLocked"));try{return this._appAPIlock=e,this.setScrambleKey(n),yield t.apply(s,l)}finally{this._appAPIlock=null}})}setTraceContext(e){this.tracer=this.tracer.withContext(e)}updateTraceContext(e){this.tracer.updateContext(e)}getTraceContext(){return this.tracer.getContext()}}me.ErrorMessage_ListenTimeout="No Ledger device found (timeout)";me.ErrorMessage_NoDeviceFound="No Ledger device found";const xe=5;function kt(r){const e=Buffer.alloc(2);return e.writeUInt16BE(r,0),e}const Vt={data:Buffer.alloc(0),dataLength:0,sequence:0},jt=(r,e)=>({makeBlocks(t){let s=Buffer.concat([kt(t.length),t]);const n=e-5,l=Math.ceil(s.length/n);s=Buffer.concat([s,Buffer.alloc(l*n-s.length+1).fill(0)]);const c=[];for(let h=0;h<l;h++){const i=Buffer.alloc(5);i.writeUInt16BE(r,0),i.writeUInt8(xe,2),i.writeUInt16BE(h,3);const a=s.slice(h*n,(h+1)*n);c.push(Buffer.concat([i,a]))}return c},reduceResponse(t,s){let{data:n,dataLength:l,sequence:c}=t||Vt;if(s.readUInt16BE(0)!==r)throw new B("Invalid channel","InvalidChannel");if(s.readUInt8(2)!==xe)throw new B("Invalid tag","InvalidTag");if(s.readUInt16BE(3)!==c)throw new B("Invalid sequence","InvalidSequence");t||(l=s.readUInt16BE(5)),c++;const h=s.slice(t?5:7);return n=Buffer.concat([n,h]),n.length>l&&(n=n.slice(0,l)),{data:n,dataLength:l,sequence:c}},getReducedResult(t){if(t&&t.dataLength===t.data.length)return t.data}});var fe={exports:{}};const Xt="2.0.0",it=256,Ht=Number.MAX_SAFE_INTEGER||9007199254740991,qt=16,zt=it-6,Yt=["major","premajor","minor","preminor","patch","prepatch","prerelease"];var re={MAX_LENGTH:it,MAX_SAFE_COMPONENT_LENGTH:qt,MAX_SAFE_BUILD_LENGTH:zt,MAX_SAFE_INTEGER:Ht,RELEASE_TYPES:Yt,SEMVER_SPEC_VERSION:Xt,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},ae={};const Wt=typeof process=="object"&&ae&&ae.NODE_DEBUG&&/\bsemver\b/i.test(ae.NODE_DEBUG)?(...r)=>console.error("SEMVER",...r):()=>{};var se=Wt;(function(r,e){const{MAX_SAFE_COMPONENT_LENGTH:t,MAX_SAFE_BUILD_LENGTH:s,MAX_LENGTH:n}=re,l=se;e=r.exports={};const c=e.re=[],h=e.safeRe=[],i=e.src=[],a=e.t={};let u=0;const f="[a-zA-Z0-9-]",T=[["\\s",1],["\\d",n],[f,s]],I=C=>{for(const[x,P]of T)C=C.split(`${x}*`).join(`${x}{0,${P}}`).split(`${x}+`).join(`${x}{1,${P}}`);return C},$=(C,x,P)=>{const H=I(x),L=u++;l(C,L,x),a[C]=L,i[L]=x,c[L]=new RegExp(x,P?"g":void 0),h[L]=new RegExp(H,P?"g":void 0)};$("NUMERICIDENTIFIER","0|[1-9]\\d*"),$("NUMERICIDENTIFIERLOOSE","\\d+"),$("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${f}*`),$("MAINVERSION",`(${i[a.NUMERICIDENTIFIER]})\\.(${i[a.NUMERICIDENTIFIER]})\\.(${i[a.NUMERICIDENTIFIER]})`),$("MAINVERSIONLOOSE",`(${i[a.NUMERICIDENTIFIERLOOSE]})\\.(${i[a.NUMERICIDENTIFIERLOOSE]})\\.(${i[a.NUMERICIDENTIFIERLOOSE]})`),$("PRERELEASEIDENTIFIER",`(?:${i[a.NUMERICIDENTIFIER]}|${i[a.NONNUMERICIDENTIFIER]})`),$("PRERELEASEIDENTIFIERLOOSE",`(?:${i[a.NUMERICIDENTIFIERLOOSE]}|${i[a.NONNUMERICIDENTIFIER]})`),$("PRERELEASE",`(?:-(${i[a.PRERELEASEIDENTIFIER]}(?:\\.${i[a.PRERELEASEIDENTIFIER]})*))`),$("PRERELEASELOOSE",`(?:-?(${i[a.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${i[a.PRERELEASEIDENTIFIERLOOSE]})*))`),$("BUILDIDENTIFIER",`${f}+`),$("BUILD",`(?:\\+(${i[a.BUILDIDENTIFIER]}(?:\\.${i[a.BUILDIDENTIFIER]})*))`),$("FULLPLAIN",`v?${i[a.MAINVERSION]}${i[a.PRERELEASE]}?${i[a.BUILD]}?`),$("FULL",`^${i[a.FULLPLAIN]}$`),$("LOOSEPLAIN",`[v=\\s]*${i[a.MAINVERSIONLOOSE]}${i[a.PRERELEASELOOSE]}?${i[a.BUILD]}?`),$("LOOSE",`^${i[a.LOOSEPLAIN]}$`),$("GTLT","((?:<|>)?=?)"),$("XRANGEIDENTIFIERLOOSE",`${i[a.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),$("XRANGEIDENTIFIER",`${i[a.NUMERICIDENTIFIER]}|x|X|\\*`),$("XRANGEPLAIN",`[v=\\s]*(${i[a.XRANGEIDENTIFIER]})(?:\\.(${i[a.XRANGEIDENTIFIER]})(?:\\.(${i[a.XRANGEIDENTIFIER]})(?:${i[a.PRERELEASE]})?${i[a.BUILD]}?)?)?`),$("XRANGEPLAINLOOSE",`[v=\\s]*(${i[a.XRANGEIDENTIFIERLOOSE]})(?:\\.(${i[a.XRANGEIDENTIFIERLOOSE]})(?:\\.(${i[a.XRANGEIDENTIFIERLOOSE]})(?:${i[a.PRERELEASELOOSE]})?${i[a.BUILD]}?)?)?`),$("XRANGE",`^${i[a.GTLT]}\\s*${i[a.XRANGEPLAIN]}$`),$("XRANGELOOSE",`^${i[a.GTLT]}\\s*${i[a.XRANGEPLAINLOOSE]}$`),$("COERCEPLAIN",`(^|[^\\d])(\\d{1,${t}})(?:\\.(\\d{1,${t}}))?(?:\\.(\\d{1,${t}}))?`),$("COERCE",`${i[a.COERCEPLAIN]}(?:$|[^\\d])`),$("COERCEFULL",i[a.COERCEPLAIN]+`(?:${i[a.PRERELEASE]})?(?:${i[a.BUILD]})?(?:$|[^\\d])`),$("COERCERTL",i[a.COERCE],!0),$("COERCERTLFULL",i[a.COERCEFULL],!0),$("LONETILDE","(?:~>?)"),$("TILDETRIM",`(\\s*)${i[a.LONETILDE]}\\s+`,!0),e.tildeTrimReplace="$1~",$("TILDE",`^${i[a.LONETILDE]}${i[a.XRANGEPLAIN]}$`),$("TILDELOOSE",`^${i[a.LONETILDE]}${i[a.XRANGEPLAINLOOSE]}$`),$("LONECARET","(?:\\^)"),$("CARETTRIM",`(\\s*)${i[a.LONECARET]}\\s+`,!0),e.caretTrimReplace="$1^",$("CARET",`^${i[a.LONECARET]}${i[a.XRANGEPLAIN]}$`),$("CARETLOOSE",`^${i[a.LONECARET]}${i[a.XRANGEPLAINLOOSE]}$`),$("COMPARATORLOOSE",`^${i[a.GTLT]}\\s*(${i[a.LOOSEPLAIN]})$|^$`),$("COMPARATOR",`^${i[a.GTLT]}\\s*(${i[a.FULLPLAIN]})$|^$`),$("COMPARATORTRIM",`(\\s*)${i[a.GTLT]}\\s*(${i[a.LOOSEPLAIN]}|${i[a.XRANGEPLAIN]})`,!0),e.comparatorTrimReplace="$1$2$3",$("HYPHENRANGE",`^\\s*(${i[a.XRANGEPLAIN]})\\s+-\\s+(${i[a.XRANGEPLAIN]})\\s*$`),$("HYPHENRANGELOOSE",`^\\s*(${i[a.XRANGEPLAINLOOSE]})\\s+-\\s+(${i[a.XRANGEPLAINLOOSE]})\\s*$`),$("STAR","(<|>)?=?\\s*\\*"),$("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),$("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")})(fe,fe.exports);var W=fe.exports;const Kt=Object.freeze({loose:!0}),Zt=Object.freeze({}),Qt=r=>r?typeof r!="object"?Kt:r:Zt;var Ie=Qt;const _e=/^[0-9]+$/,ot=(r,e)=>{const t=_e.test(r),s=_e.test(e);return t&&s&&(r=+r,e=+e),r===e?0:t&&!s?-1:s&&!t?1:r<e?-1:1},Jt=(r,e)=>ot(e,r);var at={compareIdentifiers:ot,rcompareIdentifiers:Jt};const Z=se,{MAX_LENGTH:Ce,MAX_SAFE_INTEGER:Q}=re,{safeRe:De,t:Pe}=W,er=Ie,{compareIdentifiers:k}=at;let tr=class b{constructor(e,t){if(t=er(t),e instanceof b){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>Ce)throw new TypeError(`version is longer than ${Ce} characters`);Z("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const s=e.trim().match(t.loose?De[Pe.LOOSE]:De[Pe.FULL]);if(!s)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+s[1],this.minor=+s[2],this.patch=+s[3],this.major>Q||this.major<0)throw new TypeError("Invalid major version");if(this.minor>Q||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>Q||this.patch<0)throw new TypeError("Invalid patch version");s[4]?this.prerelease=s[4].split(".").map(n=>{if(/^[0-9]+$/.test(n)){const l=+n;if(l>=0&&l<Q)return l}return n}):this.prerelease=[],this.build=s[5]?s[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(Z("SemVer.compare",this.version,this.options,e),!(e instanceof b)){if(typeof e=="string"&&e===this.version)return 0;e=new b(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof b||(e=new b(e,this.options)),k(this.major,e.major)||k(this.minor,e.minor)||k(this.patch,e.patch)}comparePre(e){if(e instanceof b||(e=new b(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const s=this.prerelease[t],n=e.prerelease[t];if(Z("prerelease compare",t,s,n),s===void 0&&n===void 0)return 0;if(n===void 0)return 1;if(s===void 0)return-1;if(s===n)continue;return k(s,n)}while(++t)}compareBuild(e){e instanceof b||(e=new b(e,this.options));let t=0;do{const s=this.build[t],n=e.build[t];if(Z("build compare",t,s,n),s===void 0&&n===void 0)return 0;if(n===void 0)return 1;if(s===void 0)return-1;if(s===n)continue;return k(s,n)}while(++t)}inc(e,t,s){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,s);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,s);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,s),this.inc("pre",t,s);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",t,s),this.inc("pre",t,s);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const n=Number(s)?1:0;if(!t&&s===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[n];else{let l=this.prerelease.length;for(;--l>=0;)typeof this.prerelease[l]=="number"&&(this.prerelease[l]++,l=-2);if(l===-1){if(t===this.prerelease.join(".")&&s===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(n)}}if(t){let l=[t,n];s===!1&&(l=[t]),k(this.prerelease[0],t)===0?isNaN(this.prerelease[1])&&(this.prerelease=l):this.prerelease=l}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};var _=tr;const ye=_,rr=(r,e,t=!1)=>{if(r instanceof ye)return r;try{return new ye(r,e)}catch(s){if(!t)return null;throw s}};var X=rr;const sr=X,nr=(r,e)=>{const t=sr(r,e);return t?t.version:null};var ir=nr;const or=X,ar=(r,e)=>{const t=or(r.trim().replace(/^[=v]+/,""),e);return t?t.version:null};var cr=ar;const Ue=_,lr=(r,e,t,s,n)=>{typeof t=="string"&&(n=s,s=t,t=void 0);try{return new Ue(r instanceof Ue?r.version:r,t).inc(e,s,n).version}catch{return null}};var ur=lr;const be=X,dr=(r,e)=>{const t=be(r,null,!0),s=be(e,null,!0),n=t.compare(s);if(n===0)return null;const l=n>0,c=l?t:s,h=l?s:t,i=!!c.prerelease.length;if(!!h.prerelease.length&&!i)return!h.patch&&!h.minor?"major":c.patch?"patch":c.minor?"minor":"major";const u=i?"pre":"";return t.major!==s.major?u+"major":t.minor!==s.minor?u+"minor":t.patch!==s.patch?u+"patch":"prerelease"};var hr=dr;const fr=_,Er=(r,e)=>new fr(r,e).major;var pr=Er;const mr=_,Ir=(r,e)=>new mr(r,e).minor;var $r=Ir;const Rr=_,gr=(r,e)=>new Rr(r,e).patch;var Nr=gr;const vr=X,Tr=(r,e)=>{const t=vr(r,e);return t&&t.prerelease.length?t.prerelease:null};var Sr=Tr;const Fe=_,Ar=(r,e,t)=>new Fe(r,t).compare(new Fe(e,t));var y=Ar;const Lr=y,Or=(r,e,t)=>Lr(e,r,t);var wr=Or;const xr=y,_r=(r,e)=>xr(r,e,!0);var Cr=_r;const Be=_,Dr=(r,e,t)=>{const s=new Be(r,t),n=new Be(e,t);return s.compare(n)||s.compareBuild(n)};var $e=Dr;const Pr=$e,yr=(r,e)=>r.sort((t,s)=>Pr(t,s,e));var Ur=yr;const br=$e,Fr=(r,e)=>r.sort((t,s)=>br(s,t,e));var Br=Fr;const Gr=y,Mr=(r,e,t)=>Gr(r,e,t)>0;var ne=Mr;const kr=y,Vr=(r,e,t)=>kr(r,e,t)<0;var Re=Vr;const jr=y,Xr=(r,e,t)=>jr(r,e,t)===0;var ct=Xr;const Hr=y,qr=(r,e,t)=>Hr(r,e,t)!==0;var lt=qr;const zr=y,Yr=(r,e,t)=>zr(r,e,t)>=0;var ge=Yr;const Wr=y,Kr=(r,e,t)=>Wr(r,e,t)<=0;var Ne=Kr;const Zr=ct,Qr=lt,Jr=ne,es=ge,ts=Re,rs=Ne,ss=(r,e,t,s)=>{switch(e){case"===":return typeof r=="object"&&(r=r.version),typeof t=="object"&&(t=t.version),r===t;case"!==":return typeof r=="object"&&(r=r.version),typeof t=="object"&&(t=t.version),r!==t;case"":case"=":case"==":return Zr(r,t,s);case"!=":return Qr(r,t,s);case">":return Jr(r,t,s);case">=":return es(r,t,s);case"<":return ts(r,t,s);case"<=":return rs(r,t,s);default:throw new TypeError(`Invalid operator: ${e}`)}};var ut=ss;const ns=_,is=X,{safeRe:J,t:ee}=W,os=(r,e)=>{if(r instanceof ns)return r;if(typeof r=="number"&&(r=String(r)),typeof r!="string")return null;e=e||{};let t=null;if(!e.rtl)t=r.match(e.includePrerelease?J[ee.COERCEFULL]:J[ee.COERCE]);else{const i=e.includePrerelease?J[ee.COERCERTLFULL]:J[ee.COERCERTL];let a;for(;(a=i.exec(r))&&(!t||t.index+t[0].length!==r.length);)(!t||a.index+a[0].length!==t.index+t[0].length)&&(t=a),i.lastIndex=a.index+a[1].length+a[2].length;i.lastIndex=-1}if(t===null)return null;const s=t[2],n=t[3]||"0",l=t[4]||"0",c=e.includePrerelease&&t[5]?`-${t[5]}`:"",h=e.includePrerelease&&t[6]?`+${t[6]}`:"";return is(`${s}.${n}.${l}${c}${h}`,e)};var as=os;class cs{constructor(){this.max=1e3,this.map=new Map}get(e){const t=this.map.get(e);if(t!==void 0)return this.map.delete(e),this.map.set(e,t),t}delete(e){return this.map.delete(e)}set(e,t){if(!this.delete(e)&&t!==void 0){if(this.map.size>=this.max){const n=this.map.keys().next().value;this.delete(n)}this.map.set(e,t)}return this}}var ls=cs,ce,Ge;function U(){if(Ge)return ce;Ge=1;const r=/\s+/g;class e{constructor(d,R){if(R=n(R),d instanceof e)return d.loose===!!R.loose&&d.includePrerelease===!!R.includePrerelease?d:new e(d.raw,R);if(d instanceof l)return this.raw=d.value,this.set=[[d]],this.formatted=void 0,this;if(this.options=R,this.loose=!!R.loose,this.includePrerelease=!!R.includePrerelease,this.raw=d.trim().replace(r," "),this.set=this.raw.split("||").map(p=>this.parseRange(p.trim())).filter(p=>p.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const p=this.set[0];if(this.set=this.set.filter(g=>!C(g[0])),this.set.length===0)this.set=[p];else if(this.set.length>1){for(const g of this.set)if(g.length===1&&x(g[0])){this.set=[g];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let d=0;d<this.set.length;d++){d>0&&(this.formatted+="||");const R=this.set[d];for(let p=0;p<R.length;p++)p>0&&(this.formatted+=" "),this.formatted+=R[p].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(d){const p=((this.options.includePrerelease&&I)|(this.options.loose&&$))+":"+d,g=s.get(p);if(g)return g;const m=this.options.loose,N=m?i[a.HYPHENRANGELOOSE]:i[a.HYPHENRANGE];d=d.replace(N,Tt(this.options.includePrerelease)),c("hyphen replace",d),d=d.replace(i[a.COMPARATORTRIM],u),c("comparator trim",d),d=d.replace(i[a.TILDETRIM],f),c("tilde trim",d),d=d.replace(i[a.CARETTRIM],T),c("caret trim",d);let S=d.split(" ").map(O=>H(O,this.options)).join(" ").split(/\s+/).map(O=>vt(O,this.options));m&&(S=S.filter(O=>(c("loose invalid filter",O,this.options),!!O.match(i[a.COMPARATORLOOSE])))),c("range list",S);const v=new Map,A=S.map(O=>new l(O,this.options));for(const O of A){if(C(O))return[O];v.set(O.value,O)}v.size>1&&v.has("")&&v.delete("");const D=[...v.values()];return s.set(p,D),D}intersects(d,R){if(!(d instanceof e))throw new TypeError("a Range is required");return this.set.some(p=>P(p,R)&&d.set.some(g=>P(g,R)&&p.every(m=>g.every(N=>m.intersects(N,R)))))}test(d){if(!d)return!1;if(typeof d=="string")try{d=new h(d,this.options)}catch{return!1}for(let R=0;R<this.set.length;R++)if(St(this.set[R],d,this.options))return!0;return!1}}ce=e;const t=ls,s=new t,n=Ie,l=ie(),c=se,h=_,{safeRe:i,t:a,comparatorTrimReplace:u,tildeTrimReplace:f,caretTrimReplace:T}=W,{FLAG_INCLUDE_PRERELEASE:I,FLAG_LOOSE:$}=re,C=E=>E.value==="<0.0.0-0",x=E=>E.value==="",P=(E,d)=>{let R=!0;const p=E.slice();let g=p.pop();for(;R&&p.length;)R=p.every(m=>g.intersects(m,d)),g=p.pop();return R},H=(E,d)=>(c("comp",E,d),E=It(E,d),c("caret",E),E=pt(E,d),c("tildes",E),E=Rt(E,d),c("xrange",E),E=Nt(E,d),c("stars",E),E),L=E=>!E||E.toLowerCase()==="x"||E==="*",pt=(E,d)=>E.trim().split(/\s+/).map(R=>mt(R,d)).join(" "),mt=(E,d)=>{const R=d.loose?i[a.TILDELOOSE]:i[a.TILDE];return E.replace(R,(p,g,m,N,S)=>{c("tilde",E,p,g,m,N,S);let v;return L(g)?v="":L(m)?v=`>=${g}.0.0 <${+g+1}.0.0-0`:L(N)?v=`>=${g}.${m}.0 <${g}.${+m+1}.0-0`:S?(c("replaceTilde pr",S),v=`>=${g}.${m}.${N}-${S} <${g}.${+m+1}.0-0`):v=`>=${g}.${m}.${N} <${g}.${+m+1}.0-0`,c("tilde return",v),v})},It=(E,d)=>E.trim().split(/\s+/).map(R=>$t(R,d)).join(" "),$t=(E,d)=>{c("caret",E,d);const R=d.loose?i[a.CARETLOOSE]:i[a.CARET],p=d.includePrerelease?"-0":"";return E.replace(R,(g,m,N,S,v)=>{c("caret",E,g,m,N,S,v);let A;return L(m)?A="":L(N)?A=`>=${m}.0.0${p} <${+m+1}.0.0-0`:L(S)?m==="0"?A=`>=${m}.${N}.0${p} <${m}.${+N+1}.0-0`:A=`>=${m}.${N}.0${p} <${+m+1}.0.0-0`:v?(c("replaceCaret pr",v),m==="0"?N==="0"?A=`>=${m}.${N}.${S}-${v} <${m}.${N}.${+S+1}-0`:A=`>=${m}.${N}.${S}-${v} <${m}.${+N+1}.0-0`:A=`>=${m}.${N}.${S}-${v} <${+m+1}.0.0-0`):(c("no pr"),m==="0"?N==="0"?A=`>=${m}.${N}.${S}${p} <${m}.${N}.${+S+1}-0`:A=`>=${m}.${N}.${S}${p} <${m}.${+N+1}.0-0`:A=`>=${m}.${N}.${S} <${+m+1}.0.0-0`),c("caret return",A),A})},Rt=(E,d)=>(c("replaceXRanges",E,d),E.split(/\s+/).map(R=>gt(R,d)).join(" ")),gt=(E,d)=>{E=E.trim();const R=d.loose?i[a.XRANGELOOSE]:i[a.XRANGE];return E.replace(R,(p,g,m,N,S,v)=>{c("xRange",E,p,g,m,N,S,v);const A=L(m),D=A||L(N),O=D||L(S),q=O;return g==="="&&q&&(g=""),v=d.includePrerelease?"-0":"",A?g===">"||g==="<"?p="<0.0.0-0":p="*":g&&q?(D&&(N=0),S=0,g===">"?(g=">=",D?(m=+m+1,N=0,S=0):(N=+N+1,S=0)):g==="<="&&(g="<",D?m=+m+1:N=+N+1),g==="<"&&(v="-0"),p=`${g+m}.${N}.${S}${v}`):D?p=`>=${m}.0.0${v} <${+m+1}.0.0-0`:O&&(p=`>=${m}.${N}.0${v} <${m}.${+N+1}.0-0`),c("xRange return",p),p})},Nt=(E,d)=>(c("replaceStars",E,d),E.trim().replace(i[a.STAR],"")),vt=(E,d)=>(c("replaceGTE0",E,d),E.trim().replace(i[d.includePrerelease?a.GTE0PRE:a.GTE0],"")),Tt=E=>(d,R,p,g,m,N,S,v,A,D,O,q)=>(L(p)?R="":L(g)?R=`>=${p}.0.0${E?"-0":""}`:L(m)?R=`>=${p}.${g}.0${E?"-0":""}`:N?R=`>=${R}`:R=`>=${R}${E?"-0":""}`,L(A)?v="":L(D)?v=`<${+A+1}.0.0-0`:L(O)?v=`<${A}.${+D+1}.0-0`:q?v=`<=${A}.${D}.${O}-${q}`:E?v=`<${A}.${D}.${+O+1}-0`:v=`<=${v}`,`${R} ${v}`.trim()),St=(E,d,R)=>{for(let p=0;p<E.length;p++)if(!E[p].test(d))return!1;if(d.prerelease.length&&!R.includePrerelease){for(let p=0;p<E.length;p++)if(c(E[p].semver),E[p].semver!==l.ANY&&E[p].semver.prerelease.length>0){const g=E[p].semver;if(g.major===d.major&&g.minor===d.minor&&g.patch===d.patch)return!0}return!1}return!0};return ce}var le,Me;function ie(){if(Me)return le;Me=1;const r=Symbol("SemVer ANY");class e{static get ANY(){return r}constructor(u,f){if(f=t(f),u instanceof e){if(u.loose===!!f.loose)return u;u=u.value}u=u.trim().split(/\s+/).join(" "),c("comparator",u,f),this.options=f,this.loose=!!f.loose,this.parse(u),this.semver===r?this.value="":this.value=this.operator+this.semver.version,c("comp",this)}parse(u){const f=this.options.loose?s[n.COMPARATORLOOSE]:s[n.COMPARATOR],T=u.match(f);if(!T)throw new TypeError(`Invalid comparator: ${u}`);this.operator=T[1]!==void 0?T[1]:"",this.operator==="="&&(this.operator=""),T[2]?this.semver=new h(T[2],this.options.loose):this.semver=r}toString(){return this.value}test(u){if(c("Comparator.test",u,this.options.loose),this.semver===r||u===r)return!0;if(typeof u=="string")try{u=new h(u,this.options)}catch{return!1}return l(u,this.operator,this.semver,this.options)}intersects(u,f){if(!(u instanceof e))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new i(u.value,f).test(this.value):u.operator===""?u.value===""?!0:new i(this.value,f).test(u.semver):(f=t(f),f.includePrerelease&&(this.value==="<0.0.0-0"||u.value==="<0.0.0-0")||!f.includePrerelease&&(this.value.startsWith("<0.0.0")||u.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&u.operator.startsWith(">")||this.operator.startsWith("<")&&u.operator.startsWith("<")||this.semver.version===u.semver.version&&this.operator.includes("=")&&u.operator.includes("=")||l(this.semver,"<",u.semver,f)&&this.operator.startsWith(">")&&u.operator.startsWith("<")||l(this.semver,">",u.semver,f)&&this.operator.startsWith("<")&&u.operator.startsWith(">")))}}le=e;const t=Ie,{safeRe:s,t:n}=W,l=ut,c=se,h=_,i=U();return le}const us=U(),ds=(r,e,t)=>{try{e=new us(e,t)}catch{return!1}return e.test(r)};var oe=ds;const hs=U(),fs=(r,e)=>new hs(r,e).set.map(t=>t.map(s=>s.value).join(" ").trim().split(" "));var Es=fs;const ps=_,ms=U(),Is=(r,e,t)=>{let s=null,n=null,l=null;try{l=new ms(e,t)}catch{return null}return r.forEach(c=>{l.test(c)&&(!s||n.compare(c)===-1)&&(s=c,n=new ps(s,t))}),s};var $s=Is;const Rs=_,gs=U(),Ns=(r,e,t)=>{let s=null,n=null,l=null;try{l=new gs(e,t)}catch{return null}return r.forEach(c=>{l.test(c)&&(!s||n.compare(c)===1)&&(s=c,n=new Rs(s,t))}),s};var vs=Ns;const ue=_,Ts=U(),ke=ne,Ss=(r,e)=>{r=new Ts(r,e);let t=new ue("0.0.0");if(r.test(t)||(t=new ue("0.0.0-0"),r.test(t)))return t;t=null;for(let s=0;s<r.set.length;++s){const n=r.set[s];let l=null;n.forEach(c=>{const h=new ue(c.semver.version);switch(c.operator){case">":h.prerelease.length===0?h.patch++:h.prerelease.push(0),h.raw=h.format();case"":case">=":(!l||ke(h,l))&&(l=h);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${c.operator}`)}}),l&&(!t||ke(t,l))&&(t=l)}return t&&r.test(t)?t:null};var As=Ss;const Ls=U(),Os=(r,e)=>{try{return new Ls(r,e).range||"*"}catch{return null}};var ws=Os;const xs=_,dt=ie(),{ANY:_s}=dt,Cs=U(),Ds=oe,Ve=ne,je=Re,Ps=Ne,ys=ge,Us=(r,e,t,s)=>{r=new xs(r,s),e=new Cs(e,s);let n,l,c,h,i;switch(t){case">":n=Ve,l=Ps,c=je,h=">",i=">=";break;case"<":n=je,l=ys,c=Ve,h="<",i="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(Ds(r,e,s))return!1;for(let a=0;a<e.set.length;++a){const u=e.set[a];let f=null,T=null;if(u.forEach(I=>{I.semver===_s&&(I=new dt(">=0.0.0")),f=f||I,T=T||I,n(I.semver,f.semver,s)?f=I:c(I.semver,T.semver,s)&&(T=I)}),f.operator===h||f.operator===i||(!T.operator||T.operator===h)&&l(r,T.semver))return!1;if(T.operator===i&&c(r,T.semver))return!1}return!0};var ve=Us;const bs=ve,Fs=(r,e,t)=>bs(r,e,">",t);var Bs=Fs;const Gs=ve,Ms=(r,e,t)=>Gs(r,e,"<",t);var ks=Ms;const Xe=U(),Vs=(r,e,t)=>(r=new Xe(r,t),e=new Xe(e,t),r.intersects(e,t));var js=Vs;const Xs=oe,Hs=y;var qs=(r,e,t)=>{const s=[];let n=null,l=null;const c=r.sort((u,f)=>Hs(u,f,t));for(const u of c)Xs(u,e,t)?(l=u,n||(n=u)):(l&&s.push([n,l]),l=null,n=null);n&&s.push([n,null]);const h=[];for(const[u,f]of s)u===f?h.push(u):!f&&u===c[0]?h.push("*"):f?u===c[0]?h.push(`<=${f}`):h.push(`${u} - ${f}`):h.push(`>=${u}`);const i=h.join(" || "),a=typeof e.raw=="string"?e.raw:String(e);return i.length<a.length?i:e};const He=U(),Te=ie(),{ANY:de}=Te,z=oe,Se=y,zs=(r,e,t={})=>{if(r===e)return!0;r=new He(r,t),e=new He(e,t);let s=!1;e:for(const n of r.set){for(const l of e.set){const c=Ws(n,l,t);if(s=s||c!==null,c)continue e}if(s)return!1}return!0},Ys=[new Te(">=0.0.0-0")],qe=[new Te(">=0.0.0")],Ws=(r,e,t)=>{if(r===e)return!0;if(r.length===1&&r[0].semver===de){if(e.length===1&&e[0].semver===de)return!0;t.includePrerelease?r=Ys:r=qe}if(e.length===1&&e[0].semver===de){if(t.includePrerelease)return!0;e=qe}const s=new Set;let n,l;for(const I of r)I.operator===">"||I.operator===">="?n=ze(n,I,t):I.operator==="<"||I.operator==="<="?l=Ye(l,I,t):s.add(I.semver);if(s.size>1)return null;let c;if(n&&l){if(c=Se(n.semver,l.semver,t),c>0)return null;if(c===0&&(n.operator!==">="||l.operator!=="<="))return null}for(const I of s){if(n&&!z(I,String(n),t)||l&&!z(I,String(l),t))return null;for(const $ of e)if(!z(I,String($),t))return!1;return!0}let h,i,a,u,f=l&&!t.includePrerelease&&l.semver.prerelease.length?l.semver:!1,T=n&&!t.includePrerelease&&n.semver.prerelease.length?n.semver:!1;f&&f.prerelease.length===1&&l.operator==="<"&&f.prerelease[0]===0&&(f=!1);for(const I of e){if(u=u||I.operator===">"||I.operator===">=",a=a||I.operator==="<"||I.operator==="<=",n){if(T&&I.semver.prerelease&&I.semver.prerelease.length&&I.semver.major===T.major&&I.semver.minor===T.minor&&I.semver.patch===T.patch&&(T=!1),I.operator===">"||I.operator===">="){if(h=ze(n,I,t),h===I&&h!==n)return!1}else if(n.operator===">="&&!z(n.semver,String(I),t))return!1}if(l){if(f&&I.semver.prerelease&&I.semver.prerelease.length&&I.semver.major===f.major&&I.semver.minor===f.minor&&I.semver.patch===f.patch&&(f=!1),I.operator==="<"||I.operator==="<="){if(i=Ye(l,I,t),i===I&&i!==l)return!1}else if(l.operator==="<="&&!z(l.semver,String(I),t))return!1}if(!I.operator&&(l||n)&&c!==0)return!1}return!(n&&a&&!l&&c!==0||l&&u&&!n&&c!==0||T||f)},ze=(r,e,t)=>{if(!r)return e;const s=Se(r.semver,e.semver,t);return s>0?r:s<0||e.operator===">"&&r.operator===">="?e:r},Ye=(r,e,t)=>{if(!r)return e;const s=Se(r.semver,e.semver,t);return s<0?r:s>0||e.operator==="<"&&r.operator==="<="?e:r};var Ks=zs;const he=W,We=re,Zs=_,Ke=at,Qs=X,Js=ir,en=cr,tn=ur,rn=hr,sn=pr,nn=$r,on=Nr,an=Sr,cn=y,ln=wr,un=Cr,dn=$e,hn=Ur,fn=Br,En=ne,pn=Re,mn=ct,In=lt,$n=ge,Rn=Ne,gn=ut,Nn=as,vn=ie(),Tn=U(),Sn=oe,An=Es,Ln=$s,On=vs,wn=As,xn=ws,_n=ve,Cn=Bs,Dn=ks,Pn=js,yn=qs,Un=Ks;var bn={parse:Qs,valid:Js,clean:en,inc:tn,diff:rn,major:sn,minor:nn,patch:on,prerelease:an,compare:cn,rcompare:ln,compareLoose:un,compareBuild:dn,sort:hn,rsort:fn,gt:En,lt:pn,eq:mn,neq:In,gte:$n,lte:Rn,cmp:gn,coerce:Nn,Comparator:vn,Range:Tn,satisfies:Sn,toComparators:An,maxSatisfying:Ln,minSatisfying:On,minVersion:wn,validRange:xn,outside:_n,gtr:Cn,ltr:Dn,intersects:Pn,simplifyRange:yn,subset:Un,SemVer:Zs,re:he.re,src:he.src,tokens:he.t,SEMVER_SPEC_VERSION:We.SEMVER_SPEC_VERSION,RELEASE_TYPES:We.RELEASE_TYPES,compareIdentifiers:Ke.compareIdentifiers,rcompareIdentifiers:Ke.rcompareIdentifiers};const Ze=Lt(bn);var w;(function(r){r.blue="blue",r.nanoS="nanoS",r.nanoSP="nanoSP",r.nanoX="nanoX",r.stax="stax",r.europa="europa"})(w||(w={}));const Ee={[w.blue]:{id:w.blue,productName:"Ledger Blue",productIdMM:0,legacyUsbProductId:0,usbOnly:!0,memorySize:480*1024,masks:[822083584,822149120],getBlockSize:r=>4*1024},[w.nanoS]:{id:w.nanoS,productName:"Ledger Nano S",productIdMM:16,legacyUsbProductId:1,usbOnly:!0,memorySize:320*1024,masks:[823132160],getBlockSize:r=>{var e;return Ze.lt((e=Ze.coerce(r))!==null&&e!==void 0?e:"","2.0.0")?4*1024:2*1024}},[w.nanoX]:{id:w.nanoX,productName:"Ledger Nano X",productIdMM:64,legacyUsbProductId:4,usbOnly:!1,memorySize:2*1024*1024,masks:[855638016],getBlockSize:r=>4*1024,bluetoothSpec:[{serviceUuid:"13d63400-2c97-0004-0000-4c6564676572",notifyUuid:"13d63400-2c97-0004-0001-4c6564676572",writeUuid:"13d63400-2c97-0004-0002-4c6564676572",writeCmdUuid:"13d63400-2c97-0004-0003-4c6564676572"}]},[w.nanoSP]:{id:w.nanoSP,productName:"Ledger Nano S Plus",productIdMM:80,legacyUsbProductId:5,usbOnly:!0,memorySize:1533*1024,masks:[856686592],getBlockSize:r=>32},[w.stax]:{id:w.stax,productName:"Ledger Stax",productIdMM:96,legacyUsbProductId:6,usbOnly:!1,memorySize:1533*1024,masks:[857735168],getBlockSize:r=>32,bluetoothSpec:[{serviceUuid:"13d63400-2c97-6004-0000-4c6564676572",notifyUuid:"13d63400-2c97-6004-0001-4c6564676572",writeUuid:"13d63400-2c97-6004-0002-4c6564676572",writeCmdUuid:"13d63400-2c97-6004-0003-4c6564676572"}]},[w.europa]:{id:w.europa,productName:"Ledger Flex",productIdMM:112,legacyUsbProductId:7,usbOnly:!1,memorySize:1533*1024,masks:[858783744],getBlockSize:r=>32,bluetoothSpec:[{serviceUuid:"13d63400-2c97-3004-0000-4c6564676572",notifyUuid:"13d63400-2c97-3004-0001-4c6564676572",writeUuid:"13d63400-2c97-3004-0002-4c6564676572",writeCmdUuid:"13d63400-2c97-3004-0003-4c6564676572"}]}};w.blue,w.nanoS,w.nanoSP,w.nanoX,w.stax,w.europa;const Qe=Object.values(Ee),ht=11415,ft=r=>{const e=Qe.find(n=>n.legacyUsbProductId===r);if(e)return e;const t=r>>8;return Qe.find(n=>n.productIdMM===t)},Fn=[],Je={};for(const r in Ee){const e=Ee[r],{bluetoothSpec:t}=e;if(t)for(let s=0;s<t.length;s++){const n=t[s];Fn.push(n.serviceUuid),Je[n.serviceUuid]=Je[n.serviceUuid.replace(/-/g,"")]=Object.assign({deviceModel:e},n)}}var F=function(r,e,t,s){function n(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function h(u){try{a(s.next(u))}catch(f){c(f)}}function i(u){try{a(s.throw(u))}catch(f){c(f)}}function a(u){u.done?l(u.value):n(u.value).then(h,i)}a((s=s.apply(r,e||[])).next())})};const Bn=[{vendorId:ht}],Gn=()=>Promise.resolve(!!(window.navigator&&window.navigator.hid)),te=()=>{const{hid:r}=navigator;if(!r)throw new B("navigator.hid is not supported","HIDNotSupported");return r};function Et(){return F(this,void 0,void 0,function*(){const r=yield te().requestDevice({filters:Bn});return Array.isArray(r)?r:[r]})}function Ae(){return F(this,void 0,void 0,function*(){return(yield te().getDevices()).filter(e=>e.vendorId===ht)})}function Mn(){return F(this,void 0,void 0,function*(){const r=yield Ae();return r.length>0?r[0]:(yield Et())[0]})}class M extends me{constructor(e){super(),this.channel=Math.floor(Math.random()*65535),this.packetSize=64,this.inputs=[],this.read=()=>this.inputs.length?Promise.resolve(this.inputs.shift()):new Promise(t=>{this.inputCallback=t}),this.onInputReport=t=>{const s=Buffer.from(t.data.buffer);this.inputCallback?(this.inputCallback(s),this.inputCallback=null):this.inputs.push(s)},this._disconnectEmitted=!1,this._emitDisconnect=t=>{this._disconnectEmitted||(this._disconnectEmitted=!0,this.emit("disconnect",t))},this.exchange=t=>F(this,void 0,void 0,function*(){return yield this.exchangeAtomicImpl(()=>F(this,void 0,void 0,function*(){const{channel:n,packetSize:l}=this;we("apdu","=> "+t.toString("hex"));const c=jt(n,l),h=c.makeBlocks(t);for(let u=0;u<h.length;u++)yield this.device.sendReport(0,h[u]);let i,a;for(;!(i=c.getReducedResult(a));){const u=yield this.read();a=c.reduceResponse(a,u)}return we("apdu","<= "+i.toString("hex")),i})).catch(n=>{throw n&&n.message&&n.message.includes("write")?(this._emitDisconnect(n),new Ut(n.message)):n})}),this.device=e,this.deviceModel=typeof e.productId=="number"?ft(e.productId):void 0,e.addEventListener("inputreport",this.onInputReport)}static request(){return F(this,void 0,void 0,function*(){const[e]=yield Et();return M.open(e)})}static openConnected(){return F(this,void 0,void 0,function*(){const e=yield Ae();return e.length===0?null:M.open(e[0])})}static open(e){return F(this,void 0,void 0,function*(){yield e.open();const t=new M(e),s=n=>{e===n.device&&(te().removeEventListener("disconnect",s),t._emitDisconnect(new yt))};return te().addEventListener("disconnect",s),t})}close(){return F(this,void 0,void 0,function*(){yield this.exchangeBusyPromise,this.device.removeEventListener("inputreport",this.onInputReport),yield this.device.close()})}setScrambleKey(){}}M.isSupported=Gn;M.list=Ae;M.listen=r=>{let e=!1;Mn().then(s=>{if(!s)r.error(new Le("Access denied to use Ledger device"));else if(!e){const n=typeof s.productId=="number"?ft(s.productId):void 0;r.next({type:"add",descriptor:s,deviceModel:n}),r.complete()}},s=>{r.error(new Le(s.message))});function t(){e=!0}return{unsubscribe:t}};const et=r=>new Promise((e,t)=>{setTimeout(()=>{t(new Error("timed out"))},r)}),tt=3e5,jn=async(r,e={derivationType:_t.ED25519})=>{const t=await Promise.race([M.create(),et(tt)]);try{const s=await Ot(r),{accountId:n,tezos:l,isActivated:c}=await Promise.race([await xt(s,t,e),et(tt)]),h={id:n,isActivated:c,type:"ledger",network:r.id.toString(),explorer:s.explorer,rpc:s.rpc,balance:0n,stakedBalance:0n,fullBalance:0n},i=l;return i.signOperation=async f=>({signature:(await l.signer.sign(f,new Uint8Array([3]))).sbytes.slice(f.length)}),{...await wt(h,i),logout:async()=>{t.close()}}}catch(s){throw t.close(),s}};export{jn as createLedgerSession};
