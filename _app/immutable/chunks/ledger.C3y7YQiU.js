import{aY as Ht,g as qt,aZ as zt,a_ as kt}from"./Input.L2BHlfpG.js";import{c as Yt,D as Wt}from"./0.CAuLDmnP.js";const Kt={},Zt={},Rt=(r,e)=>{Zt[r]=e},a=r=>{class e extends Error{constructor(n,s,i){if(super(n||r,i),Object.setPrototypeOf(this,e.prototype),this.name=r,s)for(const l in s)this[l]=s[l];if(i&&Qt(i)&&"cause"in i&&!("cause"in this)){const l=i.cause;this.cause=l,"stack"in l&&(this.stack=this.stack+`
CAUSE: `+l.stack)}}}return Kt[r]=e,e};function Qt(r){return typeof r=="object"}a("AccountNameRequired");a("AccountNotSupported");a("AmountRequired");a("BluetoothRequired");a("BtcUnmatchedApp");a("CantOpenDevice");a("CashAddrNotSupported");a("ClaimRewardsFeesWarning");a("CurrencyNotSupported");a("DeviceAppVerifyNotSupported");a("DeviceGenuineSocketEarlyClose");a("DeviceNotGenuine");a("DeviceOnDashboardExpected");a("DeviceOnDashboardUnexpected");a("DeviceInOSUExpected");a("DeviceHalted");a("DeviceNameInvalid");a("DeviceSocketFail");a("DeviceSocketNoBulkStatus");a("DeviceSocketNoBulkStatus");a("UnresponsiveDeviceError");const Jt=a("DisconnectedDevice"),er=a("DisconnectedDeviceDuringOperation");a("DeviceExtractOnboardingStateError");a("DeviceOnboardingStatePollingError");a("EnpointConfig");a("EthAppPleaseEnableContractData");a("FeeEstimationFailed");a("FirmwareNotRecognized");a("HardResetFail");a("InvalidXRPTag");a("InvalidAddress");a("InvalidNonce");a("InvalidAddressBecauseDestinationIsAlsoSource");a("LatestMCUInstalledError");a("UnknownMCU");a("LedgerAPIError");a("LedgerAPIErrorWithMessage");a("LedgerAPINotAvailable");a("ManagerAppAlreadyInstalled");a("ManagerAppRelyOnBTC");a("ManagerAppDepInstallRequired");a("ManagerAppDepUninstallRequired");a("ManagerDeviceLocked");a("ManagerFirmwareNotEnoughSpace");a("ManagerNotEnoughSpace");a("ManagerUninstallBTCDep");a("NetworkDown");a("NetworkError");a("NoAddressesFound");a("NotEnoughBalance");a("NotEnoughBalanceToDelegate");a("NotEnoughBalanceInParentAccount");a("NotEnoughSpendableBalance");a("NotEnoughBalanceBecauseDestinationNotCreated");a("NoAccessToCamera");a("NotEnoughGas");a("NotEnoughGasSwap");a("NotSupportedLegacyAddress");a("GasLessThanEstimate");a("PriorityFeeTooLow");a("PriorityFeeTooHigh");a("PriorityFeeHigherThanMaxFee");a("MaxFeeTooLow");a("PasswordsDontMatch");a("PasswordIncorrect");a("RecommendSubAccountsToEmpty");a("RecommendUndelegation");a("TimeoutTagged");a("UnexpectedBootloader");a("MCUNotGenuineToDashboard");a("RecipientRequired");a("UnavailableTezosOriginatedAccountReceive");a("UnavailableTezosOriginatedAccountSend");a("UpdateFetchFileFail");a("UpdateIncorrectHash");a("UpdateIncorrectSig");a("UpdateYourApp");a("UserRefusedDeviceNameChange");a("UserRefusedAddress");a("UserRefusedFirmwareUpdate");a("UserRefusedAllowManager");a("UserRefusedOnDevice");a("ExpertModeRequired");const Ve=a("TransportOpenUserCancelled");a("TransportInterfaceNotAvailable");const tr=a("TransportPendingOperation");a("TransportWebUSBGestureRequired");a("TransactionHasBeenValidatedError");a("TransportExchangeTimeoutError");a("DeviceShouldStayInApp");a("WebsocketConnectionError");a("WebsocketConnectionFailed");a("WrongDeviceForAccount");a("WrongDeviceForAccountPayout");a("WrongDeviceForAccountRefund");a("WrongAppForCurrency");a("ETHAddressNonEIP");a("CantScanQRCode");a("FeeNotLoaded");a("FeeNotLoadedSwap");a("FeeRequired");a("FeeTooHigh");a("PendingOperation");a("SyncError");a("PairingFailed");a("PeerRemovedPairing");a("GenuineCheckFailed");a("LedgerAPI4xx");a("LedgerAPI5xx");a("FirmwareOrAppUpdateRequired");a("ReplacementTransactionUnderpriced");a("OpReturnSizeLimit");a("DustLimit");a("LanguageNotFound");a("NoDBPathGiven");a("DBWrongPassword");a("DBNotReset");a("SequenceNumberError");a("DisabledTransactionBroadcastError");var Xe;(function(r){r.Unknown="Unknown",r.LocationServicesDisabled="LocationServicesDisabled",r.LocationServicesUnauthorized="LocationServicesUnauthorized",r.BluetoothScanStartFailed="BluetoothScanStartFailed"})(Xe||(Xe={}));class j extends Error{constructor(e,t){const n="TransportError";super(e||n),this.name=n,this.message=e,this.stack=new Error(e).stack,this.id=t}}Rt("TransportError",r=>new j(r.message,r.id));const Q={ACCESS_CONDITION_NOT_FULFILLED:38916,ALGORITHM_NOT_SUPPORTED:38020,CLA_NOT_SUPPORTED:28160,CODE_BLOCKED:38976,CODE_NOT_INITIALIZED:38914,COMMAND_INCOMPATIBLE_FILE_STRUCTURE:27009,CONDITIONS_OF_USE_NOT_SATISFIED:27013,CONTRADICTION_INVALIDATION:38928,CONTRADICTION_SECRET_CODE_STATUS:38920,CUSTOM_IMAGE_BOOTLOADER:26159,CUSTOM_IMAGE_EMPTY:26158,FILE_ALREADY_EXISTS:27273,FILE_NOT_FOUND:37892,GP_AUTH_FAILED:25344,HALTED:28586,INCONSISTENT_FILE:37896,INCORRECT_DATA:27264,INCORRECT_LENGTH:26368,INCORRECT_P1_P2:27392,INS_NOT_SUPPORTED:27904,DEVICE_NOT_ONBOARDED:27911,DEVICE_NOT_ONBOARDED_2:26129,INVALID_KCV:38021,INVALID_OFFSET:37890,LICENSING:28482,LOCKED_DEVICE:21781,MAX_VALUE_REACHED:38992,MEMORY_PROBLEM:37440,MISSING_CRITICAL_PARAMETER:26624,NO_EF_SELECTED:37888,NOT_ENOUGH_MEMORY_SPACE:27268,OK:36864,PIN_REMAINING_ATTEMPTS:25536,REFERENCED_DATA_NOT_FOUND:27272,SECURITY_STATUS_NOT_SATISFIED:27010,TECHNICAL_PROBLEM:28416,UNKNOWN_APDU:27906,USER_REFUSED_ON_DEVICE:21761,NOT_ENOUGH_SPACE:20738};function rr(r){switch(r){case 26368:return"Incorrect length";case 26624:return"Missing critical parameter";case 27010:return"Security not satisfied (dongle locked or have invalid access rights)";case 27013:return"Condition of use not satisfied (denied by the user?)";case 27264:return"Invalid data received";case 27392:return"Invalid parameter received";case 21781:return"Locked device"}if(28416<=r&&r<=28671)return"Internal error, please report"}class ee extends Error{constructor(e,{canBeMappedToChildError:t=!0}={}){const n=Object.keys(Q).find(u=>Q[u]===e)||"UNKNOWN_ERROR",s=rr(e)||n,i=e.toString(16),l=`Ledger device: ${s} (0x${i})`;if(super(l),this.name="TransportStatusError",this.statusCode=e,this.statusText=n,Object.setPrototypeOf(this,ee.prototype),t&&e===Q.LOCKED_DEVICE)return new De(l)}}class De extends ee{constructor(e){super(Q.LOCKED_DEVICE,{canBeMappedToChildError:!1}),e&&(this.message=e),this.name="LockedDeviceError",Object.setPrototypeOf(this,De.prototype)}}Rt("TransportStatusError",r=>new ee(r.statusCode));let St=0;const X=[],He=(r,e,t)=>{const n={type:r,id:String(++St),date:new Date};e&&(n.message=e),Nt(n)},nr=({type:r,message:e,data:t,context:n})=>{const s={type:r,id:String(++St),date:new Date};e&&(s.message=e),t&&(s.data=t),n&&(s.context=n),Nt(s)};class ie{constructor(e,t){this.type=e,this.context=t}trace(e,t){nr({type:this.type,message:e,data:t,context:this.context})}getContext(){return this.context}setContext(e){this.context=e}updateContext(e){this.context=Object.assign(Object.assign({},this.context),e)}getType(){return this.type}setType(e){this.type=e}withType(e){return new ie(e,this.context)}withContext(e){return new ie(this.type,e)}withUpdatedContext(e){return new ie(this.type,Object.assign(Object.assign({},this.context),e))}}const sr=r=>(X.push(r),()=>{const e=X.indexOf(r);e!==-1&&(X[e]=X[X.length-1],X.pop())});function Nt(r){for(let e=0;e<X.length;e++)try{X[e](r)}catch(t){console.error(t)}}typeof window<"u"&&(window.__ledgerLogsListen=sr);var ce=function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(l){l(i)})}return new(t||(t=Promise))(function(i,l){function u(h){try{c(n.next(h))}catch(d){l(d)}}function o(h){try{c(n.throw(h))}catch(d){l(d)}}function c(h){h.done?i(h.value):s(h.value).then(u,o)}c((n=n.apply(r,e||[])).next())})};const ir="transport";class Ce{constructor({context:e,logType:t}={}){this.exchangeTimeout=3e4,this.unresponsiveTimeout=15e3,this.deviceModel=null,this._events=new Ht,this.send=(n,s,i,l,u=Buffer.alloc(0),o=[Q.OK],{abortTimeoutMs:c}={})=>ce(this,void 0,void 0,function*(){const h=this.tracer.withUpdatedContext({function:"send"});if(u.length>=256)throw h.trace("data.length exceeded 256 bytes limit",{dataLength:u.length}),new j("data.length exceed 256 bytes limit. Got: "+u.length,"DataLengthTooBig");h.trace("Starting an exchange",{abortTimeoutMs:c});const d=yield this.exchange(Buffer.concat([Buffer.from([n,s,i,l]),Buffer.from([u.length]),u]),{abortTimeoutMs:c});h.trace("Received response from exchange");const T=d.readUInt16BE(d.length-2);if(!o.some(m=>m===T))throw new ee(T);return d}),this._appAPIlock=null,this.tracer=new ie(t??ir,e)}exchange(e,{abortTimeoutMs:t}={}){throw new Error("exchange not implemented")}exchangeBulk(e,t){let n=!1;const s=()=>{n=!0};return ce(this,void 0,void 0,function*(){if(!n)for(const l of e){const u=yield this.exchange(l);if(n)return;const o=u.readUInt16BE(u.length-2);if(o!==Q.OK)throw new ee(o);t.next(u)}}).then(()=>!n&&t.complete(),l=>!n&&t.error(l)),{unsubscribe:s}}setScrambleKey(e){}close(){return Promise.resolve()}on(e,t){this._events.on(e,t)}off(e,t){this._events.removeListener(e,t)}emit(e,...t){this._events.emit(e,...t)}setDebugMode(){console.warn("setDebugMode is deprecated. use @ledgerhq/logs instead. No logs are emitted in this anymore.")}setExchangeTimeout(e){this.exchangeTimeout=e}setExchangeUnresponsiveTimeout(e){this.unresponsiveTimeout=e}static create(e=3e3,t){return new Promise((n,s)=>{let i=!1;const l=this.listen({next:o=>{i=!0,l&&l.unsubscribe(),u&&clearTimeout(u),this.open(o.descriptor,e).then(n,s)},error:o=>{u&&clearTimeout(u),s(o)},complete:()=>{u&&clearTimeout(u),i||s(new j(this.ErrorMessage_NoDeviceFound,"NoDeviceFound"))}}),u=t?setTimeout(()=>{l.unsubscribe(),s(new j(this.ErrorMessage_ListenTimeout,"ListenTimeout"))},t):null})}exchangeAtomicImpl(e){return ce(this,void 0,void 0,function*(){const t=this.tracer.withUpdatedContext({function:"exchangeAtomicImpl",unresponsiveTimeout:this.unresponsiveTimeout});if(this.exchangeBusyPromise)throw t.trace("Atomic exchange is already busy"),new tr("An action was already pending on the Ledger device. Please deny or reconnect.");let n;const s=new Promise(u=>{n=u});this.exchangeBusyPromise=s;let i=!1;const l=setTimeout(()=>{t.trace('Timeout reached, emitting Transport event "unresponsive"',{unresponsiveTimeout:this.unresponsiveTimeout}),i=!0,this.emit("unresponsive")},this.unresponsiveTimeout);try{const u=yield e();return i&&(t.trace("Device was unresponsive, emitting responsive"),this.emit("responsive")),u}finally{t.trace("Finalize, clearing busy guard"),clearTimeout(l),n&&n(),this.exchangeBusyPromise=null}})}decorateAppAPIMethods(e,t,n){for(const s of t)e[s]=this.decorateAppAPIMethod(s,e[s],e,n)}decorateAppAPIMethod(e,t,n,s){return(...i)=>ce(this,void 0,void 0,function*(){const{_appAPIlock:l}=this;if(l)return Promise.reject(new j("Ledger Device is busy (lock "+l+")","TransportLocked"));try{return this._appAPIlock=e,this.setScrambleKey(s),yield t.apply(n,i)}finally{this._appAPIlock=null}})}setTraceContext(e){this.tracer=this.tracer.withContext(e)}updateTraceContext(e){this.tracer.updateContext(e)}getTraceContext(){return this.tracer.getContext()}}Ce.ErrorMessage_ListenTimeout="No Ledger device found (timeout)";Ce.ErrorMessage_NoDeviceFound="No Ledger device found";const qe=5;function or(r){const e=Buffer.alloc(2);return e.writeUInt16BE(r,0),e}const ar={data:Buffer.alloc(0),dataLength:0,sequence:0},cr=(r,e)=>({makeBlocks(t){let n=Buffer.concat([or(t.length),t]);const s=e-5,i=Math.ceil(n.length/s);n=Buffer.concat([n,Buffer.alloc(i*s-n.length+1).fill(0)]);const l=[];for(let u=0;u<i;u++){const o=Buffer.alloc(5);o.writeUInt16BE(r,0),o.writeUInt8(qe,2),o.writeUInt16BE(u,3);const c=n.slice(u*s,(u+1)*s);l.push(Buffer.concat([o,c]))}return l},reduceResponse(t,n){let{data:s,dataLength:i,sequence:l}=t||ar;if(n.readUInt16BE(0)!==r)throw new j("Invalid channel","InvalidChannel");if(n.readUInt8(2)!==qe)throw new j("Invalid tag","InvalidTag");if(n.readUInt16BE(3)!==l)throw new j("Invalid sequence","InvalidSequence");t||(i=n.readUInt16BE(5)),l++;const u=n.slice(t?5:7);return s=Buffer.concat([s,u]),s.length>i&&(s=s.slice(0,i)),{data:s,dataLength:i,sequence:l}},getReducedResult(t){if(t&&t.dataLength===t.data.length)return t.data}});var xe={exports:{}};const lr="2.0.0",Tt=256,ur=Number.MAX_SAFE_INTEGER||9007199254740991,hr=16,fr=Tt-6,dr=["major","premajor","minor","preminor","patch","prepatch","prerelease"];var Ee={MAX_LENGTH:Tt,MAX_SAFE_COMPONENT_LENGTH:hr,MAX_SAFE_BUILD_LENGTH:fr,MAX_SAFE_INTEGER:ur,RELEASE_TYPES:dr,SEMVER_SPEC_VERSION:lr,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},$e={};const pr=typeof process=="object"&&$e&&$e.NODE_DEBUG&&/\bsemver\b/i.test($e.NODE_DEBUG)?(...r)=>console.error("SEMVER",...r):()=>{};var me=pr;(function(r,e){const{MAX_SAFE_COMPONENT_LENGTH:t,MAX_SAFE_BUILD_LENGTH:n,MAX_LENGTH:s}=Ee,i=me;e=r.exports={};const l=e.re=[],u=e.safeRe=[],o=e.src=[],c=e.t={};let h=0;const d="[a-zA-Z0-9-]",T=[["\\s",1],["\\d",s],[d,n]],m=V=>{for(const[_,q]of T)V=V.split(`${_}*`).join(`${_}{0,${q}}`).split(`${_}+`).join(`${_}{1,${q}}`);return V},v=(V,_,q)=>{const w=m(_),z=h++;i(V,z,_),c[V]=z,o[z]=_,l[z]=new RegExp(_,q?"g":void 0),u[z]=new RegExp(w,q?"g":void 0)};v("NUMERICIDENTIFIER","0|[1-9]\\d*"),v("NUMERICIDENTIFIERLOOSE","\\d+"),v("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${d}*`),v("MAINVERSION",`(${o[c.NUMERICIDENTIFIER]})\\.(${o[c.NUMERICIDENTIFIER]})\\.(${o[c.NUMERICIDENTIFIER]})`),v("MAINVERSIONLOOSE",`(${o[c.NUMERICIDENTIFIERLOOSE]})\\.(${o[c.NUMERICIDENTIFIERLOOSE]})\\.(${o[c.NUMERICIDENTIFIERLOOSE]})`),v("PRERELEASEIDENTIFIER",`(?:${o[c.NUMERICIDENTIFIER]}|${o[c.NONNUMERICIDENTIFIER]})`),v("PRERELEASEIDENTIFIERLOOSE",`(?:${o[c.NUMERICIDENTIFIERLOOSE]}|${o[c.NONNUMERICIDENTIFIER]})`),v("PRERELEASE",`(?:-(${o[c.PRERELEASEIDENTIFIER]}(?:\\.${o[c.PRERELEASEIDENTIFIER]})*))`),v("PRERELEASELOOSE",`(?:-?(${o[c.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${o[c.PRERELEASEIDENTIFIERLOOSE]})*))`),v("BUILDIDENTIFIER",`${d}+`),v("BUILD",`(?:\\+(${o[c.BUILDIDENTIFIER]}(?:\\.${o[c.BUILDIDENTIFIER]})*))`),v("FULLPLAIN",`v?${o[c.MAINVERSION]}${o[c.PRERELEASE]}?${o[c.BUILD]}?`),v("FULL",`^${o[c.FULLPLAIN]}$`),v("LOOSEPLAIN",`[v=\\s]*${o[c.MAINVERSIONLOOSE]}${o[c.PRERELEASELOOSE]}?${o[c.BUILD]}?`),v("LOOSE",`^${o[c.LOOSEPLAIN]}$`),v("GTLT","((?:<|>)?=?)"),v("XRANGEIDENTIFIERLOOSE",`${o[c.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),v("XRANGEIDENTIFIER",`${o[c.NUMERICIDENTIFIER]}|x|X|\\*`),v("XRANGEPLAIN",`[v=\\s]*(${o[c.XRANGEIDENTIFIER]})(?:\\.(${o[c.XRANGEIDENTIFIER]})(?:\\.(${o[c.XRANGEIDENTIFIER]})(?:${o[c.PRERELEASE]})?${o[c.BUILD]}?)?)?`),v("XRANGEPLAINLOOSE",`[v=\\s]*(${o[c.XRANGEIDENTIFIERLOOSE]})(?:\\.(${o[c.XRANGEIDENTIFIERLOOSE]})(?:\\.(${o[c.XRANGEIDENTIFIERLOOSE]})(?:${o[c.PRERELEASELOOSE]})?${o[c.BUILD]}?)?)?`),v("XRANGE",`^${o[c.GTLT]}\\s*${o[c.XRANGEPLAIN]}$`),v("XRANGELOOSE",`^${o[c.GTLT]}\\s*${o[c.XRANGEPLAINLOOSE]}$`),v("COERCEPLAIN",`(^|[^\\d])(\\d{1,${t}})(?:\\.(\\d{1,${t}}))?(?:\\.(\\d{1,${t}}))?`),v("COERCE",`${o[c.COERCEPLAIN]}(?:$|[^\\d])`),v("COERCEFULL",o[c.COERCEPLAIN]+`(?:${o[c.PRERELEASE]})?(?:${o[c.BUILD]})?(?:$|[^\\d])`),v("COERCERTL",o[c.COERCE],!0),v("COERCERTLFULL",o[c.COERCEFULL],!0),v("LONETILDE","(?:~>?)"),v("TILDETRIM",`(\\s*)${o[c.LONETILDE]}\\s+`,!0),e.tildeTrimReplace="$1~",v("TILDE",`^${o[c.LONETILDE]}${o[c.XRANGEPLAIN]}$`),v("TILDELOOSE",`^${o[c.LONETILDE]}${o[c.XRANGEPLAINLOOSE]}$`),v("LONECARET","(?:\\^)"),v("CARETTRIM",`(\\s*)${o[c.LONECARET]}\\s+`,!0),e.caretTrimReplace="$1^",v("CARET",`^${o[c.LONECARET]}${o[c.XRANGEPLAIN]}$`),v("CARETLOOSE",`^${o[c.LONECARET]}${o[c.XRANGEPLAINLOOSE]}$`),v("COMPARATORLOOSE",`^${o[c.GTLT]}\\s*(${o[c.LOOSEPLAIN]})$|^$`),v("COMPARATOR",`^${o[c.GTLT]}\\s*(${o[c.FULLPLAIN]})$|^$`),v("COMPARATORTRIM",`(\\s*)${o[c.GTLT]}\\s*(${o[c.LOOSEPLAIN]}|${o[c.XRANGEPLAIN]})`,!0),e.comparatorTrimReplace="$1$2$3",v("HYPHENRANGE",`^\\s*(${o[c.XRANGEPLAIN]})\\s+-\\s+(${o[c.XRANGEPLAIN]})\\s*$`),v("HYPHENRANGELOOSE",`^\\s*(${o[c.XRANGEPLAINLOOSE]})\\s+-\\s+(${o[c.XRANGEPLAINLOOSE]})\\s*$`),v("STAR","(<|>)?=?\\s*\\*"),v("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),v("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")})(xe,xe.exports);var ae=xe.exports;const Er=Object.freeze({loose:!0}),mr=Object.freeze({}),vr=r=>r?typeof r!="object"?Er:r:mr;var _e=vr;const ze=/^[0-9]+$/,Ot=(r,e)=>{const t=ze.test(r),n=ze.test(e);return t&&n&&(r=+r,e=+e),r===e?0:t&&!n?-1:n&&!t?1:r<e?-1:1},gr=(r,e)=>Ot(e,r);var At={compareIdentifiers:Ot,rcompareIdentifiers:gr};const le=me,{MAX_LENGTH:ke,MAX_SAFE_INTEGER:ue}=Ee,{safeRe:Ye,t:We}=ae,Ir=_e,{compareIdentifiers:K}=At;let $r=class F{constructor(e,t){if(t=Ir(t),e instanceof F){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>ke)throw new TypeError(`version is longer than ${ke} characters`);le("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const n=e.trim().match(t.loose?Ye[We.LOOSE]:Ye[We.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>ue||this.major<0)throw new TypeError("Invalid major version");if(this.minor>ue||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>ue||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(s=>{if(/^[0-9]+$/.test(s)){const i=+s;if(i>=0&&i<ue)return i}return s}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(le("SemVer.compare",this.version,this.options,e),!(e instanceof F)){if(typeof e=="string"&&e===this.version)return 0;e=new F(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof F||(e=new F(e,this.options)),K(this.major,e.major)||K(this.minor,e.minor)||K(this.patch,e.patch)}comparePre(e){if(e instanceof F||(e=new F(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const n=this.prerelease[t],s=e.prerelease[t];if(le("prerelease compare",t,n,s),n===void 0&&s===void 0)return 0;if(s===void 0)return 1;if(n===void 0)return-1;if(n===s)continue;return K(n,s)}while(++t)}compareBuild(e){e instanceof F||(e=new F(e,this.options));let t=0;do{const n=this.build[t],s=e.build[t];if(le("prerelease compare",t,n,s),n===void 0&&s===void 0)return 0;if(s===void 0)return 1;if(n===void 0)return-1;if(n===s)continue;return K(n,s)}while(++t)}inc(e,t,n){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,n),this.inc("pre",t,n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",t,n),this.inc("pre",t,n);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const s=Number(n)?1:0;if(!t&&n===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[s];else{let i=this.prerelease.length;for(;--i>=0;)typeof this.prerelease[i]=="number"&&(this.prerelease[i]++,i=-2);if(i===-1){if(t===this.prerelease.join(".")&&n===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(s)}}if(t){let i=[t,s];n===!1&&(i=[t]),K(this.prerelease[0],t)===0?isNaN(this.prerelease[1])&&(this.prerelease=i):this.prerelease=i}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};var D=$r;const Ke=D,Rr=(r,e,t=!1)=>{if(r instanceof Ke)return r;try{return new Ke(r,e)}catch(n){if(!t)return null;throw n}};var te=Rr;const Sr=te,Nr=(r,e)=>{const t=Sr(r,e);return t?t.version:null};var Tr=Nr;const Or=te,Ar=(r,e)=>{const t=Or(r.trim().replace(/^[=v]+/,""),e);return t?t.version:null};var Lr=Ar;const Ze=D,yr=(r,e,t,n,s)=>{typeof t=="string"&&(s=n,n=t,t=void 0);try{return new Ze(r instanceof Ze?r.version:r,t).inc(e,n,s).version}catch{return null}};var xr=yr;const Qe=te,wr=(r,e)=>{const t=Qe(r,null,!0),n=Qe(e,null,!0),s=t.compare(n);if(s===0)return null;const i=s>0,l=i?t:n,u=i?n:t,o=!!l.prerelease.length;if(!!u.prerelease.length&&!o)return!u.patch&&!u.minor?"major":l.patch?"patch":l.minor?"minor":"major";const h=o?"pre":"";return t.major!==n.major?h+"major":t.minor!==n.minor?h+"minor":t.patch!==n.patch?h+"patch":"prerelease"};var Dr=wr;const Cr=D,_r=(r,e)=>new Cr(r,e).major;var Pr=_r;const br=D,Ur=(r,e)=>new br(r,e).minor;var Fr=Ur;const Gr=D,Br=(r,e)=>new Gr(r,e).patch;var Mr=Br;const jr=te,Vr=(r,e)=>{const t=jr(r,e);return t&&t.prerelease.length?t.prerelease:null};var Xr=Vr;const Je=D,Hr=(r,e,t)=>new Je(r,t).compare(new Je(e,t));var b=Hr;const qr=b,zr=(r,e,t)=>qr(e,r,t);var kr=zr;const Yr=b,Wr=(r,e)=>Yr(r,e,!0);var Kr=Wr;const et=D,Zr=(r,e,t)=>{const n=new et(r,t),s=new et(e,t);return n.compare(s)||n.compareBuild(s)};var Pe=Zr;const Qr=Pe,Jr=(r,e)=>r.sort((t,n)=>Qr(t,n,e));var en=Jr;const tn=Pe,rn=(r,e)=>r.sort((t,n)=>tn(n,t,e));var nn=rn;const sn=b,on=(r,e,t)=>sn(r,e,t)>0;var ve=on;const an=b,cn=(r,e,t)=>an(r,e,t)<0;var be=cn;const ln=b,un=(r,e,t)=>ln(r,e,t)===0;var Lt=un;const hn=b,fn=(r,e,t)=>hn(r,e,t)!==0;var yt=fn;const dn=b,pn=(r,e,t)=>dn(r,e,t)>=0;var Ue=pn;const En=b,mn=(r,e,t)=>En(r,e,t)<=0;var Fe=mn;const vn=Lt,gn=yt,In=ve,$n=Ue,Rn=be,Sn=Fe,Nn=(r,e,t,n)=>{switch(e){case"===":return typeof r=="object"&&(r=r.version),typeof t=="object"&&(t=t.version),r===t;case"!==":return typeof r=="object"&&(r=r.version),typeof t=="object"&&(t=t.version),r!==t;case"":case"=":case"==":return vn(r,t,n);case"!=":return gn(r,t,n);case">":return In(r,t,n);case">=":return $n(r,t,n);case"<":return Rn(r,t,n);case"<=":return Sn(r,t,n);default:throw new TypeError(`Invalid operator: ${e}`)}};var xt=Nn;const Tn=D,On=te,{safeRe:he,t:fe}=ae,An=(r,e)=>{if(r instanceof Tn)return r;if(typeof r=="number"&&(r=String(r)),typeof r!="string")return null;e=e||{};let t=null;if(!e.rtl)t=r.match(e.includePrerelease?he[fe.COERCEFULL]:he[fe.COERCE]);else{const o=e.includePrerelease?he[fe.COERCERTLFULL]:he[fe.COERCERTL];let c;for(;(c=o.exec(r))&&(!t||t.index+t[0].length!==r.length);)(!t||c.index+c[0].length!==t.index+t[0].length)&&(t=c),o.lastIndex=c.index+c[1].length+c[2].length;o.lastIndex=-1}if(t===null)return null;const n=t[2],s=t[3]||"0",i=t[4]||"0",l=e.includePrerelease&&t[5]?`-${t[5]}`:"",u=e.includePrerelease&&t[6]?`+${t[6]}`:"";return On(`${n}.${s}.${i}${l}${u}`,e)};var Ln=An,Re,tt;function yn(){return tt||(tt=1,Re=function(r){r.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}),Re}var xn=N;N.Node=W;N.create=N;function N(r){var e=this;if(e instanceof N||(e=new N),e.tail=null,e.head=null,e.length=0,r&&typeof r.forEach=="function")r.forEach(function(s){e.push(s)});else if(arguments.length>0)for(var t=0,n=arguments.length;t<n;t++)e.push(arguments[t]);return e}N.prototype.removeNode=function(r){if(r.list!==this)throw new Error("removing node which does not belong to this list");var e=r.next,t=r.prev;return e&&(e.prev=t),t&&(t.next=e),r===this.head&&(this.head=e),r===this.tail&&(this.tail=t),r.list.length--,r.next=null,r.prev=null,r.list=null,e};N.prototype.unshiftNode=function(r){if(r!==this.head){r.list&&r.list.removeNode(r);var e=this.head;r.list=this,r.next=e,e&&(e.prev=r),this.head=r,this.tail||(this.tail=r),this.length++}};N.prototype.pushNode=function(r){if(r!==this.tail){r.list&&r.list.removeNode(r);var e=this.tail;r.list=this,r.prev=e,e&&(e.next=r),this.tail=r,this.head||(this.head=r),this.length++}};N.prototype.push=function(){for(var r=0,e=arguments.length;r<e;r++)Dn(this,arguments[r]);return this.length};N.prototype.unshift=function(){for(var r=0,e=arguments.length;r<e;r++)Cn(this,arguments[r]);return this.length};N.prototype.pop=function(){if(this.tail){var r=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,r}};N.prototype.shift=function(){if(this.head){var r=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,r}};N.prototype.forEach=function(r,e){e=e||this;for(var t=this.head,n=0;t!==null;n++)r.call(e,t.value,n,this),t=t.next};N.prototype.forEachReverse=function(r,e){e=e||this;for(var t=this.tail,n=this.length-1;t!==null;n--)r.call(e,t.value,n,this),t=t.prev};N.prototype.get=function(r){for(var e=0,t=this.head;t!==null&&e<r;e++)t=t.next;if(e===r&&t!==null)return t.value};N.prototype.getReverse=function(r){for(var e=0,t=this.tail;t!==null&&e<r;e++)t=t.prev;if(e===r&&t!==null)return t.value};N.prototype.map=function(r,e){e=e||this;for(var t=new N,n=this.head;n!==null;)t.push(r.call(e,n.value,this)),n=n.next;return t};N.prototype.mapReverse=function(r,e){e=e||this;for(var t=new N,n=this.tail;n!==null;)t.push(r.call(e,n.value,this)),n=n.prev;return t};N.prototype.reduce=function(r,e){var t,n=this.head;if(arguments.length>1)t=e;else if(this.head)n=this.head.next,t=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var s=0;n!==null;s++)t=r(t,n.value,s),n=n.next;return t};N.prototype.reduceReverse=function(r,e){var t,n=this.tail;if(arguments.length>1)t=e;else if(this.tail)n=this.tail.prev,t=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var s=this.length-1;n!==null;s--)t=r(t,n.value,s),n=n.prev;return t};N.prototype.toArray=function(){for(var r=new Array(this.length),e=0,t=this.head;t!==null;e++)r[e]=t.value,t=t.next;return r};N.prototype.toArrayReverse=function(){for(var r=new Array(this.length),e=0,t=this.tail;t!==null;e++)r[e]=t.value,t=t.prev;return r};N.prototype.slice=function(r,e){e=e||this.length,e<0&&(e+=this.length),r=r||0,r<0&&(r+=this.length);var t=new N;if(e<r||e<0)return t;r<0&&(r=0),e>this.length&&(e=this.length);for(var n=0,s=this.head;s!==null&&n<r;n++)s=s.next;for(;s!==null&&n<e;n++,s=s.next)t.push(s.value);return t};N.prototype.sliceReverse=function(r,e){e=e||this.length,e<0&&(e+=this.length),r=r||0,r<0&&(r+=this.length);var t=new N;if(e<r||e<0)return t;r<0&&(r=0),e>this.length&&(e=this.length);for(var n=this.length,s=this.tail;s!==null&&n>e;n--)s=s.prev;for(;s!==null&&n>r;n--,s=s.prev)t.push(s.value);return t};N.prototype.splice=function(r,e,...t){r>this.length&&(r=this.length-1),r<0&&(r=this.length+r);for(var n=0,s=this.head;s!==null&&n<r;n++)s=s.next;for(var i=[],n=0;s&&n<e;n++)i.push(s.value),s=this.removeNode(s);s===null&&(s=this.tail),s!==this.head&&s!==this.tail&&(s=s.prev);for(var n=0;n<t.length;n++)s=wn(this,s,t[n]);return i};N.prototype.reverse=function(){for(var r=this.head,e=this.tail,t=r;t!==null;t=t.prev){var n=t.prev;t.prev=t.next,t.next=n}return this.head=e,this.tail=r,this};function wn(r,e,t){var n=e===r.head?new W(t,null,e,r):new W(t,e,e.next,r);return n.next===null&&(r.tail=n),n.prev===null&&(r.head=n),r.length++,n}function Dn(r,e){r.tail=new W(e,r.tail,null,r),r.head||(r.head=r.tail),r.length++}function Cn(r,e){r.head=new W(e,null,r.head,r),r.tail||(r.tail=r.head),r.length++}function W(r,e,t,n){if(!(this instanceof W))return new W(r,e,t,n);this.list=n,this.value=r,e?(e.next=this,this.prev=e):this.prev=null,t?(t.prev=this,this.next=t):this.next=null}try{yn()(N)}catch{}const _n=xn,k=Symbol("max"),B=Symbol("length"),Z=Symbol("lengthCalculator"),oe=Symbol("allowStale"),Y=Symbol("maxAge"),G=Symbol("dispose"),rt=Symbol("noDisposeOnSet"),x=Symbol("lruList"),P=Symbol("cache"),wt=Symbol("updateAgeOnGet"),Se=()=>1;class Pn{constructor(e){if(typeof e=="number"&&(e={max:e}),e||(e={}),e.max&&(typeof e.max!="number"||e.max<0))throw new TypeError("max must be a non-negative number");this[k]=e.max||1/0;const t=e.length||Se;if(this[Z]=typeof t!="function"?Se:t,this[oe]=e.stale||!1,e.maxAge&&typeof e.maxAge!="number")throw new TypeError("maxAge must be a number");this[Y]=e.maxAge||0,this[G]=e.dispose,this[rt]=e.noDisposeOnSet||!1,this[wt]=e.updateAgeOnGet||!1,this.reset()}set max(e){if(typeof e!="number"||e<0)throw new TypeError("max must be a non-negative number");this[k]=e||1/0,ne(this)}get max(){return this[k]}set allowStale(e){this[oe]=!!e}get allowStale(){return this[oe]}set maxAge(e){if(typeof e!="number")throw new TypeError("maxAge must be a non-negative number");this[Y]=e,ne(this)}get maxAge(){return this[Y]}set lengthCalculator(e){typeof e!="function"&&(e=Se),e!==this[Z]&&(this[Z]=e,this[B]=0,this[x].forEach(t=>{t.length=this[Z](t.value,t.key),this[B]+=t.length})),ne(this)}get lengthCalculator(){return this[Z]}get length(){return this[B]}get itemCount(){return this[x].length}rforEach(e,t){t=t||this;for(let n=this[x].tail;n!==null;){const s=n.prev;nt(this,e,n,t),n=s}}forEach(e,t){t=t||this;for(let n=this[x].head;n!==null;){const s=n.next;nt(this,e,n,t),n=s}}keys(){return this[x].toArray().map(e=>e.key)}values(){return this[x].toArray().map(e=>e.value)}reset(){this[G]&&this[x]&&this[x].length&&this[x].forEach(e=>this[G](e.key,e.value)),this[P]=new Map,this[x]=new _n,this[B]=0}dump(){return this[x].map(e=>de(this,e)?!1:{k:e.key,v:e.value,e:e.now+(e.maxAge||0)}).toArray().filter(e=>e)}dumpLru(){return this[x]}set(e,t,n){if(n=n||this[Y],n&&typeof n!="number")throw new TypeError("maxAge must be a number");const s=n?Date.now():0,i=this[Z](t,e);if(this[P].has(e)){if(i>this[k])return J(this,this[P].get(e)),!1;const o=this[P].get(e).value;return this[G]&&(this[rt]||this[G](e,o.value)),o.now=s,o.maxAge=n,o.value=t,this[B]+=i-o.length,o.length=i,this.get(e),ne(this),!0}const l=new bn(e,t,i,s,n);return l.length>this[k]?(this[G]&&this[G](e,t),!1):(this[B]+=l.length,this[x].unshift(l),this[P].set(e,this[x].head),ne(this),!0)}has(e){if(!this[P].has(e))return!1;const t=this[P].get(e).value;return!de(this,t)}get(e){return Ne(this,e,!0)}peek(e){return Ne(this,e,!1)}pop(){const e=this[x].tail;return e?(J(this,e),e.value):null}del(e){J(this,this[P].get(e))}load(e){this.reset();const t=Date.now();for(let n=e.length-1;n>=0;n--){const s=e[n],i=s.e||0;if(i===0)this.set(s.k,s.v);else{const l=i-t;l>0&&this.set(s.k,s.v,l)}}}prune(){this[P].forEach((e,t)=>Ne(this,t,!1))}}const Ne=(r,e,t)=>{const n=r[P].get(e);if(n){const s=n.value;if(de(r,s)){if(J(r,n),!r[oe])return}else t&&(r[wt]&&(n.value.now=Date.now()),r[x].unshiftNode(n));return s.value}},de=(r,e)=>{if(!e||!e.maxAge&&!r[Y])return!1;const t=Date.now()-e.now;return e.maxAge?t>e.maxAge:r[Y]&&t>r[Y]},ne=r=>{if(r[B]>r[k])for(let e=r[x].tail;r[B]>r[k]&&e!==null;){const t=e.prev;J(r,e),e=t}},J=(r,e)=>{if(e){const t=e.value;r[G]&&r[G](t.key,t.value),r[B]-=t.length,r[P].delete(t.key),r[x].removeNode(e)}};class bn{constructor(e,t,n,s,i){this.key=e,this.value=t,this.length=n,this.now=s,this.maxAge=i||0}}const nt=(r,e,t,n)=>{let s=t.value;de(r,s)&&(J(r,t),r[oe]||(s=void 0)),s&&e.call(n,s.value,s.key,r)};var Un=Pn,Te,st;function U(){if(st)return Te;st=1;class r{constructor(f,$){if($=n($),f instanceof r)return f.loose===!!$.loose&&f.includePrerelease===!!$.includePrerelease?f:new r(f.raw,$);if(f instanceof s)return this.raw=f.value,this.set=[[f]],this.format(),this;if(this.options=$,this.loose=!!$.loose,this.includePrerelease=!!$.includePrerelease,this.raw=f.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map(g=>this.parseRange(g.trim())).filter(g=>g.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const g=this.set[0];if(this.set=this.set.filter(I=>!v(I[0])),this.set.length===0)this.set=[g];else if(this.set.length>1){for(const I of this.set)if(I.length===1&&V(I[0])){this.set=[I];break}}}this.format()}format(){return this.range=this.set.map(f=>f.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(f){const g=((this.options.includePrerelease&&T)|(this.options.loose&&m))+":"+f,I=t.get(g);if(I)return I;const E=this.options.loose,R=E?u[o.HYPHENRANGELOOSE]:u[o.HYPHENRANGE];f=f.replace(R,Vt(this.options.includePrerelease)),i("hyphen replace",f),f=f.replace(u[o.COMPARATORTRIM],c),i("comparator trim",f),f=f.replace(u[o.TILDETRIM],h),i("tilde trim",f),f=f.replace(u[o.CARETTRIM],d),i("caret trim",f);let O=f.split(" ").map(L=>q(L,this.options)).join(" ").split(/\s+/).map(L=>jt(L,this.options));E&&(O=O.filter(L=>(i("loose invalid filter",L,this.options),!!L.match(u[o.COMPARATORLOOSE])))),i("range list",O);const S=new Map,A=O.map(L=>new s(L,this.options));for(const L of A){if(v(L))return[L];S.set(L.value,L)}S.size>1&&S.has("")&&S.delete("");const C=[...S.values()];return t.set(g,C),C}intersects(f,$){if(!(f instanceof r))throw new TypeError("a Range is required");return this.set.some(g=>_(g,$)&&f.set.some(I=>_(I,$)&&g.every(E=>I.every(R=>E.intersects(R,$)))))}test(f){if(!f)return!1;if(typeof f=="string")try{f=new l(f,this.options)}catch{return!1}for(let $=0;$<this.set.length;$++)if(Xt(this.set[$],f,this.options))return!0;return!1}}Te=r;const e=Un,t=new e({max:1e3}),n=_e,s=ge(),i=me,l=D,{safeRe:u,t:o,comparatorTrimReplace:c,tildeTrimReplace:h,caretTrimReplace:d}=ae,{FLAG_INCLUDE_PRERELEASE:T,FLAG_LOOSE:m}=Ee,v=p=>p.value==="<0.0.0-0",V=p=>p.value==="",_=(p,f)=>{let $=!0;const g=p.slice();let I=g.pop();for(;$&&g.length;)$=g.every(E=>I.intersects(E,f)),I=g.pop();return $},q=(p,f)=>(i("comp",p,f),p=Ut(p,f),i("caret",p),p=z(p,f),i("tildes",p),p=Gt(p,f),i("xrange",p),p=Mt(p,f),i("stars",p),p),w=p=>!p||p.toLowerCase()==="x"||p==="*",z=(p,f)=>p.trim().split(/\s+/).map($=>bt($,f)).join(" "),bt=(p,f)=>{const $=f.loose?u[o.TILDELOOSE]:u[o.TILDE];return p.replace($,(g,I,E,R,O)=>{i("tilde",p,g,I,E,R,O);let S;return w(I)?S="":w(E)?S=`>=${I}.0.0 <${+I+1}.0.0-0`:w(R)?S=`>=${I}.${E}.0 <${I}.${+E+1}.0-0`:O?(i("replaceTilde pr",O),S=`>=${I}.${E}.${R}-${O} <${I}.${+E+1}.0-0`):S=`>=${I}.${E}.${R} <${I}.${+E+1}.0-0`,i("tilde return",S),S})},Ut=(p,f)=>p.trim().split(/\s+/).map($=>Ft($,f)).join(" "),Ft=(p,f)=>{i("caret",p,f);const $=f.loose?u[o.CARETLOOSE]:u[o.CARET],g=f.includePrerelease?"-0":"";return p.replace($,(I,E,R,O,S)=>{i("caret",p,I,E,R,O,S);let A;return w(E)?A="":w(R)?A=`>=${E}.0.0${g} <${+E+1}.0.0-0`:w(O)?E==="0"?A=`>=${E}.${R}.0${g} <${E}.${+R+1}.0-0`:A=`>=${E}.${R}.0${g} <${+E+1}.0.0-0`:S?(i("replaceCaret pr",S),E==="0"?R==="0"?A=`>=${E}.${R}.${O}-${S} <${E}.${R}.${+O+1}-0`:A=`>=${E}.${R}.${O}-${S} <${E}.${+R+1}.0-0`:A=`>=${E}.${R}.${O}-${S} <${+E+1}.0.0-0`):(i("no pr"),E==="0"?R==="0"?A=`>=${E}.${R}.${O}${g} <${E}.${R}.${+O+1}-0`:A=`>=${E}.${R}.${O}${g} <${E}.${+R+1}.0-0`:A=`>=${E}.${R}.${O} <${+E+1}.0.0-0`),i("caret return",A),A})},Gt=(p,f)=>(i("replaceXRanges",p,f),p.split(/\s+/).map($=>Bt($,f)).join(" ")),Bt=(p,f)=>{p=p.trim();const $=f.loose?u[o.XRANGELOOSE]:u[o.XRANGE];return p.replace($,(g,I,E,R,O,S)=>{i("xRange",p,g,I,E,R,O,S);const A=w(E),C=A||w(R),L=C||w(O),re=L;return I==="="&&re&&(I=""),S=f.includePrerelease?"-0":"",A?I===">"||I==="<"?g="<0.0.0-0":g="*":I&&re?(C&&(R=0),O=0,I===">"?(I=">=",C?(E=+E+1,R=0,O=0):(R=+R+1,O=0)):I==="<="&&(I="<",C?E=+E+1:R=+R+1),I==="<"&&(S="-0"),g=`${I+E}.${R}.${O}${S}`):C?g=`>=${E}.0.0${S} <${+E+1}.0.0-0`:L&&(g=`>=${E}.${R}.0${S} <${E}.${+R+1}.0-0`),i("xRange return",g),g})},Mt=(p,f)=>(i("replaceStars",p,f),p.trim().replace(u[o.STAR],"")),jt=(p,f)=>(i("replaceGTE0",p,f),p.trim().replace(u[f.includePrerelease?o.GTE0PRE:o.GTE0],"")),Vt=p=>(f,$,g,I,E,R,O,S,A,C,L,re,di)=>(w(g)?$="":w(I)?$=`>=${g}.0.0${p?"-0":""}`:w(E)?$=`>=${g}.${I}.0${p?"-0":""}`:R?$=`>=${$}`:$=`>=${$}${p?"-0":""}`,w(A)?S="":w(C)?S=`<${+A+1}.0.0-0`:w(L)?S=`<${A}.${+C+1}.0-0`:re?S=`<=${A}.${C}.${L}-${re}`:p?S=`<${A}.${C}.${+L+1}-0`:S=`<=${S}`,`${$} ${S}`.trim()),Xt=(p,f,$)=>{for(let g=0;g<p.length;g++)if(!p[g].test(f))return!1;if(f.prerelease.length&&!$.includePrerelease){for(let g=0;g<p.length;g++)if(i(p[g].semver),p[g].semver!==s.ANY&&p[g].semver.prerelease.length>0){const I=p[g].semver;if(I.major===f.major&&I.minor===f.minor&&I.patch===f.patch)return!0}return!1}return!0};return Te}var Oe,it;function ge(){if(it)return Oe;it=1;const r=Symbol("SemVer ANY");class e{static get ANY(){return r}constructor(h,d){if(d=t(d),h instanceof e){if(h.loose===!!d.loose)return h;h=h.value}h=h.trim().split(/\s+/).join(" "),l("comparator",h,d),this.options=d,this.loose=!!d.loose,this.parse(h),this.semver===r?this.value="":this.value=this.operator+this.semver.version,l("comp",this)}parse(h){const d=this.options.loose?n[s.COMPARATORLOOSE]:n[s.COMPARATOR],T=h.match(d);if(!T)throw new TypeError(`Invalid comparator: ${h}`);this.operator=T[1]!==void 0?T[1]:"",this.operator==="="&&(this.operator=""),T[2]?this.semver=new u(T[2],this.options.loose):this.semver=r}toString(){return this.value}test(h){if(l("Comparator.test",h,this.options.loose),this.semver===r||h===r)return!0;if(typeof h=="string")try{h=new u(h,this.options)}catch{return!1}return i(h,this.operator,this.semver,this.options)}intersects(h,d){if(!(h instanceof e))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new o(h.value,d).test(this.value):h.operator===""?h.value===""?!0:new o(this.value,d).test(h.semver):(d=t(d),d.includePrerelease&&(this.value==="<0.0.0-0"||h.value==="<0.0.0-0")||!d.includePrerelease&&(this.value.startsWith("<0.0.0")||h.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&h.operator.startsWith(">")||this.operator.startsWith("<")&&h.operator.startsWith("<")||this.semver.version===h.semver.version&&this.operator.includes("=")&&h.operator.includes("=")||i(this.semver,"<",h.semver,d)&&this.operator.startsWith(">")&&h.operator.startsWith("<")||i(this.semver,">",h.semver,d)&&this.operator.startsWith("<")&&h.operator.startsWith(">")))}}Oe=e;const t=_e,{safeRe:n,t:s}=ae,i=xt,l=me,u=D,o=U();return Oe}const Fn=U(),Gn=(r,e,t)=>{try{e=new Fn(e,t)}catch{return!1}return e.test(r)};var Ie=Gn;const Bn=U(),Mn=(r,e)=>new Bn(r,e).set.map(t=>t.map(n=>n.value).join(" ").trim().split(" "));var jn=Mn;const Vn=D,Xn=U(),Hn=(r,e,t)=>{let n=null,s=null,i=null;try{i=new Xn(e,t)}catch{return null}return r.forEach(l=>{i.test(l)&&(!n||s.compare(l)===-1)&&(n=l,s=new Vn(n,t))}),n};var qn=Hn;const zn=D,kn=U(),Yn=(r,e,t)=>{let n=null,s=null,i=null;try{i=new kn(e,t)}catch{return null}return r.forEach(l=>{i.test(l)&&(!n||s.compare(l)===1)&&(n=l,s=new zn(n,t))}),n};var Wn=Yn;const Ae=D,Kn=U(),ot=ve,Zn=(r,e)=>{r=new Kn(r,e);let t=new Ae("0.0.0");if(r.test(t)||(t=new Ae("0.0.0-0"),r.test(t)))return t;t=null;for(let n=0;n<r.set.length;++n){const s=r.set[n];let i=null;s.forEach(l=>{const u=new Ae(l.semver.version);switch(l.operator){case">":u.prerelease.length===0?u.patch++:u.prerelease.push(0),u.raw=u.format();case"":case">=":(!i||ot(u,i))&&(i=u);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${l.operator}`)}}),i&&(!t||ot(t,i))&&(t=i)}return t&&r.test(t)?t:null};var Qn=Zn;const Jn=U(),es=(r,e)=>{try{return new Jn(r,e).range||"*"}catch{return null}};var ts=es;const rs=D,Dt=ge(),{ANY:ns}=Dt,ss=U(),is=Ie,at=ve,ct=be,os=Fe,as=Ue,cs=(r,e,t,n)=>{r=new rs(r,n),e=new ss(e,n);let s,i,l,u,o;switch(t){case">":s=at,i=os,l=ct,u=">",o=">=";break;case"<":s=ct,i=as,l=at,u="<",o="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(is(r,e,n))return!1;for(let c=0;c<e.set.length;++c){const h=e.set[c];let d=null,T=null;if(h.forEach(m=>{m.semver===ns&&(m=new Dt(">=0.0.0")),d=d||m,T=T||m,s(m.semver,d.semver,n)?d=m:l(m.semver,T.semver,n)&&(T=m)}),d.operator===u||d.operator===o||(!T.operator||T.operator===u)&&i(r,T.semver))return!1;if(T.operator===o&&l(r,T.semver))return!1}return!0};var Ge=cs;const ls=Ge,us=(r,e,t)=>ls(r,e,">",t);var hs=us;const fs=Ge,ds=(r,e,t)=>fs(r,e,"<",t);var ps=ds;const lt=U(),Es=(r,e,t)=>(r=new lt(r,t),e=new lt(e,t),r.intersects(e,t));var ms=Es;const vs=Ie,gs=b;var Is=(r,e,t)=>{const n=[];let s=null,i=null;const l=r.sort((h,d)=>gs(h,d,t));for(const h of l)vs(h,e,t)?(i=h,s||(s=h)):(i&&n.push([s,i]),i=null,s=null);s&&n.push([s,null]);const u=[];for(const[h,d]of n)h===d?u.push(h):!d&&h===l[0]?u.push("*"):d?h===l[0]?u.push(`<=${d}`):u.push(`${h} - ${d}`):u.push(`>=${h}`);const o=u.join(" || "),c=typeof e.raw=="string"?e.raw:String(e);return o.length<c.length?o:e};const ut=U(),Be=ge(),{ANY:Le}=Be,se=Ie,Me=b,$s=(r,e,t={})=>{if(r===e)return!0;r=new ut(r,t),e=new ut(e,t);let n=!1;e:for(const s of r.set){for(const i of e.set){const l=Ss(s,i,t);if(n=n||l!==null,l)continue e}if(n)return!1}return!0},Rs=[new Be(">=0.0.0-0")],ht=[new Be(">=0.0.0")],Ss=(r,e,t)=>{if(r===e)return!0;if(r.length===1&&r[0].semver===Le){if(e.length===1&&e[0].semver===Le)return!0;t.includePrerelease?r=Rs:r=ht}if(e.length===1&&e[0].semver===Le){if(t.includePrerelease)return!0;e=ht}const n=new Set;let s,i;for(const m of r)m.operator===">"||m.operator===">="?s=ft(s,m,t):m.operator==="<"||m.operator==="<="?i=dt(i,m,t):n.add(m.semver);if(n.size>1)return null;let l;if(s&&i){if(l=Me(s.semver,i.semver,t),l>0)return null;if(l===0&&(s.operator!==">="||i.operator!=="<="))return null}for(const m of n){if(s&&!se(m,String(s),t)||i&&!se(m,String(i),t))return null;for(const v of e)if(!se(m,String(v),t))return!1;return!0}let u,o,c,h,d=i&&!t.includePrerelease&&i.semver.prerelease.length?i.semver:!1,T=s&&!t.includePrerelease&&s.semver.prerelease.length?s.semver:!1;d&&d.prerelease.length===1&&i.operator==="<"&&d.prerelease[0]===0&&(d=!1);for(const m of e){if(h=h||m.operator===">"||m.operator===">=",c=c||m.operator==="<"||m.operator==="<=",s){if(T&&m.semver.prerelease&&m.semver.prerelease.length&&m.semver.major===T.major&&m.semver.minor===T.minor&&m.semver.patch===T.patch&&(T=!1),m.operator===">"||m.operator===">="){if(u=ft(s,m,t),u===m&&u!==s)return!1}else if(s.operator===">="&&!se(s.semver,String(m),t))return!1}if(i){if(d&&m.semver.prerelease&&m.semver.prerelease.length&&m.semver.major===d.major&&m.semver.minor===d.minor&&m.semver.patch===d.patch&&(d=!1),m.operator==="<"||m.operator==="<="){if(o=dt(i,m,t),o===m&&o!==i)return!1}else if(i.operator==="<="&&!se(i.semver,String(m),t))return!1}if(!m.operator&&(i||s)&&l!==0)return!1}return!(s&&c&&!i&&l!==0||i&&h&&!s&&l!==0||T||d)},ft=(r,e,t)=>{if(!r)return e;const n=Me(r.semver,e.semver,t);return n>0?r:n<0||e.operator===">"&&r.operator===">="?e:r},dt=(r,e,t)=>{if(!r)return e;const n=Me(r.semver,e.semver,t);return n<0?r:n>0||e.operator==="<"&&r.operator==="<="?e:r};var Ns=$s;const ye=ae,pt=Ee,Ts=D,Et=At,Os=te,As=Tr,Ls=Lr,ys=xr,xs=Dr,ws=Pr,Ds=Fr,Cs=Mr,_s=Xr,Ps=b,bs=kr,Us=Kr,Fs=Pe,Gs=en,Bs=nn,Ms=ve,js=be,Vs=Lt,Xs=yt,Hs=Ue,qs=Fe,zs=xt,ks=Ln,Ys=ge(),Ws=U(),Ks=Ie,Zs=jn,Qs=qn,Js=Wn,ei=Qn,ti=ts,ri=Ge,ni=hs,si=ps,ii=ms,oi=Is,ai=Ns;var ci={parse:Os,valid:As,clean:Ls,inc:ys,diff:xs,major:ws,minor:Ds,patch:Cs,prerelease:_s,compare:Ps,rcompare:bs,compareLoose:Us,compareBuild:Fs,sort:Gs,rsort:Bs,gt:Ms,lt:js,eq:Vs,neq:Xs,gte:Hs,lte:qs,cmp:zs,coerce:ks,Comparator:Ys,Range:Ws,satisfies:Ks,toComparators:Zs,maxSatisfying:Qs,minSatisfying:Js,minVersion:ei,validRange:ti,outside:ri,gtr:ni,ltr:si,intersects:ii,simplifyRange:oi,subset:ai,SemVer:Ts,re:ye.re,src:ye.src,tokens:ye.t,SEMVER_SPEC_VERSION:pt.SEMVER_SPEC_VERSION,RELEASE_TYPES:pt.RELEASE_TYPES,compareIdentifiers:Et.compareIdentifiers,rcompareIdentifiers:Et.rcompareIdentifiers};const mt=qt(ci);var y;(function(r){r.blue="blue",r.nanoS="nanoS",r.nanoSP="nanoSP",r.nanoX="nanoX",r.stax="stax",r.europa="europa"})(y||(y={}));const we={[y.blue]:{id:y.blue,productName:"Ledger Blue",productIdMM:0,legacyUsbProductId:0,usbOnly:!0,memorySize:480*1024,masks:[822083584,822149120],getBlockSize:r=>4*1024},[y.nanoS]:{id:y.nanoS,productName:"Ledger Nano S",productIdMM:16,legacyUsbProductId:1,usbOnly:!0,memorySize:320*1024,masks:[823132160],getBlockSize:r=>{var e;return mt.lt((e=mt.coerce(r))!==null&&e!==void 0?e:"","2.0.0")?4*1024:2*1024}},[y.nanoX]:{id:y.nanoX,productName:"Ledger Nano X",productIdMM:64,legacyUsbProductId:4,usbOnly:!1,memorySize:2*1024*1024,masks:[855638016],getBlockSize:r=>4*1024,bluetoothSpec:[{serviceUuid:"13d63400-2c97-0004-0000-4c6564676572",notifyUuid:"13d63400-2c97-0004-0001-4c6564676572",writeUuid:"13d63400-2c97-0004-0002-4c6564676572",writeCmdUuid:"13d63400-2c97-0004-0003-4c6564676572"}]},[y.nanoSP]:{id:y.nanoSP,productName:"Ledger Nano S Plus",productIdMM:80,legacyUsbProductId:5,usbOnly:!0,memorySize:1533*1024,masks:[856686592],getBlockSize:r=>32},[y.stax]:{id:y.stax,productName:"Ledger Stax",productIdMM:96,legacyUsbProductId:6,usbOnly:!1,memorySize:1533*1024,masks:[857735168],getBlockSize:r=>32,bluetoothSpec:[{serviceUuid:"13d63400-2c97-6004-0000-4c6564676572",notifyUuid:"13d63400-2c97-6004-0001-4c6564676572",writeUuid:"13d63400-2c97-6004-0002-4c6564676572",writeCmdUuid:"13d63400-2c97-6004-0003-4c6564676572"}]},[y.europa]:{id:y.europa,productName:"Ledger Europa",productIdMM:112,legacyUsbProductId:7,usbOnly:!1,memorySize:1533*1024,masks:[858783744],getBlockSize:r=>32,bluetoothSpec:[{serviceUuid:"13d63400-2c97-3004-0000-4c6564676572",notifyUuid:"13d63400-2c97-3004-0001-4c6564676572",writeUuid:"13d63400-2c97-3004-0002-4c6564676572",writeCmdUuid:"13d63400-2c97-3004-0003-4c6564676572"}]}};y.blue,y.nanoS,y.nanoSP,y.nanoX,y.stax,y.europa;const vt=Object.values(we),Ct=11415,_t=r=>{const e=vt.find(s=>s.legacyUsbProductId===r);if(e)return e;const t=r>>8;return vt.find(s=>s.productIdMM===t)},li=[],gt={};for(const r in we){const e=we[r],{bluetoothSpec:t}=e;if(t)for(let n=0;n<t.length;n++){const s=t[n];li.push(s.serviceUuid),gt[s.serviceUuid]=gt[s.serviceUuid.replace(/-/g,"")]=Object.assign({deviceModel:e},s)}}var M=function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(l){l(i)})}return new(t||(t=Promise))(function(i,l){function u(h){try{c(n.next(h))}catch(d){l(d)}}function o(h){try{c(n.throw(h))}catch(d){l(d)}}function c(h){h.done?i(h.value):s(h.value).then(u,o)}c((n=n.apply(r,e||[])).next())})};const ui=[{vendorId:Ct}],hi=()=>Promise.resolve(!!(window.navigator&&window.navigator.hid)),pe=()=>{const{hid:r}=navigator;if(!r)throw new j("navigator.hid is not supported","HIDNotSupported");return r};function Pt(){return M(this,void 0,void 0,function*(){const r=yield pe().requestDevice({filters:ui});return Array.isArray(r)?r:[r]})}function je(){return M(this,void 0,void 0,function*(){return(yield pe().getDevices()).filter(e=>e.vendorId===Ct)})}function fi(){return M(this,void 0,void 0,function*(){const r=yield je();return r.length>0?r[0]:(yield Pt())[0]})}class H extends Ce{constructor(e){super(),this.channel=Math.floor(Math.random()*65535),this.packetSize=64,this.inputs=[],this.read=()=>this.inputs.length?Promise.resolve(this.inputs.shift()):new Promise(t=>{this.inputCallback=t}),this.onInputReport=t=>{const n=Buffer.from(t.data.buffer);this.inputCallback?(this.inputCallback(n),this.inputCallback=null):this.inputs.push(n)},this._disconnectEmitted=!1,this._emitDisconnect=t=>{this._disconnectEmitted||(this._disconnectEmitted=!0,this.emit("disconnect",t))},this.exchange=t=>M(this,void 0,void 0,function*(){return yield this.exchangeAtomicImpl(()=>M(this,void 0,void 0,function*(){const{channel:s,packetSize:i}=this;He("apdu","=> "+t.toString("hex"));const l=cr(s,i),u=l.makeBlocks(t);for(let h=0;h<u.length;h++)yield this.device.sendReport(0,u[h]);let o,c;for(;!(o=l.getReducedResult(c));){const h=yield this.read();c=l.reduceResponse(c,h)}return He("apdu","<= "+o.toString("hex")),o})).catch(s=>{throw s&&s.message&&s.message.includes("write")?(this._emitDisconnect(s),new er(s.message)):s})}),this.device=e,this.deviceModel=typeof e.productId=="number"?_t(e.productId):void 0,e.addEventListener("inputreport",this.onInputReport)}static request(){return M(this,void 0,void 0,function*(){const[e]=yield Pt();return H.open(e)})}static openConnected(){return M(this,void 0,void 0,function*(){const e=yield je();return e.length===0?null:H.open(e[0])})}static open(e){return M(this,void 0,void 0,function*(){yield e.open();const t=new H(e),n=s=>{e===s.device&&(pe().removeEventListener("disconnect",n),t._emitDisconnect(new Jt))};return pe().addEventListener("disconnect",n),t})}close(){return M(this,void 0,void 0,function*(){yield this.exchangeBusyPromise,this.device.removeEventListener("inputreport",this.onInputReport),yield this.device.close()})}setScrambleKey(){}}H.isSupported=hi;H.list=je;H.listen=r=>{let e=!1;fi().then(n=>{if(!n)r.error(new Ve("Access denied to use Ledger device"));else if(!e){const s=typeof n.productId=="number"?_t(n.productId):void 0;r.next({type:"add",descriptor:n,deviceModel:s}),r.complete()}},n=>{r.error(new Ve(n.message))});function t(){e=!0}return{unsubscribe:t}};const It=r=>new Promise((e,t)=>{setTimeout(()=>{console.log("timed out"),t(new Error("timed out"))},r)}),$t=3e5,mi=async(r,e={derivationType:Wt.ED25519})=>{const t=await Promise.race([H.create(),It($t)]);try{const n=await zt(r),{accountId:s,tezos:i,isActivated:l}=await Promise.race([await Yt(n,t,e),It($t)]),u={id:s,isActivated:l,type:"ledger",network:r.id.toString(),explorer:n.explorer,rpc:n.rpc,balance:0n,stakedBalance:0n,fullBalance:0n},o=i;return o.signOperation=async d=>({signature:(await i.signer.sign(d,new Uint8Array([3]))).sbytes.slice(d.length)}),{...await kt(u,o),logout:async()=>{t.close()}}}catch(n){throw t.close(),n}};export{mi as createLedgerSession};
